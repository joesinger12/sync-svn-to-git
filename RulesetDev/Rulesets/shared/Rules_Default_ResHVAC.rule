; -------------------------------------------------------------------------
; Rules pertaining to:   Defaulting the Proposed Building Model's HVAC objects
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------

ENUM_PROPERTIES_VALUE   ; ensures retrieval/logic/us of enum properties assume numeric value (alternative is ENUM_PROPERTIES_STRING)

; SAC 10/24/16 - new rulelist to default zone height, HVAC & cool vent properties
;*************************************************************************
RULELIST "ProposedInput_HVAC" 0 0 0 0
;*************************************************************************
   ;--------------------------------------------------------------------
   ; ProposedInput: HVAC System Rules
   ;--------------------------------------------------------------------
;	"Set ResZn:Top"			ResZn:Top 	= {	Local( Bottom ) + (Local( FloorHeight ) * Local( NumStories ))  }
	"Set ResZn:Top"			ResZn:Top 	= {	Bottom + (FloorHeight * (NumStories - 1)) + CeilingHeight  }
;	"Set ResOtherZn:Top"	ResOtherZn:Top 	= {	Bottom + (FloorHeight * (NumStories - 1)) + ValidOr( CeilingHeight, 9 )  }      ; SAC 9/18/19 - (MFamProto)

; debugging
;"dbg" ResProj:Action = { MessageBox( "ResProj:NumStories >\n   MaxAll( ResZn:Top ) = %g\n   MaxAll( ResOtherZn:Top ) = %g\n   MinAll( ResZn:Bottom ) = %g\n   MinAll( ResOtherZn:Bottom ) = %g\n   SumAll( ResZn:CeilingHeight ) = %g\n   SumAll( ResOtherZn:CeilingHeight ) = %g\n   # Zone + OtherZone = %g",
;            MaxAll( ResZn:Top ), MaxAll( ResOtherZn:Top ), MinAll( ResZn:Bottom ), MinAll( ResOtherZn:Bottom ), SumAll( ResZn:CeilingHeight ), SumAll( ResOtherZn:CeilingHeight ), ComponentCount( Zone ) + ComponentCount( OtherZone ) ) }
	; SAC 10/22/12 - should work reasonably well for floors < 4-5 and floor & ceiling heights fairly close to each other
	; SAC 4/8/13 - added "2 +" into formulaa to resolve issue believed to be decimal precision related, causing ResProj:NumStories to truncate to 0
	"Set ResProj:NumStories"			ResProj:NumStories		= {
		if (ComponentCount( Zone ) < 1 .AND. ComponentCount( OtherZone ) < 1) then  1
		else if (SumAll( ResZn:CeilingHeight ) < 1 .AND. SumAll( ResOtherZn:CeilingHeight ) < 1) then  1
		else if (ComponentCount( Zone ) > 0 .AND. ComponentCount( OtherZone ) > 0)
		then  (2 + max( MaxAll( ResZn:Top    ), MaxAll( ResOtherZn:Top    ) ) -
		           min( MinAll( ResZn:Bottom ), MinAll( ResOtherZn:Bottom ) )) / 
		       ((SumAll( ResZn:CeilingHeight ) + SumAll( ResOtherZn:CeilingHeight )) /
		        (ComponentCount( Zone ) + ComponentCount( OtherZone )))
		else  (2 + MaxAll( ResZn:Top ) - MinAll( ResZn:Bottom )) / 
		       (SumAll( ResZn:CeilingHeight ) / ComponentCount( Zone ))
		endif endif endif  }

   "Set ResZn:Top_HasDHW"            ResZn:Top_HasDHW         = {   if (HasDHWUse) then  Top    + ((FloorHeight/2) * (Mult - 1))  else  UNDEFINED  endif  }    ; SAC 08/30/20
   "Set ResOtherZn:Top_HasDHW"       ResOtherZn:Top_HasDHW    = {   if (HasDHWUse) then  Top    + ((FloorHeight/2) * (Mult - 1))  else  UNDEFINED  endif  }    ; adjusted for flr mults - SAC 04/26/23 (tic #3392)
   "Set ResZn:Bottom_HasDHW"         ResZn:Bottom_HasDHW      = {   if (HasDHWUse) then  Bottom - ((FloorHeight/2) * (Mult - 1))  else  UNDEFINED  endif  }
   "Set ResOtherZn:Bottom_HasDHW"    ResOtherZn:Bottom_HasDHW = {   if (HasDHWUse) then  Bottom - ((FloorHeight/2) * (Mult - 1))  else  UNDEFINED  endif  }
	"Set ResProj:NumStories_HasDHW"		ResProj:NumStories_HasDHW	=                                ; added for DHW-related calcs - SAC 08/30/20
	{	if (ComponentCount( Zone ) < 1 .AND. ComponentCount( OtherZone ) < 1) then  1
		else if (SumAll( ResZn:Top_HasDHW ) < 1 .AND. SumAll( ResOtherZn:Top_HasDHW ) < 1) then  1
		else if (ComponentCount( Zone ) > 0 .AND. ComponentCount( OtherZone ) > 0)
		then  (2 + max( MaxAll( ResZn:Top_HasDHW    ), MaxAll( ResOtherZn:Top_HasDHW    ) ) -
		           min( MinAll( ResZn:Bottom_HasDHW ), MinAll( ResOtherZn:Bottom_HasDHW ) )) / 
		       ((SumAcrossIf( ResZn:CeilingHeight, ResZn:HasDHWUse ) + SumAcrossIf( ResOtherZn:CeilingHeight, ResOtherZn:HasDHWUse )) /
		        (SumAll( ResZn:HasDHWUse ) + SumAll( ResOtherZn:HasDHWUse )))
		else  (2 + MaxAll( ResZn:Top_HasDHW ) - MinAll( ResZn:Bottom_HasDHW )) / 
		       (SumAcrossIf( ResZn:CeilingHeight, ResZn:HasDHWUse ) / SumAll( ResZn:HasDHWUse ))
		endif endif endif  }

   "Call rulelist to UN-assign HVACSys objects from Zones in MFam models"     ResZn:Action =        ; SAC 04/09/21
      {  if (ResProj:IsMultiFamily < 0.5 .OR. ResProj:RunAbbrev != "u" .OR. IfValidAnd( Proj:DefaultingRounds > 2 )) then  UNCHANGED   
         else if (LocalCompAssigned( HVACSystem    ) > 0 .OR.
                  LocalCompAssigned( AltHVACSystem ) > 0 .OR.
                  LocalCompAssigned( exHVACSystem  ) > 0)
         then  EvalRulelist( "Blast_Zone_HVACSys_Assignments", 1 )
         else  UNCHANGED  endif endif  }

;	mjb	10/27/14	Force assignment of HVACSystem from ActiveHVACSystem for AA & E+A+A when HVAC is existing
	"Force HVAC assignment for Additions Alone"	ResZn:Action	=	{
	   if ( (ResProj:IsAddAlone > 0.5 .OR. ResProj:RunScope == 2) .AND. HVACSysStatus == 1)
	   then  EvalRulelist( "ForceDefault_Zone_HVAC", 1 )  else  UNCHANGED  endif  }

	"Consolidate all HVAC defaulting rules"	ResProj:Action	= {	EvalRulelist( "Default_AllHVAC" )  }

   ; SAC 1/20/19 - moved HERE here mid-Shell defaulting to so that ClVentFan properties are defaulted before referenced (tic #1040)
   "Set ResZn:ClVent*"	ResProj:Action	= {	if (IsMultiFamily < 0.5)
														then  EvalRulelist( "Set_ZoneClVent_SFam" )
														else	EvalRulelist( "Set_ZoneClVent_MFam" )  endif  }

; SAC 12/31/15 - added new calcs & message to estimate & report attic relief vent free area for display in cool vent tab of project tabbed dialog (ticket #596)
	"Set ResProj:ClVentAtticRelief"	ResProj:ClVentAtticRelief	= {
		if (SumAll( ResAttic:ClVentableVolume ) < 0.1) then  0
		else if (UnitClVentOption == 3)		; CFI Cool Vent
		then	SumAll( ResHVACSys:AirNet_CoolVent   ) * UnitClVenTAreaMult / 
		         T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", BldgTypeTblStr )
		else	ValidOr( ResProj:UnitClVentCFMTot, 0 ) * UnitClVenTAreaMult / 
		         T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", BldgTypeTblStr )		endif endif  }
	"Set ResProj:ClVentAtticRelMsg"	ResProj:ClVentAtticRelMsg	= {
		if (ClVentAtticRelief < 0.01) then  " "
		else  Format( "%.1f ft2 of Attic Relief Vent Free Area", ClVentAtticRelief )  endif  }

   ; SAC 2/14/18 - added new cool vent fan power message (tic #977)
   ; SAC 1/20/19 - revised for new 'Whole House Fan exhausting to outside' UnitClVentOption option (tic #1040)
   "Set ResProj:ClVentFanPowerTot-1"   ResProj:ClVentFanPowerTot = {
      if ((EnableClVent < 0.5 .AND. LimitedClVent < 0.5) .OR. UnitClVentOption < 1) then  0
      else if (UnitClVentOption == 1 .OR. UnitClVentOption == 5)
      then 	T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", BldgTypeTblStr ) * ValidOr( UnitClVentCFMTot, 0 )
      else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[1] ))
      then	ValidOr( UnitClVentFan[1]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[1]:CoolingVent, 0 )
      else  0  endif endif endif  }
   "Set ResProj:ClVentFanPowerTot-2"   ResProj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[2] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[2]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[2]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set ResProj:ClVentFanPowerTot-3"   ResProj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[3] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[3]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[3]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set ResProj:ClVentFanPowerTot-4"   ResProj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[4] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[4]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[4]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set ResProj:ClVentFanPowerTot-5"   ResProj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[5] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[5]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[5]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set ResProj:ClVentFanPowerTot-6"   ResProj:ClVentFanPowerTot = {
      if (ClVentFanUI > 0 .AND. LocalCompAssigned( UnitClVentFan[6] ))
      then	ClVentFanPowerTot + (ValidOr( UnitClVentFan[6]:WperCFMCool, 0 ) * ValidOr( UnitClVentFan[6]:CoolingVent, 0 ))
      else  UNCHANGED  endif  }
   "Set ResProj:ClVentFanPowerMsg"  ResProj:ClVentFanPowerMsg = {
      if (IfValidAnd( ClVentFanPowerTot > 0 ) .AND. IfValidAnd( UnitClVentCFMTot > 0 ))
      then  Format( "%0.2f W/CFM (%s W)", (ClVentFanPowerTot / UnitClVentCFMTot), flttostr( ClVentFanPowerTot ) )
      else  UNDEFINED  endif  }

   "Set ResProj:ClVentFansToAttic-1"      ResProj:ClVentFansToAttic  =     ; SAC 4/23/19 (tic #1023)
      {  if (IsMultiFamily > 0) then  0
         else if (UnitClVentOption = 1 .OR. 
                 (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 1 ) .AND. IfValidAnd( UnitClVentFan[1]:ExhaustsTo = 1 ))) then  1  else  0  endif endif  }
   "Set ResProj:ClVentFansToAttic-2"      ResProj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 2 ) .AND. IfValidAnd( UnitClVentFan[2]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToAttic-3"      ResProj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 3 ) .AND. IfValidAnd( UnitClVentFan[3]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToAttic-4"      ResProj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 4 ) .AND. IfValidAnd( UnitClVentFan[4]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToAttic-5"      ResProj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 5 ) .AND. IfValidAnd( UnitClVentFan[5]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToAttic-6"      ResProj:ClVentFansToAttic  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 6 ) .AND. IfValidAnd( UnitClVentFan[6]:ExhaustsTo = 1 ))
         then  ClVentFansToAttic + 1  else  UNCHANGED  endif endif  }

   "Set ResProj:ClVentFansToOutsd-1"      ResProj:ClVentFansToOutsd  =     ; SAC 4/23/19 (tic #1023)
      {  if (IsMultiFamily > 0) then  0
         else if (UnitClVentOption = 5 .OR. 
                 (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 1 ) .AND. IfValidAnd( UnitClVentFan[1]:ExhaustsTo = 2 ))) then  1  else  0  endif endif  }
   "Set ResProj:ClVentFansToOutsd-2"      ResProj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 2 ) .AND. IfValidAnd( UnitClVentFan[2]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToOutsd-3"      ResProj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 3 ) .AND. IfValidAnd( UnitClVentFan[3]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToOutsd-4"      ResProj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 4 ) .AND. IfValidAnd( UnitClVentFan[4]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToOutsd-5"      ResProj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 5 ) .AND. IfValidAnd( UnitClVentFan[5]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }
   "Set ResProj:ClVentFansToOutsd-6"      ResProj:ClVentFansToOutsd  =
      {  if (IsMultiFamily > 0) then  UNCHANGED
         else if (UnitClVentOption = 2 .AND. IfValidAnd( UnitClVentNumFans >= 6 ) .AND. IfValidAnd( UnitClVentFan[6]:ExhaustsTo = 2 ))
         then  ClVentFansToOutsd + 1  else  UNCHANGED  endif endif  }

   "Default ResZn:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"         ResZn:AirFlowMeter =           ; SAC 10/01/20 (tic #1247)
      {  if (Type < 10) then  1  else  0  endif  }
   "Default ResOtherZn:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"    ResOtherZn:AirFlowMeter =      ; SAC 10/01/20 (tic #1247)
      {  if (Type < 10) then  1  else  0  endif  }
   "Default ResGarage:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"       ResGarage:AirFlowMeter     = {  0  }   ; SAC 10/01/20 (tic #1247)
   "Default ResAttic:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"        ResAttic:AirFlowMeter      = {  0  }
   "Default ResCrawlSpc:AirFlowMeter - ID of air flow meter used to track/report hourly air flow"   ResCrawlSpc:AirFlowMeter = {  0  }

END
;*************************************************************************

;*************************************************************************
RULELIST "Default_AllHVAC" 0 0 0 0
;*************************************************************************
   ; limits on attic & crawlspace area before ducts can be located there - SAC 08/13/20 (tic #1062)
   "Set ResProj:DuctsInAtticMinPctArea - minimum percent attic area for ducts to be located there" 
      ResProj:DuctsInAtticMinPctArea  = {  10  }
   "Set ResProj:DuctsInCrawlMinPctArea - minimum percent crawlspace area for ducts to be located there" 
      ResProj:DuctsInCrawlMinPctArea  = {  15  }
   "Set ResProj:AtticAreaOKForDucts - whether there is sufficient attic area for ducts" 
      ResProj:AtticAreaOKForDucts =       ; fix divide by zero issue that can arise in Com - SAC 10/21/21 (MFam)
         {  if (IfValidAnd( CondFloorArea > 0 )==0) then  0
            else if ((SumAll( ResAttic:FloorAreaOverCond ) / CondFloorArea) > ((DuctsInAtticMinPctArea/100)-0.0001))
            then  1  else  0  endif endif  }
;"dbg" ResProj:Action = { PostMessageToLog( "   just set ResProj:AtticAreaOKForDucts to %g for model '%s' - sum ResAttic:FloorAreaOverCond %g / CondFloorArea %g / DuctsInAtticMinPctArea %g", 
;                                                  AtticAreaOKForDucts, RunAbbrev, SumAll( ResAttic:FloorAreaOverCond ), ValidOr( CondFloorArea, 1 ), DuctsInAtticMinPctArea ) }
   "Set ResProj:CrawlAreaOKForDucts - whether there is sufficient crawlspace area for ducts" 
      ResProj:CrawlAreaOKForDucts =
         {  if (IfValidAnd( CondFloorArea > 0 )==0) then  0
            else if ((SumAll( ResCrawlSpc:Area ) / CondFloorArea) > ((DuctsInCrawlMinPctArea/100)-0.0001))
            then  1  else  0  endif endif  }

; DEBUGGING
; "dbg" Proj:Action = { StoreBEMProc( Format( "dflt-rnd %g", ValidOr( DefaultingRounds, 0 ) ), 0 ) }

	"Set ResHVACSys:TypeAbbrev"			ResHVACSys:TypeAbbrev		= {  Local( Type )  }
	"Set ResHVACSys:TypeAbbrevStr"		ResHVACSys:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }

	; Whether or not the selected HVAC system type is valid/allowed/enabled
	"Set ResHVACSys:TypeOK"			ResHVACSys:TypeOK	= {	if (Type == 3 .AND. ResProj:EnableVarFlowOAV < 0.5) then  0
																	else  1  endif  }

; moved to ForceDefault_Zone_HVAC rulelist, called from Rules_Default.rule
;;	mjb	10/14/14	assign HVACSystem from ActiveHVACSystem for IsAddAlone
;	"Conditionally Set HVACSystem to ActiveHVACSystem"	ResZn:HVACSystem	=	{	if (ResProj:IsAddAlone > 0.5) then ActiveHVACSystem else UNCHANGED endif	}
;
  ; SAC 12/5/13 - added logic to take into account Alt & Ex HVAC assignments
	"Set ResHVACSys:FloorAreaServed[1]"	ResHVACSys:FloorAreaServed[1]	= {
      SumRevRef( ResZn:HVACSystem,		ResZn:HVACNewCondFloorAreaWithMult ) +
      SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACNewCondFloorAreaWithMult ) +
      SumRevRef( ResZn:AltHVACSystem,	ResZn:HVACAltCondFloorAreaWithMult ) +
      SumRevRef( ResZn:exHVACSystem,		ResZn:HVACExCondFloorAreaWithMult  )  }
																		;				switch ( type )
																		;		; SAC 1/11/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
																		;		;			case 10 :	SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
																		;	;				case 10 :	if (LocalCompAssigned( Fan ) == 0) then  SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
																		;	;								else if (Fan:DefaultSystem  < 0.5) then  SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
																		;	;								else	ResProj:CondFloorArea  endif endif
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	ResProj:CondFloorArea
																		;					case 20 :	SumRevRef( ResZn:IAQVentSystem , ResZn:CondFloorArea )
																		;					default :	SumRevRef( ResZn:HVACSystem    , ResZn:CondFloorArea )
																		;				endswitch  }
	; JP 8/26/19 moved here to ensure the ResClgSys:HERSCheck will be created (tic #1060)
	"Set ResHVACSys:FloorAreaServed[2]"		ResHVACSys:FloorAreaServed[2]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[3]"		ResHVACSys:FloorAreaServed[3]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[4]"		ResHVACSys:FloorAreaServed[4]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[5]"		ResHVACSys:FloorAreaServed[5]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[6]"		ResHVACSys:FloorAreaServed[6]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[7]"		ResHVACSys:FloorAreaServed[7]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[8]"		ResHVACSys:FloorAreaServed[8]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[9]"		ResHVACSys:FloorAreaServed[9]		= {	FloorAreaServed[1]  }
	"Set ResHVACSys:FloorAreaServed[10]"	ResHVACSys:FloorAreaServed[10]	= {	FloorAreaServed[1]  }

"Set ResHVACSys:FloorAreaSrvdInclV - Floor area served by this system (including altered/verified system area)"
      ResHVACSys:FloorAreaSrvdInclV	= {
         FloorAreaServed[1] + SumRevRef( ResZn:exHVACSystem, ResZn:HVACExVCondFloorAreaWithMult )  }

	"Set ResHVACSys:AtticArea"				ResHVACSys:AtticArea				= {
      SumRevRef( ResZn:HVACSystem,		ResZn:AtticArea ) +
      SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:AtticArea ) +
      SumRevRef( ResZn:AltHVACSystem,	ResZn:AtticArea ) +
      SumRevRef( ResZn:exHVACSystem,		ResZn:AtticArea  )  }
	"Set ResHVACSys:UncondAtticArea"		ResHVACSys:UncondAtticArea		= {
      SumRevRef( ResZn:HVACSystem,		ResZn:UncondAtticArea ) +
      SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:UncondAtticArea ) +
      SumRevRef( ResZn:AltHVACSystem,	ResZn:UncondAtticArea ) +
      SumRevRef( ResZn:exHVACSystem,		ResZn:UncondAtticArea  )  }

	"Set ResHVACSys:MaxClVentableAtticVol[1]"		ResHVACSys:MaxClVentableAtticVol[1]	= {	MaxRevRef( ResZn:HVACSystem   ,	ResZn:MaxClVentableVolume )  }
	"Set ResHVACSys:MaxClVentableAtticVol[2]"		ResHVACSys:MaxClVentableAtticVol[2]	= {	MaxRevRef( ResZn:AltHVACSystem,	ResZn:MaxClVentableVolume )  }
	"Set ResHVACSys:MaxClVentableAtticVol[3]"		ResHVACSys:MaxClVentableAtticVol[3]	= {	MaxRevRef( ResZn:exHVACSystem,		ResZn:MaxClVentableVolume )  }
	"Set ResHVACSys:MaxClVentableAtticVol[4]"		ResHVACSys:MaxClVentableAtticVol[4]	= {	if (LocalStatus( MaxClVentableAtticVol[1] ) > 0.5)
																												then	if (LocalStatus( MaxClVentableAtticVol[2] ) > 0.5)
																														then	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[1], max( MaxClVentableAtticVol[2], MaxClVentableAtticVol[3] ) )
																																else	max( MaxClVentableAtticVol[1],      MaxClVentableAtticVol[2] )
																																endif
																														else	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[1], MaxClVentableAtticVol[3] )
																																else	     MaxClVentableAtticVol[1]
																																endif
																														endif
																												else	if (LocalStatus( MaxClVentableAtticVol[2] ) > 0.5)
																														then	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	max( MaxClVentableAtticVol[2], MaxClVentableAtticVol[3] )
																																else	     MaxClVentableAtticVol[2]
																																endif
																														else	if (LocalStatus( MaxClVentableAtticVol[3] ) > 0.5)
																																then	     MaxClVentableAtticVol[3]
																																else	     0
																																endif
																														endif  endif  }
	"Set ResHVACSys:MaxClVentableAtticZn"	ResHVACSys:MaxClVentableAtticZn	= {	if (		ValidOr( MaxRevRef(	ResZn:HVACSystem,		ResZn:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			ResZn:HVACSystem,		ResZn:MaxClVentableVolume )
																									else if (ValidOr( MaxRevRef(	ResZn:AltHVACSystem,	ResZn:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			ResZn:AltHVACSystem,	ResZn:MaxClVentableVolume )
																									else if (ValidOr( MaxRevRef(	ResZn:exHVACSystem,	ResZn:MaxClVentableVolume ), 0 ) > (MaxClVentableAtticVol[4]-1))
																									then  MaxRevRefComp( 			ResZn:exHVACSystem,	ResZn:MaxClVentableVolume )
																									else	UNDEFINED  endif endif endif  }
	"Set ResHVACSys:MaxClVentableAttic"		ResHVACSys:MaxClVentableAttic		= {	if (LocalCompAssigned( MaxClVentableAtticZn ) < 0.5) then  UNDEFINED
																									else if (LocalCompAssigned( MaxClVentableAtticZn:MaxClVentableAttic ) < 0.5) then  UNDEFINED
																									else	MaxClVentableAtticZn:MaxClVentableAttic    endif endif  }

;	mjb	4/18/14	- added this to track existing (but not altered/verified) floor area at HVACSys level
	"Set ResHVACSys:exFloorAreaSrvd - existing Floor area served by this system"
			ResHVACSys:exFloorAreaSrvd	= {	SumRevRef( ResZn:exHVACSystem, ResZn:exCondFloorArea )  }

;	mjb	4/18/14	- added this to track HVAC Systems that are Active in Zones
	"Set ResHVACSys:ActiveInAnyZone"			ResHVACSys:ActiveInAnyZone	= {	SumRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysAssigned ) +
	                                                                  SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysAssigned )  }
;	"debug ActiveInAnyZone"			ResHVACSys:Action	= { MessageBox( "HVAC PI '%s' ActiveInAnyResZn: %g", Name, ActiveInAnyZone )	}
;	"debug ActiveInAnyZone"			ResZn:Action	= { MessageBox( "HVAC PI ResZn: '%s' ActiveHVACSystem: '%s' HVACSysAssigned: %g", Name, ActiveHVACSystem:Name, HVACSysAssigned  )	}

; SAC 1/13/15 - moved up here from below in SetupHVACSys_Round1_HeatCool &  to ensure these defaults are in place PRIOR to their being referenced in rule logic
	"Default ResHVACSys:NumHeatSystemTypes"	ResHVACSys:NumHeatSystemTypes		= {	if (IfValidAnd( Type == 1 )==0 .AND. IfValidAnd( Type == 3 )==0) then  0		; Type invalid or NOT = 1 or 3
																										else if (LocalCompAssigned( HeatSystem[10] )) then  10
																										else if (LocalCompAssigned( HeatSystem[9]  )) then   9
																										else if (LocalCompAssigned( HeatSystem[8]  )) then   8
																										else if (LocalCompAssigned( HeatSystem[7]  )) then   7
																										else if (LocalCompAssigned( HeatSystem[6]  )) then   6
																										else if (LocalCompAssigned( HeatSystem[5]  )) then   5
																										else if (LocalCompAssigned( HeatSystem[4]  )) then   4
																										else if (LocalCompAssigned( HeatSystem[3]  )) then   3
																										else if (LocalCompAssigned( HeatSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }
	"Default ResHVACSys:NumCoolSystemTypes"	ResHVACSys:NumCoolSystemTypes		= {	if (IfValidAnd( Type == 1 )==0 .AND. IfValidAnd( Type == 3 )==0) then  0		; Type invalid or NOT = 1 or 3
																										else if (LocalCompAssigned( CoolSystem[10] )) then  10
																										else if (LocalCompAssigned( CoolSystem[9]  )) then   9
																										else if (LocalCompAssigned( CoolSystem[8]  )) then   8
																										else if (LocalCompAssigned( CoolSystem[7]  )) then   7
																										else if (LocalCompAssigned( CoolSystem[6]  )) then   6
																										else if (LocalCompAssigned( CoolSystem[5]  )) then   5
																										else if (LocalCompAssigned( CoolSystem[4]  )) then   4
																										else if (LocalCompAssigned( CoolSystem[3]  )) then   3
																										else if (LocalCompAssigned( CoolSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }
	"Default ResHVACSys:NumHtPumpSystemTypes"	ResHVACSys:NumHtPumpSystemTypes	= {	if (IfValidAnd( Type == 2 )==0) then  0		; Type invalid or NOT = 2
																										else if (LocalCompAssigned( HtPumpSystem[10] )) then  10
																										else if (LocalCompAssigned( HtPumpSystem[9]  )) then   9
																										else if (LocalCompAssigned( HtPumpSystem[8]  )) then   8
																										else if (LocalCompAssigned( HtPumpSystem[7]  )) then   7
																										else if (LocalCompAssigned( HtPumpSystem[6]  )) then   6
																										else if (LocalCompAssigned( HtPumpSystem[5]  )) then   5
																										else if (LocalCompAssigned( HtPumpSystem[4]  )) then   4
																										else if (LocalCompAssigned( HtPumpSystem[3]  )) then   3
																										else if (LocalCompAssigned( HtPumpSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }

  ; SAC 12/23/13 - added to improve defaulting of HVACCool/Heat/HtPump:FloorAreaServerd defaulting
  ; SAC 12/22/14 - added logic to ensure that Type of assigned systems is valid (not '- none -' or NoCooling)
  ; SAC 3/7/16 - expended to arrays of 10 to ensure SumRevRef() functions for assigned cool/heat objects get set properly 
	"Set ResHVACSys:ClFlrAreaServed[1]"		ResHVACSys:ClFlrAreaServed[1]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 1 ) .AND. IfValidAnd( CoolSystem[1]:Type   > 1 )) then  FloorAreaServed[1]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[2]"		ResHVACSys:ClFlrAreaServed[2]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 2 ) .AND. IfValidAnd( CoolSystem[2]:Type   > 1 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[3]"		ResHVACSys:ClFlrAreaServed[3]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 3 ) .AND. IfValidAnd( CoolSystem[3]:Type   > 1 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[4]"		ResHVACSys:ClFlrAreaServed[4]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 4 ) .AND. IfValidAnd( CoolSystem[4]:Type   > 1 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[5]"		ResHVACSys:ClFlrAreaServed[5]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 5 ) .AND. IfValidAnd( CoolSystem[5]:Type   > 1 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[6]"		ResHVACSys:ClFlrAreaServed[6]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 6 ) .AND. IfValidAnd( CoolSystem[6]:Type   > 1 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[7]"		ResHVACSys:ClFlrAreaServed[7]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 7 ) .AND. IfValidAnd( CoolSystem[7]:Type   > 1 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[8]"		ResHVACSys:ClFlrAreaServed[8]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 8 ) .AND. IfValidAnd( CoolSystem[8]:Type   > 1 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[9]"		ResHVACSys:ClFlrAreaServed[9]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >= 9 ) .AND. IfValidAnd( CoolSystem[9]:Type   > 1 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set ResHVACSys:ClFlrAreaServed[10]"	ResHVACSys:ClFlrAreaServed[10]	= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumCoolSystemTypes   >=10 ) .AND. IfValidAnd( CoolSystem[10]:Type  > 1 )) then  FloorAreaServed[10] else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[1]"		ResHVACSys:HtFlrAreaServed[1]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 1 ) .AND. IfValidAnd( HeatSystem[1]:Type   > 0 )) then  FloorAreaServed[1]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[2]"		ResHVACSys:HtFlrAreaServed[2]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 2 ) .AND. IfValidAnd( HeatSystem[2]:Type   > 0 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[3]"		ResHVACSys:HtFlrAreaServed[3]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 3 ) .AND. IfValidAnd( HeatSystem[3]:Type   > 0 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[4]"		ResHVACSys:HtFlrAreaServed[4]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 4 ) .AND. IfValidAnd( HeatSystem[4]:Type   > 0 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[5]"		ResHVACSys:HtFlrAreaServed[5]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 5 ) .AND. IfValidAnd( HeatSystem[5]:Type   > 0 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[6]"		ResHVACSys:HtFlrAreaServed[6]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 6 ) .AND. IfValidAnd( HeatSystem[6]:Type   > 0 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[7]"		ResHVACSys:HtFlrAreaServed[7]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 7 ) .AND. IfValidAnd( HeatSystem[7]:Type   > 0 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[8]"		ResHVACSys:HtFlrAreaServed[8]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 8 ) .AND. IfValidAnd( HeatSystem[8]:Type   > 0 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[9]"		ResHVACSys:HtFlrAreaServed[9]		= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >= 9 ) .AND. IfValidAnd( HeatSystem[9]:Type   > 0 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set ResHVACSys:HtFlrAreaServed[10]"	ResHVACSys:HtFlrAreaServed[10]	= {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type != 2 .AND. IfValidAnd( NumHeatSystemTypes   >=10 ) .AND. IfValidAnd( HeatSystem[10]:Type  > 0 )) then  FloorAreaServed[10] else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed"		ResHVACSys:HtPmpFlrAreaServed[1] = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 1 ) .AND. IfValidAnd( HtPumpSystem[1]:Type > 0 )) then  FloorAreaServed[1]  else  0  endif  }
   "Set ResHVACSys:SDHVFlrAreaServed - area served by SDHV system"   ResHVACSys:SDHVFlrAreaServed =   ; SAC 8/19/19 (tic #1041)
      {  if (ResProj:EnergyCodeYearNum < 2019) then  0
         else if ( ( Type == 2                 .AND. IfValidAnd( NumHtPumpSystemTypes >= 1 ) .AND. IfValidAnd( HtPumpSystem[1]:Type = 19 )) .OR.
                   ((Type == 1 .OR. Type == 3) .AND. IfValidAnd( NumCoolSystemTypes   >= 1 ) .AND. IfValidAnd(   CoolSystem[1]:Type = 18 )) )
         then  FloorAreaServed[1]
         else  0  endif endif  }
	; SAC 12/23/14 - additional properties to track Existing/Altered/New heating floor area
	"Set ResHVACSys:HtExFlrAreaServed"		ResHVACSys:HtExFlrAreaServed		= {	if (ResProj:RunScope == 2 .AND. Status == 1) then  HtFlrAreaServed  else  0  endif  }
	"Set ResHVACSys:HtAltFlrAreaServed"		ResHVACSys:HtAltFlrAreaServed		= {	if (ResProj:RunScope == 2 .AND. Status == 2) then  HtFlrAreaServed  else  0  endif  }
	"Set ResHVACSys:HtNewFlrAreaServed"		ResHVACSys:HtNewFlrAreaServed		= {	if (                         Status == 3) then  HtFlrAreaServed  else  0  endif  }

;  mjb   11/7/14  populate the rest of the HtPmpFlrAreaServed array
; SAC 3/7/16 - revised logic along lines of above Cl/Ht arrays so that *FlrAreaServed only set if the # equip types and equip assignments are all valid
	"Set ResHVACSys:HtPmpFlrAreaServed[2]"		ResHVACSys:HtPmpFlrAreaServed[2]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 2 ) .AND. IfValidAnd( HtPumpSystem[2]:Type > 0 )) then  FloorAreaServed[2]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[3]"		ResHVACSys:HtPmpFlrAreaServed[3]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 3 ) .AND. IfValidAnd( HtPumpSystem[3]:Type > 0 )) then  FloorAreaServed[3]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[4]"		ResHVACSys:HtPmpFlrAreaServed[4]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 4 ) .AND. IfValidAnd( HtPumpSystem[4]:Type > 0 )) then  FloorAreaServed[4]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[5]"		ResHVACSys:HtPmpFlrAreaServed[5]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 5 ) .AND. IfValidAnd( HtPumpSystem[5]:Type > 0 )) then  FloorAreaServed[5]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[6]"		ResHVACSys:HtPmpFlrAreaServed[6]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 6 ) .AND. IfValidAnd( HtPumpSystem[6]:Type > 0 )) then  FloorAreaServed[6]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[7]"		ResHVACSys:HtPmpFlrAreaServed[7]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 7 ) .AND. IfValidAnd( HtPumpSystem[7]:Type > 0 )) then  FloorAreaServed[7]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[8]"		ResHVACSys:HtPmpFlrAreaServed[8]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 8 ) .AND. IfValidAnd( HtPumpSystem[8]:Type > 0 )) then  FloorAreaServed[8]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[9]"		ResHVACSys:HtPmpFlrAreaServed[9]   = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >= 9 ) .AND. IfValidAnd( HtPumpSystem[9]:Type > 0 )) then  FloorAreaServed[9]  else  0  endif  }
	"Set ResHVACSys:HtPmpFlrAreaServed[10]"	ResHVACSys:HtPmpFlrAreaServed[10]  = {	if (IfValidAnd( TypeOK > 0.5 ) .AND. Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes >=10 ) .AND. IfValidAnd( HtPumpSystem[10]:Type >0 )) then  FloorAreaServed[10] else  0  endif  }

;  mjb   11/12/14  poplate the HVACSys Status arrays
; SAC 11/21/14 - switched to using separate property name for Status ARRAY, to avoid third party vendor data model questions/issues
	"Set ResHVACSys:StatusArray[1]"		ResHVACSys:StatusArray[1]   = {	Status  }
	"Set ResHVACSys:StatusArray[2]"		ResHVACSys:StatusArray[2]   = {	Status  }
	"Set ResHVACSys:StatusArray[3]"		ResHVACSys:StatusArray[3]   = {	Status  }
	"Set ResHVACSys:StatusArray[4]"		ResHVACSys:StatusArray[4]   = {	Status  }
	"Set ResHVACSys:StatusArray[5]"		ResHVACSys:StatusArray[5]   = {	Status  }
	"Set ResHVACSys:StatusArray[6]"		ResHVACSys:StatusArray[6]   = {	Status  }
	"Set ResHVACSys:StatusArray[7]"		ResHVACSys:StatusArray[7]   = {	Status  }
	"Set ResHVACSys:StatusArray[8]"		ResHVACSys:StatusArray[8]   = {	Status  }
	"Set ResHVACSys:StatusArray[9]"		ResHVACSys:StatusArray[9]   = {	Status  }
	"Set ResHVACSys:StatusArray[10]"		ResHVACSys:StatusArray[10]  = {	Status  }

	"Set ResHVACSys:MinFloorHeight"		ResHVACSys:MinFloorHeight	=
	   {	if (SumRevRef( ResOtherZn:ActiveHVACSystem,  ResOtherZn:CondFloorArea ) > 0 .AND.
	          SumRevRef(      ResZn:HVACSystem  ,       ResZn:CondFloorArea ) > 0)
	      then  min( MinRevRef( ResOtherZn:ActiveHVACSystem,  ResOtherZn:FloorHeight ),
	                 MinRevRef(      ResZn:HVACSystem  ,       ResZn:FloorHeight ) )
	      else if (SumRevRef(  ResOtherZn:ActiveHVACSystem,  ResOtherZn:CondFloorArea ) > 0)
	      then  MinRevRef(     ResOtherZn:ActiveHVACSystem,  ResOtherZn:FloorHeight )
	      else  MinRevRef( ResZn:HVACSystem    , ResZn:FloorHeight )
	      endif endif  }
																		;				switch ( type )
																		;	;				case 10 :	MinRevRef( ResZn:CoolVentSystem, ResZn:FloorHeight )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	MinAll(                         ResZn:FloorHeight )
																		;					case 20 :	MinRevRef( ResZn:IAQVentSystem , ResZn:FloorHeight )
																		;					default :	MinRevRef( ResZn:HVACSystem    , ResZn:FloorHeight )
																		;				endswitch  }
	"Set ResHVACSys:FloorZRange"			ResHVACSys:FloorZRange		=
	   {	if (SumRevRef( ResOtherZn:ActiveHVACSystem,  ResOtherZn:CondFloorArea ) > 0 .AND.
	          SumRevRef(      ResZn:HVACSystem  ,       ResZn:CondFloorArea ) > 0)
	      then  max( MaxRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:Bottom ),
	                 MaxRevRef(      ResZn:HVACSystem  ,      ResZn:Bottom ) ) -
	            min( MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:Bottom ),
	                 MinRevRef(      ResZn:HVACSystem  ,      ResZn:Bottom ) )
	      else if (SumRevRef(  ResOtherZn:ActiveHVACSystem,  ResOtherZn:CondFloorArea ) > 0)
	      then  MaxRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:Bottom ) - MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:Bottom )
	      else  MaxRevRef( ResZn:HVACSystem    , ResZn:Bottom ) - MinRevRef( ResZn:HVACSystem    , ResZn:Bottom )
	      endif endif  }
																		;				switch ( type )
																		;	;				case 10 :	MaxRevRef( ResZn:CoolVentSystem, ResZn:Bottom ) - MinRevRef( ResZn:CoolVentSystem, ResZn:Bottom )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;					case 10 :	MaxAll(                         ResZn:Bottom ) - MinAll(                         ResZn:Bottom )
																		;					case 20 :	MaxRevRef( ResZn:IAQVentSystem , ResZn:Bottom ) - MinRevRef( ResZn:IAQVentSystem , ResZn:Bottom )
																		;					default :	MaxRevRef( ResZn:HVACSystem    , ResZn:Bottom ) - MinRevRef( ResZn:HVACSystem    , ResZn:Bottom )
																		;				endswitch  }
; SAC 4/30/14 - added logic to ensure that ResHVACSys:NumStoriesServed = 0 when FloorAreaServed[1] = 0 (designed to help resolve GC #297)
	"Set ResHVACSys:NumStoriesServed"	ResHVACSys:NumStoriesServed = {	if (IfValidAnd( FloorAreaServed[1] > 0.1 ) == 0) then  0
																						else if (IfValidAnd( MinFloorHeight > 0.1 ))
																						then  max( max( MaxRevRef( ResZn:HVACSystem       , ResZn:NumStories ),
																						                MaxRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:NumStories ) ),
																						           int( (FloorZRange / MinFloorHeight) ) + 1 )
																						else  max( MaxRevRef( ResZn:HVACSystem       , ResZn:NumStories ),
																						           MaxRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:NumStories ) )
																						endif endif  }
																		;				switch ( type )
																		;					case 10 :	if (Local( MinFloorHeight ) > 0.1)
																		;	;								then  max( MaxRevRef( ResZn:CoolVentSystem, ResZn:NumStories ),
																		;	;								           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;	;								else       MaxRevRef( ResZn:CoolVentSystem, ResZn:NumStories )
																		;	; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA
																		;									then  max( MaxAll( ResZn:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxAll( ResZn:NumStories )
																		;									endif
																		;					case 20 :	if (Local( MinFloorHeight ) > 0.1)
																		;									then  max( MaxRevRef( ResZn:IAQVentSystem , ResZn:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxRevRef( ResZn:IAQVentSystem , ResZn:NumStories )
																		;									endif
																		;					default :	if (Local( MinFloorHeight ) > 0.1)
																		;									then  max( MaxRevRef( ResZn:HVACSystem    , ResZn:NumStories ),
																		;									           int( (Local( FloorZRange ) / Local( MinFloorHeight )) ) + 1 )
																		;									else       MaxRevRef( ResZn:HVACSystem    , ResZn:NumStories )
																		;									endif
																		;				endswitch  }

	"Set ResHVACSys:NumStoriesSrvdMsg"	ResHVACSys:NumStoriesSrvdMsg	= {	if (IfValidAnd( NumStoriesServed = 1 )) then  "(1 story)"
																							else if (LocalStatus( NumStoriesServed ) < 1) then  "(? stories)"
																							else  Format( "(%g stories)", Local( NumStoriesServed ) )
																							endif endif  }

   "Set ResHVACSys:NumDUsServed - # dwelling units served by this system"     ResHVACSys:NumDUsServed =           ; SAC 04/21/21
      {  if (ResProj:IsMultiFamily < 0.5) then  1
         else  max( SumRevRef( ResZn:HVACSystem, ResZn:NumDwellingUnits ), 1 ) + 
               SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysAssigned )
         endif  }

; SAC 8/26/13 - added CFI (Central Fan Integrated) Cool Vent properties and defaulting
	"Set ResHVACSys:CFIClVentCompat"		ResHVACSys:CFIClVentCompat		= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3)		; 3 => "Central Fan Ventilation Cooling System" (or old wording: "CFI (Central Fan Integrated) Cool Vent")
																						then  1  else  0  endif  }
	;	no default:  ResHVACSys:CFIClVentOption,  BEMP_Sym,  1,    0,                  "CFI (central fan integrated) cooling ventilation option"       
	"Set ResHVACSys:CFIClVentOptShow"	ResHVACSys:CFIClVentOptShow	= {	if (Type == 3 .OR. ResProj:EnableFixedFlowOAV < 0.5) then  0		; never display for ResHVACSys:type = "Variable Outdoor Air Ventilation Central Heat/Cool System"  (3)
																							else if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3) then  2		; show & editable
																							else if (ResProj:UnitClVentOption == 3 .OR. CFIClVentOption > 0) then  1		; show but uneditable - if it is currently set but the model is NOT compatible with CFI cool vent
																							else  0  endif endif endif  }
;	"Set ResHVACSys:CFIClVentMsg"		ResHVACSys:CFIClVentMsg		= {	if (Type == 3 .OR. Type < 1) then  " "
	"Set ResHVACSys:CFIClVentMsg"		ResHVACSys:CFIClVentMsg		= {	if (Type > 3 .OR. Type < 1 .OR. TypeOK < 0.5) then  " "
																					else if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3)
																					then  if (Type != 3 .AND. ResProj:EnableFixedFlowOAV < 0.5) then  "(CFI cool vent NOT available - this feature is under development)"
																							else  " "  endif
																					else if (Type == 3 .OR. (Type != 3 .AND. CFIClVentOption != 0))
																					then	if (ResProj:EnableClVent < 0.5) then				"(CFI cool vent NOT available - must be single family home with ventilated attic)"
																							else if (ResProj:UnitClVentOption != 3) then		"(CFI cool vent NOT available - see Cool Vent tab of Project data dialog)"
																							else  " "  endif endif
																					else if (ResProj:EnableClVent < 0.5 .AND. ResProj:UnitClVentOption == 3) then  "(CFI cool vent available only for single family homes with attics)"
																					else  ; => CFIClVentOption == 0
																							if (ResProj:EnableClVent < 0.5) then  				"(CFI cool vent available only for single family homes with ventilated attics)"
																							else if (ResProj:UnitClVentOption != 3) then		"(activate CFI cool vent via Cool Vent tab of the Project data dialog)"
																							else  " "  endif endif
																					endif endif endif endif  }

   "Set ResHVACSys:TreeDescrip"     ResHVACSys:TreeDescrip  =        ; SAC 8/27/19   ; SAC 6/27/20 - revised to incl. "unused" for MFam models  ; removed MFam unused msg - SAC 08/10/20
   ;   {  if (ResProj:IsMultiFamily > 0.5 .AND. ComponentCount( OtherZone ) < 1) then  "unused for multifamily models"
   ;      else if (ResProj:RunScope == 1 .AND. ResProj:IsAddAlone < 0.5)
      {  if (ResProj:RunScope == 1 .AND. ResProj:IsAddAlone < 0.5)
         then  if (FloorAreaServed[1] > 0.1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed[1] ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed[1] > 0.1)
               then  Format( "%s %s, %s SqFt assigned", EnumString( Status ), TypeAbbrevStr, FltToStr( FloorAreaServed[1] ) )
               else  Format( "%s %s, not assigned", EnumString( Status ), TypeAbbrevStr )
               endif  endif  }

   "ensure AutoSizeHeatInp & AutoSizeCoolInp not user-defined when not in research mode"  ResHVACSys:Action =     ; SAC 3/25/22
      {  if (IfValidAnd( ResProj:ResAnalysisType != 0 ) .AND.
             (LocalStatus( AutoSizeHeatInp ) > 5 .OR. LocalStatus( AutoSizeCoolInp ) > 5))
         then  EvalRulelist( "Blast_ResHVACSys_AutoSizeInputs", 1 )
         else  UNCHANGED  endif  }

; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties   ; SAC 03/18/22 (WSHP)
	"Initialize HVACSys Heat/Cool/HtPump properties"  ResHVACSys:Action		= { if (Type == 1 .OR. Type == 3)
                                                                            then  EvalRulelist( "SetupHVACSys_Round1_HeatCool", 1 )
                                                                            else if (Type == 2)
                                                                            then EvalRulelist( "SetupHVACSys_Round1_HeatPump", 1 )
                                                                            else if (Type == 4)
                                                                            then 	switch ( CentralEqpType )             ; "Central Heat/Cool"
                                                                                  case  1 :  EvalRulelist( "SetupHVACSys_Round1_Central_FPFC", 1 )         ; "Four-pipe fan coil"
                                                                                  case  2 :  EvalRulelist( "SetupHVACSys_Round1_Central_WSHP", 1 )         ; "Water source heat pump"
                                                                                  case  3 :  UNCHANGED                                                     ; "Hydronic heating only"
                                                                                  case  4 :  EvalRulelist( "SetupHVACSys_Round1_Central_VRF", 1 )          ; "Variable refrigerant flow"
                                                                                  default :  UNCHANGED   endswitch
                                                                            else UNCHANGED  endif endif endif  }

   "Initialize MFam DwellUnitType area served properties - iff MFam model AND no HVACSys assigned to Zones (yet)"    ResProj:Action =        ; SAC 04/08/21   ; SAC 04/09/21
      {  if (IsMultiFamily)
         then  EvalRulelist( "SetupDwellUnitType_AreaServed" )  else  UNCHANGED  endif  }

	"Set ResDistSys:FloorAreaServed"	ResDistSys:FloorAreaServed  =                  ; revised following rules to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21   ; SAC 04/09/21
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACDistRef, DwellUnitType:DUFloorAreaServed ) +
               SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:FloorAreaServed[1] )
         else  SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:FloorAreaServed[1] )  endif  }
	"Set ResFanSys:FloorAreaServed"  	ResFanSys:FloorAreaServed   =
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUFloorAreaServed ) +
               SumRevRef( ResHVACSys:Fan, 	        ResHVACSys:FloorAreaServed[1] )
         else  SumRevRef( ResHVACSys:Fan, 	        ResHVACSys:FloorAreaServed[1] )  endif  }
	"Set ResFanSys:ClFlrAreaServed"  	ResFanSys:ClFlrAreaServed   =
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUClFlrAreaServed ) + SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed ) +
               SumRevRef( ResHVACSys:Fan,           ResHVACSys:ClFlrAreaServed    ) + SumRevRef( ResHVACSys:Fan, ResHVACSys:HtPmpFlrAreaServed[1] )
         else  SumRevRef( ResHVACSys:Fan,           ResHVACSys:ClFlrAreaServed    ) + SumRevRef( ResHVACSys:Fan, ResHVACSys:HtPmpFlrAreaServed[1] )  endif  }		; GC issue 450
	"Set ResFanSys:GasFurnAreaServed"  ResFanSys:GasFurnAreaServed =
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUGasFurnAreaServed ) +
               SumRevRef( ResHVACSys:Fan,           ResHVACSys:GasFurnAreaServed  )
         else  SumRevRef( ResHVACSys:Fan,           ResHVACSys:GasFurnAreaServed  )  endif  }		; 2019 code (tic #928) - SAC 2/5/18
	"Set ResFanSys:HtPumpAreaServed"   ResFanSys:HtPumpAreaServed  =
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed ) +
               SumRevRef( ResHVACSys:Fan,           ResHVACSys:HtPmpFlrAreaServed[1]  )
         else  SumRevRef( ResHVACSys:Fan,           ResHVACSys:HtPmpFlrAreaServed[1]  )  endif  }	; 2019 fan power defaulting (tic #1074) - SAC 5/16/19
	"Set ResFanSys:SDHVAreaServed"     ResFanSys:SDHVAreaServed    =
      {  if (ResProj:IsMultiFamily)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUSDHVFlrAreaServed ) +
               SumRevRef( ResHVACSys:Fan,           ResHVACSys:SDHVFlrAreaServed      )
         else  SumRevRef( ResHVACSys:Fan,           ResHVACSys:SDHVFlrAreaServed      )  endif  }	; 2019 fan power defaulting (tic #1041) - SAC 8/19/19
	"Set ResDistSys:NumStoriesServed"	ResDistSys:NumStoriesServed  = {  SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:NumStoriesServed )  }
;	"Set ResFanSys:NumStoriesServed"  	ResFanSys:NumStoriesServed   = {  SumRevRef( ResHVACSys:Fan, 	         ResHVACSys:NumStoriesServed )  }

   "Blast ResHtPumpSys:CFMperTon if it is user-defined but not available for edit"    ResHtPumpSys:Action =        ; SAC 08/20/20 (tic #1003)   ; VCHP2 - SAC 11/01/20
      {  if (Type ==  7 .OR.   ; "RoomHeatPump"
             Type == 10 .OR.   ; "DuctlessMiniSplitHeatPump"  
             Type == 20 .OR.   ; "DuctlessMultiSplitHeatPump"
             Type == 21 .OR.   ; "DuctlessVRFHeatPump" 
             Type == 22 .OR.   ; "VCHP" 
             Type == 33 .OR.   ; "VCHP2" 
             Type == 26 .OR.   ; "PkgTermHeatPump"
             Type == 28 .OR.   ; "DuctedMiniSplitHeatPump"
             Type == 30 .OR.   ; "DuctedMultiSplitHeatPump"
             Type == 32 )      ; "Ducted+DuctlessMultiSplitHeatPump"
         then  EvalRulelist( "Blast_HVACHtPump_CFMperTon", 1 )
         else  UNCHANGED  endif  }

   "Blast ResClgSys:CFMperTon if it is user-defined but not available for edit"      ResClgSys:Action =          ; SAC 08/20/20 (tic #1003)
      {  if (Type ==  5 .OR.   ; "RoomAirCond"
             Type == 25 )      ; "PkgTermAirCond"
         then  EvalRulelist( "Blast_HVACCool_CFMperTon", 1 )
         else  UNCHANGED  endif  }

	"Call subordinate rulelist to default generic cooling system data"
		ResClgSys:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }

	"Call subordinate rulelist to default generic heating system data"
		ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }

	"Call subordinate rulelist to default generic heat pump system data"
		ResHtPumpSys:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }

	"Call subordinate rulelist to default type-specific heating system data"
		ResHtgSys:Action 	= {	switch (Local( Type ))
											case  1 :  EvalRulelist( "Default_Heat_CntrlFurnace"      		, 1 )   				; "CntrlFurnace - Fuel-fired central furnace"
											case  2 :  EvalRulelist( "Default_Heat_WallFurnaceFan"    		, 1 )   				; "Heater - Non-central fuel-fired space heater"
											case  3 :  EvalRulelist( "Default_Heat_Boiler"         				, 1 )   				; "Boiler - Gas or oil boiler"
											case 17 :  EvalRulelist( "Default_Heat_WoodHeat"          		, 1 )   				; "WoodHeat - Wood heat meeting exceptional method criteria"
											case 18 :  EvalRulelist( "Default_Heat_PkgGasFurnace"    		, 1 )   				; "PkgGasFurnace - Packaged gas furnace"        ; SAC 6/22/20 (tic #1227)
											case 14 :  EvalRulelist( "Default_Heat_WallFurnaceGravity"		, 1 )   				; ""		- SAC 11/25/14 - value 4->14
							 				case 15 :  EvalRulelist( "Default_Heat_FloorFurnace"      		, 1 )   				; ""		- SAC 11/25/14 - value 5->15
											case 16 :  EvalRulelist( "Default_Heat_RoomHeater"  	    		, 1 )   				; ""		- SAC 11/25/14 - value 6->16
											case  8 :  EvalRulelist( "Default_Heat_Electric"          		, 1 )   				; "Electric - All electric heating systems other than heat pump"
											case  9 :  EvalRulelist( "Default_Heat_CombHydro"         		, 1 )   				; "CombHydro - Water heating system can be storage gas/elec/ht pump"
											default :  EvalRulelist( "Default_Heat_unknown"								, 1 )
										endswitch  }

	"Secondary call to subordinate rulelist(s) to force defaults of certain heating system data"
		ResHtgSys:Action 	= {	switch (Local( Type ))
											case  9 :	if (IfValidAnd( AFUE == CHRecoveryEff )) then  UNCHANGED
															else  EvalRulelist( "ForceDefault_Heat_CombHydro_AFUE" , 1 )  endif   ; "CombHydro - Water heating system can be storage gas/elec/ht pump"  - to address GC issue 396
											default :  UNCHANGED
										endswitch  }
    ; RJH 2/11/20 tic #1176
    "Set ResHtPumpSys:HERS_LowStaticVCHP"    ResHtPumpSys:HERS_LowStaticVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_AirToHabitableRoomsVCHP"    ResHtPumpSys:HERS_AirToHabitableRoomsVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_MinimumAirflowVCHP"    ResHtPumpSys:HERS_MinimumAirflowVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_DuctsInConditionedSpaceTested"    ResHtPumpSys:HERS_DuctsInConditionedSpaceTested = { UNDEFINED }
    "Set ResHtPumpSys:HERS_WallThermostatVCHP"    ResHtPumpSys:HERS_WallThermostatVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP"    ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_FilterSizeVCHP"    ResHtPumpSys:HERS_FilterSizeVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_FilterPressureDropVCHP"    ResHtPumpSys:HERS_FilterPressureDropVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = { UNDEFINED }
    "Set ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace"    ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace = { UNDEFINED }
    "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = { UNDEFINED }

   "Set default ResHtPumpSys:TempLabels[1]"     ResHtPumpSys:TempLabels[1] = {  "@ 47F:"  }      ; SAC 07/24/21
   "Set default ResHtPumpSys:TempLabels[2]"     ResHtPumpSys:TempLabels[2] = {  "@ 35F:"  }
   "Set default ResHtPumpSys:TempLabels[3]"     ResHtPumpSys:TempLabels[3] = {  "@ 17F:"  }

   "Blast HVACHtPump:PerfDetailsErrMsg prior to defaulting"    ResHtPumpSys:PerfDetailsErrMsg = {  UNDEFINED  }   ; SAC 09/23/21
   "Blast HVACHtPump:PerfDetailsError prior to defaulting"     ResHtPumpSys:PerfDetailsError  = {  UNDEFINED  }

	"Call subordinate rulelist to default type-specific heat pump system data"
		ResHtPumpSys:Action = {	switch (Local( Type ))
											case  4 :  EvalRulelist( "Default_HtPump_SplitHeatPump"       , 1 )   				; "SplitHeatPump - Heating side of central split heat pump"
											case 26 :  EvalRulelist( "Default_HtPump_PkgTermHeatPump"     , 1 )   				; "PkgTermHeatPump - Packaged terminal heat pump (PTHP)"          ; SAC 6/22/20 (tic #1225)
											case 24 :  EvalRulelist( "Default_HtPump_PkgTermHeatPump"     , 1 )   				; "SglPkgVertHeatPump - Single package vertical heat pump"        ; SAC 6/22/20 (tic #1226)
											case 19 :  EvalRulelist( "Default_HtPump_SDHVSplitHeatPump"   , 1 )   				; "SDHVSplitHeatPump - Small duct, high velocity, central split heat pump"
											case 10 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump"  , 1 )    ; "DuctlessMiniSplitHeatPump - Ductless mini-split heat pump"
											case 20 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctlessMultiSplitHeatPump - Ductless multi-split heat pump"      ; SAC 6/22/20 - consolidated into single rulelist (tic #1229)
											case 21 :  EvalRulelist( "Default_HtPump_DuctlessVRFHeatPump" , 1 )   				; "DuctlessVRFHeatPump - Ductless variable refrigerant flow (VRF) heat pump" 
											case 28 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctedMiniSplitHeatPump - Ducted mini-split heat pump"                        ; SAC 6/22/20 (tic #1229)
											case 30 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "DuctedMultiSplitHeatPump - Ducted multi-split heat pump"                      ; SAC 6/22/20 (tic #1229)
											case 32 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )     ; "Ducted+DuctlessMultiSplitHeatPump - Ducted+ductless multi-split heat pump"    ; SAC 6/22/20 (tic #1229)
											case  5 :  EvalRulelist( "Default_HtPump_PkgHeatPump"         , 1 )   				; "PkgHeatPump - Heating side of central packaged heat pump"
											case  6 :  EvalRulelist( "Default_HtPump_LrgPkgHeatPump"      , 1 )   				; "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit"
											case  7 :  EvalRulelist( "Default_HtPump_RoomHeatPump"        , 1 )   				; "RoomHeatPump - Heating side of non-central room A/C system"
											case 11 :  EvalRulelist( "Default_HtPump_AirToWaterHeatPump"  , 1 )   				; "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
											case 12 :  EvalRulelist( "Default_HtPump_GroundSourceHeatPump", 1 )   				; "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
											case 22 :  EvalRulelist( "Default_HtPump_VariableCapHeatPump" , 1 )   				; "VCHP" - SAC 11/2/18
											case 33 :  EvalRulelist( "Default_HtPump_VariableCapHeatPump2", 1 )   				; "VCHP2" - SAC 11/01/20
											default :  EvalRulelist( "Default_HtPump_unknown", 1 )
										endswitch  }

   ; properties added for dual fuel heat pumps - SAC 12/08/20
   "Set ResHtPumpSys:AllowDualFuel - compatible w/ dual fuel flag"        ResHtPumpSys:AllowDualFuel =    ; logic added to prevent access in code vints prior to 2022 - SAC 03/10/21
      {  if (IfValidAnd( Proj:AnalysisVersion >= 220000 )==0) then  0
         else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
         then  1  else  0  endif endif  }
   "Default ResHtPumpSys:IsDualFuel - user dual fuel selection"           ResHtPumpSys:IsDualFuel =
      {  if (AllowDualFuel < 1) then  UNDEFINED  else  0  endif  }
   "Default ResHtPumpSys:AFUE  - backup efficiency (%)"                   ResHtPumpSys:AFUE =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED
         else  T24RHeatingEquipment:AFUE(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "CntrlFurnace" )  endif  }
   "Default ResHtPumpSys:HasHPLockout - has lockout temp for HP"          ResHtPumpSys:HasHPLockout =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED  else  1  endif  }
   "Default ResHtPumpSys:HPLockoutTemp - lockout temperature for HP"      ResHtPumpSys:HPLockoutTemp =
      {  if (AllowDualFuel < 1 .OR. IfValidAnd( IsDualFuel > 0 )==0) then  UNDEFINED  else  35  endif  }
   "Set ResHtPumpSys:ModelDualFuel - whether dual fuel is compatible, selected & includes valid inputs"    ResHtPumpSys:ModelDualFuel =
      {  if (AllowDualFuel > 0 .AND. IfValidAnd( IsDualFuel > 0 ) .AND. IfValidAnd( AFUE > 0 ))
         then  1  else  UNDEFINED  endif  }

  "Call subordinate rulelist to default cooling system data"
		ResClgSys:Action = {	switch (Local( Type ))
										case  1 :  EvalRulelist( "Default_Cool_None"										, 1 )   				; "NoCooling - No cooling equipment"
										case  2 :  EvalRulelist( "Default_Cool_SplitAirCond"						, 1 )   				; "SplitAirCond - Split air conditioning system"
										case 25 :  EvalRulelist( "Default_Cool_PkgTermAirCond"					, 1 )   				; "PkgTermAirCond - Packaged terminal air conditioner (PTAC)"     ; SAC 6/20/20 (tic #1225)
										case 23 :  EvalRulelist( "Default_Cool_PkgTermAirCond"   				, 1 )   				; "SglPkgVertAirCond - Single package vertical A/C system"        ; SAC 6/20/20 (tic #1226)
										case  3 :  EvalRulelist( "Default_Cool_PkgAirCond"							, 1 )   				; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
										case  4 :  EvalRulelist( "Default_Cool_LrgPkgAirCond"						, 1 )						; "LrgPkgAirCond - Large packaged A/C system (>= 65 kBtuh)"
										case 18 :  EvalRulelist( "Default_Cool_SDHVSplitAirCond"				, 1 )   				; "SDHVSplitAirCond - Small duct, high velocity, split A/C system"
										case 16 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctlessMiniSplitAirCond  Ductless mini-split A/C system"
										case 20 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctlessMultiSplitAirCond - Ductless multi-split A/C system"       ; SAC 6/22/20 - consolidated into single rulelist (tic #1229)
										case 21 :  EvalRulelist( "Default_Cool_DuctlessVRFAirCond"		  , 1 )						; "DuctlessVRFAirCond - Ductless variable refrigerant flow (VRF) A/C system"
										case 27 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctedMiniSplitAirCond - Ducted mini-split A/C system"                         ; SAC 6/22/20 (tic #1229)
										case 29 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "DuctedMultiSplitAirCond - Ducted multi-split A/C system"                       ; SAC 6/22/20 (tic #1229)
										case 31 :  EvalRulelist( "Default_Cool_DuctlessMiniSplitAirCond"			, 1 )		  ; "Ducted+DuctlessMultiSplitAirCond - Ducted+ductless multi-split A/C system"     ; SAC 6/22/20 (tic #1229)
										case  5 :  EvalRulelist( "Default_Cool_RoomAirCond"							, 1 )						; "RoomAirCond - Non-central room A/C system"
										case  14 : EvalRulelist( "Default_Cool_EvapCondenser"						, 1 )   ; "EvapCondenser - Evaporatively-cooled condenser for split AC systems"
										default :  EvalRulelist( "Default_Cool_unknown"									, 1 )		
									endswitch  }

   "Set ResClgSys:IsPackaged"     ResClgSys:IsPackaged  =
      {  switch (Local( Type ))
            case 25 :  1  	   ; "PkgTermAirCond - Packaged terminal air conditioner (PTAC)"     ; SAC 6/24/20 (tic #1225)
            case 23 :  1  	   ; "SglPkgVertAirCond - Single package vertical A/C system"        ; SAC 6/24/20 (tic #1226)
            default :  0
         endswitch  }

   "Reset HVACSys:AutoSizeCool[1] iff Autosized VCHP2"   ResHVACSys:AutoSizeCool[1] =        ; SAC 09/23/21 (VCHP2)
      {  if (FloorAreaServed[1] > 0.5 .AND. Type == 2 .AND.
             IfValidAnd( HtPumpSystem[1]:Type = 33 ) .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize = 0 )) then  0
         else  UNCHANGED  endif  }

	"Call subordinate rulelist to set cooling system reporting variables"		; SAC 5/27/14
		ResProj:Action		= {	EvalRulelist( "SetupHVACCoolCF1RReportVariables" )  }


   "Set ResHtgSys:NumAssigningDUs"      ResHtgSys:NumAssigningDUs  =      ; SAC 6/27/20
      {  if (ResProj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACHeatRef, DwellUnitType:NumAssigningHtClDUs )  endif  }
   "Set ResClgSys:NumAssigningDUs"      ResClgSys:NumAssigningDUs  = 
      {  if (ResProj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACCoolRef, DwellUnitType:NumAssigningHtClDUs )  endif  }
   "Set ResHtPumpSys:NumAssigningDUs"    ResHtPumpSys:NumAssigningDUs  = 
      {  if (ResProj:IsMultiFamily < 0.5) then  UNDEFINED
         else  SumRevRef( DwellUnitType:HVACHtPumpRef, DwellUnitType:NumAssigningHPDUs )  endif  }

   "Set ResHtgSys:TreeDescrip"    ResHtgSys:TreeDescrip   =               ; SAC 6/27/20
      {  if (ResProj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed > 1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         endif  }
   "Set ResClgSys:TreeDescrip"    ResClgSys:TreeDescrip   =
      {  if (ResProj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         else  if (FloorAreaServed > 1)
               then  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
               else  Format( "%s, not assigned", TypeAbbrevStr )
               endif
         endif  }
   "Set ResHtPumpSys:TreeDescrip"  ResHtPumpSys:TreeDescrip   =    ; prepended 'dual fuel' label - SAC 12/08/20
      {  if (ResProj:IsMultiFamily > 0.5)
         then  if (IfValidAnd( NumAssigningDUs > 0 ))
               then  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
                     else  Format( "%s, serving %g dwelling unit(s)", TypeAbbrevStr, NumAssigningDUs )
                     endif
               else  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, not assigned", TypeAbbrevStr )
                     else  Format( "%s, not assigned", TypeAbbrevStr )
                     endif
               endif
         else  if (FloorAreaServed > 1)
               then  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
                     else  Format( "%s, %s SqFt assigned", TypeAbbrevStr, FltToStr( FloorAreaServed ) )
                     endif
               else  if (IfValidAnd( ModelDualFuel > 0 ))
                     then  Format( "dual fuel %s, not assigned", TypeAbbrevStr )
                     else  Format( "%s, not assigned", TypeAbbrevStr )
                     endif
               endif
         endif  }

   ; SAC 11/14/18 - blast Ducted HP checkbox and Dist & Fan assignments for VCHP systems
   ; SAC 2/12/19 - revise rule to PREVENT blasting duct flag and assignments for Std, SMF, DRtg... runs    ; VCHP2 - SAC 11/01/20
   "Reset duct-related HVACSys properties for VCHP systems"    ResHVACSys:Action  =                   ; prevent duct/fan reset for VCHP2 systems - SAC 08/02/21
      {  if (IfValidAnd( ResProj:RunAbbrev = "s" ) .OR. IfValidAnd( ResProj:RunAbbrev == "zb" ) .OR. IfValidAnd( ResProj:RunAbbrev = "smf" ) .OR.
             IfValidAnd( ResProj:RunAbbrev = "dr" )) then  UNCHANGED
         else if ( (IfValidAnd( HtPumpDucted > 0 ) .OR. LocalCompAssigned( DistribSystem ) .OR.
                                                        LocalCompAssigned( Fan )) .AND.
                   Type == 2 .AND. IfValidAnd( NumHtPumpSystemTypes > 0 ) .AND.
                   IfValidAnd( HtPumpSystem[1]:Type = 22 ))
         then  EvalRulelist( "Reset_HVACSys_HtPump_Ducts", 1 )
         else  UNCHANGED  endif endif  }

	"Default HVACDist via subordinate rulelist"		ResDistSys:Action	= {  EvalRulelist( "Default_HVACDist", 1 )  }

	"Default HVACDist - Verified Duct Design via subordinate rulelist"	ResProj:Action	= {
	      if (Proj:StdDesignBase >= 2019)
         then  EvalRulelist( "Default_HVACDist_VerifiedDuctDesign" )
         else  UNCHANGED  endif  }

   "Set ResDistSys:ReportDuctDesign"     ResDistSys:ReportDuctDesign  =        ; SAC 4/13/19
      {  if (Proj:StdDesignBase >= 2019 .AND. IfValidAnd( DefaultSystem = 0 ) .AND. IfValidAnd( DuctsPresent > 0 ) .AND.
             IfValidAnd( DuctDesign > 0 ) .AND. IfValidAnd( FloorAreaServed > 0 ) .AND.
             SumChildren( ResDuctSeg:SupplyArea ) > 0.1 .AND. SumChildren( ResDuctSeg:ReturnArea ) > 0.1 .AND.
             IfValidAnd( DuctDesignInsRvalue > 0 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 0 ))
         then  1  else  UNDEFINED  endif  }

	"Default HVACFan via subordinate rulelist"		ResFanSys:Action	 	= {  EvalRulelist( "Default_Fan", 1 )  }


  ; More HVACSys heating/cooling equipment summarization
	"Round2 of HVACSys Heat/Cool/HtPump property init"		ResHVACSys:Action		=
      {  switch (Type)
            case  1 :  EvalRulelist( "SetupHVACSys_Round2_HeatCool", 1 )         ; "Other Heat/Cool"
            case  2 :  EvalRulelist( "SetupHVACSys_Round2_HeatPump", 1 )         ; "Heat Pump"
            case  3 :  EvalRulelist( "SetupHVACSys_Round2_HeatCool", 1 )         ; "Var OA Vent Heat/Cool"
            case  4 :  switch (ValidOr( HVACCentralRef[1]:Type, 0 ))             ; "Central Heat/Cool"
                          case  1 :  EvalRulelist( "SetupHVACSys_Round2_CentralHtgClg_FPFC", 1 )   ; "Four-pipe fan coil"
                          case  2 :  EvalRulelist( "SetupHVACSys_Round2_CentralHtgClg_WSHP", 1 )   ; "Water source heat pump"
                          case  3 :  UNCHANGED                                                     ; "Hydronic heating only"
                          case  4 :  EvalRulelist( "SetupHVACSys_Round2_CentralHtgClg_VRF", 1 )    ; "Variable refrigerant flow"
                          default :  UNCHANGED   endswitch
            default :  UNCHANGED
         endswitch  }

  ; SAC 3/10/14 - set new property used to identify sum of all cool/heat/htpump equip units across all new, altered or existing/verified systems (used for generating SCSysRpt report records)
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down BELOW eval of 'SetupHVACSys_Round2_*' rules since ResHVACSys:MaxNumHVACEquipTypes not set until those rules due to new dependence on HtOrClDucted
	"Set ResProj:NumSCSysEquipUnits"		ResProj:NumSCSysEquipUnits		= {	SumAll( ResHVACSys:MaxNumHVACEquipTypes )  }

	; setup properties related to user toggle of cooling equipment simulation (in proposed model when No Cooling selected)
	"Default ResHVACSys:PreventCoolingSim"		ResHVACSys:PreventCoolingSim	= {	0  }		; toggle enabling user to toggle OFF cooling equipment simulation (in proposed model when No Cooling selected)
	"Set ResHVACSys:NoPropCoolingSim"			ResHVACSys:NoPropCoolingSim	= {	if (ResProj:BypassRuleLimits > 0 .AND. PreventCoolingSim > 0 .AND.
																										 (Type == 1 .OR. Type == 3) .AND. CoolSysType == 1)		; "NoCooling - No cooling equipment"
																									then  1  else  0  endif  }

  ; SAC 7/16/14 - new property to track the CoolDucted setting for the INPUT model
  ; mjb 7/17/14	- converted this property to a 10 element array to match CoolSystem and HtPumpSystem
  ; mjb 8/25/14	- keeping tract at the equipment level is not needed for reporting
  ; SAC 4/23/15 - restored settings @ equipment level to prevent HERS airflow flags for equipment of unducted systems
	"Set ResHVACSys:CoolDuctedRpt"		ResHVACSys:CoolDuctedRpt	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 )) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[2]"	ResHVACSys:CoolDuctedRpt[2]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 2 .AND. LocalCompAssigned(   CoolSystem[2] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 2 .AND. LocalCompAssigned( HtPumpSystem[2] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[3]"	ResHVACSys:CoolDuctedRpt[3]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 3 .AND. LocalCompAssigned(   CoolSystem[3] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 3 .AND. LocalCompAssigned( HtPumpSystem[3] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[4]"	ResHVACSys:CoolDuctedRpt[4]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 4 .AND. LocalCompAssigned(   CoolSystem[4] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 4 .AND. LocalCompAssigned( HtPumpSystem[4] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[5]"	ResHVACSys:CoolDuctedRpt[5]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 5 .AND. LocalCompAssigned(   CoolSystem[5] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 5 .AND. LocalCompAssigned( HtPumpSystem[5] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[6]"	ResHVACSys:CoolDuctedRpt[6]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 6 .AND. LocalCompAssigned(   CoolSystem[6] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 6 .AND. LocalCompAssigned( HtPumpSystem[6] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[7]"	ResHVACSys:CoolDuctedRpt[7]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 7 .AND. LocalCompAssigned(   CoolSystem[7] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 7 .AND. LocalCompAssigned( HtPumpSystem[7] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[8]"	ResHVACSys:CoolDuctedRpt[8]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 8 .AND. LocalCompAssigned(   CoolSystem[8] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 8 .AND. LocalCompAssigned( HtPumpSystem[8] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[9]"	ResHVACSys:CoolDuctedRpt[9]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 9 .AND. LocalCompAssigned(   CoolSystem[9] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 9 .AND. LocalCompAssigned( HtPumpSystem[9] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }
	"Set ResHVACSys:CoolDuctedRpt[10]"	ResHVACSys:CoolDuctedRpt[10]	= {	if (IfValidAnd( ResProj:RunNumber < 0.5 ).AND. ( (Type!=2 .AND. NumCoolSystemTypes   >= 10 .AND. LocalCompAssigned(   CoolSystem[10] ) > 0) .OR.
																																						 (Type==2 .AND. NumHtPumpSystemTypes >= 10 .AND. LocalCompAssigned( HtPumpSystem[10] ) > 0))) then  CoolDucted  else  UNCHANGED  endif  }

	; mjb	4/17/14	set flags for HVAC objects that match HVACSys Prop. Design (set in Round2 rulelists above)
; AFUE            ; switched from individual rules to For loop - SAC 10/06/22
	"Set IsHtSysAFUE flag for HeatSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsHtSysAFUE[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HeatSystem[#Sys]) ) then
																													if ( IfValidAnd( HeatSystem[#Sys]:AFUE <= HtSysAFUE ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHtSysAFUE flag for HVACHeat"				ResHtgSys:IsHtSysAFUE		=	{ MaxRevRef( ResHVACSys:HeatSystem, ResHVACSys:IsHtSysAFUE ) }

;	"debug"		ResHtgSys:Action	= {	MessageBox( "Default -- ResHtgSys: '%s':  IsHtSysAFUE = %g", Name, IsHtSysAFUE )  }
;	"debug"		ResHVACSys:Action	= {	MessageBox( "Default -- ResHVACSys: '%s':  ActiveInAnyZone = %g  IsHtSysAFUE[1] = %g  IsHtSysAFUE[2] = %g", Name, ActiveInAnyZone, IsHtSysAFUE[1], IsHtSysAFUE[2] )  }

; SEER - HVACCool                ; switched from individual rules to For loop & added SEER2 references - SAC 10/06/22 (tic #3431)
	"Set IsClSysSEER flag for CoolSystem[1-10]"	   for:#Sys=(1to10)	ResHVACSys:IsClSysSEER[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( CoolSystem[#Sys]:EffMetric = 1 ) ) then
																													if ( IfValidAnd( CoolSystem[#Sys]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER2 flag for CoolSystem[1-10]"	   for:#Sys=(1to10)	ResHVACSys:IsClSysSEER2[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( CoolSystem[#Sys]:EffMetric = 2 ) ) then
																													if ( IfValidAnd( CoolSystem[#Sys]:SEER2 <= ClSysSEER2 ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysSEER flag for HVACCool"				ResClgSys:IsClSysSEER		=	{ MaxRevRef( ResHVACSys:CoolSystem, ResHVACSys:IsClSysSEER ) }

; EER - HVACCool
   ;--------------------------------------------------------------------
   ; Reset ResClgSys:EER based on UseEERinAnalysis 		mjb-08/01/14
   ;--------------------------------------------------------------------
	"Set UseEERinAnalysis flag if EER is user-defined"		ResClgSys:UseEERinAnalysis	=        ; SAC 10/06/22 (tic #3431)
      {	if ( EffMetric = 1 .AND. LocalStatus( EER ) == 7 ) then 1
         else if ( EffMetric = 2 .AND. LocalStatus( EER2 ) == 7 ) then 1
         else  UNCHANGED endif endif	}
	"Reset EER if UseEERinAnalysis not checked"		ResClgSys:Action = {	if (FloorAreaServed > 0.5 .AND. IfValidAnd( UseEERinAnalysis > 0.5 )==0 ) then
																									if (EffMetric = 1 )
                                                                           then  EvalRulelist( "ForceDefault_HVACCool_EER",  1 )
                                                                           else  EvalRulelist( "ForceDefault_HVACCool_EER2", 1 )  endif
																								else UNCHANGED endif	}
;	"debug HVAC"			ResClgSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "PostProposedInput  ResClgSys: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }
   ;--------------------------------------------------------------------


   ; switched from individual rules to For loop & added EER2 references - SAC 10/06/22 (tic #3431)
	"Set IsClSysEER flag for CoolSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsClSysEER[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( CoolSystem[#Sys]:EffMetric = 1 ) ) then
																													if ( IfValidAnd( CoolSystem[#Sys]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER2 flag for CoolSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsClSysEER2[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( CoolSystem[#Sys]:EffMetric = 2 ) ) then
																													if ( IfValidAnd( CoolSystem[#Sys]:EER2 <= ClSysEER2 ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysEER flag for HVACCool"				ResClgSys:IsClSysEER		=	{ MaxRevRef( ResHVACSys:CoolSystem, ResHVACSys:IsClSysEER ) }

; CFMperTon - HVACCool
   ; switched from individual rules to For loop - SAC 10/06/22
	"Set IsClSysCFMperTon flag for CoolSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsClSysCFMperTon[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(CoolSystem[#Sys]) ) then
																													if ( IfValidAnd( CoolSystem[#Sys]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsClSysCFMperTon flag for HVACCool"				ResClgSys:IsClSysCFMperTon		=	{ MaxRevRef( ResHVACSys:CoolSystem, ResHVACSys:IsClSysCFMperTon ) }

; SEER - HVACHtPump        ; switched from individual rules to For loop and revised for SEER2 - SAC 10/06/22 (tic #3431)
	"Set IsHPSysSEER flag for HtPumpSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsHPSysSEER[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( HtPumpSystem[#Sys]:EffMetric = 1 ) ) then
																													if ( IfValidAnd( HtPumpSystem[#Sys]:SEER <= ClSysSEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER2 flag for HtPumpSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsHPSysSEER2[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( HtPumpSystem[#Sys]:EffMetric = 2 ) ) then
																													if ( IfValidAnd( HtPumpSystem[#Sys]:SEER2 <= ClSysSEER2 ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysSEER flag for HVACHtPump"				ResHtPumpSys:IsClSysSEER		=	{ MaxRevRef( ResHVACSys:HtPumpSystem, ResHVACSys:IsHPSysSEER ) }

; EER - HVACCHtPump

   "Set UseEERinAnalysis flag if EER is user-defined"	   ResHtPumpSys:UseEERinAnalysis	=     ; SAC 10/06/22 (tic #3431)
      {  if ( EffMetric = 1 .AND. LocalStatus( EER ) == 7 ) then 1
         else if ( EffMetric = 2 .AND. LocalStatus( EER2 ) == 7 ) then 1
         else  UNCHANGED  endif endif	}

   ; SAC 11/4/18 - added logic to check EERValid flag before looking it up (prevent error in VCHP models)      ; SAC 10/06/22 (tic #3431)
   "Reset EER if UseEERinAnalysis not checked"		ResHtPumpSys:Action = {	if (FloorAreaServed > 0.5 .AND. UseEERinAnalysis < 0.5)
                                                                           then  if (EffMetric = 1 .AND.
                                                                                     T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                                 then  EvalRulelist( "ForceDefault_HVACHtPump_EER", 1 )
                                                                                 else if (EffMetric = 2 .AND.
                                                                                     T24RCoolingEquipment:EER2Valid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                                 then  EvalRulelist( "ForceDefault_HVACHtPump_EER2", 1 )
                                                                                 else  UNCHANGED  endif endif
			   																					else UNCHANGED endif	}
   ; switched from individual rules to For loop and revised for EER2 - SAC 10/06/22 (tic #3431)
	"Set IsHPSysEER flag for HtPumpSystem[1-10]"	   for:#Sys=(1to10) 	ResHVACSys:IsHPSysEER[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( HtPumpSystem[#Sys]:EffMetric = 1 ) ) then
																													if ( IfValidAnd( HtPumpSystem[#Sys]:EER <= ClSysEER ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER2 flag for HtPumpSystem[1-10]"	for:#Sys=(1to10)	ResHVACSys:IsHPSysEER2[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( IfValidAnd( HtPumpSystem[#Sys]:EffMetric = 2 ) ) then
																													if ( IfValidAnd( HtPumpSystem[#Sys]:EER2 <= ClSysEER2 ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysEER flag for HVACHtPump"			ResHtPumpSys:IsClSysEER		=	{ MaxRevRef( ResHVACSys:HtPumpSystem, ResHVACSys:IsHPSysEER ) }

; CFMperTon - HVACHtPump
   ; switched from individual rules to For loop - SAC 09/19/22
	"Set IsHPSysCFMperTon flag for HtPumpSystem[1-10]"	  for:#Sys=(1to10)	ResHVACSys:IsHPSysCFMperTon[#Sys]		=
                                                                              {  if ( ActiveInAnyZone > 0.5 ) then
																												if ( LocalCompAssigned(HtPumpSystem[#Sys]) ) then
																													if ( IfValidAnd( HtPumpSystem[#Sys]:CFMperTon <= ClSysCFMperTon ) .AND. Status != 1 ) then 1 else 0 endif
																													else 0 endif
																											else 0 endif	}
	"Set IsHPSysCFMperTon flag for HVACHtPump"			ResHtPumpSys:IsClSysCFMperTon		=	{ MaxRevRef( ResHVACSys:HtPumpSystem, ResHVACSys:IsHPSysCFMperTon ) }

	;	no default:  ResHVACSys:CFIClVentFan,     BEMP_Obj,  1,    1, "ClVentFan",     "Fan type used to supply CFI cooling ventilation"               
	"Set ResHVACSys:CFIClVentFlow - PLACEHOLDER"	ResHVACSys:CFIClVentFlow	= {	if (ResProj:EnableClVent < 0.5 .OR. ResProj:UnitClVentOption != 3) then  0
																									else if (Type == 3)
																									then	if (LocalCompAssigned( CFIClVentFan ) == 0) then  0
																											else  1  endif    ; would be if it were already defaulted...: CFIClVentFan:CoolingVent  endif
																									else if (Type == 1 .OR. Type == 2)
																									then	if (CFIClVentOption < 1 .OR. LocalCompAssigned( CFIClVentFan ) == 0) then  0
																											else  1  endif    ; would be if it were already defaulted...: CFIClVentFan:CoolingVent  endif
																									else  0  endif endif endif  }

   "Set ResHtPumpSys:UIDialogMsg"     ResHtPumpSys:UIDialogMsg  = {
         if (IfValidAnd( IsAvailable > 0 )==0)
         then  "This system type is not yet available for compliance analysis"
         else if (Type == 22)  ; VCHP
         then  "HSPF, Cap @ 17, SEER and EER for reporting only, no analysis impact"
         else  UNDEFINED  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput:  HVACSys object used as DHWHeater
   ;--------------------------------------------------------------------
	"Set HtEqpCanBeDHWHtr flag for HtPumpSystem[1]"		ResHVACSys:HtEqpCanBeDHWHtr	= {	if (Type != 2) then  0
																													else if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:CanBeDHWHtr > -1 ))
																													then  HtPumpSystem[1]:CanBeDHWHtr
																													else  0  endif endif  }
	"Default ResHVACSys:ServesAsDHWHtr flag"					ResHVACSys:ServesAsDHWHtr		= {	HtEqpCanBeDHWHtr  }
	"Set CanBeDHWHtr flag"										ResHVACSys:CanBeDHWHtr			= {	if (HtEqpCanBeDHWHtr > 0.1 .AND. ServesAsDHWHtr > 0.5) then  1  else  0  endif  }

; probably MOVE these rules to a subordinate rulelist that sets them based on some reasonable logic referencing DHW-related HVACHtPump properties
; FOR NOW - hardwire to DHWHeater settings from a prototype model
; will need to move AFTER call to RULELIST "SetupHVACSys_Round2_HeatPump", where HPSysCOP47 is assigned
; move to rulelist that gets called from ASHP equivalent to above RULELIST?	
	; "Set ResHVACSys:DHWHeaterElementType"  ResHVACSys:DHWHeaterElementType	= {	"Heat Pump"      }
	; SAC 6/2/14 - added logic to account for new GSHP HeaterElementType option
	"Set ResHVACSys:DHWHeaterElementType"  ResHVACSys:DHWHeaterElementType	= {	if (IfValidAnd( Type = 2 ) .AND. IfValidAnd( HtPumpSysType = 12 ))  ; Type = HP / HtPumpSysType = "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
																									then	"Ground-Source Heat Pump"
																									else	   "Air-Source Heat Pump"    endif  }
;	"Set ResHVACSys:DHWTankType"           ResHVACSys:DHWTankType         	= {	"Small Storage"  }			; SAC 5/7/14 - using "Unfired Storage Tank" or "Indirect" here doesn't work with Heat Pump
	"Set ResHVACSys:DHWTankType"           ResHVACSys:DHWTankType         	= {	"Indirect"       }			; SAC 6/6/14 - updated DHW engine now works w/ AWHP + Indirect tank
	"Set ResHVACSys:DHWInputRating"        ResHVACSys:DHWInputRating      	= {	0                }
	"Set ResHVACSys:DHWInputRatingUnits"	ResHVACSys:DHWInputRatingUnits	= {	switch (DHWHeaterElementType)
																										case  0 :	"watts"   ; "Electric Resistance" 
																										case  1 :   "Btu/hr"  ; "Natural Gas"   
																										case  2 :   "Btu/hr"  ; "Propane"             
																										case  3 :   "watts"   ; "Air-Source Heat Pump"           
																										case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																										case  4 :   "Btu/hr"  ; "Oil"   
																										default :	" "
																									endswitch  }
;	"Set ResHVACSys:DHWEnergyFactor"       ResHVACSys:DHWEnergyFactor     	= {	(0.9376 * ResHVACSys:HPSysCOP47 - 0.7032) / (1.086 - 0.1102 * ResHVACSys:HPSysCOP47)	}
;	"Set ResHVACSys:DHWEnergyFactor"       ResHVACSys:DHWEnergyFactor     	= {	0.575	           }
	"Set ResHVACSys:DHWEnergyFactor"       ResHVACSys:DHWEnergyFactor     	= {	if (IfValidAnd( HPSysCOP47 > 0.5 )) then  HPSysCOP47  else  3  endif  }
	"Set ResHVACSys:DHWTankVolume"         ResHVACSys:DHWTankVolume       	= {	50               }
	"Set ResHVACSys:DHWIntInsulRVal"       ResHVACSys:DHWIntInsulRVal     	= {	0                }
	"Set ResHVACSys:DHWExtInsulRVal"       ResHVACSys:DHWExtInsulRVal     	= {	0                }
	"Set ResHVACSys:DHWAmbientCond"        ResHVACSys:DHWAmbientCond      	= {	"Unconditioned"  }
	"Set ResHVACSys:DHWStandbyLossFrac"    ResHVACSys:DHWStandbyLossFrac  	= {	0                }
;HSPF = (3.2 x COP)  2.4
;RE = HSPF / 3.413
;EF = RE/(1 + 0.1175 x RE)
; so EF = (.9376 x COP - .7032) / (1.086 - 0.1102 x COP)
	"Set ResHVACSys:DHWFloorAreaServed"		ResHVACSys:DHWFloorAreaServed 	= {	SumRevRef( ResDHWSys:DHWHeater, ResDHWSys:FloorAreaServed )  }		; SAC 5/7/14 - added to facilitate error checks


   ;--------------------------------------------------------------------
   ; ProposedInput: DwellUnitType HVAC Rules
   ;--------------------------------------------------------------------

	; "Default DwellUnitType:HVACSysType"
	"Set DwellUnitType:HVACSysTypeAbbrev"		DwellUnitType:HVACSysTypeAbbrev		= {	HVACSysType  }
	"Set DwellUnitType:HVACSysTypeAbbrevStr"	DwellUnitType:HVACSysTypeAbbrevStr	= {	EnumString( HVACSysTypeAbbrev )  }

	"Set DwellUnitType:HeatEquipNumLbl"		DwellUnitType:HeatEquipNumLbl		= {	if (HVACSysType == 2) then	"Heat Pump(s):"
                                                                            else if( HVACSysType == 4 ) then "Central System Type:"
                                                                            else "Heating:"	endif	endif  }

   ; mods to ensure NumHeatEquipTypes & NumCoolEquipTypes not user-defined if not Heat/Cool system type - SAC 09/03/22
   "Blast DwellUnitType:NumHeatEquipTypes & NumCoolEquipTypes if not Heat/Cool system"    DwellUnitType:Action =
      {  if (HVACSysType != 1 .AND. (LocalStatus( NumHeatEquipTypes ) > 5 .OR. LocalStatus( NumCoolEquipTypes ) > 5))
         then  EvalRulelist( "ForceReset_DwellUnitType_NumHeatCoolEquipTypes", 1 )
         else  UNCHANGED  endif  }
	"Default DwellUnitType:NumHeatEquipTypes"		DwellUnitType:NumHeatEquipTypes	=     ; default to 0 for non-Heat/Cool systems - SAC 09/03/22
      {	if (HVACSysType != 1) then  0  else  1  endif  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatEquipTypes
	"Force reset of DwellUnitType:HeatEquip*[1]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 1 .OR. (LocalStatus( HeatEquipCount[1] ) < 6 .AND. LocalStatus( HVACHeatRef[1] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[2]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 2 .OR. (LocalStatus( HeatEquipCount[2] ) < 6 .AND. LocalStatus( HVACHeatRef[2] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[3]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 3 .OR. (LocalStatus( HeatEquipCount[3] ) < 6 .AND. LocalStatus( HVACHeatRef[3] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[4]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 4 .OR. (LocalStatus( HeatEquipCount[4] ) < 6 .AND. LocalStatus( HVACHeatRef[4] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:HeatEquip*[5]"		DwellUnitType:Action		= {	if (NumHeatEquipTypes >= 5 .OR. (LocalStatus( HeatEquipCount[5] ) < 6 .AND. LocalStatus( HVACHeatRef[5] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_HeatEquip_5", 1 )  endif  }

	"Default DwellUnitType:HeatEquipCount[1]"		DwellUnitType:HeatEquipCount[1]	= {	if (NumHeatEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[2]"		DwellUnitType:HeatEquipCount[2]	= {	if (NumHeatEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[3]"		DwellUnitType:HeatEquipCount[3]	= {	if (NumHeatEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[4]"		DwellUnitType:HeatEquipCount[4]	= {	if (NumHeatEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:HeatEquipCount[5]"		DwellUnitType:HeatEquipCount[5]	= {	if (NumHeatEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACHeatRef"

	"Set DwellUnitType:NumHeatEqpUnits - 1"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  )) then                    HeatEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 2"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  )) then  NumHeatEqpUnits + HeatEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 3"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  )) then  NumHeatEqpUnits + HeatEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 4"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  )) then  NumHeatEqpUnits + HeatEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHeatEqpUnits - 5"	DwellUnitType:NumHeatEqpUnits	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  )) then  NumHeatEqpUnits + HeatEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:HeatEqpType"				DwellUnitType:HeatEqpType			= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																												then  HVACHeatRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:HeatEqpTypeAbbrev"		DwellUnitType:HeatEqpTypeAbbrev	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																												then  HVACHeatRef[1]:TypeAbbrevStr
																												else  " "  endif  }

	"Blast Heat* user input if HeatEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( HeatEqpTypeSetup ) < 1 .OR. LocalStatus( PrevHeatEqpType ) < 1) then  UNCHANGED
																												else if (HeatEqpTypeSetup < 0.5) then  UNCHANGED
																												else if (HeatEqpType != PrevHeatEqpType)
																												then	EvalRulelist( "BlastDwellUnitTypeUserInput_Heating", 1 )
																												else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevHeatEqpType"		DwellUnitType:PrevHeatEqpType		= {	HeatEqpType  }
	"Set DwellUnitType:HeatEqpTypeSetup"	DwellUnitType:HeatEqpTypeSetup	= {	if (HeatEqpType > 0) then  1  else  0  endif  }

   ; mods to ensure NumHtPumpEquipTypes not user-defined if not HtPump system type - SAC 09/03/22
   "Blast DwellUnitType:NumHeatEquipTypes & NumCoolEquipTypes if not Heat/Cool system"    DwellUnitType:Action =
      {  if (HVACSysType != 2 .AND. LocalStatus( NumHtPumpEquipTypes ) > 5)
         then  EvalRulelist( "ForceReset_DwellUnitType_NumHtPumpEquipTypes", 1 )
         else  UNCHANGED  endif  }
	"Default DwellUnitType:NumHtPumpEquipTypes"		DwellUnitType:NumHtPumpEquipTypes	=           ; default to 0 if not HtPump system - SAC 09/03/22
      {	if (HVACSysType != 2) then  0  else  1  endif  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpEquipTypes
	"Force reset of DwellUnitType:HtPumpEquip*[1]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 1 .OR. (LocalStatus( HtPumpEquipCount[1] ) < 6 .AND. LocalStatus( HVACHtPumpRef[1] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[2]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 2 .OR. (LocalStatus( HtPumpEquipCount[2] ) < 6 .AND. LocalStatus( HVACHtPumpRef[2] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[3]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 3 .OR. (LocalStatus( HtPumpEquipCount[3] ) < 6 .AND. LocalStatus( HVACHtPumpRef[3] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[4]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 4 .OR. (LocalStatus( HtPumpEquipCount[4] ) < 6 .AND. LocalStatus( HVACHtPumpRef[4] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:HtPumpEquip*[5]"		DwellUnitType:Action		= {	if (NumHtPumpEquipTypes >= 5 .OR. (LocalStatus( HtPumpEquipCount[5] ) < 6 .AND. LocalStatus( HVACHtPumpRef[5] ) < 6)) then  UNCHANGED
																												else	EvalRulelist( "ForceReset_DwellUnitType_HtPumpEquip_5", 1 )  endif  }

	"Default DwellUnitType:HtPumpEquipCount[1]"		DwellUnitType:HtPumpEquipCount[1]	= {	if (NumHtPumpEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[2]"		DwellUnitType:HtPumpEquipCount[2]	= {	if (NumHtPumpEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[3]"		DwellUnitType:HtPumpEquipCount[3]	= {	if (NumHtPumpEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[4]"		DwellUnitType:HtPumpEquipCount[4]	= {	if (NumHtPumpEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:HtPumpEquipCount[5]"		DwellUnitType:HtPumpEquipCount[5]	= {	if (NumHtPumpEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACHtPumpRef"

	"Set DwellUnitType:NumHtPumpEqpUnits - 1"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  )) then                      HtPumpEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 2"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 3"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 4"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumHtPumpEqpUnits - 5"		DwellUnitType:NumHtPumpEqpUnits		= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  )) then  NumHtPumpEqpUnits + HtPumpEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:HtPumpEqpType"				DwellUnitType:HtPumpEqpType			= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																														then  HVACHtPumpRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:HtPumpEqpTypeAbbrev"		DwellUnitType:HtPumpEqpTypeAbbrev	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																														then  HVACHtPumpRef[1]:TypeAbbrevStr
																														else  " "  endif  }

	"Blast HtPump* user input if HtPumpEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( HtPumpEqpTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpEqpType ) < 1) then  UNCHANGED
																													else if (HtPumpEqpTypeSetup < 0.5) then  UNCHANGED
																													else if (HtPumpEqpType != PrevHtPumpEqpType)
																													then	EvalRulelist( "BlastDwellUnitTypeUserInput_HeatPump", 1 )
																													else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevHtPumpEqpType"		DwellUnitType:PrevHtPumpEqpType		= {	HtPumpEqpType  }
	"Set DwellUnitType:HtPumpEqpTypeSetup"		DwellUnitType:HtPumpEqpTypeSetup		= {	if (HtPumpEqpType > 0) then  1  else  0  endif  }

	"Default DwellUnitType:NumCoolEquipTypes"		DwellUnitType:NumCoolEquipTypes	=        ; default to 0 if not Heat/Cool system - SAC 09/03/22
      {	if (HVACSysType != 1) then  0  else  1  endif  }

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumCoolEquipTypes
	"Force reset of DwellUnitType:CoolEquip*[1]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 1 .OR. (LocalStatus( CoolEquipCount[1] ) < 6 .AND. LocalStatus( HVACCoolRef[1] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_1", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[2]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 2 .OR. (LocalStatus( CoolEquipCount[2] ) < 6 .AND. LocalStatus( HVACCoolRef[2] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_2", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[3]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 3 .OR. (LocalStatus( CoolEquipCount[3] ) < 6 .AND. LocalStatus( HVACCoolRef[3] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_3", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[4]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 4 .OR. (LocalStatus( CoolEquipCount[4] ) < 6 .AND. LocalStatus( HVACCoolRef[4] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_4", 1 )  endif  }
	"Force reset of DwellUnitType:CoolEquip*[5]"		DwellUnitType:Action		= {	if (NumCoolEquipTypes >= 5 .OR. (LocalStatus( CoolEquipCount[5] ) < 6 .AND. LocalStatus( HVACCoolRef[5] ) < 6)) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_CoolEquip_5", 1 )  endif  }

	"Default DwellUnitType:CoolEquipCount[1]"		DwellUnitType:CoolEquipCount[1]	= {	if (NumCoolEquipTypes > 0) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[2]"		DwellUnitType:CoolEquipCount[2]	= {	if (NumCoolEquipTypes > 1) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[3]"		DwellUnitType:CoolEquipCount[3]	= {	if (NumCoolEquipTypes > 2) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[4]"		DwellUnitType:CoolEquipCount[4]	= {	if (NumCoolEquipTypes > 3) then  1  else  0  endif  }
	"Default DwellUnitType:CoolEquipCount[5]"		DwellUnitType:CoolEquipCount[5]	= {	if (NumCoolEquipTypes > 4) then  1  else  0  endif  }
	; "Default DwellUnitType:HVACCoolRef"

	"Set DwellUnitType:NumCoolEqpUnits - 1"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  )) then                    CoolEquipCount[1]   else      0      endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 2"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  )) then  NumCoolEqpUnits + CoolEquipCount[2]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 3"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  )) then  NumCoolEqpUnits + CoolEquipCount[3]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 4"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  )) then  NumCoolEqpUnits + CoolEquipCount[4]   else  UNCHANGED  endif  }
	"Set DwellUnitType:NumCoolEqpUnits - 5"	DwellUnitType:NumCoolEqpUnits	= {	if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  )) then  NumCoolEqpUnits + CoolEquipCount[5]   else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEqpType"				DwellUnitType:CoolEqpType			= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																												then  HVACCoolRef[1]:Type  else  0  endif  }
	"Set DwellUnitType:CoolEqpTypeAbbrev"		DwellUnitType:CoolEqpTypeAbbrev	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																												then  HVACCoolRef[1]:TypeAbbrevStr
																												else  " "  endif  }

	"Blast Cool* user input if CoolEqpType has changed"	DwellUnitType:Action	= {	if (LocalStatus( CoolEqpTypeSetup ) < 1 .OR. LocalStatus( PrevCoolEqpType ) < 1) then  UNCHANGED
																												else if (CoolEqpTypeSetup < 0.5) then  UNCHANGED
																												else if (CoolEqpType != PrevCoolEqpType)
																												then	EvalRulelist( "BlastDwellUnitTypeUserInput_Cooling", 1 )
																												else	UNCHANGED  endif endif endif  }
	"Set DwellUnitType:PrevCoolEqpType"		DwellUnitType:PrevCoolEqpType		= {	CoolEqpType  }
	"Set DwellUnitType:CoolEqpTypeSetup"	DwellUnitType:CoolEqpTypeSetup	= {	if (CoolEqpType > 0) then  1  else  0  endif  }

	; setup properties related to user toggle of cooling equipment simulation (in proposed model when No Cooling selected)
	"Default DwellUnitType:PreventCoolingSim"		DwellUnitType:PreventCoolingSim	= {	0  }		; toggle enabling user to toggle OFF cooling equipment simulation (in proposed model when No Cooling selected)
	"Set DwellUnitType:NoPropCoolingSim"			DwellUnitType:NoPropCoolingSim	= {	if (ResProj:BypassRuleLimits > 0 .AND. PreventCoolingSim > 0 .AND.
																														 (HVACSysType == 1 .OR. HVACSysType == 3) .AND. CoolEqpType == 1)		; "NoCooling - No cooling equipment"
																													then  1  else  0  endif  }


  ; More DwellUnitType heating/cooling equipment summarization
	"Round2 of DwellUnitType Heat/Cool/HtPump property init"		DwellUnitType:Action	= {	if (HVACSysType == 1 .OR. HVACSysType == 3)
																														then  EvalRulelist( "SetupDwellUnitType_Round2_HeatCool", 1 )
																														else if (HVACSysType == 2)
																														then	EvalRulelist( "SetupDwellUnitType_Round2_HeatPump", 1 )
																														else	UNCHANGED  endif endif  }

   ; SAC 5/24/19 - added new flag indicating whether the DwellUnitType has mechanical cooling equip
   "Set DwellUnitType:HaveCooling"     DwellUnitType:HaveCooling  =
      {  if (HVACSysType == 1 .OR. HVACSysType == 3)
         then  if (NumCoolEquipTypes < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) < 1) then  0
               else if (HVACCoolRef[1]:Type < 2) then  0
               else  1  endif endif
         else  if (NumHtPumpEquipTypes < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) < 1) then  0
               else if (HVACHtPumpRef[1]:Type < 1) then  0
               else  1  endif endif
         endif  }

	"Set DwellUnitType:AddlEquipLabel"		DwellUnitType:AddlEquipLabel	= {	if (NumHeatEquipTypes > 1 .OR. NumHtPumpEquipTypes > 1 .OR. NumCoolEquipTypes > 1)
																										then	"All heating, cooling and heat pump equipment must be of the same 'Type'."
																										else	"Heating, cooling and heat pump equipment entered on main DwellUnitType tab."  endif  }


   ;--------------------------------------------------------------------
	; ClVentFan defaulting
   ;--------------------------------------------------------------------
   "Default ResClVentFan:ExhaustsTo"      ResClVentFan:ExhaustsTo =        ; SAC 4/23/19 (tic #1023)
      {  if (IfValidAnd( ResProj:LimitedClVent = 1 )) then  2  else  1  endif  }

   "Default ResClVentFan:DefaultSystem"			ResClVentFan:DefaultSystem  = {  1  }
  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
	"Ensure ResClVentFan:DefaultSystem valid"		ResClVentFan:Action	= {
						if (DefaultSystem > 0.5)
						then	if (	LocalStatus( WperCFMCool ) > 4  .OR.  LocalStatus( CoolingVent ) > 4 )
								then	EvalRulelist( "ForceDefaults_ClVentFan", 1 )
								else	UNCHANGED  endif
						else	UNCHANGED  endif  }

   ; SAC 8/27/13 - revised fan flow & power defaults for CFI scenario - from Bruce via e-mail: flow rate for these CFI systems is much lower that whole house fans - suggest 0.5 CFM/ft2
   ; SAC 9/4/13 - revised defaulting to enable user edits to ResHVACSys:CFIClVentFlow & CFIClVentPwr
   ; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
   ; SAC 1/17/19 - added additional if statement to use table CFM/SF iff > 0 (requested by KN)
   "Default ResClVentFan:CoolingVent"     ResClVentFan:CoolingVent  =
      {  if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
             SumAll( ResHVACSys:CFIClVentFlow ) > 0.5 .AND. CountRefs( ResHVACSys:CFIClVentFan ) > 0.5)      ; SumRevRef( ResHVACSys:CFIClVentFan, ResHVACSys:CFIClVentFlow ) > 0.5)
         then  0.5 * SumRevRef( ResHVACSys:CFIClVentFan, ResHVACSys:FloorAreaServed[1] ) / CountRefs( ResHVACSys:CFIClVentFan )      ; SumRevRef( ResHVACSys:CFIClVentFan, ResHVACSys:CFIClVentFlow )
         else if (Global( Proj:CliZnNum ) < 0.5) then  UNDEFINED
         else if (T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0)
         then  T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 
               ResProj:CondFloorArea
         else  ResProj:CondFloorArea * 1.5
         endif endif endif  }
         ;              Local( FloorAreaServed )  endif  }
         ; SAC 4/21/13 - always use entire home area to default CoolingVent
   ; SAC 7/31/17 - replaced old default of 0.58 WperCFM value w/ table look-up for CFI cool vent (tic #882)
   ; SAC 2/12/18 - replaced 'hard-coded' 0.1 W/CFM default WHF power value w/ look-up table entry to accommodate 2019 update (tic #977)
   "Default ResClVentFan:WperCFMCool"			ResClVentFan:WperCFMCool    = {
      if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
          SumAll( ResHVACSys:CFIClVentFlow ) > 0.5 .AND. SumRevRef( ResHVACSys:CFIClVentFan, ResHVACSys:CFIClVentFlow ) > 0.5)
      then  T24RClimateZoneCodeBase:WperCFM(    "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      else  T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      endif  }

   "Set ResClVentFan:UIMessage[1]"     ResClVentFan:UIMessage[1]  = {  Format( "Exhausts to %s", EnumString( ExhaustsTo ) )  }   ; SAC 4/23/19
   "Set ResClVentFan:UIMessage[2]"     ResClVentFan:UIMessage[2]  =
      {  if (ExhaustsTo = 1 .AND. IfValidAnd( ResProj:LimitedClVent = 1 ))
         then  "Warning:  No attic present in model to exhaust to"
         else  UNDEFINED  endif  }

   "Re-default project-wide SFam ClVent in case ClVentFan properties have been updated"  ResProj:Action =      ; SAC 1/20/19 (tic #1040)
      {  if (IsMultiFamily > 0.5 .OR. ClVentFanUI < 0.5) then  UNCHANGED
         else  EvalRulelist( "Default_SFam_CoolingVent" )  endif  }

; SAC 8/27/13 - secondary part of CFI (Central Fan Integrated) Cool Vent properties and defaulting - FOLLOWING ClVentFan defaulting
	"Set ResHVACSys:CFIClVentFlow"	ResHVACSys:CFIClVentFlow	= {	if (ResProj:EnableClVent < 0.5 .OR. ResProj:UnitClVentOption != 3) then  0
																					else if (Type == 3)
																					then	if (LocalCompAssigned( CFIClVentFan ) == 0)
																							then  0.5 * FloorAreaServed[1]
																							else  CFIClVentFan:CoolingVent  endif
																					else if (Type == 1 .OR. Type == 2)
																					then	if (CFIClVentOption < 1) then  0
																							else if (LocalCompAssigned( CFIClVentFan ) == 0)
																							then  0.5 * FloorAreaServed[1]
																							else  CFIClVentFan:CoolingVent  endif endif
																					else  0  endif endif endif  }
   ; SAC 7/31/17 - replaced old default of 0.58 WperCFM value w/ table look-up for CFI cool vent (tic #882)
	"Set ResHVACSys:CFIClVentPwr"		ResHVACSys:CFIClVentPwr		= {
      if (CFIClVentFlow < 1) then  0
      else if (LocalCompAssigned( CFIClVentFan ) == 0)
      then  T24RClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
      else  CFIClVentFan:WperCFMCool  endif endif  }

; SAC 10/17/14 - added to accommodate multiple attics
	"Default ResHVACSys:CFIClVentAttic"	ResHVACSys:CFIClVentAttic		= 	{	if (ResProj:EnableClVent < 0.5 .OR. LocalCompAssigned( MaxClVentableAttic ) < 0.5) then  UNDEFINED
																							else	MaxClVentableAttic  endif  }

; SAC 9/4/13 - revised to reflect NEW primary inputs of ResHVACSys:CFIClVentFlow & CFIClVentPwr  (as opposed to CFIClVentFan)
	"Set ResHVACSys:CFIClVentFanShow"	ResHVACSys:CFIClVentFanShow	= {	if (Type < 1 .OR. Type > 3) then  0
																							else if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
																											((ResProj:EnableVarFlowOAV   .AND. Type == 3) .OR.
																											 (ResProj:EnableFixedFlowOAV .AND. Type != 3 .AND. CFIClVentOption > 0))) then  1
																							else  0  endif endif  }
	"Set ResHVACSys:CFIClVentFanLbl"		ResHVACSys:CFIClVentFanLbl		= {	if (Type == 3) then  "Maximum Flow:"
																							else if (CFIClVentFanShow < 0.5) then  " "
																							else  "      Fixed Flow:"  endif endif  }
	"Set ResHVACSys:CFIClVentFanMsg"		ResHVACSys:CFIClVentFanMsg		= {	if (Type == 3 .OR. CFIClVentOption > 0)
																							then	if (ResProj:EnableClVent < 0.5)
																									then  "(CFI cool vent available only for single family homes with ventilated attics)"
																									else if (ResProj:UnitClVentOption != 3)
																									then  "(activate CFI cool vent via selection in Cool Vent tab of the Project data dialog)"
																									else  " "  endif endif
																					;				else if (LocalCompAssigned( CFIClVentFan ))
																					;				then	Format( "%s CFM, %.3f W/CFM (when operating in cool vent mode)", FltToStr( CFIClVentFan:CoolingVent ), CFIClVentFan:WperCFMCool )
																					;				else	"(maximum air flow and fan W when operating in cool vent mode)"
																					;				endif endif endif
																							else	" "  endif  }
; SAC 12/21/14 - address GC issue 435 by implementing a reporting property
	"Set ResHVACSys:CFIClVentOptionRpt"	ResHVACSys:CFIClVentOptionRpt	= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) .AND.
																									IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) .AND.
																									(Type == 3 .OR. CFIClVentOption > 0) )
																							then	if (Type == 3)
																									then	"Variable Flow"
																									else	"Fixed Flow"
																									endif
																							else	UNDEFINED
																							endif  }

	"Set ResHVACSys:IsVariableCFIClVent"	ResHVACSys:IsVariableCFIClVent = {If(ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 )
																	 .AND. Type=3 .AND. IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) 
																	 .AND. LocalCompAssigned (ResHVACSys:CFIClVentAttic))
																	 then 1
																	 else 0
																	 endif}
																	 
	"Set ResHVACSys:IsFixedCFIClVent"		ResHVACSys:IsFixedCFIClVent = {If(ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND. IfValidAnd( FloorAreaServed[1] > 0 )
																	 .AND. Type!=3 .AND. CFIClVentOption > 0 .AND. IfValidAnd( CFIClVentFlow > 0 ) .AND. IfValidAnd( CFIClVentPwr > 0 ) 
																	 .AND. LocalCompAssigned (ResHVACSys:CFIClVentAttic))
																	 then 1
																	 else 0
																	 endif}

   ;--------------------------------------------------------------------
	; IAQFan defaulting
   ;--------------------------------------------------------------------
   ; moved primary IAQFan defaulting rules into Default_HVAC_IAQFan rulelist - SAC 7/21/20 (tic #1174)

; SAC 2/5/20 - moved ResIAQFan:NumAssignments up from below (in analysis prep rules) in order to take into account for backward compatibility (tic #1174)
	"Init all ResIAQFan:NumAssignments"							ResIAQFan:NumAssignments	= {	0  }
                        ; SAC 1/14/15 - updated rules for latest DwellUnitType structure and eliminate references to old (proj-based) MFam inputs
	"Incrament ResProj:UnitIAQFan1[1]:NumAssignments"		ResProj:UnitIAQFan1[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt1[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan1[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitIAQFan2[1]:NumAssignments"		ResProj:UnitIAQFan2[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt2[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan2[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitIAQFan3[1]:NumAssignments"		ResProj:UnitIAQFan3[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt3[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan3[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitIAQFan4[1]:NumAssignments"		ResProj:UnitIAQFan4[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFanCnt4[1] > 0.5 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan4[1]:NumAssignments + 1  else  UNCHANGED  endif  }

   ; ensure ADU IAQ fan assignments also tracked - SAC 06/01/21 (tic #1218)
	"Incra. ADU ResProj:UnitIAQFan1[2]:NumAssignments"		ResProj:UnitIAQFan1[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt1[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan1[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU ResProj:UnitIAQFan2[2]:NumAssignments"		ResProj:UnitIAQFan2[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt2[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan2[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU ResProj:UnitIAQFan3[2]:NumAssignments"		ResProj:UnitIAQFan3[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt3[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan3[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incra. ADU ResProj:UnitIAQFan4[2]:NumAssignments"		ResProj:UnitIAQFan4[2]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFanCnt4[2] > 0.5 ) .AND. IfValidAnd( SFamADUIAQUI > 0 ) .AND. IAQDisabled < 0.5) then  UnitIAQFan4[2]:NumAssignments + 1  else  UNCHANGED  endif  }

	"Incrament DwellUnitType:IAQFanRef[1]:NumAssignments"		DwellUnitType:IAQFanRef[1]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[2]:NumAssignments"		DwellUnitType:IAQFanRef[2]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[3]:NumAssignments"		DwellUnitType:IAQFanRef[3]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[3]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament DwellUnitType:IAQFanRef[4]:NumAssignments"		DwellUnitType:IAQFanRef[4]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. IfValidAnd( AssignedDUFlrArea = 0 )==0) then  IAQFanRef[4]:NumAssignments + 1  else  UNCHANGED  endif  }

   "Incrament ResOtherZn:IAQFanRef[1-4]:NumAssignments"   for:#Fan=(1to4)   ResOtherZn:IAQFanRef[#Fan]:NumAssignments  =      ; SAC 06/26/23
      {  if (IfValidAnd(IAQDisabled < 1) .AND. IfValidAnd(AllowIAQInps > 0) .AND.
             IAQOption == 2 .AND. IfValidAnd( IAQNumFanRefs >= #Fan ))
         then  IAQFanRef[#Fan]:NumAssignments + 1  else  UNCHANGED  endif  }

   "Set ResIAQFan:WperCFMIAQRpt - iff this fan is referenced in analysis (for reporting as special feature)"   ResIAQFan:WperCFMIAQRpt  =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IfValidAnd( WperCFMIAQ > 0 )==0) then  UNDEFINED
         else  WperCFMIAQ  endif  }
   "Set ResIAQFan:HRV_SRE_Rpt - iff this fan is referenced in analysis (for reporting as special feature)"     ResIAQFan:HRV_SRE_Rpt   =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IAQFanType != 3 .OR.
             IncludesRecov < 1 .OR. IfValidAnd( SensRecovEff > 0 )==0) then  UNDEFINED
         else  SensRecovEff  endif  }
   "Set ResIAQFan:HRV_ASRE_Rpt - iff this fan is referenced in analysis (for reporting as special feature)"    ResIAQFan:HRV_ASRE_Rpt  =   ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. NumAssignments < 1 .OR. IAQFanType != 3 .OR.
             IncludesRecov < 1 .OR. IfValidAnd( AdjSensRecovEff > 0 )==0) then  UNDEFINED
         else  AdjSensRecovEff  endif  }

   ; ----- IAQ fan heat recovery backward compatibility -----
   "hardwire ResIAQFan:IncludesRecov ON for older models w/ non-zero IAQRecovEffect"   ResIAQFan:Action  =     ; SAC 2/5/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IAQFanType = 3 .AND. IAQRecovEffect > 0)
         then  EvalRulelist( "ForceOn_IAQFan_IncludesRecov", 1 )
         else  UNCHANGED  endif  }
   "force reset of ResIAQFan:IAQRecovEffect in 2019.2.0+ versions"   ResIAQFan:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. LocalStatus( IAQRecovEffect ) > 4)
         then  EvalRulelist( "ForceReset_IAQFan_IAQRecovEffect", 1 )
         else  UNCHANGED  endif  }


   ;--------------------------------------------------------------------
	; RE-default some Fan-related data that might now be different than above
   ;--------------------------------------------------------------------
; SAC 12/12/13 - removed as it is no longer applicable.  Type can no longer be = 10 or 20 ('Cooling Vent' or 'IAQ Vent', respctively)
;	"Set ResHVACSys:FloorAreaServed[1]"		ResHVACSys:FloorAreaServed[1]	= {	switch ( type )
;																				; SAC 1/11/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
;																				;			case 10 :	SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
;																			;				case 10 :	if (LocalCompAssigned( Fan ) == 0) then  SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
;																			;								else if (Fan:DefaultSystem  < 0.5) then  SumRevRef( ResZn:CoolVentSystem, ResZn:CondFloorArea )
;																			;								else	ResProj:CondFloorArea  endif endif
;																			; SAC 4/21/13 - revised default for whole house fan floor area served to be ALL CFA if fan data defaulted
;																							case 10 :	ResProj:CondFloorArea
;																							case 20 :	SumRevRef( ResZn:IAQVentSystem , ResZn:CondFloorArea )
;																							default :	SumRevRef( ResZn:HVACSystem,		ResZn:HVACNewCondFloorArea ) +
;																											SumRevRef( ResZn:AltHVACSystem,	ResZn:HVACAltCondFloorArea ) +
;																											SumRevRef( ResZn:exHVACSystem,		ResZn:HVACExCondFloorArea  )
;																						endswitch  }
;	"Set ResHVACSys:FloorAreaServed[2]"		ResHVACSys:FloorAreaServed[2]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[3]"		ResHVACSys:FloorAreaServed[3]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[4]"		ResHVACSys:FloorAreaServed[4]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[5]"		ResHVACSys:FloorAreaServed[5]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[6]"		ResHVACSys:FloorAreaServed[6]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[7]"		ResHVACSys:FloorAreaServed[7]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[8]"		ResHVACSys:FloorAreaServed[8]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[9]"		ResHVACSys:FloorAreaServed[9]		= {	FloorAreaServed[1]  }
;	"Set ResHVACSys:FloorAreaServed[10]"	ResHVACSys:FloorAreaServed[10]	= {	FloorAreaServed[1]  }

  ; SAC 1/15/13 - added new ResHVACSys:DfltWHFAreaServed to facilitate default WHF system assignment
	"Set ResHVACSys:DfltWHFAreaServed"	ResHVACSys:DfltWHFAreaServed = {	if (type == 10 .AND. LocalCompAssigned( Fan ) > 0.5)
																						then	if (Fan:DefaultSystem > 0.5) then  FloorAreaServed[1]
																								else  0  endif
																						else  0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: more Zone Rules (related to default assignment of whole house fan to appropriate zone)
   ;--------------------------------------------------------------------
; SAC 5/1/13 - moved up to be set prior to SFam ClVent defaulting rules
;	"Set ResZn:ClgBlwAtticArea"			ResZn:ClgBlwAtticArea		= {	SumChildren( CeilingBelowAttic:Area )  }
;	"Set ResZn:CondClgBlwAtticArea"	ResZn:CondClgBlwAtticArea ={	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
;	"Set ResZn:HasCondClgBlwAttic"		ResZn:HasCondClgBlwAttic	= {	if (CondClgBlwAtticArea > 0.1) then  1  else  0  endif  }
	"Set ResProj:DfltCoolVentZone"		ResProj:DfltCoolVentZone	= {	if (ComponentCount( HVACSys ) < 1) then  UNDEFINED
																						else  MaxAllComp( ResZn:CondClgBlwAtticArea )  endif  }

;	"Set ResProj:DfltCoolVentSys"			ResProj:DfltCoolVentSys		= {	if (ComponentCount( HVACSys ) < 1) then  UNDEFINED
;																						else  MaxAllComp( ResHVACSys:DfltWHFAreaServed )  endif  }

;	"Default assignment of Cool Vent system in conditioned Zone w/ maximal ClgBlwAtticArea"
;			ResProj:DfltCoolVentZone:CoolVentSystem	= {	if (LocalCompAssigned( DfltCoolVentSys ) > 0.5) then	DfltCoolVentSys
;																		else  UNDEFINED  endif  }

;	"Default ResHVACSys:AirNet_CoolVentZone"		ResHVACSys:AirNet_CoolVentZone	= {	if (Type != 10) then  UNDEFINED
;																											else  MaxRevRefComp( ResZn:CoolVentSystem, ResZn:CondClgBlwAtticArea )  endif  }
;	"Default ResHVACSys:AirNet_CoolVentZone #2"	ResHVACSys:AirNet_CoolVentZone	= {	if (Type != 10 .OR. LocalCompAssigned( AirNet_CoolVentZone )) then  UNCHANGED
;																											else  MaxAllComp( ResZn:CondClgBlwAtticArea )  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: ACH50 defaulting
   ;--------------------------------------------------------------------
; SAC 9/4/13 - replaced above property & rules w/ following to fix ACH50 defaulting bug (GC issue 169)
	"Set ResHVACSys:VLLCDuctAreaSrvd"		ResHVACSys:VLLCDuctAreaSrvd	= {	if (Type < 1 .OR. Type > 3) then  0
																						;		else if (Type == 2 .AND. IfValidAnd( HtPumpSysType == 10 )) then  0		; SAC 11/3/14 - set to 0 for DuctlessHeatPump (GC issue 405)
																								else if (LocalCompAssigned( DistribSystem ) == 0)   ; no ducts
																								then  FloorAreaServed[1]
																								else if (DistribSystem:Type == 12 .OR.		; "Verified low-leakage ducts entirely in conditioned space"
																											DistribSystem:Type == 8 )			; "Distribution systems without ducts"
																								then	FloorAreaServed[1]
																								else  0  endif endif endif  }

; SAC 11/18/14 - secondary rules to zero OUT ResHVACSys:VLLCDuctAreaSrvd for generic, non-ducted or PropEqStd equipment
	"Reset ResHVACSys:VLLCDuctAreaSrvd - HtCl"	ResHVACSys:VLLCDuctAreaSrvd	= {
		if (VLLCDuctAreaSrvd < 0.1 .OR. ((IfValidAnd( HeatDucted > 0.5 ) .OR. IfValidAnd( CoolDucted > 0.5 )) .AND.
        (IfValidAnd( DistribSystem:Type == 12 ) .OR. IfValidAnd( DistribSystem:Type == 8 )))) 
    then  UNCHANGED
    else if (Type != 2)
    then ; Is not a heat pump
      if ( IfValidAnd( HeatSysType > 0.5 ) )
      then ; Has heating
        if ( T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) < 0.5 .OR. 
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5 )
        then  0
        else UNCHANGED
        endif
      else if ( IfValidAnd( CoolSysType > 0.5 ) )
      then ; Has cooling
        if ( T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 0.5 .OR.
             T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0.5 )
        then 0
    	  else UNCHANGED
    	  endif
    	else 0 ; Has no heating or cooling
    	endif endif
    else if ( IfValidAnd( HtPumpSysType > 0.5 ) )
    then ; Has a HeatPump
      if ( T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .OR. 
           T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 0.5 )
      then  0
      else UNCHANGED
    	endif
    else 0
    endif endif endif }

	"Set ResHVACSys:UncondDuctAreaSrvd"		ResHVACSys:UncondDuctAreaSrvd	= {	if (VLLCDuctAreaSrvd > 0) then  0
																								else	FloorAreaServed[1]  endif  }


; SAC 9/9/13 - added rule to FORCE the defaulting of ACH50 (should it be defined in a model for which it should always be defaulted)
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on ResProj:IsMFamDupOrTownhm)
; revised to prevent re-default for ERM or BRL (research) - SAC 7/19/20 (MFamProto)
; removed logic preventing re-default for ERM or BRL (research) - SAC 03/05/21
; prevent reset for s, smf & dr runs - SAC 06/28/21 (tic #1274)
	"Force re-default of ResProj:ACH50 (iff necessary)"		ResProj:Action	=     ; added logic to prevent reset of ACH50 for 2022+ models where UseDefaultACH50 = 0 - SAC 07/06/21
      {  if ( LocalStatus( ACH50 ) > 5 .AND. ResProj:IsMultiFamily .AND. ResProj:IsMFamDupOrTownhm < 0.5 .AND.
              ResProj:RunAbbrev != "dr" .AND. ResProj:RunAbbrev != "s" .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf" .AND.
              (IfValidAnd( EnergyCodeYearNum	< 2022 ) .OR. IfValidAnd( UseDefaultACH50 = 0 )==0) )
         then  EvalRulelist( "ForceDefault_ResProj_ACH50", 1 )
         else  UNCHANGED  endif  }

   "Default ResProj:UseDefaultACH50"   ResProj:UseDefaultACH50 =        ; SAC 06/27/21 (tic #1274)
      {  if (LocalStatus( UseDefaultACH50 ) < 1)
         then  if (LocalStatus( ACH50 ) > 5)
               then  0
               else  1  endif
         else  UNCHANGED  endif  }
   "Force re-default of ResProj:ACH50 #2"    ResProj:Action	=           ; SAC 06/27/21 (tic #1274)
      {  if ( LocalStatus( ACH50 ) > 5 .AND. IfValidAnd( UseDefaultACH50 > 0 ) .AND.
              ResProj:RunAbbrev != "dr" .AND. ResProj:RunAbbrev != "s" .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf" )
         then  EvalRulelist( "ForceDefault_ResProj_ACH50", 1 )
         else  UNCHANGED  endif  }

; SAC 1/7/13 - moved ACH50 defaulting down here, BELOW system duct rules, so that presence of ducts in unconditioned space is known
; SAC 9/4/13 - revised logic to fix ACH50 defaulting bug (GC issue 169)
; mjb 1/30/15 - mods to lookup std ACH50 from T24RClimateZoneCodeBase
;	"Default ResProj:ACH50 - per ACM section 2.2.2.1"		ResProj:ACH50	= {	if (SumAll( ResHVACSys:VLLCDuctAreaSrvd ) > 1 .AND. SumAll( ResHVACSys:UncondDuctAreaSrvd ) < 1)
;																								then  if (ResProj:IsMultiFamily > 0.5) then	6.2  else  4.4  endif
;																								else  if (ResProj:IsMultiFamily > 0.5) then	7.0  else  5.0  endif endif  }
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on ResProj:IsMFamDupOrTownhm)
; SAC 5/3/16 - revisions to first set DefaultACH50 based on model details, then set analysis ACH50 based on the default (DefaultACH50) (tic #627)
	"Set ResProj:DefaultACH50 - per ACM section 2.2.2.1"		ResProj:DefaultACH50	= {
													if (Proj:CliZnNum < 1) then  7
                                       else if (SumAll( ResHVACSys:VLLCDuctAreaSrvd ) > 1 .AND. SumAll( ResHVACSys:UncondDuctAreaSrvd ) < 1)
													then  if (ResProj:IsMultiFamily > 0.5 .AND. ResProj:IsMFamDupOrTownhm < 0.5)
															then	(T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 0.8)
															else  (T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 0.6)  endif
													else  T24RClimateZoneCodeBase:ACH50( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
													endif endif  }
   "Default ExEDR ResProj:DefaultACH50"      ResProj:Action  = {
         if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( DefaultACH50 ) < 6)
         then  EvalRulelist( "ExEDRDefault_ResProj_DefaultACH50", 1 )
         else  UNCHANGED  endif  }     ; SAC 5/24/17
	"Default ResProj:ACH50 (based on DefaultACH50)"		ResProj:ACH50	= {	DefaultACH50  }

	"Default ResProj:CFM50"				ResProj:CFM50			=	{	ValidOr( ResProj:ACH50, 7 ) * ResProj:CondVolume / 60	}

; SAC 5/13/13 - moved down here from above (to access defaulted ResHtgSys:ConstHtgSetpt)
   ;--------------------------------------------------------------------
   ; ProposedInput: Thermostat Setpoint Rules
   ;--------------------------------------------------------------------
	"Default ResProj:SZHeat_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:SZHeat_DefaultTDaySch		= {	if (LocalStatus( SZHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 SZ Heat Hrly" )  endif  }
	"Default ResProj:LivHeat_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:LivHeat_DefaultTDaySch	= {	if (LocalStatus( LivHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Liv Heat Hrly" )  endif  }
	"Default ResProj:SlpHeat_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:SlpHeat_DefaultTDaySch	= {	if (LocalStatus( SlpHeat_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Slp Heat Hrly" )  endif  }
	"Default ResProj:SZCool_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:SZCool_DefaultTDaySch		= {	if (LocalStatus( SZCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 SZ Cool Hrly" )  endif  }
	"Default ResProj:LivCool_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:LivCool_DefaultTDaySch	= {	if (LocalStatus( LivCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Liv Cool Hrly" )  endif  }
	"Default ResProj:SlpCool_DefaultTDaySch based on library entry (if not already defined)"
			ResProj:SlpCool_DefaultTDaySch	= {	if (LocalStatus( SlpCool_DefaultTDaySch ) > 0) then  UNCHANGED
															else  RuleLibrary( SchDay, "CARes2013 Slp Cool Hrly" )  endif  }
; the following rules will need to be expanded beyond SZ schedules... mjb RESNET 030816
	"Reset ResProj:SZCool_DefaultTDaySch for Design Rating model"
			ResProj:SZCool_DefaultTDaySch		= {	if (ResProj:DRtgRefRunID == 2014) then RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset ResProj:SZHeat_DefaultTDaySch for Design Rating model"
			ResProj:SZHeat_DefaultTDaySch		= {	if (ResProj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }

  ; SAC 5/13/13 - enable constant heating t-stat schedules
; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Set constant heating t-stat temperature if defined for assigned heating system"
				ResZn:ConstHtgSetpt	= {	if (LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "ResHVACSys" ))
													then	ActiveHVACSystem:ConstHtgSetpt
													else  -1  endif  }
;													then	if (LocalCompAssigned( ActiveHVACSystem:HeatSystem ) > 0)
;															then	if (LocalStatus( ActiveHVACSystem:HeatSystem:ConstHtgSetpt ) > 0)
;																	then	ActiveHVACSystem:HeatSystem:ConstHtgSetpt
;																	else  -1  endif
;															else  -1  endif
;													else  -1  endif  }
	"Set constant heating t-stat temperature if defined for assigned heating system"    ; handle runs where ActiveHVACSystem not ResHVACSys - SAC 05/18/22
				ResOtherZn:ConstHtgSetpt	= {	if (LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "ResHVACSys" ))
													then	ValidOr( ActiveHVACSystem:ConstHtgSetpt, -1 )
													else  -1  endif  }

  ; SAC 8/2/13 - added to enable compliance reporting
	"Thermostat type (used for compliance reporting)"
		ResZn:ThermostatTypeRpt	= {	if (ConstHtgSetpt > 0)
												then  "Not Setback"
												else  "Setback"      endif  }

	"Default heating thermostat setpoint profile (ResZn:HeatTDaySched)"
				ResZn:HeatTDaySched	= {	if (ConstHtgSetpt > 0) then  UNDEFINED
													else  switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( ResProj:SZHeat_DefaultTDaySch ) > 0) then  Global( ResProj:SZHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											case 2:	;	living
													if (GlobalStatus( ResProj:LivHeat_DefaultTDaySch ) > 0) then  Global( ResProj:LivHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											case 3:	;	sleeping
													if (GlobalStatus( ResProj:SlpHeat_DefaultTDaySch ) > 0) then  Global( ResProj:SlpHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch  endif	}

	"Default cooling thermostat setpoint profile (ResZn:CoolTDaySched)"
				ResZn:CoolTDaySched	= {	switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( ResProj:SZCool_DefaultTDaySch ) > 0) then  Global( ResProj:SZCool_DefaultTDaySch )
													else  UNCHANGED  endif
											case 2:	;	living
													if (GlobalStatus( ResProj:LivCool_DefaultTDaySch ) > 0) then  Global( ResProj:LivCool_DefaultTDaySch )
													else  UNCHANGED  endif
											case 3:	;	sleeping
													if (GlobalStatus( ResProj:SlpCool_DefaultTDaySch ) > 0) then  Global( ResProj:SlpCool_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch	}

	"Thermostat type (used for compliance reporting)"       ; SAC 9/20/19 - OtherZone (MFamProto)
		ResOtherZn:ThermostatTypeRpt	= {	if (ConstHtgSetpt > 0)
												then  "Not Setback"
												else  "Setback"      endif  }
	"Default heating thermostat setpoint profile (ResOtherZn:HeatTDaySched)"
				ResOtherZn:HeatTDaySched	= {	if (ConstHtgSetpt > 0) then  UNDEFINED
													else  switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( ResProj:SZHeat_DefaultTDaySch ) > 0) then  Global( ResProj:SZHeat_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch  endif	}
	"Default cooling thermostat setpoint profile (ResOtherZn:CoolTDaySched)"
				ResOtherZn:CoolTDaySched	= {	switch (Local( Type ))
											case 1:	;	conditioned/single zone
													if (GlobalStatus( ResProj:SZCool_DefaultTDaySch ) > 0) then  Global( ResProj:SZCool_DefaultTDaySch )
													else  UNCHANGED  endif
											default: ; unconditioned
													UNCHANGED
										endswitch	}

; change setpoint schedules for design rating   mjb  RESNET 02/12/16
	"Reset ResZn:CoolTDaySched for Design Rating model"
			ResZn:CoolTDaySched	= {	if (ResProj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset ResZn:HeatTDaySched for Design Rating model"
			ResZn:HeatTDaySched	= {	if (ResProj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }
	"Reset ResOtherZn:CoolTDaySched for Design Rating model"       ; SAC 9/20/19 - OtherZone (MFamProto)
			ResOtherZn:CoolTDaySched	= {	if (ResProj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Cool Hrly" )
															else  UNCHANGED   endif  }
	"Reset ResOtherZn:HeatTDaySched for Design Rating model"       ; SAC 9/20/19 - OtherZone (MFamProto)
			ResOtherZn:HeatTDaySched	= {	if (ResProj:DRtgRefRunID == 2014) then  RuleLibrary( SchDay, "RESNET SZ Heat Hrly" )
															else  UNCHANGED   endif  }

	"Default ResProj:DefaultWinterVentTemp"     ResProj:DefaultWinterVentTemp	= {	77  }
	"Default ResProj:DefaultWinterCoolTemp"     ResProj:DefaultWinterCoolTemp	= {	78  }
	"Default ResProj:DefaultSummerVentTemp"     ResProj:DefaultSummerVentTemp	= {	68  }
	"Default ResProj:DefaultSummerHeatTemp"     ResProj:DefaultSummerHeatTemp	= {	60  }

	"Set ResZn:WinterVentTemp"				ResZn:WinterVentTemp			= {	Global(ResProj:DefaultWinterVentTemp)  }
	"Set ResZn:WinterCoolTemp"				ResZn:WinterCoolTemp			= {	Global(ResProj:DefaultWinterCoolTemp)  }
	"Set ResZn:SummerVentTemp"				ResZn:SummerVentTemp			= {	Global(ResProj:DefaultSummerVentTemp)  }
	"Set ResZn:SummerHeatTemp"				ResZn:SummerHeatTemp			= {	Global(ResProj:DefaultSummerHeatTemp)  }

	"Set ResOtherZn:WinterVentTemp"		ResOtherZn:WinterVentTemp	= {	Global(ResProj:DefaultWinterVentTemp)  }       ; SAC 9/20/19 - OtherZone (MFamProto)
	"Set ResOtherZn:WinterCoolTemp"		ResOtherZn:WinterCoolTemp	= {	Global(ResProj:DefaultWinterCoolTemp)  }
	"Set ResOtherZn:SummerVentTemp"		ResOtherZn:SummerVentTemp	= {	Global(ResProj:DefaultSummerVentTemp)  }
	"Set ResOtherZn:SummerHeatTemp"		ResOtherZn:SummerHeatTemp	= {	Global(ResProj:DefaultSummerHeatTemp)  }

	; new CSE thermostat setpoint include file mechanism - SAC 7/2/15
	; ResZn:TstatIncludeFile    Prescribed    BEMP_Str   "CSE Include file to be used in place of individual thermostat setpoints" 
	"Set ResZn:UseTstatIncFile - flag indicating CSE Include file to be used in place of thermostat setpoints/expressions" 
			ResZn:UseTstatIncFile		= {	if (ResProj:BypassRuleLimits > 0.5 .AND. LocalStatus( TstatIncludeFile ) > 0)
													then	if (strlen( TstatIncludeFile ) > 0)
															then  1
															else  0  endif
													else  0  endif  }
	"Set ResOtherZn:UseTstatIncFile - flag indicating CSE Include file to be used in place of thermostat setpoints/expressions" 
			ResOtherZn:UseTstatIncFile	= {	if (ResProj:BypassRuleLimits > 0.5 .AND. LocalStatus( TstatIncludeFile ) > 0)
														then	if (strlen( TstatIncludeFile ) > 0)
																then  1
																else  0  endif
														else  0  endif  }

   ;--------------------------------------------------------------------  ; SAC 03/30/22
   ; ProposedInput: UMLH Rules (unmet load hours)
   ;--------------------------------------------------------------------
   "Set ResZn:TrackUMLHs - Conditioned only"     ResZn:TrackUMLHs =
      {  if (IfValidAnd( ActiveHVACSystem:Type > 0 ) .AND.
             IfValidAnd( Type < 10 ))
         then  1  else  0  endif  }
   "Set ResZn:ClgUMLHLimit"       ResZn:ClgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }   ; using same 0.1 factor as used in check done on NRes models - SAC 03/30/22
   "Set ResZn:HtgUMLHLimit"       ResZn:HtgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }

   "Set ResOtherZn:TrackUMLHs - Conditioned only"     ResOtherZn:TrackUMLHs =
      {  if (LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "ResHVACSys" ) .AND.
             IfValidAnd( ActiveHVACSystem:Type > 0 ) .AND.
             IfValidAnd( Type < 10 ))
         then  1  else  0  endif  }
   "Set ResOtherZn:ClgUMLHLimit"       ResOtherZn:ClgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }   ; using same 0.1 factor as used in check done on NRes models - SAC 03/30/22
   "Set ResOtherZn:HtgUMLHLimit"       ResOtherZn:HtgUMLHLimit = {  if (TrackUMLHs > 0) then  150.1  else  UNDEFINED  endif  }

END
;*************************************************************************


;************************************************************************* SAC 7/21/20 (tic #1174)
RULELIST "Default_HVAC_IAQFan" 0 0 0 0
;*************************************************************************
; moved primary IAQFan defaulting rules from inside Default_AllHVAC into this rulelist to fix evaluation order issue - SAC 7/21/20 (tic #1174)

;   "Set ResIAQFan:MinIAQCFM"				ResIAQFan:MinIAQCFM      = {  (0.01 * Local( FloorAreaServed )) + (7.5 * (Max(Global( ResProj:NumBedrooms ),1) + 1))  }							    ; added Max function in case NumBedrooms < 1 ...MJB 4/22/13
   "Default ResIAQFan:IAQCFM"				ResIAQFan:IAQCFM         = {  UNDEFINED  }		; Local( MinIAQCFM )  }
   ; removed ResIAQFan:WperCFMIAQ default for 2019.2.0+ versions - SAC 7/20/20 (tic #1174)
   "Default ResIAQFan:WperCFMIAQ"		ResIAQFan:WperCFMIAQ     =       ; SAC 2/12/20 - installed new std design ResIAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam as new defaults (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  UNDEFINED
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif  }
   "Default ResIAQFan:IAQFanType"		ResIAQFan:IAQFanType     = {  1  }    ; "Exhaust"
   "Default ResIAQFan:IAQRecovEffect"	ResIAQFan:IAQRecovEffect = {  0  }    ; No Heat Recovery ...MJB 4/22/13	

   "Prevent SensRecovEff & AdjSensRecovEff user inputs if not ResearchMode (for versions before 2019.2.0)"  ResIAQFan:Action =         ; SAC 10/21/19
      {  if (IfValidAnd( Proj:EnableResearchMode > 0 ) .OR. IfValidAnd( Proj:AnalysisVersion >= 190200 )) then  UNCHANGED
         else if (LocalStatus( SensRecovEff ) > 4 .OR. LocalStatus( AdjSensRecovEff ) > 4)
         then  EvalRulelist( "ForceReset_IAQFan_SensRecovEff", 1 )
         else  UNCHANGED  endif endif  }

   "default ResIAQFan:IncludesRecov to 0"    ResIAQFan:IncludesRecov  = {  0  }     ; SAC 2/5/20 (tic #1174)
   ; no defaults for new HRV/ERV inputs:
   ;     ResIAQFan:SensRecovEff
   ;     ResIAQFan:AdjSensRecovEff

   "default ResIAQFan:SetPerfByHVIInterp to 0"    ResIAQFan:SetPerfByHVIInterp  = {  0  }     ; SAC 2/7/20 (tic #1174)

   "Set SensRecovEff & AdjSensRecovEff based on HVI listing interpolation"    ResIAQFan:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IncludesRecov == 0 .OR.
             SetPerfByHVIInterp == 0) then  UNCHANGED
         else if (IfValidAnd( HVIListedInterpCFM[1] > 0 ) .AND. IfValidAnd( HVIListedInterpSRE[1] > 0 ) .AND. IfValidAnd( HVIListedInterpASRE[1] > 0 ) .AND.
                  IfValidAnd( HVIListedInterpCFM[2] > 0 ) .AND. IfValidAnd( HVIListedInterpSRE[2] > 0 ) .AND. IfValidAnd( HVIListedInterpASRE[2] > 0 ) .AND.
                  IfValidAnd( HVIListedInterpCFM[1] <= IAQCFM ) .AND. IfValidAnd( HVIListedInterpCFM[2] >= IAQCFM ) .AND.
                  IfValidAnd( HVIListedInterpCFM[2] > HVIListedInterpCFM[1] ))
         then  EvalRulelist( "Interpolate_IAQFan_SRE_ASRE", 1 )
         else  EvalRulelist( "ForceReset_IAQFan_SensRecovEff", 1 )  endif endif  }

   "Default ResIAQFan:HERSVerified - whether IAQ fan is HERS verified"     ResIAQFan:HERSVerified =      ; SAC 7/20/20 (tic #1174)
      {  0  }     ; eventually this may become a user input
   ; revised to restrict IAQ HERS multipliers to Proposed model(s) - SAC 7/21/20 (tic #1174)
   ; removed limit to MFam fans, added separate mults by y/n HtRecov and revised multipliers - SAC 01/20/21 (tic #1243)
   ; added logic to retain settings for 's' & 'smf' runs when NOT ResProj:IAQSupInletsAccessible - SAC 01/26/21 (tic #1243)
   ; modified logic to keep std design Exhaust power mult @ 1 when IAQSupInletsAccessible < 1 - SAC 03/18/21 (tic #1243)
   ; changed logic on 115% derating from exclusively IncludesRecov to include all supply & balanced fans - SAC 03/18/21 (tic #1243)
   ; added logic to prevent reset of FanPowerMult when HardwireStdFanPower flag set - SAC 03/18/21 (tic #1243)
   ; revised adjustment to NOT degrade when FID present - SAC 08/22/21 (tic #1243)
   "Set ResIAQFan:FanPowerMult"        ResIAQFan:FanPowerMult =         ; postponed HERS derating until 2023 (placeholder) - SAC 08/23/21 (tic #1243)  ; postponed further to 2026 (placeholder) - SAC 10/24/21
      {  if (IfValidAnd( HardwireStdFanPower > 0 )) then  1
         else if ( IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. ResProj:RunAbbrev != "dr" .AND.
                   ( (ResProj:RunAbbrev != "s" .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf") .OR.
                     (ResProj:IAQSupInletsAccessible < 1 .AND. IAQFanType > 1) ) )
         then  if (IAQFanType > 1 .AND. IfValidAnd( ResProj:IAQHasFID > 0 )==0)  ; not Exhaust & not FID
               then  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 260000 ))
                     then  1.15
                     else  1.10  endif
               else  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 260000 ))
                     then  1.05
                     else  1     endif endif
         else  1  endif endif  }
   ; removed limit to MFam fans, added separate mults by y/n HtRecov and revised multipliers - SAC 01/20/21 (tic #1243)
   ; added logic to retain settings for 's' & 'smf' runs when NOT ResProj:IAQSupInletsAccessible - SAC 01/26/21 (tic #1243)
   ; revised adjustment to NOT degrade when FID present - SAC 08/22/21 (tic #1243)
   "Set ResIAQFan:FanHeatRecovMult"    ResIAQFan:FanHeatRecovMult =     ; postponed HERS derating until 2023 (placeholder) - SAC 08/23/21 (tic #1243)  ; postponed further to 2026 (placeholder) - SAC 10/24/21
      {  if ( IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IfValidAnd( IncludesRecov > 0 ) .AND. ResProj:RunAbbrev != "dr" .AND.
              ((ResProj:RunAbbrev != "s" .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf") .OR. ResProj:IAQSupInletsAccessible < 1) )
         then  if (IfValidAnd( ResProj:IAQHasFID > 0 ))
               then  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 260000 ))
                     then  0.95
                     else  1     endif
               else  if (HERSVerified == 0 .AND. IfValidAnd( Proj:AnalysisVersion >= 260000 ))
                     then  0.85
                     else  0.9   endif
               endif
         else  1  endif  }

   ; SAC 2/7/20 (tic #1174)      ; added check for WperCFMIAQ > 0 - SAC 7/21/20 (tic #1174)
   "Set ResIAQFan:IAQErrID"      ResIAQFan:IAQErrID  =            ; prevent HVI look-up error checks when IAQFanType != 3 - SAC 7/24/20 (tic #1174)
      {  if (IfValidAnd( IAQCFM > 0 )==0) then  1
         else if (IfValidAnd( WperCFMIAQ > 0 )==0) then  5
         else if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND.
                  IAQFanType == 3 .AND. IncludesRecov)
         then  if (SetPerfByHVIInterp .AND.
                   (IfValidAnd( HVIListedInterpCFM[1] > 0 )==0 .OR. IfValidAnd( HVIListedInterpSRE[1] > 0 )==0 .OR. IfValidAnd( HVIListedInterpASRE[1] > 0 )==0 .OR.
                    IfValidAnd( HVIListedInterpCFM[2] > 0 )==0 .OR. IfValidAnd( HVIListedInterpSRE[2] > 0 )==0 .OR. IfValidAnd( HVIListedInterpASRE[2] > 0 )==0))
               then  2
               else if (SetPerfByHVIInterp .AND.
                        (IfValidAnd( HVIListedInterpCFM[1] <= IAQCFM )==0 .OR. IfValidAnd( HVIListedInterpCFM[2] >= IAQCFM )==0 .OR.
                         IfValidAnd( HVIListedInterpCFM[2] > HVIListedInterpCFM[1] )==0))
               then  3
               else if (SetPerfByHVIInterp == 0 .AND. 
                        (IfValidAnd( SensRecovEff > 0 )==0 .OR. IfValidAnd( AdjSensRecovEff > 0 )==0))
               then  4
               else  0  endif endif endif
         else  0  endif endif endif  }
   "Set ResIAQFan:IAQErrMsg"     ResIAQFan:IAQErrMsg  =
      {  switch (IAQErrID)
            case  1 :  "Fan CFM must be specified."
            case  2 :  Format( "CFM, SRE and ASRE for HVI-listed fans that bound design %s CFM required below.", FltToStr( IAQCFM, 11 ) )
            case  3 :  Format( "HVI-listed fan CFMs invalid:  low %s <= design %s <= high %s required below.", FltToStr( HVIListedInterpCFM[1], 11 ), FltToStr( IAQCFM, 11 ), FltToStr( HVIListedInterpCFM[2], 11 ) )
            case  4 :  "Fan SRE and ASRE are required inputs when modeling heat recovery."
            case  5 :  "Fan Power (W/CFM) must be specified."
            default :  UNDEFINED
         endswitch  }

   "Set ResIAQFan:IAQFanTypeStr"    ResIAQFan:IAQFanTypeStr  = {  EnumString( IAQFanType )  }     ; SAC 8/13/13
   "Set ResIAQFan:TreeDescrip"      ResIAQFan:TreeDescrip    =
      {  switch (IAQErrID)
            case  1 :   IAQFanTypeStr + ", missing fan CFM"
            case  2 :   IAQFanTypeStr + ", missing HVI-listed fan interpolation data"
            case  3 :   IAQFanTypeStr + ", invalid HVI-listed fan interpolation data"
            case  4 :   IAQFanTypeStr + ", missing SRE and/or ASRE inputs"
            case  5 :   IAQFanTypeStr + ", missing fan power"
            default :   if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
                        then  if (IAQFanType == 3 .AND. IncludesRecov)
                              then  Format( "%s, %g CFM, HRV SRE %g%%, ASRE %g%", IAQFanTypeStr, IAQCFM, SensRecovEff, AdjSensRecovEff )
                              else  Format( "%s, %g CFM", IAQFanTypeStr, IAQCFM )  endif
                        else  if (IAQFanType == 3 .AND. IAQRecovEffect > 0)
                              then  Format( "%s, %g CFM, HRV RecovEff %g%", IAQFanTypeStr, IAQCFM, IAQRecovEffect )
                              else  Format( "%s, %g CFM", IAQFanTypeStr, IAQCFM )  endif endif
         endswitch  }
END
;*************************************************************************


; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_HeatCool" 0 0 0 0
;*************************************************************************
  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatSystemTypes
	"Force reset of ResHVACSys:HeatSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 1 ) .OR. (LocalStatus( HeatSystemCount[1] ) < 6 .AND. LocalStatus( HeatSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_1", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[2]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 2 ) .OR. (LocalStatus( HeatSystemCount[2] ) < 6 .AND. LocalStatus( HeatSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_2", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[3]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 3 ) .OR. (LocalStatus( HeatSystemCount[3] ) < 6 .AND. LocalStatus( HeatSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_3", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[4]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 4 ) .OR. (LocalStatus( HeatSystemCount[4] ) < 6 .AND. LocalStatus( HeatSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_4", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[5]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 5 ) .OR. (LocalStatus( HeatSystemCount[5] ) < 6 .AND. LocalStatus( HeatSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_5", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[6]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 6 ) .OR. (LocalStatus( HeatSystemCount[6] ) < 6 .AND. LocalStatus( HeatSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_6", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[7]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 7 ) .OR. (LocalStatus( HeatSystemCount[7] ) < 6 .AND. LocalStatus( HeatSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_7", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[8]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 8 ) .OR. (LocalStatus( HeatSystemCount[8] ) < 6 .AND. LocalStatus( HeatSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_8", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[9]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 9 ) .OR. (LocalStatus( HeatSystemCount[9] ) < 6 .AND. LocalStatus( HeatSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_9", 1 )  endif  }
	"Force reset of ResHVACSys:HeatSystem*[10]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 10 ) .OR. (LocalStatus( HeatSystemCount[10] ) < 6 .AND. LocalStatus( HeatSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HeatSystem_10", 1 )  endif  }

	"Default ResHVACSys:HeatSystemCount[1]"	ResHVACSys:HeatSystemCount[1]		= {	if (NumHeatSystemTypes > 0) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[2]"	ResHVACSys:HeatSystemCount[2]		= {	if (NumHeatSystemTypes > 1) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[3]"	ResHVACSys:HeatSystemCount[3]		= {	if (NumHeatSystemTypes > 2) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[4]"	ResHVACSys:HeatSystemCount[4]		= {	if (NumHeatSystemTypes > 3) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[5]"	ResHVACSys:HeatSystemCount[5]		= {	if (NumHeatSystemTypes > 4) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[6]"	ResHVACSys:HeatSystemCount[6]		= {	if (NumHeatSystemTypes > 5) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[7]"	ResHVACSys:HeatSystemCount[7]		= {	if (NumHeatSystemTypes > 6) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[8]"	ResHVACSys:HeatSystemCount[8]		= {	if (NumHeatSystemTypes > 7) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[9]"	ResHVACSys:HeatSystemCount[9]		= {	if (NumHeatSystemTypes > 8) then  1  else  0  endif  }
	"Default ResHVACSys:HeatSystemCount[10]"	ResHVACSys:HeatSystemCount[10]	= {	if (NumHeatSystemTypes > 9) then  1  else  0  endif  }
;	ResHVACSys:HeatSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set ResHVACSys:NumHeatSysUnits - 1"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  )) then                    HeatSystemCount[1]   else      0      endif  }
	"Set ResHVACSys:NumHeatSysUnits - 2"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  )) then  NumHeatSysUnits + HeatSystemCount[2]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 3"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  )) then  NumHeatSysUnits + HeatSystemCount[3]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 4"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  )) then  NumHeatSysUnits + HeatSystemCount[4]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 5"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  )) then  NumHeatSysUnits + HeatSystemCount[5]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 6"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  )) then  NumHeatSysUnits + HeatSystemCount[6]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 7"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  )) then  NumHeatSysUnits + HeatSystemCount[7]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 8"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  )) then  NumHeatSysUnits + HeatSystemCount[8]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 9"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  )) then  NumHeatSysUnits + HeatSystemCount[9]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHeatSysUnits - 10"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] )) then  NumHeatSysUnits + HeatSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure HeatSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
   "Set ResHVACSys:HeatSysType"     ResHVACSys:HeatSysType  = {
         if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
					then  StdHeatingType
					else  HeatSystem[1]:Type  endif
         else  0  endif  }

   ; SAC 7/3/20 - added PkgGasFurnace (18) to HeatSysTypes that are considered 'Gas Furnace' (tic #1227)
   "Set ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      ResHVACSys:GasFurnAreaServed  = {
         if (HeatSysType == 1 .OR. HeatSysType == 18) then  FloorAreaServed[1]    ; CntrlFurnace or PkgGasFurnace
         else  0  endif  }

   "Set ResHVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      ResHVACSys:SDHVAreaServed  = {
         if (CoolSysType == 18) then  FloorAreaServed[1]    ; "SDHVSplitAirCond or SDHVSplitHeatPump"
         else  0  endif  }

	"Blast Heat* user input if HeatSysType has changed"	ResHVACSys:Action	= {	if (LocalStatus( HeatSysTypeSetup ) < 1 .OR. LocalStatus( PrevHeatSysType ) < 1) then  UNCHANGED
																										else if (HeatSysTypeSetup < 0.5) then  UNCHANGED
																										else if (HeatSysType != PrevHeatSysType)
																										then	EvalRulelist( "BlastHVACSysUserInput_Heating", 1 )
																										else	UNCHANGED  endif endif endif  }
	"Set ResHVACSys:PrevHeatSysType"		ResHVACSys:PrevHeatSysType		= {	HeatSysType  }
	"Set ResHVACSys:HeatSysTypeSetup"	ResHVACSys:HeatSysTypeSetup	= {	if (HeatSysType > 0) then  1  else  0  endif  }

  ; SAC 1/10/13 - revised to prevent setting AUTOSIZE for rsCapH when system is of type ASHP
	"Default ResHVACSys:AutoSizeHeatInp"		ResHVACSys:AutoSizeHeatInp	= {	1  }

	; need to set this such that we error on the HIGH side, so that referenced objects that are not used due to lack of floor area or incompatible system types don't cause assigned HVACHeat obejcts to get set to 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	if (AutoSizeHeatInp == 0 .AND. FloorAreaServed[1] > 0.5 .AND. NumHeatSystemTypes > 0) then  0  else  1  endif  }

	"Set ResHVACSys:HasCentralFurnace"	ResHVACSys:HasCentralFurnace	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
																							then  if (HeatSystem[1]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2] ))
																							then  if (HeatSystem[2]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3] ))
																							then  if (HeatSystem[3]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4] ))
																							then  if (HeatSystem[4]:Type == 1) then  1  else  0  endif
																							else if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5] ))
																							then  if (HeatSystem[5]:Type == 1) then  1  else  0  endif
																							else	0  endif endif endif endif endif  }


  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumCoolSystemTypes
	"Force reset of ResHVACSys:CoolSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 1 ) .OR. (LocalStatus( CoolSystemCount[1] ) < 6 .AND. LocalStatus( CoolSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_1", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[2]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 2 ) .OR. (LocalStatus( CoolSystemCount[2] ) < 6 .AND. LocalStatus( CoolSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_2", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[3]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 3 ) .OR. (LocalStatus( CoolSystemCount[3] ) < 6 .AND. LocalStatus( CoolSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_3", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[4]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 4 ) .OR. (LocalStatus( CoolSystemCount[4] ) < 6 .AND. LocalStatus( CoolSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_4", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[5]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 5 ) .OR. (LocalStatus( CoolSystemCount[5] ) < 6 .AND. LocalStatus( CoolSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_5", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[6]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 6 ) .OR. (LocalStatus( CoolSystemCount[6] ) < 6 .AND. LocalStatus( CoolSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_6", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[7]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 7 ) .OR. (LocalStatus( CoolSystemCount[7] ) < 6 .AND. LocalStatus( CoolSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_7", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[8]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 8 ) .OR. (LocalStatus( CoolSystemCount[8] ) < 6 .AND. LocalStatus( CoolSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_8", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[9]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 9 ) .OR. (LocalStatus( CoolSystemCount[9] ) < 6 .AND. LocalStatus( CoolSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_9", 1 )  endif  }
	"Force reset of ResHVACSys:CoolSystem*[10]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 10 ) .OR. (LocalStatus( CoolSystemCount[10] ) < 6 .AND. LocalStatus( CoolSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_CoolSystem_10", 1 )  endif  }

	"Default ResHVACSys:CoolSystemCount[1]"	ResHVACSys:CoolSystemCount[1]		= {	if (NumCoolSystemTypes > 0) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[2]"	ResHVACSys:CoolSystemCount[2]		= {	if (NumCoolSystemTypes > 1) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[3]"	ResHVACSys:CoolSystemCount[3]		= {	if (NumCoolSystemTypes > 2) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[4]"	ResHVACSys:CoolSystemCount[4]		= {	if (NumCoolSystemTypes > 3) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[5]"	ResHVACSys:CoolSystemCount[5]		= {	if (NumCoolSystemTypes > 4) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[6]"	ResHVACSys:CoolSystemCount[6]		= {	if (NumCoolSystemTypes > 5) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[7]"	ResHVACSys:CoolSystemCount[7]		= {	if (NumCoolSystemTypes > 6) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[8]"	ResHVACSys:CoolSystemCount[8]		= {	if (NumCoolSystemTypes > 7) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[9]"	ResHVACSys:CoolSystemCount[9]		= {	if (NumCoolSystemTypes > 8) then  1  else  0  endif  }
	"Default ResHVACSys:CoolSystemCount[10]"	ResHVACSys:CoolSystemCount[10]	= {	if (NumCoolSystemTypes > 9) then  1  else  0  endif  }
;	ResHVACSys:CoolSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set ResHVACSys:NumCoolSysUnits - 1"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  )) then                    CoolSystemCount[1]   else      0      endif  }
	"Set ResHVACSys:NumCoolSysUnits - 2"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  )) then  NumCoolSysUnits + CoolSystemCount[2]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 3"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  )) then  NumCoolSysUnits + CoolSystemCount[3]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 4"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  )) then  NumCoolSysUnits + CoolSystemCount[4]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 5"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  )) then  NumCoolSysUnits + CoolSystemCount[5]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 6"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  )) then  NumCoolSysUnits + CoolSystemCount[6]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 7"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  )) then  NumCoolSysUnits + CoolSystemCount[7]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 8"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  )) then  NumCoolSysUnits + CoolSystemCount[8]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 9"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  )) then  NumCoolSysUnits + CoolSystemCount[9]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumCoolSysUnits - 10"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] )) then  NumCoolSysUnits + CoolSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure CoolSysType consistent w/ StdCoolingType for S, SMF & DR runs (tic #1225 & #1226)
	"Set ResHVACSys:CoolSysType"			ResHVACSys:CoolSysType			= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))
																							then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
																							      then  StdCoolingType
																							      else  CoolSystem[1]:Type  endif
																							else  0  endif  }

	"Blast Cool* user input if CoolSysType has changed"	ResHVACSys:Action	= {	if (LocalStatus( CoolSysTypeSetup ) < 1 .OR. LocalStatus( PrevCoolSysType ) < 1) then  UNCHANGED
																										else if (CoolSysTypeSetup < 0.5) then  UNCHANGED
																										else if (CoolSysType != PrevCoolSysType)
																										then	EvalRulelist( "BlastHVACSysUserInput_Cooling", 1 )
																										else	UNCHANGED  endif endif endif  }
	"Set ResHVACSys:PrevCoolSysType"		ResHVACSys:PrevCoolSysType		= {	CoolSysType  }
	"Set ResHVACSys:CoolSysTypeSetup"	ResHVACSys:CoolSysTypeSetup	= {	if (CoolSysType > 0) then  1  else  0  endif  }

  ; SAC 1/10/13 - revised to prevent setting AUTOSIZE for rsCapH when system is of type ASHP
	"Default ResHVACSys:AutoSizeCoolInp"		ResHVACSys:AutoSizeCoolInp	= {	1  }

	; need to set this such that we error on the HIGH side, so that referenced objects that are not used due to lack of floor area or incompatible system types don't cause assigned HVACCool obejcts to get set to 0
	"Set ResHVACSys:AutoSizeCool[1]"		ResHVACSys:AutoSizeCool[1]		= {	if (AutoSizeCoolInp == 0 .AND. FloorAreaServed[1] > 0.5 .AND. NumCoolSystemTypes > 0) then  0  else  1  endif  }

	"Init ResHVACSys:NumHtPumpSysUnits"			ResHVACSys:NumHtPumpSysUnits		= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since ResHVACSys:MaxNumHVACEquipTypes now dependent on ResHVACSys:HtOrClDucted which is not set until that point
;	"Set ResHVACSys:MaxNumHVACEquipTypes"		ResHVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (Proj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified)))
;																										then  max( NumHeatSysUnits, NumCoolSysUnits )  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END


; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_HeatPump" 0 0 0 0
;*************************************************************************
  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpSystemTypes
	"Force reset of ResHVACSys:HtPumpSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 1 ) .OR. (LocalStatus( HtPumpSystemCount[1] ) < 6 .AND. LocalStatus( HtPumpSystem[1] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_1", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[2]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 2 ) .OR. (LocalStatus( HtPumpSystemCount[2] ) < 6 .AND. LocalStatus( HtPumpSystem[2] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_2", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[3]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 3 ) .OR. (LocalStatus( HtPumpSystemCount[3] ) < 6 .AND. LocalStatus( HtPumpSystem[3] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_3", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[4]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 4 ) .OR. (LocalStatus( HtPumpSystemCount[4] ) < 6 .AND. LocalStatus( HtPumpSystem[4] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_4", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[5]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 5 ) .OR. (LocalStatus( HtPumpSystemCount[5] ) < 6 .AND. LocalStatus( HtPumpSystem[5] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_5", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[6]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 6 ) .OR. (LocalStatus( HtPumpSystemCount[6] ) < 6 .AND. LocalStatus( HtPumpSystem[6] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_6", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[7]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 7 ) .OR. (LocalStatus( HtPumpSystemCount[7] ) < 6 .AND. LocalStatus( HtPumpSystem[7] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_7", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[8]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 8 ) .OR. (LocalStatus( HtPumpSystemCount[8] ) < 6 .AND. LocalStatus( HtPumpSystem[8] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_8", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[9]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 9 ) .OR. (LocalStatus( HtPumpSystemCount[9] ) < 6 .AND. LocalStatus( HtPumpSystem[9] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_9", 1 )  endif  }
	"Force reset of ResHVACSys:HtPumpSystem*[10]"	ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 10 ) .OR. (LocalStatus( HtPumpSystemCount[10] ) < 6 .AND. LocalStatus( HtPumpSystem[10] ) < 6)) then  UNCHANGED
																								else	EvalRulelist( "ForceReset_HtPumpSystem_10", 1 )  endif  }

	"Default ResHVACSys:HtPumpSystemCount[1]"		ResHVACSys:HtPumpSystemCount[1]		= {	if (NumHtPumpSystemTypes > 0) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[2]"		ResHVACSys:HtPumpSystemCount[2]		= {	if (NumHtPumpSystemTypes > 1) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[3]"		ResHVACSys:HtPumpSystemCount[3]		= {	if (NumHtPumpSystemTypes > 2) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[4]"		ResHVACSys:HtPumpSystemCount[4]		= {	if (NumHtPumpSystemTypes > 3) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[5]"		ResHVACSys:HtPumpSystemCount[5]		= {	if (NumHtPumpSystemTypes > 4) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[6]"		ResHVACSys:HtPumpSystemCount[6]		= {	if (NumHtPumpSystemTypes > 5) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[7]"		ResHVACSys:HtPumpSystemCount[7]		= {	if (NumHtPumpSystemTypes > 6) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[8]"		ResHVACSys:HtPumpSystemCount[8]		= {	if (NumHtPumpSystemTypes > 7) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[9]"		ResHVACSys:HtPumpSystemCount[9]		= {	if (NumHtPumpSystemTypes > 8) then  1  else  0  endif  }
	"Default ResHVACSys:HtPumpSystemCount[10]"	ResHVACSys:HtPumpSystemCount[10]		= {	if (NumHtPumpSystemTypes > 9) then  1  else  0  endif  }
;	ResHVACSys:HtPumpSystem[ALL],          Default,   0,    1,   1,    1,  1,  1

	"Set ResHVACSys:NumHtPumpSysUnits - 1"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  )) then                      HtPumpSystemCount[1]   else      0      endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 2"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[2]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 3"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[3]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 4"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[4]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 5"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[5]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 6"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[6]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 7"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[7]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 8"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[8]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 9"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[9]   else  UNCHANGED  endif  }
	"Set ResHVACSys:NumHtPumpSysUnits - 10"	ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] )) then  NumHtPumpSysUnits + HtPumpSystemCount[10]  else  UNCHANGED  endif  }

   ; SAC 6/24/20 - added logic to ensure HtPumpSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
   ; revised logic to ensure HtPumpSysType NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
	"Set ResHVACSys:HtPumpSysType"			ResHVACSys:HtPumpSysType			= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
																									then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
                                                                                 then  HtPumpSystem[1]:Type
                                                                                 else if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
																							            then  StdHeatingType
																							            else  HtPumpSystem[1]:Type  endif endif
																									else  0  endif  }

   "Set ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      ResHVACSys:GasFurnAreaServed  = {  0  }

   "Set ResHVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      ResHVACSys:SDHVAreaServed  = {
         if (HtPumpSysType == 19) then  FloorAreaServed[1]    ; "SDHVSplitAirCond or SDHVSplitHeatPump"
         else  0  endif  }

	"Blast HtPump* user input if HtPumpSysType has changed"	ResHVACSys:Action	= {	if (LocalStatus( HtPumpSysTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpSysType ) < 1) then  UNCHANGED
																											else if (HtPumpSysTypeSetup < 0.5) then  UNCHANGED
																											else if (HtPumpSysType != PrevHtPumpSysType)
																											then	EvalRulelist( "BlastHVACSysUserInput_HeatPump", 1 )
																											else	UNCHANGED  endif endif endif  }
	"Set ResHVACSys:PrevHtPumpSysType"		ResHVACSys:PrevHtPumpSysType		= {	HtPumpSysType  }
	"Set ResHVACSys:HtPumpSysTypeSetup"		ResHVACSys:HtPumpSysTypeSetup		= {	if (HtPumpSysType > 0) then  1  else  0  endif  }

; SAC 9/29/13 - added logic to cause standard design HPs to auto-size their heat caps
; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
   ; added logic to prevent setting ResHVACSys:AutoSizeHeatInp to 1 for Existing Std design systems - SAC 07/13/23
	"Default ResHVACSys:AutoSizeHeatInp"	ResHVACSys:AutoSizeHeatInp			=
      {  if (GlobalStatus( ResProj:RunAbbrev ) < 1) then  0
         else if (Status > 1 .AND. (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR.
                                    ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")) then  1  else  0  endif endif  }
	"Set ResHVACSys:AutoSizeHeat[1]"			ResHVACSys:AutoSizeHeat[1]			= {	0  }   ; never cause AUTOSIZE to get set for heating portion of HP in CSE
	"Default ResHVACSys:AutoSizeCoolInp"	ResHVACSys:AutoSizeCoolInp			= {	1  }
	"Set ResHVACSys:AutoSizeCool[1]"			ResHVACSys:AutoSizeCool[1]			= {	1  }

	"Init ResHVACSys:NumHeatSysUnits"		ResHVACSys:NumHeatSysUnits			= {	0  }
	"Init ResHVACSys:NumCoolSysUnits"		ResHVACSys:NumCoolSysUnits			= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since ResHVACSys:MaxNumHVACEquipTypes now dependent on ResHVACSys:HtOrClDucted which is not set until that point
;	"Set ResHVACSys:MaxNumHVACEquipTypes"		ResHVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																																						(IsExisting .AND. (IfValidAnd() .OR. IfValidAnd()))))
;																										then  NumHtPumpSysUnits  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END

;************************************************************************* JP 11/03/22 (FPFC)
RULELIST "SetupHVACSys_Round1_Central_FPFC" 0 0 0 0
;*************************************************************************

; Htg/Clg stuff not needed (?) - JP 11/03/22
;	"Force reset of ResHVACSys:HeatSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHeatSystemTypes >= 1 ) .OR. (LocalStatus( HeatSystemCount[1] ) < 6 .AND. LocalStatus( HeatSystem[1] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HeatSystem_1", 1 )  endif  }
;  ......
;	"Default ResHVACSys:HeatSystemCount[1]"	ResHVACSys:HeatSystemCount[1]		= {	if (NumHeatSystemTypes > 0) then  1  else  0  endif  }
;  ......
;	"Set ResHVACSys:NumHeatSysUnits - 1"	ResHVACSys:NumHeatSysUnits	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  )) then                    HeatSystemCount[1]   else      0      endif  }
;  ......
;   "Set ResHVACSys:HeatSysType"     ResHVACSys:HeatSysType  = {
;         if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
;         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
;					then  StdHeatingType
;					else  HVACCentralRef[1]:Type  endif
;         else  0  endif  }
;
;	"Force reset of ResHVACSys:CoolSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumCoolSystemTypes >= 1 ) .OR. (LocalStatus( CoolSystemCount[1] ) < 6 .AND. LocalStatus( CoolSystem[1] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_CoolSystem_1", 1 )  endif  }
;  ......
;	"Default ResHVACSys:CoolSystemCount[1]"	ResHVACSys:CoolSystemCount[1]		= {	if (NumCoolSystemTypes > 0) then  1  else  0  endif  }
;  ......
;	"Set ResHVACSys:NumCoolSysUnits - 1"	ResHVACSys:NumCoolSysUnits	= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  )) then                    CoolSystemCount[1]   else      0      endif  }
;  ......
;	"Set ResHVACSys:CoolSysType"			ResHVACSys:CoolSysType			= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))
;																							then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
;																							      then  StdCoolingType
;																							      else  CoolSystem[1]:Type  endif
;																							else  0  endif  }
																							
   "Set ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      ResHVACSys:GasFurnAreaServed  = {  0  }

   "Set ResHVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      ResHVACSys:SDHVAreaServed  = {  0  }

   "Set ResHVACSys:HasCentralFurnace"	ResHVACSys:HasCentralFurnace	= {	0 }

; SAC 9/29/13 - added logic to cause standard design HPs to auto-size their heat caps
; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
   ; added logic to prevent setting ResHVACSys:AutoSizeHeatInp to 1 for Existing Std design systems - SAC 07/13/23
	"Default ResHVACSys:AutoSizeHeatInp"	ResHVACSys:AutoSizeHeatInp			=
      {  if (GlobalStatus( ResProj:RunAbbrev ) < 1) then  0
         else if (Status > 1 .AND. (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR.
                                    ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")) then  1  else  0  endif endif  }
	"Set ResHVACSys:AutoSizeHeat[1]"      ResHVACSys:AutoSizeHeat[1]  = {	1 }   ; SAC 04/05/22 (WSHP)
	"Default ResHVACSys:AutoSizeCoolInp"  ResHVACSys:AutoSizeCoolInp  = {	1 }
	"Set ResHVACSys:AutoSizeCool[1]"      ResHVACSys:AutoSizeCool[1]  = {	1 }

	"Init ResHVACSys:NumHeatSysUnits"     ResHVACSys:NumHeatSysUnits   = { 0 }
	"Init ResHVACSys:NumCoolSysUnits"     ResHVACSys:NumCoolSysUnits   = { 0 }
	"Init ResHVACSys:NumHtPumpSysUnits"   ResHVACSys:NumHtPumpSysUnits = { 0 }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END

;************************************************************************* SAC 03/18/22 (WSHP)
RULELIST "SetupHVACSys_Round1_Central_WSHP" 0 0 0 0
;*************************************************************************

; HP stuff not needed (?) - SAC 03/18/22
;   ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpSystemTypes
;	"Force reset of ResHVACSys:HtPumpSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 1 ) .OR. (LocalStatus( HtPumpSystemCount[1] ) < 6 .AND. LocalStatus( HtPumpSystem[1] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_1", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[2]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 2 ) .OR. (LocalStatus( HtPumpSystemCount[2] ) < 6 .AND. LocalStatus( HtPumpSystem[2] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_2", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[3]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 3 ) .OR. (LocalStatus( HtPumpSystemCount[3] ) < 6 .AND. LocalStatus( HtPumpSystem[3] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_3", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[4]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 4 ) .OR. (LocalStatus( HtPumpSystemCount[4] ) < 6 .AND. LocalStatus( HtPumpSystem[4] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_4", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[5]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 5 ) .OR. (LocalStatus( HtPumpSystemCount[5] ) < 6 .AND. LocalStatus( HtPumpSystem[5] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_5", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[6]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 6 ) .OR. (LocalStatus( HtPumpSystemCount[6] ) < 6 .AND. LocalStatus( HtPumpSystem[6] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_6", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[7]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 7 ) .OR. (LocalStatus( HtPumpSystemCount[7] ) < 6 .AND. LocalStatus( HtPumpSystem[7] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_7", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[8]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 8 ) .OR. (LocalStatus( HtPumpSystemCount[8] ) < 6 .AND. LocalStatus( HtPumpSystem[8] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_8", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[9]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 9 ) .OR. (LocalStatus( HtPumpSystemCount[9] ) < 6 .AND. LocalStatus( HtPumpSystem[9] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_9", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[10]"	ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 10 ) .OR. (LocalStatus( HtPumpSystemCount[10] ) < 6 .AND. LocalStatus( HtPumpSystem[10] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_10", 1 )  endif  }
;
;	"Default ResHVACSys:HtPumpSystemCount[1]"		ResHVACSys:HtPumpSystemCount[1]		= {	if (NumHtPumpSystemTypes > 0) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[2]"		ResHVACSys:HtPumpSystemCount[2]		= {	if (NumHtPumpSystemTypes > 1) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[3]"		ResHVACSys:HtPumpSystemCount[3]		= {	if (NumHtPumpSystemTypes > 2) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[4]"		ResHVACSys:HtPumpSystemCount[4]		= {	if (NumHtPumpSystemTypes > 3) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[5]"		ResHVACSys:HtPumpSystemCount[5]		= {	if (NumHtPumpSystemTypes > 4) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[6]"		ResHVACSys:HtPumpSystemCount[6]		= {	if (NumHtPumpSystemTypes > 5) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[7]"		ResHVACSys:HtPumpSystemCount[7]		= {	if (NumHtPumpSystemTypes > 6) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[8]"		ResHVACSys:HtPumpSystemCount[8]		= {	if (NumHtPumpSystemTypes > 7) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[9]"		ResHVACSys:HtPumpSystemCount[9]		= {	if (NumHtPumpSystemTypes > 8) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[10]"	ResHVACSys:HtPumpSystemCount[10]		= {	if (NumHtPumpSystemTypes > 9) then  1  else  0  endif  }
;
;	"Set ResHVACSys:NumHtPumpSysUnits - 1"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  )) then                      HtPumpSystemCount[1]   else      0      endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 2"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[2]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 3"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[3]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 4"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[4]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 5"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[5]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 6"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[6]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 7"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[7]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 8"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[8]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 9"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[9]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 10"	ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] )) then  NumHtPumpSysUnits + HtPumpSystemCount[10]  else  UNCHANGED  endif  }
;
;   ; SAC 6/24/20 - added logic to ensure HtPumpSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
;   ; revised logic to ensure HtPumpSysType NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
;	"Set ResHVACSys:HtPumpSysType"			ResHVACSys:HtPumpSysType			= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
;																									then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
;                                                                                 then  HtPumpSystem[1]:Type
;                                                                                 else if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
;																							            then  StdHeatingType
;																							            else  HtPumpSystem[1]:Type  endif endif
;																									else  0  endif  }

   "Set ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      ResHVACSys:GasFurnAreaServed  = {  0  }

   "Set ResHVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      ResHVACSys:SDHVAreaServed  = {  0  }

; HP stuff not needed (?) - SAC 03/18/22
;	"Blast HtPump* user input if HtPumpSysType has changed"	ResHVACSys:Action	= {	if (LocalStatus( HtPumpSysTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpSysType ) < 1) then  UNCHANGED
;																											else if (HtPumpSysTypeSetup < 0.5) then  UNCHANGED
;																											else if (HtPumpSysType != PrevHtPumpSysType)
;																											then	EvalRulelist( "BlastHVACSysUserInput_HeatPump", 1 )
;																											else	UNCHANGED  endif endif endif  }
;	"Set ResHVACSys:PrevHtPumpSysType"		ResHVACSys:PrevHtPumpSysType		= {	HtPumpSysType  }
;	"Set ResHVACSys:HtPumpSysTypeSetup"		ResHVACSys:HtPumpSysTypeSetup		= {	if (HtPumpSysType > 0) then  1  else  0  endif  }


; SAC 9/29/13 - added logic to cause standard design HPs to auto-size their heat caps
; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
   ; added logic to prevent setting ResHVACSys:AutoSizeHeatInp to 1 for Existing Std design systems - SAC 07/13/23
	"Default ResHVACSys:AutoSizeHeatInp"	ResHVACSys:AutoSizeHeatInp			=
      {  if (GlobalStatus( ResProj:RunAbbrev ) < 1) then  0
         else if (Status > 1 .AND. (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR.
                                    ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")) then  1  else  0  endif endif  }
	"Set ResHVACSys:AutoSizeHeat[1]"			ResHVACSys:AutoSizeHeat[1]			= {	1  }   ; SAC 04/05/22 (WSHP)
	"Default ResHVACSys:AutoSizeCoolInp"	ResHVACSys:AutoSizeCoolInp			= {	1  }
	"Set ResHVACSys:AutoSizeCool[1]"			ResHVACSys:AutoSizeCool[1]			= {	1  }

	"Init ResHVACSys:NumHeatSysUnits"		ResHVACSys:NumHeatSysUnits			= {	0  }
	"Init ResHVACSys:NumCoolSysUnits"		ResHVACSys:NumCoolSysUnits			= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since ResHVACSys:MaxNumHVACEquipTypes now dependent on ResHVACSys:HtOrClDucted which is not set until that point
;	"Set ResHVACSys:MaxNumHVACEquipTypes"		ResHVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																																						(IsExisting .AND. (IfValidAnd() .OR. IfValidAnd()))))
;																										then  NumHtPumpSysUnits  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END

;************************************************************************* JP 04/27/22 (VRF)
RULELIST "SetupHVACSys_Round1_Central_VRF" 0 0 0 0
;*************************************************************************

; HP stuff not needed (Done in data model rules) - JP 04/27/22
;   ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHtPumpSystemTypes
;	"Force reset of ResHVACSys:HtPumpSystem*[1]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 1 ) .OR. (LocalStatus( HtPumpSystemCount[1] ) < 6 .AND. LocalStatus( HtPumpSystem[1] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_1", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[2]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 2 ) .OR. (LocalStatus( HtPumpSystemCount[2] ) < 6 .AND. LocalStatus( HtPumpSystem[2] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_2", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[3]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 3 ) .OR. (LocalStatus( HtPumpSystemCount[3] ) < 6 .AND. LocalStatus( HtPumpSystem[3] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_3", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[4]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 4 ) .OR. (LocalStatus( HtPumpSystemCount[4] ) < 6 .AND. LocalStatus( HtPumpSystem[4] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_4", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[5]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 5 ) .OR. (LocalStatus( HtPumpSystemCount[5] ) < 6 .AND. LocalStatus( HtPumpSystem[5] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_5", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[6]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 6 ) .OR. (LocalStatus( HtPumpSystemCount[6] ) < 6 .AND. LocalStatus( HtPumpSystem[6] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_6", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[7]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 7 ) .OR. (LocalStatus( HtPumpSystemCount[7] ) < 6 .AND. LocalStatus( HtPumpSystem[7] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_7", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[8]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 8 ) .OR. (LocalStatus( HtPumpSystemCount[8] ) < 6 .AND. LocalStatus( HtPumpSystem[8] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_8", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[9]"		ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 9 ) .OR. (LocalStatus( HtPumpSystemCount[9] ) < 6 .AND. LocalStatus( HtPumpSystem[9] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_9", 1 )  endif  }
;	"Force reset of ResHVACSys:HtPumpSystem*[10]"	ResHVACSys:Action		= {	if (IfValidAnd( NumHtPumpSystemTypes >= 10 ) .OR. (LocalStatus( HtPumpSystemCount[10] ) < 6 .AND. LocalStatus( HtPumpSystem[10] ) < 6)) then  UNCHANGED
;																								else	EvalRulelist( "ForceReset_HtPumpSystem_10", 1 )  endif  }
;
;	"Default ResHVACSys:HtPumpSystemCount[1]"		ResHVACSys:HtPumpSystemCount[1]		= {	if (NumHtPumpSystemTypes > 0) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[2]"		ResHVACSys:HtPumpSystemCount[2]		= {	if (NumHtPumpSystemTypes > 1) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[3]"		ResHVACSys:HtPumpSystemCount[3]		= {	if (NumHtPumpSystemTypes > 2) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[4]"		ResHVACSys:HtPumpSystemCount[4]		= {	if (NumHtPumpSystemTypes > 3) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[5]"		ResHVACSys:HtPumpSystemCount[5]		= {	if (NumHtPumpSystemTypes > 4) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[6]"		ResHVACSys:HtPumpSystemCount[6]		= {	if (NumHtPumpSystemTypes > 5) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[7]"		ResHVACSys:HtPumpSystemCount[7]		= {	if (NumHtPumpSystemTypes > 6) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[8]"		ResHVACSys:HtPumpSystemCount[8]		= {	if (NumHtPumpSystemTypes > 7) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[9]"		ResHVACSys:HtPumpSystemCount[9]		= {	if (NumHtPumpSystemTypes > 8) then  1  else  0  endif  }
;	"Default ResHVACSys:HtPumpSystemCount[10]"	ResHVACSys:HtPumpSystemCount[10]		= {	if (NumHtPumpSystemTypes > 9) then  1  else  0  endif  }
;
;	"Set ResHVACSys:NumHtPumpSysUnits - 1"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  )) then                      HtPumpSystemCount[1]   else      0      endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 2"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[2]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 3"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[3]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 4"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[4]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 5"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[5]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 6"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[6]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 7"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[7]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 8"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[8]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 9"		ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  )) then  NumHtPumpSysUnits + HtPumpSystemCount[9]   else  UNCHANGED  endif  }
;	"Set ResHVACSys:NumHtPumpSysUnits - 10"	ResHVACSys:NumHtPumpSysUnits	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] )) then  NumHtPumpSysUnits + HtPumpSystemCount[10]  else  UNCHANGED  endif  }
;
;   ; SAC 6/24/20 - added logic to ensure HtPumpSysType consistent w/ StdHeatingType for S, SMF & DR runs (tic #1225 & #1226)
;   ; revised logic to ensure HtPumpSysType NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
;	"Set ResHVACSys:HtPumpSysType"			ResHVACSys:HtPumpSysType			= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
;																									then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
;                                                                                 then  HtPumpSystem[1]:Type
;                                                                                 else if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
;																							            then  StdHeatingType
;																							            else  HtPumpSystem[1]:Type  endif endif
;																									else  0  endif  }

   "Set ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ; 2019 code (tic #928) - SAC 2/5/18
      ResHVACSys:GasFurnAreaServed  = {  0  }

   "Set ResHVACSys:SDHVAreaServed - area served if HP type or Cl type is SDHV"     ; 2019 code (tic #1130) - JP 8/16/19
      ResHVACSys:SDHVAreaServed  = {  0  }

; HP stuff not needed (?) - SAC 04/27/22
;	"Blast HtPump* user input if HtPumpSysType has changed"	ResHVACSys:Action	= {	if (LocalStatus( HtPumpSysTypeSetup ) < 1 .OR. LocalStatus( PrevHtPumpSysType ) < 1) then  UNCHANGED
;																											else if (HtPumpSysTypeSetup < 0.5) then  UNCHANGED
;																											else if (HtPumpSysType != PrevHtPumpSysType)
;																											then	EvalRulelist( "BlastHVACSysUserInput_HeatPump", 1 )
;																											else	UNCHANGED  endif endif endif  }
;	"Set ResHVACSys:PrevHtPumpSysType"		ResHVACSys:PrevHtPumpSysType		= {	HtPumpSysType  }
;	"Set ResHVACSys:HtPumpSysTypeSetup"		ResHVACSys:HtPumpSysTypeSetup		= {	if (HtPumpSysType > 0) then  1  else  0  endif  }


; SAC 9/29/13 - added logic to cause standard design HPs to auto-size their heat caps
; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
   ; added logic to prevent setting ResHVACSys:AutoSizeHeatInp to 1 for Existing Std design systems - SAC 07/13/23
	"Default ResHVACSys:AutoSizeHeatInp"	ResHVACSys:AutoSizeHeatInp			=
      {  if (GlobalStatus( ResProj:RunAbbrev ) < 1) then  0
         else if (Status > 1 .AND. (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR.
                                    ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")) then  1  else  0  endif endif  }
	"Set ResHVACSys:AutoSizeHeat[1]"			ResHVACSys:AutoSizeHeat[1]			= {	0  }   ; SAC 04/05/22 (VRF)
	"Default ResHVACSys:AutoSizeCoolInp"	ResHVACSys:AutoSizeCoolInp			= {	0  }
	"Set ResHVACSys:AutoSizeCool[1]"			ResHVACSys:AutoSizeCool[1]			= {	0  }

	"Init ResHVACSys:NumHeatSysUnits"		ResHVACSys:NumHeatSysUnits			= {	0  }
	"Init ResHVACSys:NumCoolSysUnits"		ResHVACSys:NumCoolSysUnits			= {	0  }

  ; SAC 3/10/14 - set new property used to identify # of SCSysRpt report records this HVACSys will need
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
  ; SAC 1/14/16 - moved down into 'SetupHVACSys_Round2_*' rulelist since ResHVACSys:MaxNumHVACEquipTypes now dependent on ResHVACSys:HtOrClDucted which is not set until that point
;	"Set ResHVACSys:MaxNumHVACEquipTypes"		ResHVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																																						(IsExisting .AND. (IfValidAnd() .OR. IfValidAnd()))))
;																										then  NumHtPumpSysUnits  	; Project is New Cons .OR. HVACSys is New or Altered
;																										else  0  endif  }

	"Initialize other generic properties (commong to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round1_common", 1 )  }
END

; SAC 8/24/13 - setup initial set of HVACHeat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round1_common" 0 0 0 0
;*************************************************************************
	"Set ResHVACSys:HeatSysEntryMsg"		ResHVACSys:HeatSysEntryMsg	= {	if (Type == 2) then  "Heating equipment entered on main HVAC system or Heat Pump tab for this system."
																						else if (NumHeatSystemTypes < 2) then  "Heating equipment entered on main HVAC System tab for this system."
																						else  "All heating equipment assignments must be of the same 'Type'."  endif endif  }

	"Set ResHVACSys:CoolSysEntryMsg"		ResHVACSys:CoolSysEntryMsg	= {	if (Type == 2) then  "Cooling equipment entered on main HVAC system or Heat Pump tab for this system."
																						else if (NumCoolSystemTypes < 2) then  "Cooling equipment entered on main HVAC System tab for this system."
																						else  "All cooling equipment assignments must be of the same 'Type'."  endif endif  }

	"Set ResHVACSys:HtPumpSysEntryMsg"	ResHVACSys:HtPumpSysEntryMsg	= {	if (Type == 1 .OR. Type == 3) then  "Heating & cooling equipment entered on other tabs for this system."
																							else if (NumHtPumpSystemTypes < 2) then  "Heat pump equipment entered on main HVAC System tab for this system."
																							else  "All heat pump equipment assignments must be of the same 'Type'."  endif endif  }

	"Set ResHVACSys:HeatEquipNumLbl"		ResHVACSys:HeatEquipNumLbl		= {	if (Type == 2) then	"Heat Pump(s):"
																							else						"Heating:"				endif  }
	"Set ResHVACSys:HeatEquipRefLbl"		ResHVACSys:HeatEquipRefLbl		= {	if (Type == 2 .And. NumHtPumpSystemTypes == 1) then  "Heat Pump:"
																							else if ((Type == 1 .OR. Type == 3) .And. NumHeatSystemTypes == 1) then  "Heating Unit:"
																							else  " "  endif endif  }

	"Set ResHVACSys:AutoSizeHeat[2]"		ResHVACSys:AutoSizeHeat[2]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[3]"		ResHVACSys:AutoSizeHeat[3]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[4]"		ResHVACSys:AutoSizeHeat[4]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[5]"		ResHVACSys:AutoSizeHeat[5]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[6]"		ResHVACSys:AutoSizeHeat[6]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[7]"		ResHVACSys:AutoSizeHeat[7]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[8]"		ResHVACSys:AutoSizeHeat[8]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[9]"		ResHVACSys:AutoSizeHeat[9]		= {	AutoSizeHeat[1]  }
	"Set ResHVACSys:AutoSizeHeat[10]"	ResHVACSys:AutoSizeHeat[10]	= {	AutoSizeHeat[1]  }

	"Set ResHVACSys:AutoSizeCool[2]"		ResHVACSys:AutoSizeCool[2]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[3]"		ResHVACSys:AutoSizeCool[3]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[4]"		ResHVACSys:AutoSizeCool[4]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[5]"		ResHVACSys:AutoSizeCool[5]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[6]"		ResHVACSys:AutoSizeCool[6]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[7]"		ResHVACSys:AutoSizeCool[7]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[8]"		ResHVACSys:AutoSizeCool[8]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[9]"		ResHVACSys:AutoSizeCool[9]		= {	AutoSizeCool[1]  }
	"Set ResHVACSys:AutoSizeCool[10]"	ResHVACSys:AutoSizeCool[10]	= {	AutoSizeCool[1]  }
END


; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_HeatCool" 0 0 0 0
;*************************************************************************
   ; SAC 6/25/20 - revised logic to set HeatSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
	"Set ResHVACSys:HeatSysTypeAbbrev"	ResHVACSys:HeatSysTypeAbbrev	=
      {  if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1] ))
         then  HeatSystem[1]:TypeAbbrevStr
         else  " "  endif  }
      ; SAC 6/26/20 - rollback 6/25 mod which caused issues w/ presence of ducts in std design models (tic #1225 & #1226)
      ;   then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
      ;         then  if (HtOrClDucted < 0.5)
      ;               then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSystem[1]:TypeAbbrevStr )
      ;               else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSystem[1]:TypeAbbrevStr )
      ;               endif
      ;         else  HeatSystem[1]:TypeAbbrevStr
      ;         endif
      ;   else  " "  endif  }

; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
	"Default ResHVACSys:HeatDuctedEditable"	ResHVACSys:HeatDuctedEditable		= {	if (HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) < 0) then  1
																										else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified HeatDucted if it is inconsistent w/ the DuctFlag value in the heating equipment table
	"Force reset of HeatDucted if needed"	ResHVACSys:Action						= {	if (HeatDuctedEditable > 0.5 .OR. LocalStatus( HeatDucted ) < 6 .OR. HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  UNCHANGED
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																										else if (HeatDucted != T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ))
																										then	EvalRulelist( "BlastUserUnput_HVACSys_HeatDucted", 1 )
																										else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default ResHVACSys:HeatDucted"				ResHVACSys:HeatDucted				= {	if (HeatSysType < 1 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																										else if (HeatSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) == 1) then  1
																										else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) == -1 .AND.
																													LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																										else  0  endif endif endif endif  }

; SAC 1/6/14 - revised logic to handle defaulting of AFUE for combined hydronic systems (related to GC issue #254)
; SAC 1/6/16 - switched out HeatSystem[*]:Type for ...:TypeAbbrev in order to differentiate CombHydro from ElecCombHydro (tic 374)
	"Set ResHVACSys:HtSysAFUE - 1"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. (HeatSystem[1]:DisplayAFUE  > 0 .OR. HeatSystem[1]:TypeAbbrev  == 9)) then                  HeatSystem[1]:AFUE     else      0      endif  }
	"Set ResHVACSys:HtSysAFUE - 2"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. (HeatSystem[2]:DisplayAFUE  > 0 .OR. HeatSystem[2]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[2]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 3"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. (HeatSystem[3]:DisplayAFUE  > 0 .OR. HeatSystem[3]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[3]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 4"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. (HeatSystem[4]:DisplayAFUE  > 0 .OR. HeatSystem[4]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[4]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 5"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. (HeatSystem[5]:DisplayAFUE  > 0 .OR. HeatSystem[5]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[5]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 6"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. (HeatSystem[6]:DisplayAFUE  > 0 .OR. HeatSystem[6]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[6]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 7"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. (HeatSystem[7]:DisplayAFUE  > 0 .OR. HeatSystem[7]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[7]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 8"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. (HeatSystem[8]:DisplayAFUE  > 0 .OR. HeatSystem[8]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[8]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 9"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. (HeatSystem[9]:DisplayAFUE  > 0 .OR. HeatSystem[9]:TypeAbbrev  == 9)) then  min( HtSysAFUE, HeatSystem[9]:AFUE  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysAFUE - 10"	ResHVACSys:HtSysAFUE	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. (HeatSystem[10]:DisplayAFUE > 0 .OR. HeatSystem[10]:TypeAbbrev == 9)) then  min( HtSysAFUE, HeatSystem[10]:AFUE )  else  UNCHANGED  endif  }

	"Set ResHVACSys:HtSysSizingFactor - 1"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. HeatSystemCount[1]  > 0) then                      (HeatSystem[1]:SizingFactor  * HeatSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HtSysSizingFactor - 2"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. HeatSystemCount[2]  > 0) then  HtSysSizingFactor + (HeatSystem[2]:SizingFactor  * HeatSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 3"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. HeatSystemCount[3]  > 0) then  HtSysSizingFactor + (HeatSystem[3]:SizingFactor  * HeatSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 4"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. HeatSystemCount[4]  > 0) then  HtSysSizingFactor + (HeatSystem[4]:SizingFactor  * HeatSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 5"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. HeatSystemCount[5]  > 0) then  HtSysSizingFactor + (HeatSystem[5]:SizingFactor  * HeatSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 6"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. HeatSystemCount[6]  > 0) then  HtSysSizingFactor + (HeatSystem[6]:SizingFactor  * HeatSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 7"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. HeatSystemCount[7]  > 0) then  HtSysSizingFactor + (HeatSystem[7]:SizingFactor  * HeatSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 8"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. HeatSystemCount[8]  > 0) then  HtSysSizingFactor + (HeatSystem[8]:SizingFactor  * HeatSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 9"		ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. HeatSystemCount[9]  > 0) then  HtSysSizingFactor + (HeatSystem[9]:SizingFactor  * HeatSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - 10"	ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. HeatSystemCount[10] > 0) then  HtSysSizingFactor + (HeatSystem[10]:SizingFactor * HeatSystemCount[10])  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysSizingFactor - XX"	ResHVACSys:HtSysSizingFactor	= {	if (NumHeatSysUnits > 0.5) then  HtSysSizingFactor / NumHeatSysUnits  else  UNCHANGED  endif  }

	"Set ResHVACSys:HtSysCapacity - 1"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[1]  == 0 .AND. NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) .AND. HeatSystemCount[1]  > 0 .AND. IfValidAnd( HeatSystem[1]:TotalCapacity  > 0 )) then                  (HeatSystem[1]:TotalCapacity  * HeatSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HtSysCapacity - 2"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[2]  == 0 .AND. NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) .AND. HeatSystemCount[2]  > 0 .AND. IfValidAnd( HeatSystem[2]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[2]:TotalCapacity  * HeatSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 3" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[3]  == 0 .AND. NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) .AND. HeatSystemCount[3]  > 0 .AND. IfValidAnd( HeatSystem[3]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[3]:TotalCapacity  * HeatSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 4" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[4]  == 0 .AND. NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) .AND. HeatSystemCount[4]  > 0 .AND. IfValidAnd( HeatSystem[4]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[4]:TotalCapacity  * HeatSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 5" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[5]  == 0 .AND. NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) .AND. HeatSystemCount[5]  > 0 .AND. IfValidAnd( HeatSystem[5]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[5]:TotalCapacity  * HeatSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 6" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[6]  == 0 .AND. NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) .AND. HeatSystemCount[6]  > 0 .AND. IfValidAnd( HeatSystem[6]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[6]:TotalCapacity  * HeatSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 7" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[7]  == 0 .AND. NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) .AND. HeatSystemCount[7]  > 0 .AND. IfValidAnd( HeatSystem[7]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[7]:TotalCapacity  * HeatSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 8" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[8]  == 0 .AND. NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) .AND. HeatSystemCount[8]  > 0 .AND. IfValidAnd( HeatSystem[8]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[8]:TotalCapacity  * HeatSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 9" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[9]  == 0 .AND. NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) .AND. HeatSystemCount[9]  > 0 .AND. IfValidAnd( HeatSystem[9]:TotalCapacity  > 0 )) then  HtSysCapacity + (HeatSystem[9]:TotalCapacity  * HeatSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HtSysCapacity - 10"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[10] == 0 .AND. NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) .AND. HeatSystemCount[10] > 0 .AND. IfValidAnd( HeatSystem[10]:TotalCapacity > 0 )) then  HtSysCapacity + (HeatSystem[10]:TotalCapacity * HeatSystemCount[10])  else  UNCHANGED  endif  }


; SAC 1/6/14 - revised logic to incorporate AFUE for combined hydronic systems into efficiency message (related to GC issue #254)
; SAC 1/14/14 - fixed other labels (namely ELecFurn) (GC issue #271)
	"Set ResHVACSys:HeatEquipSummary"	ResHVACSys:HeatEquipSummary	= {
					if (NumHeatSystemTypes <= 0) then  " "
					else if (NumHeatSysUnits < 1) then  "No heating equipment units (counts) defined"
					else if (LocalCompAssigned( HeatSystem[1] ) == 0) then  "Heating equipment assignment #1 not defined"
					else if (HeatSystem[1]:IsAvailable > 0 .AND. HeatSystem[1]:Type == 9)
					then	Format( "%.0f %s unit(s), AFUEeff %.1f", NumHeatSysUnits, HeatSysTypeAbbrev, HtSysAFUE )
					else if (HeatSystem[1]:IsAvailable > 0 .AND. HeatSystem[1]:DisplayAFUE > 0)
					then	Format( "%.0f %s unit(s), AFUE %.1f", NumHeatSysUnits, HeatSysTypeAbbrev, HtSysAFUE )
					else	switch (HeatSystem[1]:Type)
								case  2 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev ) 	; "Heater - Non-central fuel-fired space heater"
								case  3 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )		; "Boiler - Gas or oil boiler"
								case  8 :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )		; "Electric - All electric heating systems other than heat pump"
								default :	Format( "%.0f %s unit(s)", NumHeatSysUnits, HeatSysTypeAbbrev )
							endswitch
					endif endif endif endif endif  }

	"Set ResHVACSys:HeatEquipIssue"		ResHVACSys:HeatEquipIssue		= {
					if (NumHeatSystemTypes <= 0) then  " "
					else if (NumHeatSystemTypes > 0 .AND. LocalCompAssigned( HeatSystem[1]  ) == 0) then  "All heating equipment assignments must be specified (first is excluded)"
					else if (NumHeatSystemTypes > 1 .AND. LocalCompAssigned( HeatSystem[2]  ) == 0) then  "All heating equipment assignments must be specified (second is excluded)"
					else if (NumHeatSystemTypes > 2 .AND. LocalCompAssigned( HeatSystem[3]  ) == 0) then  "All heating equipment assignments must be specified (third is excluded)"
					else if (NumHeatSystemTypes > 3 .AND. LocalCompAssigned( HeatSystem[4]  ) == 0) then  "All heating equipment assignments must be specified (fourth is excluded)"
					else if (NumHeatSystemTypes > 4 .AND. LocalCompAssigned( HeatSystem[5]  ) == 0) then  "All heating equipment assignments must be specified (fifth is excluded)"
					else if (NumHeatSystemTypes > 5 .AND. LocalCompAssigned( HeatSystem[6]  ) == 0) then  "All heating equipment assignments must be specified (sixth is excluded)"
					else if (NumHeatSystemTypes > 6 .AND. LocalCompAssigned( HeatSystem[7]  ) == 0) then  "All heating equipment assignments must be specified (seventh is excluded)"
					else if (NumHeatSystemTypes > 7 .AND. LocalCompAssigned( HeatSystem[8]  ) == 0) then  "All heating equipment assignments must be specified (eighth is excluded)"
					else if (NumHeatSystemTypes > 8 .AND. LocalCompAssigned( HeatSystem[9]  ) == 0) then  "All heating equipment assignments must be specified (ninth is excluded)"
					else if (NumHeatSystemTypes > 9 .AND. LocalCompAssigned( HeatSystem[10] ) == 0) then  "All heating equipment assignments must be specified (tenth is excluded)"
					else if (NumHeatSystemTypes > 1 .AND. HeatSystem[2]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #2: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[2]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 2 .AND. HeatSystem[3]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #3: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[3]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 3 .AND. HeatSystem[4]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #4: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[4]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 4 .AND. HeatSystem[5]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #5: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[5]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 5 .AND. HeatSystem[6]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #6: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[6]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 6 .AND. HeatSystem[7]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #7: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[7]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 7 .AND. HeatSystem[8]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #8: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[8]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 8 .AND. HeatSystem[9]:Type  != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #9: %s)",  HeatSystem[1]:TypeAbbrevStr, HeatSystem[9]:TypeAbbrevStr )
					else if (NumHeatSystemTypes > 9 .AND. HeatSystem[10]:Type != HeatSystem[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #10: %s)", HeatSystem[1]:TypeAbbrevStr, HeatSystem[10]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif  }


  ; More HVACSys cooling equipment summarization
   "Initialize ResHVACSys:EffMetric"      ResHVACSys:EffMetric =        ; rules to setup HVACSys:EffMetric based on assigned HVACCool objects - SAC 10/06/22 (tic #3431)
      {  if (IfValidAnd( Proj:StdDesignBase >= 2022 )) then  2  else  1  endif  }
   "Reset ResHVACSys:EffMetric based on assigned HVACCool[1-10]"   for:#Sys=(1to10)   ResHVACSys:EffMetric =         ; add logic to prevent reset back to user EffMetric of 1 for 'zb' model - SAC 11/17/22
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "zb") then  UNCHANGED
         else if (IfValidAnd( CoolSystem[#Sys]:EffMetric > 0 ))
         then  CoolSystem[#Sys]:EffMetric
         else  UNCHANGED  endif endif  }

   ; SAC 6/25/20 - revised logic to set HeatSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
	"Set ResHVACSys:CoolSysTypeAbbrev"	ResHVACSys:CoolSysTypeAbbrev	=
      {  if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
               then  T24RCoolingEquipment:StdSystem( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSystem[1]:TypeAbbrevStr )
               else  CoolSystem[1]:TypeAbbrevStr
               endif
         else  " "  endif  }
      ; SAC 6/26/20 - old logic
      ;   then  CoolSystem[1]:TypeAbbrevStr
      ;   else  " "  endif  }

; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
	"Default ResHVACSys:CoolDuctedEditable"	ResHVACSys:CoolDuctedEditable		= {	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 0) then  1
																										else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified CoolDucted if it is inconsistent w/ the DuctFlag value in the cooling equipment table
	"Force reset of CoolDucted if needed"	ResHVACSys:Action						= {	if (CoolDuctedEditable > 0.5 .OR. LocalStatus( CoolDucted ) < 6 .OR. CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  UNCHANGED
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																										else if (CoolDucted != T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ))
																										then	EvalRulelist( "BlastUserUnput_HVACSys_CoolDucted", 1 )
																										else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default ResHVACSys:CoolDucted"				ResHVACSys:CoolDucted				= {	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																										else if (CoolSystem[1]:IsAvailable < 0.5) then  0
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) == 1) then  1
																										else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) == -1 .AND.
																													CoolSysType > 1 .AND. LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																										else  0  endif endif endif endif  }

   "Set ResHVACSys:ClSysSEER - 1"                      ResHVACSys:ClSysSEER   = {   if (NumCoolSystemTypes >  0    .AND. IfValidAnd( CoolSystem[ 1  ]:EffMetric = 1 ) .AND. IfValidAnd( CoolSystem[ 1  ]:SEER  >= 0 )) then                  CoolSystem[ 1  ]:SEER     else      0      endif  }
   "Set ResHVACSys:ClSysSEER - 2-10"  For:#Eqp=(2-10)  ResHVACSys:ClSysSEER   = {   if (NumCoolSystemTypes >= #Eqp .AND. IfValidAnd( CoolSystem[#Eqp]:EffMetric = 1 ) .AND. IfValidAnd( CoolSystem[#Eqp]:SEER  >= 0 )) then  min( ClSysSEER, CoolSystem[#Eqp]:SEER  )  else  UNCHANGED  endif  }      ; converted to loop - SAC 10/06/22

   "Set ResHVACSys:ClSysSEER2 - 1"                      ResHVACSys:ClSysSEER2   = {   if (NumCoolSystemTypes >  0    .AND. IfValidAnd( CoolSystem[ 1  ]:EffMetric = 2 ) .AND. IfValidAnd( CoolSystem[ 1  ]:SEER2  >= 0 )) then                  CoolSystem[ 1  ]:SEER2     else      0      endif  }  ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:ClSysSEER2 - 2-10"  For:#Eqp=(2-10)  ResHVACSys:ClSysSEER2   = {   if (NumCoolSystemTypes >= #Eqp .AND. IfValidAnd( CoolSystem[#Eqp]:EffMetric = 2 ) .AND. IfValidAnd( CoolSystem[#Eqp]:SEER2  >= 0 )) then  min( ClSysSEER, CoolSystem[#Eqp]:SEER2  )  else  UNCHANGED  endif  } 

   "Set ResHVACSys:ClSysEER - 1"                      ResHVACSys:ClSysEER   = {   if (NumCoolSystemTypes >  0    .AND. IfValidAnd( CoolSystem[ 1  ]:EffMetric = 1 ) .AND. IfValidAnd( CoolSystem[ 1  ]:EER  >= 0 )) then                 CoolSystem[ 1  ]:EER     else      0      endif  }
   "Set ResHVACSys:ClSysEER - 2-10"  For:#Eqp=(2-10)  ResHVACSys:ClSysEER   = {   if (NumCoolSystemTypes >= #Eqp .AND. IfValidAnd( CoolSystem[#Eqp]:EffMetric = 1 ) .AND. IfValidAnd( CoolSystem[#Eqp]:EER  >= 0 )) then  min( ClSysEER, CoolSystem[#Eqp]:EER  )  else  UNCHANGED  endif  }      ; converted to loop - SAC 10/06/22

   "Set ResHVACSys:ClSysEER2 - 1"                      ResHVACSys:ClSysEER2   = {   if (NumCoolSystemTypes >  0    .AND. IfValidAnd( CoolSystem[ 1  ]:EffMetric = 2 ) .AND. IfValidAnd( CoolSystem[ 1  ]:EER2  >= 0 )) then                 CoolSystem[ 1  ]:EER2     else      0      endif  }  ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:ClSysEER2 - 2-10"  For:#Eqp=(2-10)  ResHVACSys:ClSysEER2   = {   if (NumCoolSystemTypes >= #Eqp .AND. IfValidAnd( CoolSystem[#Eqp]:EffMetric = 2 ) .AND. IfValidAnd( CoolSystem[#Eqp]:EER2  >= 0 )) then  min( ClSysEER, CoolSystem[#Eqp]:EER2  )  else  UNCHANGED  endif  } 

	"Set ResHVACSys:ClSysCFMperTon - 1"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:CFMperTon  >= 0 )) then                       CoolSystem[1]:CFMperTon     else      0      endif  }
	"Set ResHVACSys:ClSysCFMperTon - 2"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 3"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 4"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 5"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[5]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 6"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[6]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 7"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[7]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 8"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[8]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 9"		ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:CFMperTon  >= 0 )) then  min( ClSysCFMperTon, CoolSystem[9]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 10"	ResHVACSys:ClSysCFMperTon	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:CFMperTon >= 0 )) then  min( ClSysCFMperTon, CoolSystem[10]:CFMperTon )  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 1"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 0 .AND. IfValidAnd( CoolSystem[1]:RefrigChgAdjFctr  >= 0 )) then                              CoolSystem[1]:RefrigChgAdjFctr     else      0      endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 2"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 1 .AND. IfValidAnd( CoolSystem[2]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 3"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 2 .AND. IfValidAnd( CoolSystem[3]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 4"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 3 .AND. IfValidAnd( CoolSystem[4]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 5"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 4 .AND. IfValidAnd( CoolSystem[5]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 6"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 5 .AND. IfValidAnd( CoolSystem[6]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[6]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 7"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 6 .AND. IfValidAnd( CoolSystem[7]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[7]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 8"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 7 .AND. IfValidAnd( CoolSystem[8]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[8]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 9"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 8 .AND. IfValidAnd( CoolSystem[9]:RefrigChgAdjFctr  >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[9]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 10"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumCoolSystemTypes > 9 .AND. IfValidAnd( CoolSystem[10]:RefrigChgAdjFctr >= 0 )) then  min( ClSysRefrigChgAdjFctr, CoolSystem[10]:RefrigChgAdjFctr )  else  UNCHANGED  endif  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set ResHVACSys:ClSysSizingFactor - 1"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) .AND. CoolSystemCount[1]  > 0) then                      (CoolSystem[1]:SizingFactor  * CoolSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:ClSysSizingFactor - 2"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) .AND. CoolSystemCount[2]  > 0) then  ClSysSizingFactor + (CoolSystem[2]:SizingFactor  * CoolSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 3"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) .AND. CoolSystemCount[3]  > 0) then  ClSysSizingFactor + (CoolSystem[3]:SizingFactor  * CoolSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 4"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) .AND. CoolSystemCount[4]  > 0) then  ClSysSizingFactor + (CoolSystem[4]:SizingFactor  * CoolSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 5"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) .AND. CoolSystemCount[5]  > 0) then  ClSysSizingFactor + (CoolSystem[5]:SizingFactor  * CoolSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 6"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) .AND. CoolSystemCount[6]  > 0) then  ClSysSizingFactor + (CoolSystem[6]:SizingFactor  * CoolSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 7"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) .AND. CoolSystemCount[7]  > 0) then  ClSysSizingFactor + (CoolSystem[7]:SizingFactor  * CoolSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 8"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) .AND. CoolSystemCount[8]  > 0) then  ClSysSizingFactor + (CoolSystem[8]:SizingFactor  * CoolSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 9"		ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) .AND. CoolSystemCount[9]  > 0) then  ClSysSizingFactor + (CoolSystem[9]:SizingFactor  * CoolSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 10"	ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) .AND. CoolSystemCount[10] > 0) then  ClSysSizingFactor + (CoolSystem[10]:SizingFactor * CoolSystemCount[10])  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - XX"	ResHVACSys:ClSysSizingFactor	= {	if (NumCoolSysUnits > 0.5) then  ClSysSizingFactor / NumCoolSysUnits  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) .AND. CoolSystemCount[1]  > 0) then                  (CoolSystem[1]:TotalCapacity  * CoolSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:ClSysCapacity - 2"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) .AND. CoolSystemCount[2]  > 0) then  ClSysCapacity + (CoolSystem[2]:TotalCapacity  * CoolSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 3" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) .AND. CoolSystemCount[3]  > 0) then  ClSysCapacity + (CoolSystem[3]:TotalCapacity  * CoolSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 4" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) .AND. CoolSystemCount[4]  > 0) then  ClSysCapacity + (CoolSystem[4]:TotalCapacity  * CoolSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 5" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) .AND. CoolSystemCount[5]  > 0) then  ClSysCapacity + (CoolSystem[5]:TotalCapacity  * CoolSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 6" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[6]  == 0 .AND. NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) .AND. CoolSystemCount[6]  > 0) then  ClSysCapacity + (CoolSystem[6]:TotalCapacity  * CoolSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 7" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[7]  == 0 .AND. NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) .AND. CoolSystemCount[7]  > 0) then  ClSysCapacity + (CoolSystem[7]:TotalCapacity  * CoolSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 8" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[8]  == 0 .AND. NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) .AND. CoolSystemCount[8]  > 0) then  ClSysCapacity + (CoolSystem[8]:TotalCapacity  * CoolSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 9" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[9]  == 0 .AND. NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) .AND. CoolSystemCount[9]  > 0) then  ClSysCapacity + (CoolSystem[9]:TotalCapacity  * CoolSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 10"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[10] == 0 .AND. NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) .AND. CoolSystemCount[10] > 0) then  ClSysCapacity + (CoolSystem[10]:TotalCapacity * CoolSystemCount[10])  else  UNCHANGED  endif  }

   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER     =              ; SAC 10/06/22 (tic #3431)   ; fix for when CoolSysTypeAbbrev invalid - SAC 10/10/22
                                                   {  if (EffMetric < 2 .OR. CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
                                                      else if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )  endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"       ResHVACSys:ClSysEER2perEER       =   
                                                   {  if (EffMetric < 2 .OR. CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
                                                      else if (T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )  endif endif  }

   "Set ResHVACSys:EffMetricLbls[1] - SEER"     ResHVACSys:EffMetricLbls[1] = {  if (EffMetric = 1) then  "SEER"  else  "SEER2"  endif  }    ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:EffMetricLbls[2] - EER"      ResHVACSys:EffMetricLbls[2] = {  if (EffMetric = 1) then   "EER"  else   "EER2"  endif  }
   "Set ResHVACSys:EffMetricVals[1] - SEER"     ResHVACSys:EffMetricVals[1] = {  if (EffMetric = 1) then  ClSysSEER  else  ClSysSEER2  endif  }
   "Set ResHVACSys:EffMetricVals[2] - EER"      ResHVACSys:EffMetricVals[2] = {  if (EffMetric = 1) then  ClSysEER   else  ClSysEER2   endif  }

	"Set ResHVACSys:CoolEquipSummary"	ResHVACSys:CoolEquipSummary	=              ; SAC 6/21/20 - prevent reporting SEER when not valid input (tic #1226)   ; SAC 08/19/20 (tic #1003)   ; SAC 08/31/20 (tic #1003)
				{	if (NumCoolSystemTypes <= 0) then  " "
					else if (NumCoolSysUnits < 1) then  "No cooling equipment units (counts) defined"
					else if (LocalCompAssigned( CoolSystem[1] ) == 0) then  "Cooling equipment assignment #1 not defined"
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowCEER > 0 ))
					then	Format( "%.0f %s unit(s), %.1f CEER", NumCoolSysUnits, CoolSysTypeAbbrev, CoolSystem[1]:CEER )
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowSEER > 0 )==0 .AND.
                        (CoolSystem[1]:Type == 5 .OR. CoolSystem[1]:Type == 25))
					then	Format( "%.0f %s unit(s), %.1f %s", NumCoolSysUnits, CoolSysTypeAbbrev, EffMetricVals[2], EffMetricLbls[2] )
					else if (CoolSystem[1]:IsAvailable > 0 .AND. IfValidAnd( CoolSystem[1]:ShowSEER > 0 )==0)
					then	Format( "%.0f %s unit(s), %.1f %s, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, EffMetricVals[2], EffMetricLbls[2], ClSysCFMperTon )
					else if (CoolSystem[1]:IsAvailable > 0)
					then	Format( "%.0f %s unit(s), %.1f %s, %.1f %s, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, EffMetricVals[1], EffMetricLbls[1], EffMetricVals[2], EffMetricLbls[2], ClSysCFMperTon )
					else	Format( "%.0f %s unit(s)", NumCoolSysUnits, CoolSysTypeAbbrev )
					endif endif endif endif endif endif endif  }

  ; SAC 6/4/14 - modified rule to check consistency between each assigned sys [2-N] w/ sys[1]:TypeRpt (rather than :Type), since No Cooling case will override user's sys[1] w/ a std design cooling system
	"Set ResHVACSys:CoolEquipIssue"		ResHVACSys:CoolEquipIssue		= {
					if (NumCoolSystemTypes <= 0) then  " "
					else if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1]  ) == 0) then  "All cooling equipment assignments must be specified (first is excluded)"
					else if (NumCoolSystemTypes > 1 .AND. LocalCompAssigned( CoolSystem[2]  ) == 0) then  "All cooling equipment assignments must be specified (second is excluded)"
					else if (NumCoolSystemTypes > 2 .AND. LocalCompAssigned( CoolSystem[3]  ) == 0) then  "All cooling equipment assignments must be specified (third is excluded)"
					else if (NumCoolSystemTypes > 3 .AND. LocalCompAssigned( CoolSystem[4]  ) == 0) then  "All cooling equipment assignments must be specified (fourth is excluded)"
					else if (NumCoolSystemTypes > 4 .AND. LocalCompAssigned( CoolSystem[5]  ) == 0) then  "All cooling equipment assignments must be specified (fifth is excluded)"
					else if (NumCoolSystemTypes > 5 .AND. LocalCompAssigned( CoolSystem[6]  ) == 0) then  "All cooling equipment assignments must be specified (sixth is excluded)"
					else if (NumCoolSystemTypes > 6 .AND. LocalCompAssigned( CoolSystem[7]  ) == 0) then  "All cooling equipment assignments must be specified (seventh is excluded)"
					else if (NumCoolSystemTypes > 7 .AND. LocalCompAssigned( CoolSystem[8]  ) == 0) then  "All cooling equipment assignments must be specified (eighth is excluded)"
					else if (NumCoolSystemTypes > 8 .AND. LocalCompAssigned( CoolSystem[9]  ) == 0) then  "All cooling equipment assignments must be specified (ninth is excluded)"
					else if (NumCoolSystemTypes > 9 .AND. LocalCompAssigned( CoolSystem[10] ) == 0) then  "All cooling equipment assignments must be specified (tenth is excluded)"
					else if (NumCoolSystemTypes > 1 .AND. CoolSystem[2]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #2: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[2]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 2 .AND. CoolSystem[3]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #3: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[3]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 3 .AND. CoolSystem[4]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #4: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[4]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 4 .AND. CoolSystem[5]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #5: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[5]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 5 .AND. CoolSystem[6]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #6: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[6]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 6 .AND. CoolSystem[7]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #7: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[7]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 7 .AND. CoolSystem[8]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #8: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[8]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 8 .AND. CoolSystem[9]:Type  != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #9: %s)",  CoolSystem[1]:TypeAbbrevStr, CoolSystem[9]:TypeAbbrevStr )
					else if (NumCoolSystemTypes > 9 .AND. CoolSystem[10]:Type != CoolSystem[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #10: %s)", CoolSystem[1]:TypeAbbrevStr, CoolSystem[10]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif endif  }

; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Default ResHVACSys:ConstHtgSetpt"		ResHVACSys:ConstHtgSetpt	= {	if (strlen( HeatSysTypeAbbrev ) < 2) then  -1
																							else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev )  endif  }
	"Init ResHVACSys:ConstClgSetpt"			ResHVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set ResHVACSys:EqpCountsMustAlign"		ResHVACSys:EqpCountsMustAlign	= {	if (HeatDucted > 0.5 .AND. (CoolDucted > 0.5 .OR. NumCoolSystemTypes <= 0 .OR.
																																	 LocalCompAssigned( CoolSystem[1] ) == 0 .OR. IfValidAnd( CoolSystem[1]:Type == 1 ))) then  1  else  0  endif  }
																	; SAC 4/30/15 - revised logic to require equipment alignment if HeatDucted and there is No Cooling (related to issue 517)
																	;							if (HeatDucted > 0.5 .AND. CoolDucted > 0.5) then  1  else  0  endif  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set ResHVACSys:ZonalSysBypassDuct"		ResHVACSys:ZonalSysBypassDuct	= {
								if (FloorAreaServed[1] < 1 .OR. (HeatDucted < 0.5 .AND. CoolDucted < 0.5) .OR. LocalCompAssigned( DistribSystem ) < 1) then  0
								else if (IfValidAnd( DistribSystem:HasBypassDuct > 0.5 )==0 .OR. IfValidAnd( DistribSystem:DuctsPresent > 0.5 )==0) then  0
								else if (NumCoolSystemTypes >=  1 .AND. IfValidAnd( CoolSystem[1]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[1]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  2 .AND. IfValidAnd( CoolSystem[2]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[2]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  3 .AND. IfValidAnd( CoolSystem[3]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[3]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  4 .AND. IfValidAnd( CoolSystem[4]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[4]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  5 .AND. IfValidAnd( CoolSystem[5]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[5]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  6 .AND. IfValidAnd( CoolSystem[6]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[6]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  7 .AND. IfValidAnd( CoolSystem[7]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[7]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  8 .AND. IfValidAnd( CoolSystem[8]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[8]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >=  9 .AND. IfValidAnd( CoolSystem[9]:IsZonal  > 0.5 ) .AND. IfValidAnd( CoolSystem[9]:ShowIsZonal  > 0.5 )) then  1
								else if (NumCoolSystemTypes >= 10 .AND. IfValidAnd( CoolSystem[10]:IsZonal > 0.5 ) .AND. IfValidAnd( CoolSystem[10]:ShowIsZonal > 0.5 )) then  1
								else	0  endif endif endif endif endif endif endif endif endif endif endif endif  }

	"Init ResHVACSys:HtPumpDucted"       ResHVACSys:HtPumpDucted      = {	0  }
	"Init ResHVACSys:HaveHtPump"         ResHVACSys:HaveHtPump        = {	0  }
	"Init ResHVACSys:HtPumpEquipIssue"   ResHVACSys:HtPumpEquipIssue  = {	UNDEFINED  }
	"Init ResHVACSys:HPSysHSPF"          ResHVACSys:HPSysHSPF         = {	UNDEFINED  }
	"Init ResHVACSys:HPSysAutoSize"      ResHVACSys:HPSysAutoSize     = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap47"         ResHVACSys:HPSysCap47        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysMinCap47"      ResHVACSys:HPSysMinCap47     = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap35"         ResHVACSys:HPSysCap35        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap17"         ResHVACSys:HPSysCap17        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP47"         ResHVACSys:HPSysCOP47        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP35"         ResHVACSys:HPSysCOP35        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP17"         ResHVACSys:HPSysCOP17        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysAuxHtgCap"     ResHVACSys:HPSysAuxHtgCap    = {	UNDEFINED  }
	"Init ResHVACSys:HPSysVCHPFanPwr"    ResHVACSys:HPSysVCHPFanPwr   = {	UNDEFINED  }
	"Init ResHVACSys:HPModelDualFuel"    ResHVACSys:HPModelDualFuel   = {	UNDEFINED  }
	"Init ResHVACSys:HPDFAFUE"           ResHVACSys:HPDFAFUE          = {	UNDEFINED  }
	"Init ResHVACSys:HPLockoutTemp"      ResHVACSys:HPLockoutTemp     = {	UNDEFINED  }
   "Init ResHVACSys:LrgHtPumpStdFanPwr" ResHVACSys:LrgHtPumpStdFanPwr =    ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }
   "Init ResHVACSys:PropHtPumpAutoSz"   ResHVACSys:PropHtPumpAutoSz  =     ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }

	"Initialize other generic properties (common to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }

; mjb 7/29/14	-	set flag if CoolSystem == EvapCond
	"Set ResHVACSys:HaveEvapCond"			ResHVACSys:HaveEvapCond			= {	if (NumCoolSystemTypes <= 0) then  0  
																								else if (CoolSystem[1]:Type == 14) then 1 else 0 endif endif	}
; mjb 7/29/14	-	calculate HVACSys average evaporative effectiveness
;	"Set ResHVACSys:SysEvapCondEff round 1"			ResHVACSys:SysEvapCondEff		= {	switch (NumCoolSystemTypes) 
;																								case  0 :  UNDEFINED   
;																								case  1 :  CoolSystem[1]:EvapCondEff   
;																								case  2 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed)  
;																								case  3 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed)  
;																								case  4 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed)  
;																								case  5 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																								case  6 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed)
;																								case  7 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed)
;																								case  8 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed)
;																								case  9 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed) + (CoolSystem[9]:EvapCondEff * CoolSystem[9]:FloorAreaServed)
;																								case  10 :  (CoolSystem[1]:EvapCondEff * CoolSystem[1]:FloorAreaServed) + (CoolSystem[2]:EvapCondEff * CoolSystem[2]:FloorAreaServed) + (CoolSystem[3]:EvapCondEff * CoolSystem[3]:FloorAreaServed) + (CoolSystem[4]:EvapCondEff * CoolSystem[4]:FloorAreaServed) + (CoolSystem[5]:EvapCondEff * CoolSystem[5]:FloorAreaServed)  
;																												+ (CoolSystem[6]:EvapCondEff * CoolSystem[6]:FloorAreaServed) + (CoolSystem[7]:EvapCondEff * CoolSystem[7]:FloorAreaServed) + (CoolSystem[8]:EvapCondEff * CoolSystem[8]:FloorAreaServed) + (CoolSystem[9]:EvapCondEff * CoolSystem[9]:FloorAreaServed)+ (CoolSystem[10]:EvapCondEff * CoolSystem[10]:FloorAreaServed)
;																								default :  CoolSystem[1]:EvapCondEff   
;																							endswitch  }
;	"Set ResHVACSys:SysEvapCondEff round 2"			ResHVACSys:SysEvapCondEff		= {	if (NumCoolSystemTypes > 1) then SysEvapCondEff / FloorAreaServed else UNCHANGED endif	}
;	"Set ResHVACSys:SysEvapCondEff round 3"			ResHVACSys:SysEvapCondEff		= {	if (HaveEvapCond > 0) then UNCHANGED else UNDEFINED endif	}

END

; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_HeatPump" 0 0 0 0
;*************************************************************************
;	"debug HtPumpSystem[1]:TypeAbbrevStr"		ResHVACSys:Action		= {	PostWarning( "HtPumpSystem[1]:TypeAbbrevStr '%s'", HtPumpSystem[1]:TypeAbbrevStr )  }
   ; SAC 6/25/20 - revised logic to set HtPumpSysTypeAbbrev properly for Std, SMF & DR models (tic #1225 & #1226)
   ; revised logic to ensure HtPumpSysTypeAbbrev NOT updated for Existing systems in Std, SMF & DR models - SAC 06/24/21
   ; "dbg ResHVACSys:HtPumpSysTypeAbbrev" ResHVACSys:Action = { PostMessageToLog( "ResHVACSys '%s' HtPumpSysTypeAbbrev (was '%s'):  HtPumpSystem[1] '%s' type %s / MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) %g / MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysStatus ) %g", Name, ValidOr( HtPumpSysTypeAbbrev, "?" ), ValidOr( HtPumpSystem[1]:Name, "missing" ), ValidOr( HtPumpSystem[1]:TypeAbbrevStr, "?" ), MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ), MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysStatus ) )  }
   ; added logic to ensure ResHVACSys:HtPumpSysTypeAbbrev properly setup for Std design HVAC assigned to ResOtherZn objects - SAC 07/13/23
	"Set ResHVACSys:HtPumpSysTypeAbbrev"	ResHVACSys:HtPumpSysTypeAbbrev	=
      {  if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
               then  if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND.
                          ( ( MinRevRef(      ResZn:ActiveHVACSystem,      ResZn:HVACSysStatus ) > 0 .AND. MinRevRef(      ResZn:ActiveHVACSystem,      ResZn:HVACSysStatus ) < 2 ) .OR.
                            ( MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysStatus ) > 0 .AND. MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:HVACSysStatus ) < 2 ) ))
                     then  UNCHANGED
                     else if (HtOrClDucted < 0.5)
                     then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSystem[1]:TypeAbbrevStr )
                     else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSystem[1]:TypeAbbrevStr )
                     endif endif
               else  HtPumpSystem[1]:TypeAbbrevStr
               endif
         else  " "  endif  }
      ; SAC 6/26/20 - old logic
      ;   then  HtPumpSystem[1]:TypeAbbrevStr
      ;   else  " "  endif  }

	"Default ResHVACSys:HtPumpDuctedEditable"		ResHVACSys:HtPumpDuctedEditable	= {	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  0
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 0) then  1
																											else  0  endif endif endif  }
	; SAC 11/26/14 - added rule to blast user-specified HtPumpDucted if it is inconsistent w/ the DuctFlag value in the heat pump equipment table
	"Force reset of HtPumpDucted if needed"	ResHVACSys:Action						= {	if (HtPumpDuctedEditable > 0.5 .OR. LocalStatus( HtPumpDucted ) < 6 .OR. HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  UNCHANGED
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  UNCHANGED
																											else if (HtPumpDucted != T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
																											then	EvalRulelist( "BlastUserUnput_HVACSys_HtPumpDucted", 1 )
																											else	UNCHANGED  endif endif endif  }
	; SAC 4/7/15 - added 4th if() to default to 1 if equipment is ductable (=-1) AND there is a valid duct system assigned to the system
	"Default ResHVACSys:HtPumpDucted"				ResHVACSys:HtPumpDucted				= {	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																											else if (HtPumpSystem[1]:IsAvailable < 0.5) then  0
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == 1) then  1
																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND.
																														LocalCompAssigned( DistribSystem ) .AND. IfValidAnd( DistribSystem:Type > 0 ) .AND. IfValidAnd( DistribSystem:Type != 8 )) then  1
																											else  0  endif endif endif endif  }

;	"debug Duct Flag"		ResHVACSys:Action		= {	MessageBox( "check HtPumpDucted %g", ResHVACSys:HtPumpDucted )  }

  ; SAC 1/18/16 - revised rules to force override of ResHVACSys:HeatDucted & CoolDucted if they are user-defiend and inconsistent w/ HtPumpDucted (to fix HERS AHUAirFlow reporting bug)
	"Set ResHVACSys:HeatDucted"		ResHVACSys:Action			= {	if (IfValidAnd( HeatDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_HeatDucted_HtPumpDucted", 1 )  endif  }
	"Set ResHVACSys:CoolDucted"		ResHVACSys:Action			= {	if (IfValidAnd( CoolDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_CoolDucted_HtPumpDucted", 1 )  endif  }
;	"debug Duct Flag"		ResHVACSys:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", ResHVACSys:CoolDucted, ResHVACSys:HeatDucted )  }

   "Initialize ResHVACSys:EffMetric"      ResHVACSys:EffMetric =        ; rules to setup ResHVACSys:EffMetric based on assigned HVACHtPump objects - SAC 10/06/22 (tic #3431)
      {  if (IfValidAnd( Proj:StdDesignBase >= 2022 )) then  2  else  1  endif  }
   "Reset ResHVACSys:EffMetric based on assigned HVACHtPump[1-10]"   for:#Sys=(1to10)   ResHVACSys:EffMetric =       ; add logic to prevent reset back to user EffMetric of 1 for 'zb' model - SAC 11/17/22
      {  if (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "smf" .OR. Proj:RunAbbrev == "dr" .OR. Proj:RunAbbrev == "zb") then  UNCHANGED
         else if (IfValidAnd( HtPumpSystem[#Sys]:EffMetric > 0 ))
         then  HtPumpSystem[#Sys]:EffMetric
         else  UNCHANGED  endif endif  }

   "Set ResHVACSys:HPSysHSPF - 1"                       ResHVACSys:HPSysHSPF  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:HSPF > 0 )) then                  HtPumpSystem[ 1  ]:HSPF     else      0      endif  }
   "Set ResHVACSys:HPSysHSPF - 2-10"  for:#Eqp=(1to10)  ResHVACSys:HPSysHSPF  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:HSPF > 0 )) then  min( HPSysHSPF, HtPumpSystem[#Eqp]:HSPF  )  else  UNCHANGED  endif  }

   "Set ResHVACSys:HPSysHSPF2 - 1"                       ResHVACSys:HPSysHSPF2  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:HSPF2 > 0 )) then                   HtPumpSystem[ 1  ]:HSPF2     else      0      endif  }   ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:HPSysHSPF2 - 2-10"  for:#Eqp=(1to10)  ResHVACSys:HPSysHSPF2  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:HSPF2 > 0 )) then  min( HPSysHSPF2, HtPumpSystem[#Eqp]:HSPF2  )  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysAutoSize - 1"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:AutoSize  > 0 )) then  1  else      0      endif  }    ; SAC 9/22/17 - auto-size sim if ANY assigned HP is flagged for autosize
	"Set ResHVACSys:HPSysAutoSize - 2"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 3"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 4"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 5"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 6"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 7"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 8"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 9"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:AutoSize  > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAutoSize - 10"	ResHVACSys:HPSysAutoSize	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:AutoSize > 0 )) then  1  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCap47 - 1"	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:Cap47  > 0 )) then               (HtPumpSystem[1]:Cap47  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HPSysCap47 - 2"	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[2]:Cap47  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 3" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[3]:Cap47  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 4" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[4]:Cap47  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 5" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[5]:Cap47  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 6" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[6]:Cap47  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 7" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[7]:Cap47  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 8" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[8]:Cap47  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 9" 	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:Cap47  > 0 )) then  HPSysCap47 + (HtPumpSystem[9]:Cap47  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap47 - 10"	ResHVACSys:HPSysCap47	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:Cap47 > 0 )) then  HPSysCap47 + (HtPumpSystem[10]:Cap47 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

   ; added to facilitate new 2022 HP standard design fan power - SAC 03/11/21
	"Set ResHVACSys:HPSysMinCap47 - 1"	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[1]:Cap47  > 0 )) then                                                             HtPumpSystem[1]:Cap47   else      0      endif  }
	"Set ResHVACSys:HPSysMinCap47 - 2"	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[2]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[2]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 3" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[3]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[3]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 4" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[4]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[4]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 5" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[5]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[5]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 6" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[6]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[6]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 7" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[7]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[7]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 8" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[8]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[8]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 9" 	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[9]:Cap47  > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:Cap47  < HPSysMinCap47 )) then  HtPumpSystem[9]:Cap47   else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysMinCap47 - 10"	ResHVACSys:HPSysMinCap47	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HtPumpSystem[10]:Cap47 > 0 ) .AND. IfValidAnd( HtPumpSystem[10]:Cap47 < HPSysMinCap47 )) then  HtPumpSystem[10]:Cap47  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCap35 - 1"	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:Cap35  ) > 0) then               (HtPumpSystem[1]:Cap35  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HPSysCap35 - 2"	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[2]:Cap35  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 3" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[3]:Cap35  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 4" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[4]:Cap35  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 5" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[5]:Cap35  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 6" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[6]:Cap35  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 7" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[7]:Cap35  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 8" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[8]:Cap35  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 9" 	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:Cap35  ) > 0) then  HPSysCap35 + (HtPumpSystem[9]:Cap35  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap35 - 10"	ResHVACSys:HPSysCap35	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:Cap35 ) > 0) then  HPSysCap35 + (HtPumpSystem[10]:Cap35 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCap17 - 1"	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 0 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:Cap17  ) > 0) then               (HtPumpSystem[1]:Cap17  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HPSysCap17 - 2"	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 1 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[2]:Cap17  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 3" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 2 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[3]:Cap17  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 4" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 3 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[4]:Cap17  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 5" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 4 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[5]:Cap17  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 6" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 5 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[6]:Cap17  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 7" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 6 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[7]:Cap17  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 8" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 7 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[8]:Cap17  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 9" 	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 8 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:Cap17  ) > 0) then  HPSysCap17 + (HtPumpSystem[9]:Cap17  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCap17 - 10"	ResHVACSys:HPSysCap17	= {	if (NumHtPumpSystemTypes > 9 .AND. HPSysAutoSize = 0 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:Cap17 ) > 0) then  HPSysCap17 + (HtPumpSystem[10]:Cap17 * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCOP47 - 1"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP47  > 0 )) then                   HtPumpSystem[1]:COP47     else      0      endif  }
	"Set ResHVACSys:HPSysCOP47 - 2"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[2]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 3"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[3]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 4"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[4]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 5"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[5]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 6"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[6]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 7"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[7]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 8"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[8]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 9"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP47  > 0 )) then  min( HPSysCOP47, HtPumpSystem[9]:COP47  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 10"	ResHVACSys:HPSysCOP47	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP47 > 0 )) then  min( HPSysCOP47, HtPumpSystem[10]:COP47 )  else  UNCHANGED  endif  }
   "Hardwire ResHVACSys:HPSysCOP47 for Packaged HP systems"    ResHVACSys:HPSysCOP47 =       ; SAC 08/18/20 (tic #1003)
      {  if (IfValidAnd( HtPumpSysTypeAbbrev = "PkgTermHeatPump"    ) .OR.
             IfValidAnd( HtPumpSysTypeAbbrev = "SglPkgVertHeatPump" ))
         then  T24RHeatingEquipment:COP47( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
         else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCOP35 - 1"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP35  > 0 )) then                   HtPumpSystem[1]:COP35     else      0      endif  }
	"Set ResHVACSys:HPSysCOP35 - 2"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[2]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 3"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[3]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 4"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[4]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 5"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[5]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 6"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[6]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 7"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[7]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 8"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[8]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 9"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP35  > 0 )) then  min( HPSysCOP35, HtPumpSystem[9]:COP35  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP35 - 10"	ResHVACSys:HPSysCOP35	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP35 > 0 )) then  min( HPSysCOP35, HtPumpSystem[10]:COP35 )  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCOP17 - 1"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:COP17  > 0 )) then                   HtPumpSystem[1]:COP17     else      0      endif  }
	"Set ResHVACSys:HPSysCOP17 - 2"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[2]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 3"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[3]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 4"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[4]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 5"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[5]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 6"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[6]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 7"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[7]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 8"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[8]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 9"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:COP17  > 0 )) then  min( HPSysCOP17, HtPumpSystem[9]:COP17  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP17 - 10"	ResHVACSys:HPSysCOP17	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:COP17 > 0 )) then  min( HPSysCOP17, HtPumpSystem[10]:COP17 )  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysAuxHtgCap - 1"		ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:AuxHtgCap  ) > 0) then                   (HtPumpSystem[1]:AuxHtgCap  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 2"		ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[2]:AuxHtgCap  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 3" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[3]:AuxHtgCap  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 4" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[4]:AuxHtgCap  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 5" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[5]:AuxHtgCap  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 6" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[6]:AuxHtgCap  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 7" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[7]:AuxHtgCap  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 8" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[8]:AuxHtgCap  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 9" 	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:AuxHtgCap  ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[9]:AuxHtgCap  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysAuxHtgCap - 10"	ResHVACSys:HPSysAuxHtgCap	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:AuxHtgCap ) > 0) then  HPSysAuxHtgCap + (HtPumpSystem[10]:AuxHtgCap * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysVCHPFanPwr - 1"	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. LocalStatus( HtPumpSystem[1]:VCHPFanPower  ) > 0) then                    (HtPumpSystem[1]:VCHPFanPower  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 2"	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. LocalStatus( HtPumpSystem[2]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[2]:VCHPFanPower  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 3" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. LocalStatus( HtPumpSystem[3]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[3]:VCHPFanPower  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 4" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. LocalStatus( HtPumpSystem[4]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[4]:VCHPFanPower  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 5" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. LocalStatus( HtPumpSystem[5]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[5]:VCHPFanPower  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 6" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. LocalStatus( HtPumpSystem[6]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[6]:VCHPFanPower  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 7" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. LocalStatus( HtPumpSystem[7]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[7]:VCHPFanPower  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 8" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. LocalStatus( HtPumpSystem[8]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[8]:VCHPFanPower  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 9" 	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. LocalStatus( HtPumpSystem[9]:VCHPFanPower  ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[9]:VCHPFanPower  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysVCHPFanPwr - 10"	ResHVACSys:HPSysVCHPFanPwr	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. LocalStatus( HtPumpSystem[10]:VCHPFanPower ) > 0) then  HPSysVCHPFanPwr + (HtPumpSystem[10]:VCHPFanPower * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPModelDualFuel - 1"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 )) then  1  else      0      endif  }  ; SAC 12/08/20
	"Set ResHVACSys:HPModelDualFuel - 2"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 3"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 4"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 5"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 6"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 7"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 8"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 9"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPModelDualFuel - 10"	ResHVACSys:HPModelDualFuel = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPDFAFUE - 1"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:AFUE > 0 ))        then  HtPumpSystem[1]:AFUE  else     101     endif  }
	"Set ResHVACSys:HPDFAFUE - 2"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:AFUE < HPDFAFUE )) then  HtPumpSystem[2]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 3"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:AFUE < HPDFAFUE )) then  HtPumpSystem[3]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 4"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:AFUE < HPDFAFUE )) then  HtPumpSystem[4]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 5"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:AFUE < HPDFAFUE )) then  HtPumpSystem[5]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 6"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:AFUE < HPDFAFUE )) then  HtPumpSystem[6]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 7"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:AFUE < HPDFAFUE )) then  HtPumpSystem[7]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 8"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:AFUE < HPDFAFUE )) then  HtPumpSystem[8]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 9"	   ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:AFUE < HPDFAFUE )) then  HtPumpSystem[9]:AFUE  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPDFAFUE - 10"	ResHVACSys:HPDFAFUE  = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[10]AFUE < HPDFAFUE )) then  HtPumpSystem[10]AFUE  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPLockoutTemp - 1"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[1]:HPLockoutTemp > -999 ))          then  HtPumpSystem[1]:HPLockoutTemp  else    -999     endif  }
	"Set ResHVACSys:HPLockoutTemp - 2"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 1 .AND. IfValidAnd( HtPumpSystem[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[2]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[2]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 3"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 2 .AND. IfValidAnd( HtPumpSystem[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[3]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[3]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 4"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 3 .AND. IfValidAnd( HtPumpSystem[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[4]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[4]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 5"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 4 .AND. IfValidAnd( HtPumpSystem[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[5]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[5]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 6"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 5 .AND. IfValidAnd( HtPumpSystem[6]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[6]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[6]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 7"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 6 .AND. IfValidAnd( HtPumpSystem[7]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[7]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[7]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 8"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 7 .AND. IfValidAnd( HtPumpSystem[8]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[8]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[8]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 9"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 8 .AND. IfValidAnd( HtPumpSystem[9]:ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[9]:HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[9]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPLockoutTemp - 10"	   ResHVACSys:HPLockoutTemp  = {	if (NumHtPumpSystemTypes > 9 .AND. IfValidAnd( HtPumpSystem[10]ModelDualFuel > 0 ) .AND. IfValidAnd( HtPumpSystem[10]HasHPLockout > 0 ) .AND. IfValidAnd( HtPumpSystem[10]HPLockoutTemp > HPLockoutTemp )) then  HtPumpSystem[10]HPLockoutTemp  else  UNCHANGED  endif  }

   "Set ResHVACSys:LrgHtPumpStdFanPwr"    ResHVACSys:LrgHtPumpStdFanPwr =        ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status == 3) .AND. 
             IfValidAnd( HtPumpDucted > 0 ) .AND. LocalCompAssigned( Fan ) > 0.5 .AND.
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 0.5 .AND.
             IfValidAnd( Proj:AnalysisVersion >= 220000 ) .AND. HPSysAutoSize == 0 .AND. HPSysMinCap47 >= 54000)
         then  0.58
         else  0  endif endif  }
   "Set ResHVACSys:PropHtPumpAutoSz"      ResHVACSys:PropHtPumpAutoSz  =         ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (HPSysAutoSize > 0) then  1  else  0  endif endif  }

   "Set ResHVACSys:HPSysHSPF2perHSPF"     ResHVACSys:HPSysHSPF2perHSPF     = {	if (EffMetric < 2 .OR. T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 1) then  0
                                                                                 else  T24RHeatingEquipment:HSPF2perHSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  endif  }      ; SAC 10/06/22

   "Set ResHVACSys:EffMetricLbls[3] - HSPF"     ResHVACSys:EffMetricLbls[3] = {  if (EffMetric = 1) then  "HSPF"     else  "HSPF2"     endif  }    ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:EffMetricVals[3] - HSPF"     ResHVACSys:EffMetricVals[3] = {  if (EffMetric = 1) then  HPSysHSPF  else  HPSysHSPF2  endif  }

   ; SAC 6/22/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
	"Set ResHVACSys:HeatEquipSummary"	ResHVACSys:HeatEquipSummary	=     ; added dual fuel (DF) indicators - SAC 12/08/20
				{	if (NumHtPumpSystemTypes <= 0) then  " "
					else if (NumHtPumpSysUnits < 1) then  "No heat pump equipment units (counts) defined"
					else if (LocalCompAssigned( HtPumpSystem[1] ) == 0) then  "Heat pump equipment assignment #1 not defined"
					else if (HtPumpSystem[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s, Cap@17 %s", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysHSPF, FltToStr( HPSysCap47 ), FltToStr( HPSysCap17 ) )
					then	if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ))
					      then  if (HtPumpSystem[1]:Type == 7)
      							then	Format( "%.0f %s unit(s), auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev )
		      					else if (HtPumpSystem[1]:Type == 11 .OR. HtPumpSystem[1]:Type == 26 .OR. HtPumpSystem[1]:Type == 24)
      							then	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), @47: COP %.1f, auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47 )
                                 else  Format( "%.0f %s unit(s), @47: COP %.1f, auto-sized",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47 )
                                 endif
		      					else	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), %s %.1f, auto-sized", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, EffMetricLbls[3], EffMetricVals[3] )
                                 else  Format( "%.0f %s unit(s), %s %.1f, auto-sized",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, EffMetricLbls[3], EffMetricVals[3] )
                                 endif
				      			endif endif
					      else  if (HtPumpSystem[1]:Type == 7)
      							then	Format( "%.0f %s unit(s), @47: Cap %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, FltToStr( HPSysCap47 ) )
      							else if (HtPumpSystem[1]:Type == 11 .OR. HtPumpSystem[1]:Type == 26 .OR. HtPumpSystem[1]:Type == 24)
      							then	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), @47: COP %.1f, Cap %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47, FltToStr( HPSysCap47 ) )
                                 else  Format( "%.0f %s unit(s), @47: COP %.1f, Cap %s Btuh",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, HPSysCOP47, FltToStr( HPSysCap47 ) )
                                 endif
      							else if (HtPumpSystem[1]:Type == 22)   ; SAC 11/2/18 - VCHP  - SAC 11/13/18 - removed Cap17 reporting
      							then	Format( "%.0f %s unit(s), Cap@47 %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, FltToStr( HPSysCap47 ) )
		      					else	if (HPModelDualFuel > 0)
                                 then  Format( "%.0f DF %s unit(s), %s %.1f, Cap@47 %s Btuh", NumHtPumpSysUnits, HtPumpSysTypeAbbrev, EffMetricLbls[3], EffMetricVals[3], FltToStr( HPSysCap47 ) )
                                 else  Format( "%.0f %s unit(s), %s %.1f, Cap@47 %s Btuh",    NumHtPumpSysUnits, HtPumpSysTypeAbbrev, EffMetricLbls[3], EffMetricVals[3], FltToStr( HPSysCap47 ) )
                                 endif
				      			endif endif endif  endif
					else	Format( "%.0f %s unit(s),  ?? efficiency ??", NumHtPumpSysUnits, HtPumpSysTypeAbbrev )
					endif endif endif endif  }
;	"debug ResHVACSys:HeatEquipSummary"		ResHVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "ResHVACSys: '%s' HeatEquipSummary: '%s'", Name, HeatEquipSummary ) else UNCHANGED endif }

  ; More HVACSys cooling equipment summarization

   "Set ResHVACSys:ClSysSEER - 1"                       ResHVACSys:ClSysSEER  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:SEER > 0 )) then                  HtPumpSystem[ 1  ]:SEER     else      0      endif  }
   "Set ResHVACSys:ClSysSEER - 2-10"  for:#Eqp=(1to10)  ResHVACSys:ClSysSEER  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:SEER > 0 )) then  min( ClSysSEER, HtPumpSystem[#Eqp]:SEER  )  else  UNCHANGED  endif  }

   "Set ResHVACSys:ClSysSEER2 - 1"                       ResHVACSys:ClSysSEER2  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:SEER2 > 0 )) then                   HtPumpSystem[ 1  ]:SEER2     else      0      endif  }   ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:ClSysSEER2 - 2-10"  for:#Eqp=(1to10)  ResHVACSys:ClSysSEER2  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:SEER2 > 0 )) then  min( ClSysSEER2, HtPumpSystem[#Eqp]:SEER2  )  else  UNCHANGED  endif  }

   "Set ResHVACSys:ClSysEER - 1"                       ResHVACSys:ClSysEER  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:EER > 0 )) then                 HtPumpSystem[ 1  ]:EER     else      0      endif  }
   "Set ResHVACSys:ClSysEER - 2-10"  for:#Eqp=(1to10)  ResHVACSys:ClSysEER  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 1 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:EER > 0 )) then  min( ClSysEER, HtPumpSystem[#Eqp]:EER  )  else  UNCHANGED  endif  }

   "Set ResHVACSys:ClSysEER2 - 1"                       ResHVACSys:ClSysEER2  = {  if (NumHtPumpSystemTypes > 0     .AND. IfValidAnd( HtPumpSystem[ 1  ]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[ 1  ]:EER2 > 0 )) then                  HtPumpSystem[ 1  ]:EER2     else      0      endif  }   ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:ClSysEER2 - 2-10"  for:#Eqp=(1to10)  ResHVACSys:ClSysEER2  = {  if (NumHtPumpSystemTypes >= #Eqp .AND. IfValidAnd( HtPumpSystem[#Eqp]:EffMetric = 2 ) .AND. IfValidAnd( HtPumpSystem[#Eqp]:EER2 > 0 )) then  min( ClSysEER2, HtPumpSystem[#Eqp]:EER2  )  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysCFMperTon - 1"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:CFMperTon  > 0 )) then                       HtPumpSystem[1]:CFMperTon     else      0      endif  }
	"Set ResHVACSys:ClSysCFMperTon - 2"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 3"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 4"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 5"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[5]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 6"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[6]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 7"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[7]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 8"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[8]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 9"		ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:CFMperTon  > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[9]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCFMperTon - 10"	ResHVACSys:ClSysCFMperTon	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:CFMperTon > 0 )) then  min( ClSysCFMperTon, HtPumpSystem[10]:CFMperTon )  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 1"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. IfValidAnd( HtPumpSystem[1]:RefrigChgAdjFctr  > 0 )) then                              HtPumpSystem[1]:RefrigChgAdjFctr     else      0      endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 2"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. IfValidAnd( HtPumpSystem[2]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 3"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. IfValidAnd( HtPumpSystem[3]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 4"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. IfValidAnd( HtPumpSystem[4]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 5"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. IfValidAnd( HtPumpSystem[5]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 6"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. IfValidAnd( HtPumpSystem[6]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[6]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 7"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. IfValidAnd( HtPumpSystem[7]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[7]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 8"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. IfValidAnd( HtPumpSystem[8]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[8]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 9"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. IfValidAnd( HtPumpSystem[9]:RefrigChgAdjFctr  > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[9]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 10"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. IfValidAnd( HtPumpSystem[10]:RefrigChgAdjFctr > 0 )) then  min( ClSysRefrigChgAdjFctr, HtPumpSystem[10]:RefrigChgAdjFctr )  else  UNCHANGED  endif  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set ResHVACSys:ClSysSizingFactor - 1"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. HtPumpSystemCount[1]  > 0 .AND. IfValidAnd( HtPumpSystem[1]:ClSizingFactor  > 0 )) then                      (HtPumpSystem[1]:ClSizingFactor  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:ClSysSizingFactor - 2"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. HtPumpSystemCount[2]  > 0 .AND. IfValidAnd( HtPumpSystem[2]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[2]:ClSizingFactor  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 3"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. HtPumpSystemCount[3]  > 0 .AND. IfValidAnd( HtPumpSystem[3]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[3]:ClSizingFactor  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 4"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. HtPumpSystemCount[4]  > 0 .AND. IfValidAnd( HtPumpSystem[4]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[4]:ClSizingFactor  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 5"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. HtPumpSystemCount[5]  > 0 .AND. IfValidAnd( HtPumpSystem[5]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[5]:ClSizingFactor  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 6"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. HtPumpSystemCount[6]  > 0 .AND. IfValidAnd( HtPumpSystem[6]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[6]:ClSizingFactor  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 7"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. HtPumpSystemCount[7]  > 0 .AND. IfValidAnd( HtPumpSystem[7]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[7]:ClSizingFactor  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 8"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. HtPumpSystemCount[8]  > 0 .AND. IfValidAnd( HtPumpSystem[8]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[8]:ClSizingFactor  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 9"		ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. HtPumpSystemCount[9]  > 0 .AND. IfValidAnd( HtPumpSystem[9]:ClSizingFactor  > 0 )) then  ClSysSizingFactor + (HtPumpSystem[9]:ClSizingFactor  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 10"	ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. HtPumpSystemCount[10] > 0 .AND. IfValidAnd( HtPumpSystem[10]:ClSizingFactor > 0 )) then  ClSysSizingFactor + (HtPumpSystem[10]:ClSizingFactor * HtPumpSystemCount[10])  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - XX"	ResHVACSys:ClSysSizingFactor	= {	if (NumHtPumpSysUnits > 0.5) then  ClSysSizingFactor / NumHtPumpSysUnits  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) .AND. HtPumpSystemCount[1]  > 0 .AND. IfValidAnd( HtPumpSystem[1]:TotalCapacity  > 0 )) then                  (HtPumpSystem[1]:TotalCapacity  * HtPumpSystemCount[1] )  else      0      endif  }
	"Set ResHVACSys:ClSysCapacity - 2"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) .AND. HtPumpSystemCount[2]  > 0 .AND. IfValidAnd( HtPumpSystem[2]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[2]:TotalCapacity  * HtPumpSystemCount[2] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 3" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) .AND. HtPumpSystemCount[3]  > 0 .AND. IfValidAnd( HtPumpSystem[3]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[3]:TotalCapacity  * HtPumpSystemCount[3] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 4" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) .AND. HtPumpSystemCount[4]  > 0 .AND. IfValidAnd( HtPumpSystem[4]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[4]:TotalCapacity  * HtPumpSystemCount[4] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 5" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) .AND. HtPumpSystemCount[5]  > 0 .AND. IfValidAnd( HtPumpSystem[5]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[5]:TotalCapacity  * HtPumpSystemCount[5] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 6" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[6]  == 0 .AND. NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) .AND. HtPumpSystemCount[6]  > 0 .AND. IfValidAnd( HtPumpSystem[6]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[6]:TotalCapacity  * HtPumpSystemCount[6] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 7" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[7]  == 0 .AND. NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) .AND. HtPumpSystemCount[7]  > 0 .AND. IfValidAnd( HtPumpSystem[7]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[7]:TotalCapacity  * HtPumpSystemCount[7] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 8" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[8]  == 0 .AND. NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) .AND. HtPumpSystemCount[8]  > 0 .AND. IfValidAnd( HtPumpSystem[8]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[8]:TotalCapacity  * HtPumpSystemCount[8] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 9" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[9]  == 0 .AND. NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) .AND. HtPumpSystemCount[9]  > 0 .AND. IfValidAnd( HtPumpSystem[9]:TotalCapacity  > 0 )) then  ClSysCapacity + (HtPumpSystem[9]:TotalCapacity  * HtPumpSystemCount[9] )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysCapacity - 10"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[10] == 0 .AND. NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) .AND. HtPumpSystemCount[10] > 0 .AND. IfValidAnd( HtPumpSystem[10]:TotalCapacity > 0 )) then  ClSysCapacity + (HtPumpSystem[10]:TotalCapacity * HtPumpSystemCount[10])  else  UNCHANGED  endif  }

   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER     =              ; SAC 10/06/22 (tic #3431)   ; fix for when HtPumpSysTypeAbbrev invalid - SAC 10/10/22
                                                   {  if (EffMetric < 2 .OR. NumHtPumpSystemTypes < 1 .OR. LocalCompAssigned( HtPumpSystem[1] )==0) then  0
                                                      else if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"       ResHVACSys:ClSysEER2perEER       =  
                                                   {  if (EffMetric < 2 .OR. NumHtPumpSystemTypes < 1 .OR. LocalCompAssigned( HtPumpSystem[1] )==0) then  0
                                                      else if (T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  endif endif  }

   "Set ResHVACSys:EffMetricLbls[1] - SEER"     ResHVACSys:EffMetricLbls[1] = {  if (EffMetric = 1) then  "SEER"  else  "SEER2"  endif  }    ; SAC 10/06/22 (tic #3431)
   "Set ResHVACSys:EffMetricLbls[2] - EER"      ResHVACSys:EffMetricLbls[2] = {  if (EffMetric = 1) then   "EER"  else   "EER2"  endif  }
   "Set ResHVACSys:EffMetricVals[1] - SEER"     ResHVACSys:EffMetricVals[1] = {  if (EffMetric = 1) then  ClSysSEER  else  ClSysSEER2  endif  }
   "Set ResHVACSys:EffMetricVals[2] - EER"      ResHVACSys:EffMetricVals[2] = {  if (EffMetric = 1) then  ClSysEER   else  ClSysEER2   endif  }

	"Set ResHVACSys:CoolEquipSummary"	ResHVACSys:CoolEquipSummary	=        ; SAC 6/22/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpSystemTypes <= 0 .OR. NumHtPumpSysUnits < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  " "
					else if (HtPumpSystem[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolSysUnits, CoolSysTypeAbbrev, ClSysSEER, ClSysEER, ClSysCFMperTon )
					then	if (HtPumpSystem[1]:Type == 22 .OR. HtPumpSystem[1]:Type == 33)   ; SAC 11/2/18 - VCHP   ; VCHP2 - SAC 11/01/20
  							then  " "
							else if (IfValidAnd( HtPumpSystem[1]:ShowCEER > 0 ))
							then	Format( "%.1f CEER", HtPumpSystem[1]:CEER )
							else if (HtPumpSystem[1]:Type == 11 .OR. IfValidAnd( HtPumpSystem[1]:Show4717COPs > 0 ))
							then	Format( "%.1f %s", EffMetricVals[2], EffMetricLbls[2] )
  							else 	Format( "%.1f %s, %.1f %s, %.0f CFM/ton", EffMetricVals[1], EffMetricLbls[1], EffMetricVals[2], EffMetricLbls[2], ClSysCFMperTon )
							endif endif endif
					else	" "
					endif endif  }
;	"debug ResHVACSys:CoolEquipSummary"		ResHVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "ResHVACSys: '%s' CoolEquipSummary: '%s'", Name, CoolEquipSummary ) else UNCHANGED endif }

	"Set ResHVACSys:HtPumpEquipIssue"		ResHVACSys:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (NumHtPumpSystemTypes <= 0) then  " "
					else if (NumHtPumpSystemTypes > 0 .AND. LocalCompAssigned( HtPumpSystem[1]  ) == 0) then  "All heat pump equipment assignments must be specified (first is excluded)"
					else if (NumHtPumpSystemTypes > 1 .AND. LocalCompAssigned( HtPumpSystem[2]  ) == 0) then  "All heat pump equipment assignments must be specified (second is excluded)"
					else if (NumHtPumpSystemTypes > 2 .AND. LocalCompAssigned( HtPumpSystem[3]  ) == 0) then  "All heat pump equipment assignments must be specified (third is excluded)"
					else if (NumHtPumpSystemTypes > 3 .AND. LocalCompAssigned( HtPumpSystem[4]  ) == 0) then  "All heat pump equipment assignments must be specified (fourth is excluded)"
					else if (NumHtPumpSystemTypes > 4 .AND. LocalCompAssigned( HtPumpSystem[5]  ) == 0) then  "All heat pump equipment assignments must be specified (fifth is excluded)"
					else if (NumHtPumpSystemTypes > 5 .AND. LocalCompAssigned( HtPumpSystem[6]  ) == 0) then  "All heat pump equipment assignments must be specified (sixth is excluded)"
					else if (NumHtPumpSystemTypes > 6 .AND. LocalCompAssigned( HtPumpSystem[7]  ) == 0) then  "All heat pump equipment assignments must be specified (seventh is excluded)"
					else if (NumHtPumpSystemTypes > 7 .AND. LocalCompAssigned( HtPumpSystem[8]  ) == 0) then  "All heat pump equipment assignments must be specified (eighth is excluded)"
					else if (NumHtPumpSystemTypes > 8 .AND. LocalCompAssigned( HtPumpSystem[9]  ) == 0) then  "All heat pump equipment assignments must be specified (ninth is excluded)"
					else if (NumHtPumpSystemTypes > 9 .AND. LocalCompAssigned( HtPumpSystem[10] ) == 0) then  "All heat pump equipment assignments must be specified (tenth is excluded)"
					else if (NumHtPumpSystemTypes > 1 .AND. HtPumpSystem[2]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #2: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[2]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 2 .AND. HtPumpSystem[3]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #3: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[3]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 3 .AND. HtPumpSystem[4]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #4: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[4]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 4 .AND. HtPumpSystem[5]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #5: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[5]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 5 .AND. HtPumpSystem[6]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #6: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[6]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 6 .AND. HtPumpSystem[7]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #7: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[7]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 7 .AND. HtPumpSystem[8]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #8: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[8]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 8 .AND. HtPumpSystem[9]:Type  != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #9: %s)",  HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[9]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 9 .AND. HtPumpSystem[10]:Type != HtPumpSystem[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #10: %s)", HtPumpSystem[1]:TypeAbbrevStr, HtPumpSystem[10]:TypeAbbrevStr )
					else if (NumHtPumpSystemTypes > 1 .AND. HtPumpSystem[2]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #2 inconsistent)"
					else if (NumHtPumpSystemTypes > 2 .AND. HtPumpSystem[3]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #3 inconsistent)"
					else if (NumHtPumpSystemTypes > 3 .AND. HtPumpSystem[4]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #4 inconsistent)"
					else if (NumHtPumpSystemTypes > 4 .AND. HtPumpSystem[5]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #5 inconsistent)"
					else if (NumHtPumpSystemTypes > 5 .AND. HtPumpSystem[6]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #6 inconsistent)"
					else if (NumHtPumpSystemTypes > 6 .AND. HtPumpSystem[7]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #7 inconsistent)"
					else if (NumHtPumpSystemTypes > 7 .AND. HtPumpSystem[8]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #8 inconsistent)"
					else if (NumHtPumpSystemTypes > 8 .AND. HtPumpSystem[9]:AutoSize  != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #9 inconsistent)"
					else if (NumHtPumpSystemTypes > 9 .AND. HtPumpSystem[10]:AutoSize != HtPumpSystem[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #10 inconsistent)"
					else  " "  endif endif endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  }

; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Default ResHVACSys:ConstHtgSetpt"		ResHVACSys:ConstHtgSetpt	= {	if (strlen( HtPumpSysTypeAbbrev ) < 2) then  -1
																							else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  endif  }
	"Init ResHVACSys:ConstClgSetpt"			ResHVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set ResHVACSys:EqpCountsMustAlign"		ResHVACSys:EqpCountsMustAlign	= {	0  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set ResHVACSys:ZonalSysBypassDuct"		ResHVACSys:ZonalSysBypassDuct	= {
								if (FloorAreaServed[1] < 1 .OR. (HeatDucted < 0.5 .AND. CoolDucted < 0.5) .OR. LocalCompAssigned( DistribSystem ) < 1) then  0
								else if (IfValidAnd( DistribSystem:HasBypassDuct > 0.5 )==0 .OR. IfValidAnd( DistribSystem:DuctsPresent > 0.5 )==0) then  0
								else if (NumHtPumpSystemTypes >=  1 .AND. IfValidAnd( HtPumpSystem[1]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[1]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  2 .AND. IfValidAnd( HtPumpSystem[2]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[2]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  3 .AND. IfValidAnd( HtPumpSystem[3]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[3]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  4 .AND. IfValidAnd( HtPumpSystem[4]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[4]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  5 .AND. IfValidAnd( HtPumpSystem[5]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[5]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  6 .AND. IfValidAnd( HtPumpSystem[6]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[6]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  7 .AND. IfValidAnd( HtPumpSystem[7]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[7]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  8 .AND. IfValidAnd( HtPumpSystem[8]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[8]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >=  9 .AND. IfValidAnd( HtPumpSystem[9]:IsZonal  > 0.5 ) .AND. IfValidAnd( HtPumpSystem[9]:ShowIsZonal  > 0.5 )) then  1
								else if (NumHtPumpSystemTypes >= 10 .AND. IfValidAnd( HtPumpSystem[10]:IsZonal > 0.5 ) .AND. IfValidAnd( HtPumpSystem[10]:ShowIsZonal > 0.5 )) then  1
								else	0  endif endif endif endif endif endif endif endif endif endif endif endif  }

	"Init ResHVACSys:HeatDuctedEditable"	ResHVACSys:HeatDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	UNDEFINED  }
	"Init ResHVACSys:HtSysSizingFactor"		ResHVACSys:HtSysSizingFactor	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysCapacity"			ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Init ResHVACSys:HeatEquipIssue"			ResHVACSys:HeatEquipIssue		= {	UNDEFINED  }
	"Init ResHVACSys:CoolDuctedEditable"	ResHVACSys:CoolDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:CoolEquipIssue"			ResHVACSys:CoolEquipIssue		= {	UNDEFINED  }

	"Initialize other generic properties (common to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END

;************************************************************************* JP 11/03/22
RULELIST "SetupHVACSys_Round2_CentralHtgClg_FPFC" 0 0 0 0
;*************************************************************************
	"Set ResHVACSys:CentralEqpTypeTypeAbbrev"	ResHVACSys:CentralEqpTypeAbbrev	=
      {  if (LocalStatus( NumCentralEquipTypes ) < 1) then  UNDEFINED
         else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
               then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
                     then  UNCHANGED
                     else if (HtOrClDucted < 0.5)
                     then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" )
                     else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" )
                     endif endif
               else  HVACCentralRef[1]:TypeAbbrevStr
               endif
         else  " "  endif endif  }

// TO DO -review duct setting
	"Default ResHVACSys:HeatDuctedEditable"	ResHVACSys:HeatDuctedEditable		= {	0 }

	"Force reset of HeatDucted if needed"	ResHVACSys:Action						= { UNCHANGED }

	"Default ResHVACSys:HeatDucted"				ResHVACSys:HeatDucted				= {	1 }

  "Set ResHVACSys:HtSysSizingFactor" ResHVACSys:HtSysSizingFactor = { if( LocalCompAssigned( HVACCentralRef[1] ) > 0 ) then HVACCentralRef[1]:HtgSizingFactor else 0 endif }
;	"Set ResHVACSys:HtSysSizingFactor - 1"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. CentralEquipCount[1]  > 0) then                      (HVACCentralRef[1]:HtgSizingFactor  * CentralEquipCount[1] )  else      0      endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 2"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. CentralEquipCount[2]  > 0) then  HtSysSizingFactor + (HVACCentralRef[2]:HtgSizingFactor  * CentralEquipCount[2] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 3"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. CentralEquipCount[3]  > 0) then  HtSysSizingFactor + (HVACCentralRef[3]:HtgSizingFactor  * CentralEquipCount[3] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 4"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. CentralEquipCount[4]  > 0) then  HtSysSizingFactor + (HVACCentralRef[4]:HtgSizingFactor  * CentralEquipCount[4] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 5"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. CentralEquipCount[5]  > 0) then  HtSysSizingFactor + (HVACCentralRef[5]:HtgSizingFactor  * CentralEquipCount[5] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 6"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. CentralEquipCount[6]  > 0) then  HtSysSizingFactor + (HVACCentralRef[6]:HtgSizingFactor  * CentralEquipCount[6] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 7"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. CentralEquipCount[7]  > 0) then  HtSysSizingFactor + (HVACCentralRef[7]:HtgSizingFactor  * CentralEquipCount[7] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 8"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. CentralEquipCount[8]  > 0) then  HtSysSizingFactor + (HVACCentralRef[8]:HtgSizingFactor  * CentralEquipCount[8] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 9"		ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. CentralEquipCount[9]  > 0) then  HtSysSizingFactor + (HVACCentralRef[9]:HtgSizingFactor  * CentralEquipCount[9] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - 10"	ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. CentralEquipCount[10] > 0) then  HtSysSizingFactor + (HVACCentralRef[10]:HtgSizingFactor * CentralEquipCount[10])  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysSizingFactor - XX"	ResHVACSys:HtSysSizingFactor	= {	if (NumCentralEqpUnits > 0.5) then  HtSysSizingFactor / NumCentralEqpUnits  else  UNCHANGED  endif  }
  "Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity	= { 0 }
;	"Set ResHVACSys:HtSysCapacity - 1"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[1]  == 0 .AND. NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. CentralEquipCount[1]  > 0 .AND. IfValidAnd( HVACCentralRef[1]:HtgCapTotNetRtd  > 0 )) then                  (HVACCentralRef[1]:HtgCapTotNetRtd  * CentralEquipCount[1] )  else      0      endif  }
;	"Set ResHVACSys:HtSysCapacity - 2"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[2]  == 0 .AND. NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. CentralEquipCount[2]  > 0 .AND. IfValidAnd( HVACCentralRef[2]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[2]:HtgCapTotNetRtd  * CentralEquipCount[2] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 3" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[3]  == 0 .AND. NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. CentralEquipCount[3]  > 0 .AND. IfValidAnd( HVACCentralRef[3]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[3]:HtgCapTotNetRtd  * CentralEquipCount[3] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 4" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[4]  == 0 .AND. NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. CentralEquipCount[4]  > 0 .AND. IfValidAnd( HVACCentralRef[4]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[4]:HtgCapTotNetRtd  * CentralEquipCount[4] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 5" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[5]  == 0 .AND. NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. CentralEquipCount[5]  > 0 .AND. IfValidAnd( HVACCentralRef[5]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[5]:HtgCapTotNetRtd  * CentralEquipCount[5] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 6" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[6]  == 0 .AND. NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. CentralEquipCount[6]  > 0 .AND. IfValidAnd( HVACCentralRef[6]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[6]:HtgCapTotNetRtd  * CentralEquipCount[6] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 7" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[7]  == 0 .AND. NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. CentralEquipCount[7]  > 0 .AND. IfValidAnd( HVACCentralRef[7]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[7]:HtgCapTotNetRtd  * CentralEquipCount[7] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 8" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[8]  == 0 .AND. NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. CentralEquipCount[8]  > 0 .AND. IfValidAnd( HVACCentralRef[8]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[8]:HtgCapTotNetRtd  * CentralEquipCount[8] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 9" 		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[9]  == 0 .AND. NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. CentralEquipCount[9]  > 0 .AND. IfValidAnd( HVACCentralRef[9]:HtgCapTotNetRtd  > 0 )) then  HtSysCapacity + (HVACCentralRef[9]:HtgCapTotNetRtd  * CentralEquipCount[9] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:HtSysCapacity - 10"		ResHVACSys:HtSysCapacity	= {	if (AutoSizeHeat[10] == 0 .AND. NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. CentralEquipCount[10] > 0 .AND. IfValidAnd( HVACCentralRef[10]:HtgCapTotNetRtd > 0 )) then  HtSysCapacity + (HVACCentralRef[10]:HtgCapTotNetRtd * CentralEquipCount[10])  else  UNCHANGED  endif  }

	"Default ResHVACSys:CoolDuctedEditable"	ResHVACSys:CoolDuctedEditable		= {	HeatDuctedEditable }

	"Force reset of CoolDucted if needed"	ResHVACSys:Action						= {	UNCHANGED }

	"Default ResHVACSys:CoolDucted"				ResHVACSys:CoolDucted				= {	HeatDucted }

	"Set ResHVACSys:ClSysCFMperTon - 1"		ResHVACSys:ClSysCFMperTon	= {	350 }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 1"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	0 }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

  "Set ResHVACSys:ClSysSizingFactor"		ResHVACSys:ClSysSizingFactor	= {	if( LocalCompAssigned( HVACCentralRef[1] ) > 0 ) then HVACCentralRef[1]:ClgSizingFactor else 0 endif }
;	"Set ResHVACSys:ClSysSizingFactor - 1"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. CentralEquipCount[1]  > 0) then                      (HVACCentralRef[1]:ClgSizingFactor  * CentralEquipCount[1] )  else      0      endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 2"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. CentralEquipCount[2]  > 0) then  ClSysSizingFactor + (HVACCentralRef[2]:ClgSizingFactor  * CentralEquipCount[2] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 3"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. CentralEquipCount[3]  > 0) then  ClSysSizingFactor + (HVACCentralRef[3]:ClgSizingFactor  * CentralEquipCount[3] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 4"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. CentralEquipCount[4]  > 0) then  ClSysSizingFactor + (HVACCentralRef[4]:ClgSizingFactor  * CentralEquipCount[4] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 5"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. CentralEquipCount[5]  > 0) then  ClSysSizingFactor + (HVACCentralRef[5]:ClgSizingFactor  * CentralEquipCount[5] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 6"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. CentralEquipCount[6]  > 0) then  ClSysSizingFactor + (HVACCentralRef[6]:ClgSizingFactor  * CentralEquipCount[6] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 7"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. CentralEquipCount[7]  > 0) then  ClSysSizingFactor + (HVACCentralRef[7]:ClgSizingFactor  * CentralEquipCount[7] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 8"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. CentralEquipCount[8]  > 0) then  ClSysSizingFactor + (HVACCentralRef[8]:ClgSizingFactor  * CentralEquipCount[8] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 9"		ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. CentralEquipCount[9]  > 0) then  ClSysSizingFactor + (HVACCentralRef[9]:ClgSizingFactor  * CentralEquipCount[9] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - 10"	ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. CentralEquipCount[10] > 0) then  ClSysSizingFactor + (HVACCentralRef[10]:ClgSizingFactor * CentralEquipCount[10])  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysSizingFactor - XX"	ResHVACSys:ClSysSizingFactor	= {	if (NumCentralEqpUnits > 0.5) then  ClSysSizingFactor / NumCentralEqpUnits  else  UNCHANGED  endif  }
  "Set ResHVACSys:ClSysCapacity"		ResHVACSys:ClSysCapacity	= { 0 }
;	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. CentralEquipCount[1]  > 0) then                  (HVACCentralRef[1]:HtgCapTotNetRtd  * CentralEquipCount[1] )  else      0      endif  }
;	"Set ResHVACSys:ClSysCapacity - 2"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. CentralEquipCount[2]  > 0) then  ClSysCapacity + (HVACCentralRef[2]:ClgCapTotNetRtd  * CentralEquipCount[2] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 3" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. CentralEquipCount[3]  > 0) then  ClSysCapacity + (HVACCentralRef[3]:ClgCapTotNetRtd  * CentralEquipCount[3] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 4" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. CentralEquipCount[4]  > 0) then  ClSysCapacity + (HVACCentralRef[4]:ClgCapTotNetRtd  * CentralEquipCount[4] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 5" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. CentralEquipCount[5]  > 0) then  ClSysCapacity + (HVACCentralRef[5]:ClgCapTotNetRtd  * CentralEquipCount[5] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 6" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[6]  == 0 .AND. NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. CentralEquipCount[6]  > 0) then  ClSysCapacity + (HVACCentralRef[6]:ClgCapTotNetRtd  * CentralEquipCount[6] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 7" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[7]  == 0 .AND. NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. CentralEquipCount[7]  > 0) then  ClSysCapacity + (HVACCentralRef[7]:ClgCapTotNetRtd  * CentralEquipCount[7] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 8" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[8]  == 0 .AND. NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. CentralEquipCount[8]  > 0) then  ClSysCapacity + (HVACCentralRef[8]:ClgCapTotNetRtd  * CentralEquipCount[8] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 9" 		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[9]  == 0 .AND. NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. CentralEquipCount[9]  > 0) then  ClSysCapacity + (HVACCentralRef[9]:ClgCapTotNetRtd  * CentralEquipCount[9] )  else  UNCHANGED  endif  }
;	"Set ResHVACSys:ClSysCapacity - 10"		ResHVACSys:ClSysCapacity	= {	if (AutoSizeCool[10] == 0 .AND. NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. CentralEquipCount[10] > 0) then  ClSysCapacity + (HVACCentralRef[10]:ClgCapTotNetRtd * CentralEquipCount[10])  else  UNCHANGED  endif  }

	"Set ResHVACSys:HtPumpEquipIssue"		ResHVACSys:HtPumpEquipIssue		=
				{	if (IfValidAnd( NumCentralEquipTypes > 0 )==0) then  " "
					else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) == 0) then  "All FPFC equipment assignments must be specified (first is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) == 0) then  "All FPFC equipment assignments must be specified (second is excluded)"
					else if (NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) == 0) then  "All FPFC equipment assignments must be specified (third is excluded)"
					else if (NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) == 0) then  "All FPFC equipment assignments must be specified (fourth is excluded)"
					else if (NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) == 0) then  "All FPFC equipment assignments must be specified (fifth is excluded)"
					else if (NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) == 0) then  "All FPFC equipment assignments must be specified (sixth is excluded)"
					else if (NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) == 0) then  "All FPFC equipment assignments must be specified (seventh is excluded)"
					else if (NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) == 0) then  "All FPFC equipment assignments must be specified (eighth is excluded)"
					else if (NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) == 0) then  "All FPFC equipment assignments must be specified (ninth is excluded)"
					else if (NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) == 0) then  "All FPFC equipment assignments must be specified (tenth is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #2: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[2]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #3: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[3]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #4: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[4]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #5: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[5]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #6: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[6]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #7: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[7]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #8: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[8]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #9: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[9]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:Type != HVACCentralRef[1]:Type) then  Format( "All assigned FPFC equipment must be of the same type (#1: %s / #10: %s)", HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[10]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #2 inconsistent)"
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #3 inconsistent)"
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #4 inconsistent)"
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #5 inconsistent)"
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #6 inconsistent)"
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #7 inconsistent)"
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #8 inconsistent)"
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #9 inconsistent)"
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:AutoSize != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized FPFC equipment (#1 & #10 inconsistent)"
					else  " "  endif endif endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  }

; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
	"Default ResHVACSys:ConstHtgSetpt"		ResHVACSys:ConstHtgSetpt	= { T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "Boiler" ) }
	
	"Init ResHVACSys:ConstClgSetpt"			ResHVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set ResHVACSys:EqpCountsMustAlign"		ResHVACSys:EqpCountsMustAlign	= {	0 }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set ResHVACSys:ZonalSysBypassDuct"		ResHVACSys:ZonalSysBypassDuct	= { 0 }

	"Init ResHVACSys:HtPumpDucted"       ResHVACSys:HtPumpDucted      = {	0  }
	"Init ResHVACSys:HaveHtPump"         ResHVACSys:HaveHtPump        = {	0  }
	"Init ResHVACSys:HtPumpEquipIssue"   ResHVACSys:HtPumpEquipIssue  = {	UNDEFINED  }
	"Init ResHVACSys:HPSysHSPF"          ResHVACSys:HPSysHSPF         = {	UNDEFINED  }
	"Init ResHVACSys:HPSysAutoSize"      ResHVACSys:HPSysAutoSize     = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap47"         ResHVACSys:HPSysCap47        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysMinCap47"      ResHVACSys:HPSysMinCap47     = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap35"         ResHVACSys:HPSysCap35        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCap17"         ResHVACSys:HPSysCap17        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP47"         ResHVACSys:HPSysCOP47        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP35"         ResHVACSys:HPSysCOP35        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysCOP17"         ResHVACSys:HPSysCOP17        = {	UNDEFINED  }
	"Init ResHVACSys:HPSysAuxHtgCap"     ResHVACSys:HPSysAuxHtgCap    = {	UNDEFINED  }
	"Init ResHVACSys:HPSysVCHPFanPwr"    ResHVACSys:HPSysVCHPFanPwr   = {	UNDEFINED  }
	"Init ResHVACSys:HPModelDualFuel"    ResHVACSys:HPModelDualFuel   = {	UNDEFINED  }
	"Init ResHVACSys:HPDFAFUE"           ResHVACSys:HPDFAFUE          = {	UNDEFINED  }
	"Init ResHVACSys:HPLockoutTemp"      ResHVACSys:HPLockoutTemp     = {	UNDEFINED  }
   "Init ResHVACSys:LrgHtPumpStdFanPwr" ResHVACSys:LrgHtPumpStdFanPwr =    ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }
   "Init ResHVACSys:PropHtPumpAutoSz"   ResHVACSys:PropHtPumpAutoSz  =     ; 2022 - SAC 03/11/21  ; SAC 03/15/21
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else  0  endif  }

	"Initialize other generic properties (common to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }

	"Set ResHVACSys:HaveEvapCond"			ResHVACSys:HaveEvapCond			= {	0 }


END

;************************************************************************* SAC 03/16/22
RULELIST "SetupHVACSys_Round2_CentralHtgClg_WSHP" 0 0 0 0
;*************************************************************************
;"dbg" ResHVACSys:Action = { PostMessageToLog( "   in 'SetupHVACSys_Round2_CentralHtgClg_WSHP' on ResHVACSys '%s':  NumCentralEquipTypes %g", Name, NumCentralEquipTypes ) }
	"Set ResHVACSys:CentralEqpTypeTypeAbbrev"	ResHVACSys:CentralEqpTypeAbbrev	=
      {  if (LocalStatus( NumCentralEquipTypes ) < 1) then  UNDEFINED
         else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
               then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
                     then  UNCHANGED
                     else if (HtOrClDucted < 0.5)
                     then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" )
                     else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" )
                     endif endif
               else  HVACCentralRef[1]:TypeAbbrevStr
               endif
         else  " "  endif endif  }

; added from HP rulelsit above - SAC 03/17/22
	"Default ResHVACSys:HtPumpDuctedEditable"		ResHVACSys:HtPumpDuctedEditable	= {	0  }
	;"Force reset of HtPumpDucted if needed"	ResHVACSys:Action  ...
	"Default ResHVACSys:HtPumpDucted"				ResHVACSys:HtPumpDucted				= {	1  }

	"Set ResHVACSys:HeatDucted"		ResHVACSys:Action			= {	if (IfValidAnd( HeatDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_HeatDucted_HtPumpDucted", 1 )  endif  }
	"Set ResHVACSys:CoolDucted"		ResHVACSys:Action			= {	if (IfValidAnd( CoolDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_CoolDucted_HtPumpDucted", 1 )  endif  }
   ; "debug Duct Flag"		ResHVACSys:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", ResHVACSys:CoolDucted, ResHVACSys:HeatDucted )  }

	"Set ResHVACSys:HPSysHSPF - 1"	ResHVACSys:HPSysHSPF	= {	0  }

	"Set ResHVACSys:HPSysAutoSize - 1"	ResHVACSys:HPSysAutoSize	= {	1  }

	"Set ResHVACSys:HPSysCap47 - 1"	ResHVACSys:HPSysCap47	= {	0  }

	"Set ResHVACSys:HPSysMinCap47 - 1"	ResHVACSys:HPSysMinCap47	= {	0  }

	"Set ResHVACSys:HPSysCap35 - 1"	ResHVACSys:HPSysCap35	= {	0  }

	"Set ResHVACSys:HPSysCap17 - 1"	ResHVACSys:HPSysCap17	= {	0  }

	"Set ResHVACSys:HPSysCOP47 - 1"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. IfValidAnd( HVACCentralRef[1]:WSHPCOP  > 0 )) then                   HVACCentralRef[1]:WSHPCOP     else      0      endif  }
	"Set ResHVACSys:HPSysCOP47 - 2"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. IfValidAnd( HVACCentralRef[2]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[2]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 3"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. IfValidAnd( HVACCentralRef[3]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[3]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 4"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. IfValidAnd( HVACCentralRef[4]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[4]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 5"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. IfValidAnd( HVACCentralRef[5]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[5]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 6"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. IfValidAnd( HVACCentralRef[6]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[6]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 7"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. IfValidAnd( HVACCentralRef[7]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[7]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 8"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. IfValidAnd( HVACCentralRef[8]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[8]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 9"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. IfValidAnd( HVACCentralRef[9]:WSHPCOP  > 0 )) then  min( HPSysCOP47, HVACCentralRef[9]:WSHPCOP  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:HPSysCOP47 - 10"	ResHVACSys:HPSysCOP47	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. IfValidAnd( HVACCentralRef[10]:WSHPCOP > 0 )) then  min( HPSysCOP47, HVACCentralRef[10]:WSHPCOP )  else  UNCHANGED  endif  }
   ;"Hardwire ResHVACSys:HPSysCOP47 for Packaged HP systems"    ResHVACSys:HPSysCOP47 =       ; SAC 08/18/20 (tic #1003)
   ;   {  if (IfValidAnd( HtPumpSysTypeAbbrev = "PkgTermHeatPump"    ) .OR.
   ;          IfValidAnd( HtPumpSysTypeAbbrev = "SglPkgVertHeatPump" ))
   ;      then  T24RHeatingEquipment:COP47( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
   ;      else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCOP35 - 1"	ResHVACSys:HPSysCOP35	= {	0  }

	"Set ResHVACSys:HPSysCOP17 - 1"	ResHVACSys:HPSysCOP17	= {	0  }

	"Set ResHVACSys:HPSysAuxHtgCap - 1"		ResHVACSys:HPSysAuxHtgCap	= {	0  }

	"Set ResHVACSys:HPSysVCHPFanPwr - 1"	ResHVACSys:HPSysVCHPFanPwr	= {	0  }

	"Set ResHVACSys:HPModelDualFuel - 1"	ResHVACSys:HPModelDualFuel = {	0  }

	"Set ResHVACSys:HPDFAFUE - 1"	   ResHVACSys:HPDFAFUE  = {	0  }   ; 101 ??

	"Set ResHVACSys:HPLockoutTemp - 1"	   ResHVACSys:HPLockoutTemp  = {	-999  }

   "Set ResHVACSys:LrgHtPumpStdFanPwr"    ResHVACSys:LrgHtPumpStdFanPwr =     
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status == 3) .AND. 
             IfValidAnd( HtPumpDucted > 0 ) .AND. LocalCompAssigned( Fan ) > 0.5 .AND.
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" ) < 0.5 .AND.
             IfValidAnd( Proj:AnalysisVersion >= 220000 ) .AND. HPSysAutoSize == 0 .AND. HPSysMinCap47 >= 54000)
         then  0.58
         else  0  endif endif  }
   "Set ResHVACSys:PropHtPumpAutoSz"      ResHVACSys:PropHtPumpAutoSz  =   
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (HPSysAutoSize > 0) then  1  else  0  endif endif  }

	;"Set ResHVACSys:HeatEquipSummary"	ResHVACSys:HeatEquipSummary	=     - set in ResCentralHVACSys.rule
   ;	"debug ResHVACSys:HeatEquipSummary"		ResHVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "ResHVACSys: '%s' HeatEquipSummary: '%s'", Name, HeatEquipSummary ) else UNCHANGED endif }

  ; More HVACSys cooling equipment summarization
	"Set ResHVACSys:ClSysSEER - 1"	ResHVACSys:ClSysSEER	= {	0  }

	"Set ResHVACSys:ClSysEER - 1"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. IfValidAnd( HVACCentralRef[1]:WSHPEER  > 0 )) then                 HVACCentralRef[1]:WSHPEER     else      0      endif  }
	"Set ResHVACSys:ClSysEER - 2"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. IfValidAnd( HVACCentralRef[2]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[2]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 3"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. IfValidAnd( HVACCentralRef[3]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[3]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 4"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. IfValidAnd( HVACCentralRef[4]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[4]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 5"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. IfValidAnd( HVACCentralRef[5]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[5]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 6"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. IfValidAnd( HVACCentralRef[6]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[6]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 7"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. IfValidAnd( HVACCentralRef[7]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[7]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 8"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. IfValidAnd( HVACCentralRef[8]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[8]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 9"		ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. IfValidAnd( HVACCentralRef[9]:WSHPEER  > 0 )) then  min( ClSysEER, HVACCentralRef[9]:WSHPEER  )  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysEER - 10"	ResHVACSys:ClSysEER	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. IfValidAnd( HVACCentralRef[10]:WSHPEER > 0 )) then  min( ClSysEER, HVACCentralRef[10]:WSHPEER )  else  UNCHANGED  endif  }

	"Set ResHVACSys:ClSysCFMperTon - 1"		ResHVACSys:ClSysCFMperTon	= {	350  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr - 1"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	0  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set ResHVACSys:ClSysSizingFactor - 1"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. IfValidAnd( CentralEquipCount[1]  > 0 ) .AND. IfValidAnd( HVACCentralRef[1]:ClgSizingFactor  > 0 )) then                      (HVACCentralRef[1]:ClgSizingFactor  * ValidOr(CentralEquipCount[1], 1 ))  else      0      endif  }
	"Set ResHVACSys:ClSysSizingFactor - 2"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. IfValidAnd( CentralEquipCount[2]  > 0 ) .AND. IfValidAnd( HVACCentralRef[2]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[2]:ClgSizingFactor  * ValidOr(CentralEquipCount[2], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 3"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. IfValidAnd( CentralEquipCount[3]  > 0 ) .AND. IfValidAnd( HVACCentralRef[3]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[3]:ClgSizingFactor  * ValidOr(CentralEquipCount[3], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 4"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. IfValidAnd( CentralEquipCount[4]  > 0 ) .AND. IfValidAnd( HVACCentralRef[4]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[4]:ClgSizingFactor  * ValidOr(CentralEquipCount[4], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 5"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. IfValidAnd( CentralEquipCount[5]  > 0 ) .AND. IfValidAnd( HVACCentralRef[5]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[5]:ClgSizingFactor  * ValidOr(CentralEquipCount[5], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 6"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. IfValidAnd( CentralEquipCount[6]  > 0 ) .AND. IfValidAnd( HVACCentralRef[6]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[6]:ClgSizingFactor  * ValidOr(CentralEquipCount[6], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 7"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. IfValidAnd( CentralEquipCount[7]  > 0 ) .AND. IfValidAnd( HVACCentralRef[7]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[7]:ClgSizingFactor  * ValidOr(CentralEquipCount[7], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 8"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. IfValidAnd( CentralEquipCount[8]  > 0 ) .AND. IfValidAnd( HVACCentralRef[8]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[8]:ClgSizingFactor  * ValidOr(CentralEquipCount[8], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 9"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. IfValidAnd( CentralEquipCount[9]  > 0 ) .AND. IfValidAnd( HVACCentralRef[9]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[9]:ClgSizingFactor  * ValidOr(CentralEquipCount[9], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 10"	  ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. IfValidAnd( CentralEquipCount[10] > 0 ) .AND. IfValidAnd( HVACCentralRef[10]:ClgSizingFactor > 0 )) then  ClSysSizingFactor + (HVACCentralRef[10]:ClgSizingFactor * ValidOr(CentralEquipCount[10], 1))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - XX"	ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEqpUnits > 0.5 )) then  ClSysSizingFactor / NumCentralEqpUnits  else  UNCHANGED  endif  }   ; fix similar to prev one for VRF below - SAC 08/05/22

	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	0  }

	;"Set ResHVACSys:CoolEquipSummary"	ResHVACSys:CoolEquipSummary	=     - set in ResCentralHVACSys.rule
   ;	"debug ResHVACSys:CoolEquipSummary"		ResHVACSys:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "ResHVACSys: '%s' CoolEquipSummary: '%s'", Name, CoolEquipSummary ) else UNCHANGED endif }

	"Set ResHVACSys:HtPumpEquipIssue"		ResHVACSys:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (IfValidAnd( NumCentralEquipTypes > 0 )==0) then  " "
					else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) == 0) then  "All WSHP equipment assignments must be specified (first is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) == 0) then  "All WSHP equipment assignments must be specified (second is excluded)"
					else if (NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) == 0) then  "All WSHP equipment assignments must be specified (third is excluded)"
					else if (NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) == 0) then  "All WSHP equipment assignments must be specified (fourth is excluded)"
					else if (NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) == 0) then  "All WSHP equipment assignments must be specified (fifth is excluded)"
					else if (NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) == 0) then  "All WSHP equipment assignments must be specified (sixth is excluded)"
					else if (NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) == 0) then  "All WSHP equipment assignments must be specified (seventh is excluded)"
					else if (NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) == 0) then  "All WSHP equipment assignments must be specified (eighth is excluded)"
					else if (NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) == 0) then  "All WSHP equipment assignments must be specified (ninth is excluded)"
					else if (NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) == 0) then  "All WSHP equipment assignments must be specified (tenth is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #2: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[2]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #3: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[3]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #4: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[4]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #5: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[5]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #6: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[6]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #7: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[7]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #8: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[8]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #9: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[9]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:Type != HVACCentralRef[1]:Type) then  Format( "All assigned WSHP equipment must be of the same type (#1: %s / #10: %s)", HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[10]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #2 inconsistent)"
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #3 inconsistent)"
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #4 inconsistent)"
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #5 inconsistent)"
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #6 inconsistent)"
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #7 inconsistent)"
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #8 inconsistent)"
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #9 inconsistent)"
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:AutoSize != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized WSHP equipment (#1 & #10 inconsistent)"
					else  " "  endif endif endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  }

	"Default ResHVACSys:ConstHtgSetpt"		ResHVACSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "SplitHeatPump" )  }
	"Init ResHVACSys:ConstClgSetpt"			ResHVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set ResHVACSys:EqpCountsMustAlign"		ResHVACSys:EqpCountsMustAlign	= {	0  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set ResHVACSys:ZonalSysBypassDuct"		ResHVACSys:ZonalSysBypassDuct	= {  0  }

	"Init ResHVACSys:HeatDuctedEditable"	ResHVACSys:HeatDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	UNDEFINED  }
	"Init ResHVACSys:HtSysSizingFactor"		ResHVACSys:HtSysSizingFactor	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysCapacity"			ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Init ResHVACSys:HeatEquipIssue"			ResHVACSys:HeatEquipIssue		= {	UNDEFINED  }
	"Init ResHVACSys:CoolDuctedEditable"	ResHVACSys:CoolDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:CoolEquipIssue"			ResHVACSys:CoolEquipIssue		= {	UNDEFINED  }


; TEST HARD SIZES - SAC 04/05/22
;	"Set ResHVACSys:AutoSizeHeat[1]"			ResHVACSys:AutoSizeHeat[1]			= {	0  }
;	"Set ResHVACSys:AutoSizeCool[1]"			ResHVACSys:AutoSizeCool[1]			= {	0  }
;	"Set ResHVACSys:HPSysAutoSize - 1"	   ResHVACSys:HPSysAutoSize	= {	0  }
;	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	48000  }
;	"Set ResHVACSys:HtSysCapacity - 1"	   ResHVACSys:HtSysCapacity	= {	40000  }
;	"Set ResHVACSys:HPSysAuxHtgCap - 1"		ResHVACSys:HPSysAuxHtgCap	= {	50000  }


	"Initialize other generic properties (common to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END
;*************************************************************************

;************************************************************************* JP 04/26/22
RULELIST "SetupHVACSys_Round2_CentralHtgClg_VRF" 0 0 0 0
;*************************************************************************
	"Set ResHVACSys:CentralEqpTypeTypeAbbrev"	ResHVACSys:CentralEqpTypeAbbrev	=
      {  if (LocalStatus( NumCentralEquipTypes ) < 1) then  UNDEFINED
         else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1] ))
         then  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
               then  if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. MinRevRef( ResZn:ActiveHVACSystem, ResZn:HVACSysStatus ) < 2)
                     then  UNCHANGED
                     else if (HtOrClDucted < 0.5)
                     then T24RHeatingEquipment:DuctlessStdSys( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "VCHP2" )
                     else T24RHeatingEquipment:DuctedStdSys(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "VCHP2" )
                     endif endif
               else  HVACCentralRef[1]:TypeAbbrevStr
               endif
         else  " "  endif endif  }

  "Set ResHVACSys:VRFSysRef" ResHVACSys:VRFSysRef = { ValidOr( HVACCentralRef[1]:VRFSysRef, "" ) }

; added from HP rulelsit above
	"Default ResHVACSys:HtPumpDuctedEditable"		ResHVACSys:HtPumpDuctedEditable	= {	0  }
	;"Force reset of HtPumpDucted if needed"	ResHVACSys:Action  ...
	"Default ResHVACSys:HtPumpDucted"				ResHVACSys:HtPumpDucted				= {	0  }

	"Set ResHVACSys:HeatDucted"		ResHVACSys:Action			= {	if (IfValidAnd( HeatDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_HeatDucted_HtPumpDucted", 1 )  endif  }
	"Set ResHVACSys:CoolDucted"		ResHVACSys:Action			= {	if (IfValidAnd( CoolDucted = HtPumpDucted )) then  UNCHANGED
																				else	EvalRulelist( "Force_HVACSys_CoolDucted_HtPumpDucted", 1 )  endif  }
   ; "debug Duct Flag"		ResHVACSys:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", ResHVACSys:CoolDucted, ResHVACSys:HeatDucted )  }

	"Set ResHVACSys:HPSysHSPF"	ResHVACSys:HPSysHSPF	= {	0  }

   ; set HPSysAutoSize based on VRFSysRef:AutoSize - SAC 07/22/22
	"Set ResHVACSys:HPSysAutoSize"	ResHVACSys:HPSysAutoSize	=
      {  if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. IfValidAnd( HVACCentralRef[1]:AutoSize > 0 )) 
         then  1  else  0  endif  }
	"Set ResHVACSys:AutoSizeCool[1]"	ResHVACSys:AutoSizeCool[1]	=
      {  if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. IfValidAnd( HVACCentralRef[1]:AutoSize > 0 )) 
         then  1  else  0  endif  }

	"Set ResHVACSys:HPSysCap47 - 1"	ResHVACSys:HPSysCap47	= {	0  }

	"Set ResHVACSys:HPSysMinCap47 - 1"	ResHVACSys:HPSysMinCap47	= {	0  }

	"Set ResHVACSys:HPSysCap35 - 1"	ResHVACSys:HPSysCap35	= {	0  }

	"Set ResHVACSys:HPSysCap17 - 1"	ResHVACSys:HPSysCap17	= {	0  }

	"Set ResHVACSys:CentralSysHtgCap - 1"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[1]:HtgCapTotNetRtd > 0  )) then                     (HVACCentralRef[1]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[1], 1 ))  else      0      endif  }
	"Set ResHVACSys:CentralSysHtgCap - 2"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[2]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[2]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[2], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 3"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[3]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[3]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[3], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 4"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[4]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[4]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[4], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 5"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[5]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[5]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[5], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 6"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[6]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[6]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[6], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 7"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[7]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[7]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[7], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 8"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[8]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[8]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[8], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 9"  ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[9]:HtgCapTotNetRtd > 0  )) then  CentralSysHtgCap + (HVACCentralRef[9]:HtgCapTotNetRtd  * ValidOr(CentralEquipCount[9], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysHtgCap - 10" ResHVACSys:CentralSysHtgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[10]:HtgCapTotNetRtd > 0 )) then  CentralSysHtgCap + (HVACCentralRef[10]:HtgCapTotNetRtd * ValidOr(CentralEquipCount[10], 1))  else  UNCHANGED  endif  }	
	

	"Set ResHVACSys:CentralSysClgCap - 1"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[1]:ClgCapTotNetRtd > 0  )) then                     (HVACCentralRef[1]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[1], 1 ))  else      0      endif  }
	"Set ResHVACSys:CentralSysClgCap - 2"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[2]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[2]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[2], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 3"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[3]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[3]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[3], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 4"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[4]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[4]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[4], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 5"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[5]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[5]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[5], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 6"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[6]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[6]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[6], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 7"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[7]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[7]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[7], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 8"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[8]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[8]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[8], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 9"  ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[9]:ClgCapTotNetRtd > 0  )) then  CentralSysClgCap + (HVACCentralRef[9]:ClgCapTotNetRtd  * ValidOr(CentralEquipCount[9], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:CentralSysClgCap - 10" ResHVACSys:CentralSysClgCap	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. HPSysAutoSize = 0 .AND. IfValidAnd( HVACCentralRef[10]:ClgCapTotNetRtd > 0 )) then  CentralSysClgCap + (HVACCentralRef[10]:ClgCapTotNetRtd * ValidOr(CentralEquipCount[10], 1))  else  UNCHANGED  endif  }

	"Set ResHVACSys:HPSysCOP35"	ResHVACSys:HPSysCOP35	= {	0  }

	"Set ResHVACSys:HPSysCOP17"	ResHVACSys:HPSysCOP17	= {	0  }

	"Set ResHVACSys:HPSysAuxHtgCap"		ResHVACSys:HPSysAuxHtgCap	= {	0  }

	"Set ResHVACSys:HPSysVCHPFanPwr"	ResHVACSys:HPSysVCHPFanPwr	= {	0  }

	"Set ResHVACSys:HPModelDualFuel"	ResHVACSys:HPModelDualFuel = {	0  }

	"Set ResHVACSys:HPDFAFUE"	   ResHVACSys:HPDFAFUE  = {	0  }

	"Set ResHVACSys:HPLockoutTemp"	   ResHVACSys:HPLockoutTemp  = {	-999  }

   "Set ResHVACSys:LrgHtPumpStdFanPwr"    ResHVACSys:LrgHtPumpStdFanPwr =     
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (FloorAreaServed[1] > 0.5 .AND. (ResProj:RunScope == 1 .OR. Status == 3) .AND. 
             IfValidAnd( HtPumpDucted > 0 ) .AND. LocalCompAssigned( Fan ) > 0.5 .AND.
             T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "VCHP2" ) < 0.5 .AND.
             IfValidAnd( Proj:AnalysisVersion >= 220000 ) .AND. HPSysAutoSize == 0 .AND. HPSysMinCap47 >= 54000)
         then  0.58
         else  0  endif endif  }
   "Set ResHVACSys:PropHtPumpAutoSz"      ResHVACSys:PropHtPumpAutoSz  =   
      {  if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr")
         then  UNCHANGED
         else if (IfValidAnd( HPSysAutoSize > 0 )) then  1  else  0  endif endif  }


	"Set ResHVACSys:ClSysCFMperTon"		ResHVACSys:ClSysCFMperTon	= {	350  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr"	ResHVACSys:ClSysRefrigChgAdjFctr	= {	0  }

; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION

	"Set ResHVACSys:ClSysSizingFactor - 1"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 0 ) .AND. LocalCompAssigned( HVACCentralRef[1]  ) .AND. IfValidAnd( CentralEquipCount[1]  > 0 ) .AND. IfValidAnd( HVACCentralRef[1]:ClgSizingFactor  > 0 )) then                      (HVACCentralRef[1]:ClgSizingFactor  * ValidOr(CentralEquipCount[1], 1 ))  else      0      endif  }
	"Set ResHVACSys:ClSysSizingFactor - 2"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 1 ) .AND. LocalCompAssigned( HVACCentralRef[2]  ) .AND. IfValidAnd( CentralEquipCount[2]  > 0 ) .AND. IfValidAnd( HVACCentralRef[2]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[2]:ClgSizingFactor  * ValidOr(CentralEquipCount[2], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 3"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 2 ) .AND. LocalCompAssigned( HVACCentralRef[3]  ) .AND. IfValidAnd( CentralEquipCount[3]  > 0 ) .AND. IfValidAnd( HVACCentralRef[3]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[3]:ClgSizingFactor  * ValidOr(CentralEquipCount[3], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 4"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 3 ) .AND. LocalCompAssigned( HVACCentralRef[4]  ) .AND. IfValidAnd( CentralEquipCount[4]  > 0 ) .AND. IfValidAnd( HVACCentralRef[4]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[4]:ClgSizingFactor  * ValidOr(CentralEquipCount[4], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 5"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 4 ) .AND. LocalCompAssigned( HVACCentralRef[5]  ) .AND. IfValidAnd( CentralEquipCount[5]  > 0 ) .AND. IfValidAnd( HVACCentralRef[5]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[5]:ClgSizingFactor  * ValidOr(CentralEquipCount[5], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 6"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 5 ) .AND. LocalCompAssigned( HVACCentralRef[6]  ) .AND. IfValidAnd( CentralEquipCount[6]  > 0 ) .AND. IfValidAnd( HVACCentralRef[6]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[6]:ClgSizingFactor  * ValidOr(CentralEquipCount[6], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 7"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 6 ) .AND. LocalCompAssigned( HVACCentralRef[7]  ) .AND. IfValidAnd( CentralEquipCount[7]  > 0 ) .AND. IfValidAnd( HVACCentralRef[7]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[7]:ClgSizingFactor  * ValidOr(CentralEquipCount[7], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 8"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 7 ) .AND. LocalCompAssigned( HVACCentralRef[8]  ) .AND. IfValidAnd( CentralEquipCount[8]  > 0 ) .AND. IfValidAnd( HVACCentralRef[8]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[8]:ClgSizingFactor  * ValidOr(CentralEquipCount[8], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 9"		ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 8 ) .AND. LocalCompAssigned( HVACCentralRef[9]  ) .AND. IfValidAnd( CentralEquipCount[9]  > 0 ) .AND. IfValidAnd( HVACCentralRef[9]:ClgSizingFactor  > 0 )) then  ClSysSizingFactor + (HVACCentralRef[9]:ClgSizingFactor  * ValidOr(CentralEquipCount[9], 1 ))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - 10"	  ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEquipTypes > 9 ) .AND. LocalCompAssigned( HVACCentralRef[10] ) .AND. IfValidAnd( CentralEquipCount[10] > 0 ) .AND. IfValidAnd( HVACCentralRef[10]:ClgSizingFactor > 0 )) then  ClSysSizingFactor + (HVACCentralRef[10]:ClgSizingFactor * ValidOr(CentralEquipCount[10], 1))  else  UNCHANGED  endif  }
	"Set ResHVACSys:ClSysSizingFactor - XX"	ResHVACSys:ClSysSizingFactor	= {	if (IfValidAnd( NumCentralEqpUnits > 0.5 )) then  ClSysSizingFactor / NumCentralEqpUnits  else  UNCHANGED  endif  }   ; SAC 07/22/22

	"Set ResHVACSys:HtPumpEquipIssue"		ResHVACSys:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (IfValidAnd( NumCentralEquipTypes > 0 )==0) then  " "
					else if (NumCentralEquipTypes > 0 .AND. LocalCompAssigned( HVACCentralRef[1]  ) == 0) then  "All VRF equipment assignments must be specified (first is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. LocalCompAssigned( HVACCentralRef[2]  ) == 0) then  "All VRF equipment assignments must be specified (second is excluded)"
					else if (NumCentralEquipTypes > 2 .AND. LocalCompAssigned( HVACCentralRef[3]  ) == 0) then  "All VRF equipment assignments must be specified (third is excluded)"
					else if (NumCentralEquipTypes > 3 .AND. LocalCompAssigned( HVACCentralRef[4]  ) == 0) then  "All VRF equipment assignments must be specified (fourth is excluded)"
					else if (NumCentralEquipTypes > 4 .AND. LocalCompAssigned( HVACCentralRef[5]  ) == 0) then  "All VRF equipment assignments must be specified (fifth is excluded)"
					else if (NumCentralEquipTypes > 5 .AND. LocalCompAssigned( HVACCentralRef[6]  ) == 0) then  "All VRF equipment assignments must be specified (sixth is excluded)"
					else if (NumCentralEquipTypes > 6 .AND. LocalCompAssigned( HVACCentralRef[7]  ) == 0) then  "All VRF equipment assignments must be specified (seventh is excluded)"
					else if (NumCentralEquipTypes > 7 .AND. LocalCompAssigned( HVACCentralRef[8]  ) == 0) then  "All VRF equipment assignments must be specified (eighth is excluded)"
					else if (NumCentralEquipTypes > 8 .AND. LocalCompAssigned( HVACCentralRef[9]  ) == 0) then  "All VRF equipment assignments must be specified (ninth is excluded)"
					else if (NumCentralEquipTypes > 9 .AND. LocalCompAssigned( HVACCentralRef[10] ) == 0) then  "All VRF equipment assignments must be specified (tenth is excluded)"
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #2: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[2]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #3: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[3]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #4: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[4]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #5: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[5]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #6: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[6]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #7: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[7]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #8: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[8]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:Type  != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #9: %s)",  HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[9]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:Type != HVACCentralRef[1]:Type) then  Format( "All assigned VRF equipment must be of the same type (#1: %s / #10: %s)", HVACCentralRef[1]:TypeAbbrevStr, HVACCentralRef[10]:TypeAbbrevStr )
					else if (NumCentralEquipTypes > 1 .AND. HVACCentralRef[2]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #2 inconsistent)"
					else if (NumCentralEquipTypes > 2 .AND. HVACCentralRef[3]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #3 inconsistent)"
					else if (NumCentralEquipTypes > 3 .AND. HVACCentralRef[4]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #4 inconsistent)"
					else if (NumCentralEquipTypes > 4 .AND. HVACCentralRef[5]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #5 inconsistent)"
					else if (NumCentralEquipTypes > 5 .AND. HVACCentralRef[6]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #6 inconsistent)"
					else if (NumCentralEquipTypes > 6 .AND. HVACCentralRef[7]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #7 inconsistent)"
					else if (NumCentralEquipTypes > 7 .AND. HVACCentralRef[8]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #8 inconsistent)"
					else if (NumCentralEquipTypes > 8 .AND. HVACCentralRef[9]:AutoSize  != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #9 inconsistent)"
					else if (NumCentralEquipTypes > 9 .AND. HVACCentralRef[10]:AutoSize != HVACCentralRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized VRF equipment (#1 & #10 inconsistent)"
					else  " "  endif endif endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  endif endif endif endif endif endif endif endif endif  }

	"Default ResHVACSys:ConstHtgSetpt"		ResHVACSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", "VCHP2" )  }
	"Init ResHVACSys:ConstClgSetpt"			ResHVACSys:ConstClgSetpt	= {	UNDEFINED  }

	"Set ResHVACSys:EqpCountsMustAlign"		ResHVACSys:EqpCountsMustAlign	= {	0  }

	; SAC 5/3/16 - added new flag to facilitate HERS flag for zonal systems w/ bypass ducts (tic #634)
	"Set ResHVACSys:ZonalSysBypassDuct"		ResHVACSys:ZonalSysBypassDuct	= {  0  }

	"Init ResHVACSys:HeatDuctedEditable"	ResHVACSys:HeatDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	UNDEFINED  }
	"Init ResHVACSys:HtSysSizingFactor"		ResHVACSys:HtSysSizingFactor	= {	UNDEFINED  }
	"Init ResHVACSys:HtSysCapacity"			ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Init ResHVACSys:HeatEquipIssue"			ResHVACSys:HeatEquipIssue		= {	UNDEFINED  }
	"Init ResHVACSys:CoolDuctedEditable"	ResHVACSys:CoolDuctedEditable	= {	UNDEFINED  }
	"Init ResHVACSys:CoolEquipIssue"			ResHVACSys:CoolEquipIssue		= {	UNDEFINED  }


; TEST HARD SIZES - SAC 04/05/22
;	"Set ResHVACSys:AutoSizeHeat[1]"			ResHVACSys:AutoSizeHeat[1]			= {	0  }
;	"Set ResHVACSys:AutoSizeCool[1]"			ResHVACSys:AutoSizeCool[1]			= {	0  }
;	"Set ResHVACSys:HPSysAutoSize - 1"	   ResHVACSys:HPSysAutoSize	= {	0  }
;	"Set ResHVACSys:ClSysCapacity - 1"		ResHVACSys:ClSysCapacity	= {	48000  }
;	"Set ResHVACSys:HtSysCapacity - 1"	   ResHVACSys:HtSysCapacity	= {	40000  }
;	"Set ResHVACSys:HPSysAuxHtgCap - 1"		ResHVACSys:HPSysAuxHtgCap	= {	50000  }


	"Initialize other generic properties (common to Ht/Cl/HP)"		ResHVACSys:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END
;*************************************************************************

; SAC 11/26/14 - added rulelists to blast user-specified *Ducted if it is inconsistent w/ the DuctFlag value in the HVAC equipment tables
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_HeatDucted" 1 0 0 0
	"Blast user input ResHVACSys:HeatDucted"		ResHVACSys:HeatDucted	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_CoolDucted" 1 0 0 0
	"Blast user input ResHVACSys:CoolDucted"		ResHVACSys:CoolDucted	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastUserUnput_HVACSys_HtPumpDucted" 1 0 0 0
	"Blast user input ResHVACSys:HtPumpDucted"	ResHVACSys:HtPumpDucted	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    - SAC 11/14/18 - blast Ducted HP checkbox and Dist & Fan assignments for VCHP systems
RULELIST "Reset_HVACSys_HtPump_Ducts" 1 0 0 0
   "Reset ResHVACSys:HtPumpDucted"     ResHVACSys:HtPumpDucted   = {  UNDEFINED  }
   "Reset ResHVACSys:DistribSystem"    ResHVACSys:DistribSystem  = {  UNDEFINED  }
   "Reset ResHVACSys:Fan"              ResHVACSys:Fan            = {  UNDEFINED  }
END
;*************************************************************************

; SAC 1/18/16 - revised rules to force override of ResHVACSys:HeatDucted & CoolDucted if they are user-defiend and inconsistent w/ HtPumpDucted (to fix HERS AHUAirFlow reporting bug)
;*************************************************************************
RULELIST "Force_HVACSys_HeatDucted_HtPumpDucted" 1 0 0 0
	"Set ResHVACSys:HeatDucted"		ResHVACSys:HeatDucted	= {	HtPumpDucted  }
END
;*************************************************************************
RULELIST "Force_HVACSys_CoolDucted_HtPumpDucted" 1 0 0 0
	"Set ResHVACSys:CoolDucted"		ResHVACSys:CoolDucted	= {	HtPumpDucted  }
END
;*************************************************************************

; SAC 6/21/14 - setup secondary set of DwellUnitType Heat/Cool assignment properties
;*************************************************************************
RULELIST "SetupDwellUnitType_Round2_HeatCool" 0 0 0 0
;*************************************************************************
	"Set DwellUnitType:HeatEqpTypeAbbrev"	DwellUnitType:HeatEqpTypeAbbrev	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1] ))
																							then  HVACHeatRef[1]:TypeAbbrevStr
																							else  " "  endif  }

;	; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
;		"Default DwellUnitType:HeatDucted"				DwellUnitType:HeatDucted				= {	if (HeatEqpType < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) == 0) then  0
;																											else if (HVACHeatRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatEqpTypeAbbrev ) == 1) then  1
;																											else  0  endif endif endif  }
;		"Default DwellUnitType:HeatDuctedEditable"	DwellUnitType:HeatDuctedEditable		= {	if (HeatEqpType < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) == 0) then  0
;																											else if (HVACHeatRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatEqpTypeAbbrev ) < 0) then  1
;																											else  0  endif endif endif  }

; SAC 1/6/14 - revised logic to handle defaulting of AFUE for combined hydronic Equips (related to GC issue #254)
	"Set DwellUnitType:HtEqpAFUE - 1"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. (HVACHeatRef[1]:DisplayAFUE  > 0 .OR. HVACHeatRef[1]:Type  == 9)) then                  HVACHeatRef[1]:AFUE     else      0      endif  }
	"Set DwellUnitType:HtEqpAFUE - 2"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. (HVACHeatRef[2]:DisplayAFUE  > 0 .OR. HVACHeatRef[2]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[2]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 3"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. (HVACHeatRef[3]:DisplayAFUE  > 0 .OR. HVACHeatRef[3]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[3]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 4"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. (HVACHeatRef[4]:DisplayAFUE  > 0 .OR. HVACHeatRef[4]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[4]:AFUE  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HtEqpAFUE - 5"	DwellUnitType:HtEqpAFUE	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. (HVACHeatRef[5]:DisplayAFUE  > 0 .OR. HVACHeatRef[5]:Type  == 9)) then  min( HtEqpAFUE, HVACHeatRef[5]:AFUE  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HtEqpSizingFactor - 1"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. HeatEquipCount[1]  > 0) then                      (HVACHeatRef[1]:SizingFactor  * HeatEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 2"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. HeatEquipCount[2]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[2]:SizingFactor  * HeatEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 3"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. HeatEquipCount[3]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[3]:SizingFactor  * HeatEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 4"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. HeatEquipCount[4]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[4]:SizingFactor  * HeatEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - 5"		DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. HeatEquipCount[5]  > 0) then  HtEqpSizingFactor + (HVACHeatRef[5]:SizingFactor  * HeatEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpSizingFactor - XX"	DwellUnitType:HtEqpSizingFactor	= {	if (NumHeatEqpUnits > 0.5) then  HtEqpSizingFactor / NumHeatEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HtEqpCapacity - 1"		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[1]  == 0 .AND. NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) .AND. HeatEquipCount[1]  > 0) then                  (HVACHeatRef[1]:TotalCapacity  * HeatEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HtEqpCapacity - 2"		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[2]  == 0 .AND. NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) .AND. HeatEquipCount[2]  > 0) then  HtEqpCapacity + (HVACHeatRef[2]:TotalCapacity  * HeatEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 3" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[3]  == 0 .AND. NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) .AND. HeatEquipCount[3]  > 0) then  HtEqpCapacity + (HVACHeatRef[3]:TotalCapacity  * HeatEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 4" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[4]  == 0 .AND. NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) .AND. HeatEquipCount[4]  > 0) then  HtEqpCapacity + (HVACHeatRef[4]:TotalCapacity  * HeatEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HtEqpCapacity - 5" 		DwellUnitType:HtEqpCapacity	= {	if (AutoSizeHeat[5]  == 0 .AND. NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) .AND. HeatEquipCount[5]  > 0) then  HtEqpCapacity + (HVACHeatRef[5]:TotalCapacity  * HeatEquipCount[5] )  else  UNCHANGED  endif  }

; SAC 1/6/14 - revised logic to incorporate AFUE for combined hydronic Equips into efficiency message (related to GC issue #254)
; SAC 1/14/14 - fixed other labels (namely ELecFurn) (GC issue #271)
	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	= {
					if (NumHeatEquipTypes <= 0) then  " "
					else if (NumHeatEqpUnits < 1) then  "No heating equipment units (counts) defined"
					else if (LocalCompAssigned( HVACHeatRef[1] ) == 0) then  "Heating equipment assignment #1 not defined"
					else if (HVACHeatRef[1]:IsAvailable > 0 .AND. HVACHeatRef[1]:Type == 9)
					then	Format( "%.0f %s unit(s), AFUEeff %.1f", NumHeatEqpUnits, HeatEqpTypeAbbrev, HtEqpAFUE )
					else if (HVACHeatRef[1]:IsAvailable > 0 .AND. HVACHeatRef[1]:DisplayAFUE > 0)
					then	Format( "%.0f %s unit(s), AFUE %.1f", NumHeatEqpUnits, HeatEqpTypeAbbrev, HtEqpAFUE )
					else	switch (HVACHeatRef[1]:Type)
								case  2 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev ) 	; "Heater - Non-central fuel-fired space heater"
								case  3 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )		; "Boiler - Gas or oil boiler"
								case  8 :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )		; "Electric - All electric heating Equips other than heat pump"
								default :	Format( "%.0f %s unit(s)", NumHeatEqpUnits, HeatEqpTypeAbbrev )
							endswitch
					endif endif endif endif endif  }

	"Set DwellUnitType:HeatEquipIssue"		DwellUnitType:HeatEquipIssue		= {
					if (NumHeatEquipTypes <= 0) then  " "
					else if (NumHeatEquipTypes > 0 .AND. LocalCompAssigned( HVACHeatRef[1]  ) == 0) then  "All heating equipment assignments must be specified (first is excluded)"
					else if (NumHeatEquipTypes > 1 .AND. LocalCompAssigned( HVACHeatRef[2]  ) == 0) then  "All heating equipment assignments must be specified (second is excluded)"
					else if (NumHeatEquipTypes > 2 .AND. LocalCompAssigned( HVACHeatRef[3]  ) == 0) then  "All heating equipment assignments must be specified (third is excluded)"
					else if (NumHeatEquipTypes > 3 .AND. LocalCompAssigned( HVACHeatRef[4]  ) == 0) then  "All heating equipment assignments must be specified (fourth is excluded)"
					else if (NumHeatEquipTypes > 4 .AND. LocalCompAssigned( HVACHeatRef[5]  ) == 0) then  "All heating equipment assignments must be specified (fifth is excluded)"
					else if (NumHeatEquipTypes > 1 .AND. HVACHeatRef[2]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #2: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[2]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 2 .AND. HVACHeatRef[3]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #3: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[3]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 3 .AND. HVACHeatRef[4]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #4: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[4]:TypeAbbrevStr )
					else if (NumHeatEquipTypes > 4 .AND. HVACHeatRef[5]:Type  != HVACHeatRef[1]:Type) then  Format( "All assigned heating equipment must be of the same type (#1: %s / #5: %s)",  HVACHeatRef[1]:TypeAbbrevStr, HVACHeatRef[5]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif  }


  ; More HVACSys cooling equipment summarization
	"Set DwellUnitType:CoolEqpTypeAbbrev"	DwellUnitType:CoolEqpTypeAbbrev	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1] ))
																							then  HVACCoolRef[1]:TypeAbbrevStr
																							else  " "  endif  }

;	; SAC 8/24/13 - moved Ducted* properties to HVACSys from HVACHeat
;		"Default DwellUnitType:CoolDucted"				DwellUnitType:CoolDucted				= {	if (CoolEqpType < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) == 0) then  0
;																											else if (HVACCoolRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolEqpTypeAbbrev ) == 1) then  1
;																											else  0  endif endif endif  }
;		"Default DwellUnitType:CoolDuctedEditable"	DwellUnitType:CoolDuctedEditable		= {	if (CoolEqpType < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) == 0) then  0
;																											else if (HVACCoolRef[1]:IsAvailable < 0.5) then  0
;																											else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolEqpTypeAbbrev ) < 0) then  1
;																											else  0  endif endif endif  }

	"Set DwellUnitType:ClEqpSEER - 1"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[1]:SEER >= 0 )) then                  HVACCoolRef[1]:SEER     else      0      endif  }
	"Set DwellUnitType:ClEqpSEER - 2"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[2]:SEER >= 0 )) then  min( ClEqpSEER, HVACCoolRef[2]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 3"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[3]:SEER >= 0 )) then  min( ClEqpSEER, HVACCoolRef[3]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 4"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[4]:SEER >= 0 )) then  min( ClEqpSEER, HVACCoolRef[4]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 5"	DwellUnitType:ClEqpSEER	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[5]:SEER >= 0 )) then  min( ClEqpSEER, HVACCoolRef[5]:SEER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpSEER2 - 1"	DwellUnitType:ClEqpSEER2	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[1]:SEER2 >= 0 )) then                   HVACCoolRef[1]:SEER2     else      0      endif  }   ; SAC 10/15/22 (tic #3431)
	"Set DwellUnitType:ClEqpSEER2 - 2"	DwellUnitType:ClEqpSEER2	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[2]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACCoolRef[2]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 3"	DwellUnitType:ClEqpSEER2	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[3]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACCoolRef[3]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 4"	DwellUnitType:ClEqpSEER2	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[4]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACCoolRef[4]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 5"	DwellUnitType:ClEqpSEER2	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[5]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACCoolRef[5]:SEER2  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER - 1"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EER >= 0 )) then                 HVACCoolRef[1]:EER     else      0      endif  }
	"Set DwellUnitType:ClEqpEER - 2"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EER >= 0 )) then  min( ClEqpEER, HVACCoolRef[2]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 3"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EER >= 0 )) then  min( ClEqpEER, HVACCoolRef[3]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 4"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EER >= 0 )) then  min( ClEqpEER, HVACCoolRef[4]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 5"		DwellUnitType:ClEqpEER	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EER >= 0 )) then  min( ClEqpEER, HVACCoolRef[5]:EER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER2 - 1"		DwellUnitType:ClEqpEER2	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EER2 >= 0 )) then                  HVACCoolRef[1]:EER2     else      0      endif  }   ; SAC 10/15/22 (tic #3431)
	"Set DwellUnitType:ClEqpEER2 - 2"		DwellUnitType:ClEqpEER2	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EER2 >= 0 )) then  min( ClEqpEER2, HVACCoolRef[2]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 3"		DwellUnitType:ClEqpEER2	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EER2 >= 0 )) then  min( ClEqpEER2, HVACCoolRef[3]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 4"		DwellUnitType:ClEqpEER2	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EER2 >= 0 )) then  min( ClEqpEER2, HVACCoolRef[4]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 5"		DwellUnitType:ClEqpEER2	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EER2 >= 0 )) then  min( ClEqpEER2, HVACCoolRef[5]:EER2  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEERa - 1"		DwellUnitType:ClEqpEERa	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EERa >= 0 )) then                  HVACCoolRef[1]:EERa     else      0      endif  }      ; SAC 10/15/22
	"Set DwellUnitType:ClEqpEERa - 2"		DwellUnitType:ClEqpEERa	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EERa >= 0 )) then  min( ClEqpEERa, HVACCoolRef[2]:EERa  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERa - 3"		DwellUnitType:ClEqpEERa	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EERa >= 0 )) then  min( ClEqpEERa, HVACCoolRef[3]:EERa  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERa - 4"		DwellUnitType:ClEqpEERa	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EERa >= 0 )) then  min( ClEqpEERa, HVACCoolRef[4]:EERa  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERa - 5"		DwellUnitType:ClEqpEERa	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EERa >= 0 )) then  min( ClEqpEERa, HVACCoolRef[5]:EERa  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER2a - 1"		DwellUnitType:ClEqpEER2a = {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EER2a >= 0 )) then                   HVACCoolRef[1]:EER2a     else      0      endif  }   ; SAC 10/15/22
	"Set DwellUnitType:ClEqpEER2a - 2"		DwellUnitType:ClEqpEER2a = {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EER2a >= 0 )) then  min( ClEqpEER2a, HVACCoolRef[2]:EER2a  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2a - 3"		DwellUnitType:ClEqpEER2a = {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EER2a >= 0 )) then  min( ClEqpEER2a, HVACCoolRef[3]:EER2a  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2a - 4"		DwellUnitType:ClEqpEER2a = {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EER2a >= 0 )) then  min( ClEqpEER2a, HVACCoolRef[4]:EER2a  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2a - 5"		DwellUnitType:ClEqpEER2a = {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EER2a >= 0 )) then  min( ClEqpEER2a, HVACCoolRef[5]:EER2a  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEERb - 1"		DwellUnitType:ClEqpEERb	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EERb >= 0 )) then                  HVACCoolRef[1]:EERb     else      0      endif  }      ; SAC 10/15/22
	"Set DwellUnitType:ClEqpEERb - 2"		DwellUnitType:ClEqpEERb	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EERb >= 0 )) then  min( ClEqpEERb, HVACCoolRef[2]:EERb  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERb - 3"		DwellUnitType:ClEqpEERb	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EERb >= 0 )) then  min( ClEqpEERb, HVACCoolRef[3]:EERb  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERb - 4"		DwellUnitType:ClEqpEERb	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EERb >= 0 )) then  min( ClEqpEERb, HVACCoolRef[4]:EERb  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEERb - 5"		DwellUnitType:ClEqpEERb	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EERb >= 0 )) then  min( ClEqpEERb, HVACCoolRef[5]:EERb  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER2b - 1"		DwellUnitType:ClEqpEER2b = {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[1]:EER2b >= 0 )) then                   HVACCoolRef[1]:EER2b     else      0      endif  }   ; SAC 10/15/22
	"Set DwellUnitType:ClEqpEER2b - 2"		DwellUnitType:ClEqpEER2b = {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[2]:EER2b >= 0 )) then  min( ClEqpEER2b, HVACCoolRef[2]:EER2b  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2b - 3"		DwellUnitType:ClEqpEER2b = {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[3]:EER2b >= 0 )) then  min( ClEqpEER2b, HVACCoolRef[3]:EER2b  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2b - 4"		DwellUnitType:ClEqpEER2b = {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[4]:EER2b >= 0 )) then  min( ClEqpEER2b, HVACCoolRef[4]:EER2b  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2b - 5"		DwellUnitType:ClEqpEER2b = {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[1]:Type = 14 ) .AND. IfValidAnd( HVACCoolRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACCoolRef[5]:EER2b >= 0 )) then  min( ClEqpEER2b, HVACCoolRef[5]:EER2b  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpCFMperTon - 1"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:CFMperTon  >= 0 )) then                       HVACCoolRef[1]:CFMperTon     else      0      endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 2"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 3"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 4"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 5"		DwellUnitType:ClEqpCFMperTon	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:CFMperTon  >= 0 )) then  min( ClEqpCFMperTon, HVACCoolRef[5]:CFMperTon  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 1"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 0 .AND. IfValidAnd( HVACCoolRef[1]:RefrigChgAdjFctr  >= 0 )) then                              HVACCoolRef[1]:RefrigChgAdjFctr     else      0      endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 2"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 1 .AND. IfValidAnd( HVACCoolRef[2]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 3"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 2 .AND. IfValidAnd( HVACCoolRef[3]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 4"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 3 .AND. IfValidAnd( HVACCoolRef[4]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 5"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumCoolEquipTypes > 4 .AND. IfValidAnd( HVACCoolRef[5]:RefrigChgAdjFctr  >= 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACCoolRef[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;	
;	; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION
;	
;		"Set DwellUnitType:ClEqpSizingFactor - 1"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) .AND. CoolEquipCount[1]  > 0) then                      (HVACCoolRef[1]:SizingFactor  * CoolEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 2"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) .AND. CoolEquipCount[2]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[2]:SizingFactor  * CoolEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 3"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) .AND. CoolEquipCount[3]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[3]:SizingFactor  * CoolEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 4"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) .AND. CoolEquipCount[4]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[4]:SizingFactor  * CoolEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 5"		DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) .AND. CoolEquipCount[5]  > 0) then  ClEqpSizingFactor + (HVACCoolRef[5]:SizingFactor  * CoolEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - XX"	DwellUnitType:ClEqpSizingFactor	= {	if (NumCoolEqpUnits > 0.5) then  ClEqpSizingFactor / NumCoolEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:ClEqpCapacity - 1"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) .AND. CoolEquipCount[1]  > 0) then                  (HVACCoolRef[1]:TotalCapacity  * CoolEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpCapacity - 2"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) .AND. CoolEquipCount[2]  > 0) then  ClEqpCapacity + (HVACCoolRef[2]:TotalCapacity  * CoolEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 3" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) .AND. CoolEquipCount[3]  > 0) then  ClEqpCapacity + (HVACCoolRef[3]:TotalCapacity  * CoolEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 4" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) .AND. CoolEquipCount[4]  > 0) then  ClEqpCapacity + (HVACCoolRef[4]:TotalCapacity  * CoolEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 5" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) .AND. CoolEquipCount[5]  > 0) then  ClEqpCapacity + (HVACCoolRef[5]:TotalCapacity  * CoolEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEquipSummary"	DwellUnitType:CoolEquipSummary	=           ; SAC 6/21/20 - prevent reporting SEER when not valid input (tic #1226)   ; SAC 08/19/20 (tic #1003)   ; SAC 08/31/20 (tic #1003)   ; Evap - SAC 10/15/22
				{	if (NumCoolEquipTypes <= 0) then  " "
					else if (NumCoolEqpUnits < 1) then  "No cooling equipment units (counts) defined"
					else if (LocalCompAssigned( HVACCoolRef[1] ) == 0) then  "Cooling equipment assignment #1 not defined"
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowCEER > 0 ))
					then	Format( "%.0f %s unit(s), %.1f CEER", NumCoolEqpUnits, CoolEqpTypeAbbrev, HVACCoolRef[1]:CEER )
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. HVACCoolRef[1]:Type == 14)
               then  if (HVACCoolRef[1]:EffMetric < 2)
                     then  Format( "%.0f %s unit(s), %.1f EERa, %.1f EERb", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEERa, ClEqpEERb )
                     else  Format( "%.0f %s unit(s), %.1f EER2a, %.1f EER2b", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER2a, ClEqpEER2b )  endif
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowSEER > 0 )==0 .AND.
                        (HVACCoolRef[1]:Type == 5 .OR. HVACCoolRef[1]:Type == 25))
					then	if (HVACCoolRef[1]:EffMetric < 2)
                     then  Format( "%.0f %s unit(s), %.1f EER", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER )
                     else  Format( "%.0f %s unit(s), %.1f EER2", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER2 )  endif
					else if (HVACCoolRef[1]:IsAvailable > 0 .AND. IfValidAnd( HVACCoolRef[1]:ShowSEER > 0 )==0)
					then	if (HVACCoolRef[1]:EffMetric < 2)
                     then  Format( "%.0f %s unit(s), %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER, ClEqpCFMperTon )
                     else  Format( "%.0f %s unit(s), %.1f EER2, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpEER2, ClEqpCFMperTon )  endif
					else if (HVACCoolRef[1]:IsAvailable > 0)
					then	if (HVACCoolRef[1]:EffMetric < 2)
                     then  Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
                     else  Format( "%.0f %s unit(s), %.1f SEER2, %.1f EER2, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpSEER2, ClEqpEER2, ClEqpCFMperTon )  endif
					else	Format( "%.0f %s unit(s)", NumCoolEqpUnits, CoolEqpTypeAbbrev )
					endif endif endif endif endif endif endif endif  }

  ; SAC 6/4/14 - modified rule to check consistency between each assigned sys [2-N] w/ sys[1]:TypeRpt (rather than :Type), since No Cooling case will override user's sys[1] w/ a std design cooling Equip
	"Set DwellUnitType:CoolEquipIssue"		DwellUnitType:CoolEquipIssue		= {
					if (NumCoolEquipTypes <= 0) then  " "
					else if (NumCoolEquipTypes > 0 .AND. LocalCompAssigned( HVACCoolRef[1]  ) == 0) then  "All cooling equipment assignments must be specified (first is excluded)"
					else if (NumCoolEquipTypes > 1 .AND. LocalCompAssigned( HVACCoolRef[2]  ) == 0) then  "All cooling equipment assignments must be specified (second is excluded)"
					else if (NumCoolEquipTypes > 2 .AND. LocalCompAssigned( HVACCoolRef[3]  ) == 0) then  "All cooling equipment assignments must be specified (third is excluded)"
					else if (NumCoolEquipTypes > 3 .AND. LocalCompAssigned( HVACCoolRef[4]  ) == 0) then  "All cooling equipment assignments must be specified (fourth is excluded)"
					else if (NumCoolEquipTypes > 4 .AND. LocalCompAssigned( HVACCoolRef[5]  ) == 0) then  "All cooling equipment assignments must be specified (fifth is excluded)"
					else if (NumCoolEquipTypes > 1 .AND. HVACCoolRef[2]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #2: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[2]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 2 .AND. HVACCoolRef[3]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #3: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[3]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 3 .AND. HVACCoolRef[4]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #4: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[4]:TypeAbbrevStr )
					else if (NumCoolEquipTypes > 4 .AND. HVACCoolRef[5]:Type  != HVACCoolRef[1]:TypeRpt) then  Format( "All assigned cooling equipment must be of the same type (#1: %s / #5: %s)",  HVACCoolRef[1]:TypeAbbrevStr, HVACCoolRef[5]:TypeAbbrevStr )
					else  " "  endif endif endif endif endif endif endif endif endif endif  }

; SAC 11/14/14 - added new properties to aid in CF1R reporting of heating & cooling (& duct/fan) equipment
	"Set DwellUnitType:HeatEquipDucted"		DwellUnitType:HeatEquipDucted		= {	if (NumHeatEquipTypes < 1 .OR. LocalCompAssigned( HVACHeatRef[1] ) < 1) then  0
																											else if (HVACHeatRef[1]:Type < 1) then  0
																											else	switch (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:CoolEquipDucted"		DwellUnitType:CoolEquipDucted		= {	if (NumCoolEquipTypes < 1 .OR. LocalCompAssigned( HVACCoolRef[1] ) < 1) then  0
																											else if (HVACCoolRef[1]:Type < 1) then  0
																											else	switch (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:HtPumpEquipDucted"	DwellUnitType:HtPumpEquipDucted	= {	0  }
	"Set DwellUnitType:EqpCountsMustAlign"	DwellUnitType:EqpCountsMustAlign	= {	if (HeatEquipDucted < 1 .OR. CoolEquipDucted < 1) then  0
																											else if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																											else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1
																											else  0  endif endif endif  }

;	; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
;		"Default DwellUnitType:ConstHtgSetpt"		DwellUnitType:ConstHtgSetpt	= {	if (strlen( HeatEqpTypeAbbrev ) < 2) then  -1
;																								else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatEqpTypeAbbrev )  endif  }
;		"Init DwellUnitType:ConstClgSetpt"			DwellUnitType:ConstClgSetpt	= {	UNDEFINED  }
;	
;		"Init DwellUnitType:HtPumpDucted"       DwellUnitType:HtPumpDucted      = {	0  }
;		"Init DwellUnitType:HaveHtPump"         DwellUnitType:HaveHtPump        = {	0  }
	"Init DwellUnitType:HtPumpEquipIssue"   DwellUnitType:HtPumpEquipIssue  = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpHSPF"          DwellUnitType:HPEqpHSPF         = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap47"         DwellUnitType:HPEqpCap47        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap35"         DwellUnitType:HPEqpCap35        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCap17"         DwellUnitType:HPEqpCap17        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP47"         DwellUnitType:HPEqpCOP47        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP35"         DwellUnitType:HPEqpCOP35        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpCOP17"         DwellUnitType:HPEqpCOP17        = {	UNDEFINED  }
;		"Init DwellUnitType:HPEqpAuxHtgCap"     DwellUnitType:HPEqpAuxHtgCap    = {	UNDEFINED  }

  ; DwellUnitType heating equipment used for DHW heating
	"Set HtEqpCanBeDHWHtr flag"							DwellUnitType:HtEqpCanBeDHWHtr	= {	0  }	; only allowed for air-to-water and ground-source heat pumps (for now)
	"Default DwellUnitType:ServesAsDHWHtr flag"		DwellUnitType:ServesAsDHWHtr		= {	0  }
	"Set DwellUnitType:HtEqpUsedAsDHWHtr flag"		DwellUnitType:HtEqpUsedAsDHWHtr	= {	0  }

;		"Initialize other generic properties (common to Ht/Cl/HP)"		DwellUnitType:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END

; SAC 6/21/14 - setup secondary set of DwellUnitType HtPump assignment properties
;*************************************************************************
RULELIST "SetupDwellUnitType_Round2_HeatPump" 0 0 0 0
;*************************************************************************
;	"debug HVACHtPumpRef[1]:TypeAbbrevStr"		DwellUnitType:Action		= {	PostWarning( "HVACHtPumpRef[1]:TypeAbbrevStr '%s'", HVACHtPumpRef[1]:TypeAbbrevStr )  }
	"Set DwellUnitType:HtPumpEqpTypeAbbrev"	DwellUnitType:HtPumpEqpTypeAbbrev	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1] ))
																													then  HVACHtPumpRef[1]:TypeAbbrevStr
																													else  " "  endif  }

;		"Default DwellUnitType:HtPumpDucted"				DwellUnitType:HtPumpDucted				= {	if (HtPumpEqpType < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  0
;																												else if (HVACHtPumpRef[1]:IsAvailable < 0.5) then  0
;																												else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpEqpTypeAbbrev ) == 1) then  1
;																												else  0  endif endif endif  }
;		"Default DwellUnitType:HtPumpDuctedEditable"		DwellUnitType:HtPumpDuctedEditable	= {	if (HtPumpEqpType < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  0
;																												else if (HVACHtPumpRef[1]:IsAvailable < 0.5) then  0
;																												else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpEqpTypeAbbrev ) < 0) then  1
;																												else  0  endif endif endif  }

;	"debug Duct Flag"		DwellUnitType:Action		= {	MessageBox( "check HtPumpDucted %g", DwellUnitType:HtPumpDucted )  }

;		"Set DwellUnitType:HeatDucted"		DwellUnitType:HeatDucted	= {	HtPumpDucted  }
;		"Set DwellUnitType:CoolDucted"		DwellUnitType:CoolDucted	= {	HtPumpDucted  }
;	"debug Duct Flag"		DwellUnitType:Action		= {	MessageBox( "check #1 CoolDucted %g HeatDucted %g", DwellUnitType:CoolDucted, DwellUnitType:HeatDucted )  }

	"Set DwellUnitType:HPEqpHSPF - 1"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:HSPF  > 0 )) then                  HVACHtPumpRef[1]:HSPF     else      0      endif  }
	"Set DwellUnitType:HPEqpHSPF - 2"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[2]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 3"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[3]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 4"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[4]:HSPF  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpHSPF - 5"	DwellUnitType:HPEqpHSPF	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:HSPF  > 0 )) then  min( HPEqpHSPF, HVACHtPumpRef[5]:HSPF  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCap47 - 1"	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:Cap47  > 0 )) then               (HVACHtPumpRef[1]:Cap47  * HtPumpEquipCount[1] )  else      0      endif  }
	"Set DwellUnitType:HPEqpCap47 - 2"	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[2]:Cap47  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 3" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[3]:Cap47  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 4" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[4]:Cap47  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap47 - 5" 	DwellUnitType:HPEqpCap47	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:Cap47  > 0 )) then  HPEqpCap47 + (HVACHtPumpRef[5]:Cap47  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HPEqpCap35 - 1"	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:Cap35  ) > 0) then               (HVACHtPumpRef[1]:Cap35  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HPEqpCap35 - 2"	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[2]:Cap35  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 3" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[3]:Cap35  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 4" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[4]:Cap35  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCap35 - 5" 	DwellUnitType:HPEqpCap35	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:Cap35  ) > 0) then  HPEqpCap35 + (HVACHtPumpRef[5]:Cap35  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCap17 - 1"	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:Cap17  ) > 0) then               (HVACHtPumpRef[1]:Cap17  * HtPumpEquipCount[1] )  else      0      endif  }
	"Set DwellUnitType:HPEqpCap17 - 2"	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[2]:Cap17  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 3" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[3]:Cap17  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 4" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[4]:Cap17  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCap17 - 5" 	DwellUnitType:HPEqpCap17	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:Cap17  ) > 0) then  HPEqpCap17 + (HVACHtPumpRef[5]:Cap17  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPEqpCOP47 - 1"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP47  > 0 )) then                   HVACHtPumpRef[1]:COP47     else      0      endif  }
	"Set DwellUnitType:HPEqpCOP47 - 2"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[2]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 3"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[3]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 4"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[4]:COP47  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPEqpCOP47 - 5"	DwellUnitType:HPEqpCOP47	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP47  > 0 )) then  min( HPEqpCOP47, HVACHtPumpRef[5]:COP47  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:HPEqpCOP35 - 1"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP35  > 0 )) then                   HVACHtPumpRef[1]:COP35     else      0      endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 2"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[2]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 3"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[3]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 4"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[4]:COP35  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP35 - 5"	DwellUnitType:HPEqpCOP35	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP35  > 0 )) then  min( HPEqpCOP35, HVACHtPumpRef[5]:COP35  )  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HPEqpCOP17 - 1"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:COP17  > 0 )) then                   HVACHtPumpRef[1]:COP17     else      0      endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 2"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[2]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 3"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[3]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 4"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[4]:COP17  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpCOP17 - 5"	DwellUnitType:HPEqpCOP17	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:COP17  > 0 )) then  min( HPEqpCOP17, HVACHtPumpRef[5]:COP17  )  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:HPEqpAuxHtgCap - 1"		DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. LocalStatus( HVACHtPumpRef[1]:AuxHtgCap  ) > 0) then                   (HVACHtPumpRef[1]:AuxHtgCap  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 2"		DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. LocalStatus( HVACHtPumpRef[2]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[2]:AuxHtgCap  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 3" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. LocalStatus( HVACHtPumpRef[3]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[3]:AuxHtgCap  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 4" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. LocalStatus( HVACHtPumpRef[4]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[4]:AuxHtgCap  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:HPEqpAuxHtgCap - 5" 	DwellUnitType:HPEqpAuxHtgCap	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. LocalStatus( HVACHtPumpRef[5]:AuxHtgCap  ) > 0) then  HPEqpAuxHtgCap + (HVACHtPumpRef[5]:AuxHtgCap  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPModelDualFuel - 1"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 )) then  1  else      0      endif  }    ; SAC 12/08/20
	"Set DwellUnitType:HPModelDualFuel - 2"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 3"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 4"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPModelDualFuel - 5"	DwellUnitType:HPModelDualFuel	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 )) then  1  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPDFAFUE - 1"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:AFUE > 0 ))        then  HVACHtPumpRef[1]:AFUE  else     101     endif  }
	"Set DwellUnitType:HPDFAFUE - 2"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[2]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 3"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[3]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 4"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[4]:AFUE  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPDFAFUE - 5"	DwellUnitType:HPDFAFUE	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:AFUE < HPDFAFUE )) then  HVACHtPumpRef[5]:AFUE  else  UNCHANGED  endif  }

	"Set DwellUnitType:HPLockoutTemp - 1"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[1]:HPLockoutTemp > -999 ))          then  HVACHtPumpRef[1]:HPLockoutTemp  else    -999     endif  }
	"Set DwellUnitType:HPLockoutTemp - 2"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[2]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[2]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[2]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 3"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[3]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[3]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[3]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 4"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[4]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[4]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[4]:HPLockoutTemp  else  UNCHANGED  endif  }
	"Set DwellUnitType:HPLockoutTemp - 5"	DwellUnitType:HPLockoutTemp	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[5]:ModelDualFuel > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:HasHPLockout > 0 ) .AND. IfValidAnd( HVACHtPumpRef[5]:HPLockoutTemp > HPLockoutTemp )) then  HVACHtPumpRef[5]:HPLockoutTemp  else  UNCHANGED  endif  }

	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	=              ; SAC 6/27/20 - added COP47 reporting for PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpEquipTypes <= 0) then  " "
					else if (NumHtPumpEqpUnits < 1) then  "No heat pump equipment units (counts) defined"
					else if (LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  "Heat pump equipment assignment #1 not defined"
					else if (HVACHtPumpRef[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s, Cap@17 %s", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF, FltToStr( HPEqpCap47 ), FltToStr( HPEqpCap17 ) )
					then	if (HVACHtPumpRef[1]:Type == 7)
                     then  if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), auto-sized",     NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev )
							      else  Format( "%.0f %s unit(s), Cap@47 %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, FltToStr( HPEqpCap47 ) )  endif
                     else if (HVACHtPumpRef[1]:Type == 11 .OR. HVACHtPumpRef[1]:Type == 26 .OR. HVACHtPumpRef[1]:Type == 24)
							then	if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), @47: COP %.1f, auto-sized",  NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpCOP47 )
							      else  Format( "%.0f %s unit(s), @47: COP %.1f, Cap %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpCOP47, FltToStr( HPEqpCap47 ) )  endif
							else	if (IfValidAnd( HVACHtPumpRef[1]:AutoSize > 0 ))
							      then  Format( "%.0f %s unit(s), HSPF %.1f, auto-sized",     NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF )
							      else  Format( "%.0f %s unit(s), HSPF %.1f, Cap@47 %s Btuh", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev, HPEqpHSPF, FltToStr( HPEqpCap47 ) )  endif
							endif endif
					else	Format( "%.0f %s unit(s),  ?? efficiency ??", NumHtPumpEqpUnits, HtPumpEqpTypeAbbrev )
					endif endif endif endif  }
	"Set DwellUnitType:HeatEquipSummary"	DwellUnitType:HeatEquipSummary	=              ; added dual fuel HP info - SAC 12/08/20
      {  if (IfValidAnd( HPModelDualFuel > 0 )==0) then  UNCHANGED
         else if (IfValidAnd( HPLockoutTemp > -999 ))
         then  Format( "%s, dual fuel AFUE %s%%, lockout @ %sF", HeatEquipSummary, FltToStr( HPDFAFUE ), FltToStr( HPLockoutTemp ) ) 
         else  Format( "%s, dual fuel AFUE %s%, no lockout",     HeatEquipSummary, FltToStr( HPDFAFUE ) ) 
         endif endif  }
;	"debug DwellUnitType:HeatEquipSummary"		DwellUnitType:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "DwellUnitType: '%s' HeatEquipSummary: '%s'", Name, HeatEquipSummary ) else UNCHANGED endif }

  ; More HVACSys cooling equipment summarization
	"Set DwellUnitType:ClEqpSEER - 1"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:SEER  > 0 )) then                  HVACHtPumpRef[1]:SEER     else      0      endif  }
	"Set DwellUnitType:ClEqpSEER - 2"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[2]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[2]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 3"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[3]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[3]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 4"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[4]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[4]:SEER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER - 5"	DwellUnitType:ClEqpSEER	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[5]:SEER  > 0 )) then  min( ClEqpSEER, HVACHtPumpRef[5]:SEER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpSEER2 - 1"	DwellUnitType:ClEqpSEER2	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:SEER2 >= 0 )) then                   HVACHtPumpRef[1]:SEER2     else      0      endif  }   ; SAC 10/15/22 (tic #3431)
	"Set DwellUnitType:ClEqpSEER2 - 2"	DwellUnitType:ClEqpSEER2	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[2]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACHtPumpRef[2]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 3"	DwellUnitType:ClEqpSEER2	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[3]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACHtPumpRef[3]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 4"	DwellUnitType:ClEqpSEER2	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[4]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACHtPumpRef[4]:SEER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpSEER2 - 5"	DwellUnitType:ClEqpSEER2	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[5]:SEER2 >= 0 )) then  min( ClEqpSEER2, HVACHtPumpRef[5]:SEER2  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER - 1"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:EER  > 0 )) then                 HVACHtPumpRef[1]:EER     else      0      endif  }
	"Set DwellUnitType:ClEqpEER - 2"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[2]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[2]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 3"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[3]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[3]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 4"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[4]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[4]:EER  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER - 5"		DwellUnitType:ClEqpEER	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric < 2 ) .AND. IfValidAnd( HVACHtPumpRef[5]:EER  > 0 )) then  min( ClEqpEER, HVACHtPumpRef[5]:EER  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpEER2 - 1"	DwellUnitType:ClEqpEER2	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:EER2 >= 0 )) then                 HVACHtPumpRef[1]:EER2     else      0      endif  }   ; SAC 10/15/22 (tic #3431)
	"Set DwellUnitType:ClEqpEER2 - 2"	DwellUnitType:ClEqpEER2	= {	if (NumHtPumpEquipTypes > 1 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[2]:EER2 >= 0 )) then  min( ClEqpEER2, HVACHtPumpRef[2]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 3"	DwellUnitType:ClEqpEER2	= {	if (NumHtPumpEquipTypes > 2 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[3]:EER2 >= 0 )) then  min( ClEqpEER2, HVACHtPumpRef[3]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 4"	DwellUnitType:ClEqpEER2	= {	if (NumHtPumpEquipTypes > 3 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[4]:EER2 >= 0 )) then  min( ClEqpEER2, HVACHtPumpRef[4]:EER2  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpEER2 - 5"	DwellUnitType:ClEqpEER2	= {	if (NumHtPumpEquipTypes > 4 .AND. IfValidAnd( HVACHtPumpRef[1]:EffMetric = 2 ) .AND. IfValidAnd( HVACHtPumpRef[5]:EER2 >= 0 )) then  min( ClEqpEER2, HVACHtPumpRef[5]:EER2  )  else  UNCHANGED  endif  }

	"Set DwellUnitType:ClEqpCFMperTon - 1"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:CFMperTon  > 0 )) then                       HVACHtPumpRef[1]:CFMperTon     else      0      endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 2"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[2]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 3"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[3]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 4"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[4]:CFMperTon  )  else  UNCHANGED  endif  }
	"Set DwellUnitType:ClEqpCFMperTon - 5"		DwellUnitType:ClEqpCFMperTon	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:CFMperTon  > 0 )) then  min( ClEqpCFMperTon, HVACHtPumpRef[5]:CFMperTon  )  else  UNCHANGED  endif  }

;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 1"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. IfValidAnd( HVACHtPumpRef[1]:RefrigChgAdjFctr  > 0 )) then                              HVACHtPumpRef[1]:RefrigChgAdjFctr     else      0      endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 2"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. IfValidAnd( HVACHtPumpRef[2]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[2]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 3"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. IfValidAnd( HVACHtPumpRef[3]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[3]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 4"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. IfValidAnd( HVACHtPumpRef[4]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[4]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpRefrigChgAdjFctr - 5"	DwellUnitType:ClEqpRefrigChgAdjFctr	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. IfValidAnd( HVACHtPumpRef[5]:RefrigChgAdjFctr  > 0 )) then  min( ClEqpRefrigChgAdjFctr, HVACHtPumpRef[5]:RefrigChgAdjFctr  )  else  UNCHANGED  endif  }
;	
;	; RULES TO SUMMARIZE ADDIITONAL COOLING PERFORMANCE PARAMETERS PASSED INTO CSE FOR SIMULATION
;	
;		"Set DwellUnitType:ClEqpSizingFactor - 1"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. HtPumpEquipCount[1]  > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:ClSizingFactor  > 0 )) then                      (HVACHtPumpRef[1]:ClSizingFactor  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 2"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. HtPumpEquipCount[2]  > 0 .AND. IfValidAnd( HVACHtPumpRef[2]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[2]:ClSizingFactor  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 3"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. HtPumpEquipCount[3]  > 0 .AND. IfValidAnd( HVACHtPumpRef[3]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[3]:ClSizingFactor  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 4"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. HtPumpEquipCount[4]  > 0 .AND. IfValidAnd( HVACHtPumpRef[4]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[4]:ClSizingFactor  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - 5"		DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. HtPumpEquipCount[5]  > 0 .AND. IfValidAnd( HVACHtPumpRef[5]:ClSizingFactor  > 0 )) then  ClEqpSizingFactor + (HVACHtPumpRef[5]:ClSizingFactor  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpSizingFactor - XX"	DwellUnitType:ClEqpSizingFactor	= {	if (NumHtPumpEqpUnits > 0.5) then  ClEqpSizingFactor / NumHtPumpEqpUnits  else  UNCHANGED  endif  }
;	
;		"Set DwellUnitType:ClEqpCapacity - 1"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[1]  == 0 .AND. NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) .AND. HtPumpEquipCount[1]  > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:TotalCapacity  > 0 )) then                  (HVACHtPumpRef[1]:TotalCapacity  * HtPumpEquipCount[1] )  else      0      endif  }
;		"Set DwellUnitType:ClEqpCapacity - 2"		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[2]  == 0 .AND. NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) .AND. HtPumpEquipCount[2]  > 0 .AND. IfValidAnd( HVACHtPumpRef[2]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[2]:TotalCapacity  * HtPumpEquipCount[2] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 3" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[3]  == 0 .AND. NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) .AND. HtPumpEquipCount[3]  > 0 .AND. IfValidAnd( HVACHtPumpRef[3]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[3]:TotalCapacity  * HtPumpEquipCount[3] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 4" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[4]  == 0 .AND. NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) .AND. HtPumpEquipCount[4]  > 0 .AND. IfValidAnd( HVACHtPumpRef[4]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[4]:TotalCapacity  * HtPumpEquipCount[4] )  else  UNCHANGED  endif  }
;		"Set DwellUnitType:ClEqpCapacity - 5" 		DwellUnitType:ClEqpCapacity	= {	if (AutoSizeCool[5]  == 0 .AND. NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) .AND. HtPumpEquipCount[5]  > 0 .AND. IfValidAnd( HVACHtPumpRef[5]:TotalCapacity  > 0 )) then  ClEqpCapacity + (HVACHtPumpRef[5]:TotalCapacity  * HtPumpEquipCount[5] )  else  UNCHANGED  endif  }

	"Set DwellUnitType:CoolEquipSummary"	DwellUnitType:CoolEquipSummary	=        ; CEER reporting - SAC 08/19/20 (tic #1003)
				{	if (NumHtPumpEquipTypes <= 0 .OR. NumHtPumpEqpUnits < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) == 0) then  " "
					else if (HVACHtPumpRef[1]:IsAvailable > 0)
			;		then	Format( "%.0f %s unit(s), %.1f SEER, %.1f EER, %.1f CFM/ton", NumCoolEqpUnits, CoolEqpTypeAbbrev, ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
					then	if (IfValidAnd( HVACHtPumpRef[1]:ShowCEER > 0 ))
                     then  Format( "%.1f CEER", HVACHtPumpRef[1]:CEER )
                     else if (HVACHtPumpRef[1]:Type == 11)
							then	if (HVACHtPumpRef[1]:EffMetric < 2)
                           then  Format( "%.1f EER", ClEqpEER )
                           else  Format( "%.1f EER2", ClEqpEER2 )  endif
							else	if (HVACHtPumpRef[1]:EffMetric < 2)
                           then  Format( "%.1f SEER, %.1f EER, %.0f CFM/ton", ClEqpSEER, ClEqpEER, ClEqpCFMperTon )
                           else  Format( "%.1f SEER2, %.1f EER2, %.0f CFM/ton", ClEqpSEER2, ClEqpEER2, ClEqpCFMperTon )  endif
							endif endif
					else	" "
					endif endif  }
;	"debug DwellUnitType:CoolEquipSummary"		DwellUnitType:Action		= {	if (FloorAreaServed > 0.5) then PostWarning( "DwellUnitType: '%s' CoolEquipSummary: '%s'", Name, CoolEquipSummary ) else UNCHANGED endif }

	"Set DwellUnitType:HtPumpEquipIssue"		DwellUnitType:HtPumpEquipIssue		=           ; added checks to ensure consistency in AutoSize flags - SAC 03/11/21
				{	if (NumHtPumpEquipTypes <= 0) then  " "
					else if (NumHtPumpEquipTypes > 0 .AND. LocalCompAssigned( HVACHtPumpRef[1]  ) == 0) then  "All heat pump equipment assignments must be specified (first is excluded)"
					else if (NumHtPumpEquipTypes > 1 .AND. LocalCompAssigned( HVACHtPumpRef[2]  ) == 0) then  "All heat pump equipment assignments must be specified (second is excluded)"
					else if (NumHtPumpEquipTypes > 2 .AND. LocalCompAssigned( HVACHtPumpRef[3]  ) == 0) then  "All heat pump equipment assignments must be specified (third is excluded)"
					else if (NumHtPumpEquipTypes > 3 .AND. LocalCompAssigned( HVACHtPumpRef[4]  ) == 0) then  "All heat pump equipment assignments must be specified (fourth is excluded)"
					else if (NumHtPumpEquipTypes > 4 .AND. LocalCompAssigned( HVACHtPumpRef[5]  ) == 0) then  "All heat pump equipment assignments must be specified (fifth is excluded)"
					else if (NumHtPumpEquipTypes > 1 .AND. HVACHtPumpRef[2]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #2: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[2]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 2 .AND. HVACHtPumpRef[3]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #3: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[3]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 3 .AND. HVACHtPumpRef[4]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #4: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[4]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 4 .AND. HVACHtPumpRef[5]:Type  != HVACHtPumpRef[1]:Type) then  Format( "All assigned heat pump equipment must be of the same type (#1: %s / #5: %s)",  HVACHtPumpRef[1]:TypeAbbrevStr, HVACHtPumpRef[5]:TypeAbbrevStr )
					else if (NumHtPumpEquipTypes > 1 .AND. HVACHtPumpRef[2]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #2 inconsistent)"
					else if (NumHtPumpEquipTypes > 2 .AND. HVACHtPumpRef[3]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #3 inconsistent)"
					else if (NumHtPumpEquipTypes > 3 .AND. HVACHtPumpRef[4]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #4 inconsistent)"
					else if (NumHtPumpEquipTypes > 4 .AND. HVACHtPumpRef[5]:AutoSize != HVACHtPumpRef[1]:AutoSize) then  "There cannot be a mixture of fixed and auto-sized heat pump equipment (#1 & #5 inconsistent)"
					else  " "  endif endif endif endif endif endif  endif endif endif endif  endif endif endif endif  }

; SAC 11/14/14 - added new properties to aid in CF1R reporting of heating & cooling (& duct/fan) equipment
	"Set DwellUnitType:HeatEquipDucted"		DwellUnitType:HeatEquipDucted		= {	0  }
	"Set DwellUnitType:CoolEquipDucted"		DwellUnitType:CoolEquipDucted		= {	0  }
	"Set DwellUnitType:HtPumpEquipDucted"	DwellUnitType:HtPumpEquipDucted	= {	if (NumHtPumpEquipTypes < 1 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) < 1) then  0
																											else if (HVACHtPumpRef[1]:Type < 1) then  0
																											else	switch (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpEqpTypeAbbrev ))
																														case  1 :	1
																														case  0 :	0
																														default :	if (LocalCompAssigned( HVACDistRef ) < 1) then  0
																																		else if (HVACDistRef:Type > 0 .AND. HVACDistRef:Type != 8) then  1  else  0  endif endif
																													endswitch
																											endif endif  }
	"Set DwellUnitType:EqpCountsMustAlign"	DwellUnitType:EqpCountsMustAlign	= {	0  }

;	; SAC 8/23/13 - moved ConstHtgSetpt from HVACHeat as part of HVAHeat array mods
;		"Default DwellUnitType:ConstHtgSetpt"		DwellUnitType:ConstHtgSetpt	= {	if (strlen( HtPumpEqpTypeAbbrev ) < 2) then  -1
;																								else  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "EqpType", HtPumpEqpTypeAbbrev )  endif  }
;		"Init DwellUnitType:ConstClgSetpt"			DwellUnitType:ConstClgSetpt	= {	UNDEFINED  }
;	
;	
;		"Init DwellUnitType:HeatDuctedEditable"	DwellUnitType:HeatDuctedEditable	= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpAFUE"				DwellUnitType:HtEqpAFUE				= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpSizingFactor"		DwellUnitType:HtEqpSizingFactor	= {	UNDEFINED  }
;		"Init DwellUnitType:HtEqpCapacity"			DwellUnitType:HtEqpCapacity		= {	UNDEFINED  }
	"Init DwellUnitType:HeatEquipIssue"			DwellUnitType:HeatEquipIssue		= {	UNDEFINED  }
;		"Init DwellUnitType:CoolDuctedEditable"	DwellUnitType:CoolDuctedEditable	= {	UNDEFINED  }
	"Init DwellUnitType:CoolEquipIssue"			DwellUnitType:CoolEquipIssue		= {	UNDEFINED  }

  ; DwellUnitType heating equipment used for DHW heating
	"Set HtEqpCanBeDHWHtr flag for HtPumpSystem[1]"		DwellUnitType:HtEqpCanBeDHWHtr	= {	if (NumHtPumpEquipTypes > 0 .AND. IfValidAnd( HVACHtPumpRef[1]:CanBeDHWHtr > -1 ))
																															then  HVACHtPumpRef[1]:CanBeDHWHtr
																															else  0  endif  }
	"Default DwellUnitType:ServesAsDHWHtr flag"			DwellUnitType:ServesAsDHWHtr		= {	0	}		; or default to TRUE if it CAN be DHW heater??  - was: HtEqpCanBeDHWHtr  }
	"Set DwellUnitType:HtEqpUsedAsDHWHtr flag"			DwellUnitType:HtEqpUsedAsDHWHtr	= {	if (HtEqpCanBeDHWHtr < 1 .OR. ServesAsDHWHtr < 1) then  0  else  1  endif  }
	"Default other DwellUnitType DHW heating properties"		DwellUnitType:Action			= {	if (HtEqpUsedAsDHWHtr < 1) then  UNCHANGED
																															else	EvalRulelist( "DefaultDwellUnitType_DHWHeating", 1 )  endif  }

;		"Initialize other generic properties (common to Ht/Cl/HP)"		DwellUnitType:Action	= {	EvalRulelist( "SetupHVACSys_Round2_common", 1 )  }
END


; SAC 9/3/15 - Defaulting of DwellUnitType (heating equipment) used as DHWHeater
;*************************************************************************
RULELIST "DefaultDwellUnitType_DHWHeating" 0 0 0 0
;*************************************************************************

	; DwellUnitType:DHWSystemType  - defaulted via enumeration definitions

	"Default DwellUnitType:DHWHeaterElementType"		DwellUnitType:DHWHeaterElementType	= {	"Air-Source Heat Pump"  }		; SAC 9/3/15 - always use ASHP, even when htg equip is GSHP - same as how we handle DHW-heating HVACSys objects
																											;				if (IfValidAnd( HVACSysType = 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:Type = 12 ))  ; Type = HP / HtPumpSysType = "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
																											;				then	"Ground-Source Heat Pump"
																											;				else	   "Air-Source Heat Pump"    endif  }
;			0, DwellUnitType:DHWHeaterElementType,  3
;			2,          3, "Air-Source Heat Pump"
;			2,          6, "Ground-Source Heat Pump"

	"Default DwellUnitType:DHWTankType"					DwellUnitType:DHWTankType         	= {	if (IfValidAnd( HVACHtPumpRef[1]:Type = 12 ) .OR.								; GSHP -> 'Small Storage'
																																 IfValidAnd( HVACHtPumpRef[1]:Type = 11 ) ) then  "Small Storage"		; AWHP -> 'Small Storage'	- SAC 1/13/16 - added (tic 560)
																															else	"Indirect"  endif  }																; SAC 6/6/14 - updated DHW engine now works w/ AWHP + Indirect tank
;			0, DwellUnitType:DHWTankType,  1
;			2,          1, "Indirect"                ; %WHTYPE_IND =      1		' indirect    
;			2,          6, "Small Storage"           ; %WHTYPE_SSTOR =    6		' small storage

	"Default DwellUnitType:DHWInputRating"				DwellUnitType:DHWInputRating      	= {	if (DHWTankType == 6) then  8000			; small storage
																															else	0  endif                }
	"Default DwellUnitType:DHWInputRatingUnits"		DwellUnitType:DHWInputRatingUnits	= {	switch (DHWHeaterElementType)
																														;		case  0 :	"watts"   ; "Electric Resistance" 
																														;		case  1 :   "Btu/hr"  ; "Natural Gas"   
																														;		case  2 :   "Btu/hr"  ; "Propane"             
																																case  3 :   "watts"   ; "Air-Source Heat Pump"           
																																case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																														;		case  4 :   "Btu/hr"  ; "Oil"   
																																default :	" "
																															endswitch  }

;	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	(0.9376 * ResHVACSys:HPSysCOP47 - 0.7032) / (1.086 - 0.1102 * ResHVACSys:HPSysCOP47)	}
;	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	0.575	           }
	"Default DwellUnitType:DHWEnergyFactor"			DwellUnitType:DHWEnergyFactor     	= {	if (IfValidAnd( HVACHtPumpRef[1]:Type = 12 ))
																															then		if (ResProj:Fuel_HaveNatGas > 0.5) then  2.8  else  1.85  endif		; GSHP defaulting		; SAC 11/10/15
																															else if (IfValidAnd( HPEqpCOP47 > 0.5 )) then  HPEqpCOP47  else  3  endif endif  }

	"Default DwellUnitType:DHWTankVolume"				DwellUnitType:DHWTankVolume       	= {	50               }
	"Default DwellUnitType:DHWIntInsulRVal"			DwellUnitType:DHWIntInsulRVal     	= {	0                }
	"Default DwellUnitType:DHWExtInsulRVal"			DwellUnitType:DHWExtInsulRVal     	= {	0                }
	"Default DwellUnitType:DHWAmbientCond"				DwellUnitType:DHWAmbientCond      	= {	"Unconditioned"  }
	"Default DwellUnitType:DHWStandbyLossFrac"		DwellUnitType:DHWStandbyLossFrac  	= {	0                }

	; DwellUnitType:DHWSolFracType  - defaulted via enumeration definitions
	"Default DwellUnitType:DHWSolFracAnn"					DwellUnitType:DHWSolFracAnn		= {	0  }
	"Default DwellUnitType:DHWSolFracMon[1] - Jan"		DwellUnitType:DHWSolFracMon[1]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[2] - Feb"		DwellUnitType:DHWSolFracMon[2]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[3] - Mar"		DwellUnitType:DHWSolFracMon[3]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[4] - Apr"		DwellUnitType:DHWSolFracMon[4]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[5] - May"		DwellUnitType:DHWSolFracMon[5]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[6] - Jun"		DwellUnitType:DHWSolFracMon[6]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[7] - Jul"		DwellUnitType:DHWSolFracMon[7]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[8] - Aug"		DwellUnitType:DHWSolFracMon[8]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[9] - Sep"		DwellUnitType:DHWSolFracMon[9]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[10] - Oct"		DwellUnitType:DHWSolFracMon[10]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[11] - Nov"		DwellUnitType:DHWSolFracMon[11]	= {	0  }
	"Default DwellUnitType:DHWSolFracMon[12] - Dec"		DwellUnitType:DHWSolFracMon[12]	= {	0  }

	"Set DwellUnitType:DHWSolFracMonAvg"		DwellUnitType:DHWSolFracMonAvg		= {		; SAC 6/17/16 - tic #682
						switch (DHWSolFracType)
							case  1 :	if (LocalStatus( DHWSolFracAnn ) > 1) then  DHWSolFracAnn  else  0  endif
							case  2 :	if (	LocalStatus( DHWSolFracMon[1]  ) > 1 .AND. LocalStatus( DHWSolFracMon[2]  ) > 1 .AND. LocalStatus( DHWSolFracMon[3]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[4]  ) > 1 .AND. LocalStatus( DHWSolFracMon[5]  ) > 1 .AND. LocalStatus( DHWSolFracMon[6]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[7]  ) > 1 .AND. LocalStatus( DHWSolFracMon[8]  ) > 1 .AND. LocalStatus( DHWSolFracMon[9]  ) > 1 .AND. 
													LocalStatus( DHWSolFracMon[10] ) > 1 .AND. LocalStatus( DHWSolFracMon[11] ) > 1 .AND. LocalStatus( DHWSolFracMon[12] ) > 1 )
											then  ( (DHWSolFracMon[1]  * 31) + (DHWSolFracMon[2]  * 28) + (DHWSolFracMon[3]  * 31) + (DHWSolFracMon[4]  * 30) +
													  (DHWSolFracMon[5]  * 31) + (DHWSolFracMon[6]  * 30) + (DHWSolFracMon[7]  * 31) + (DHWSolFracMon[8]  * 31) + 
													  (DHWSolFracMon[9]  * 30) + (DHWSolFracMon[10] * 31) + (DHWSolFracMon[11] * 30) + (DHWSolFracMon[12] * 31) ) / 365
											else  0  endif
							default :  0
						endswitch  }
END


; SAC 8/24/13 - setup secondary set of HVACSys Heat/Cool/HtPump assignment properties
;*************************************************************************
RULELIST "SetupHVACSys_Round2_common" 0 0 0 0
;*************************************************************************

;	"store BEMProc details"		ResHVACSys:Action = {  StoreBEMProc( "b4 setting HVACSys-HaveHeating", 0 )  }
;	"debugging"		ResHVACSys:Action		= {	MessageBox( "check BEMProc file for HVACSys '%s'", ResHVACSys:Name )  }

; SAC 1/14/14 - added logic to check for Std design run being performed to ensure that HtPump auto-sizing is turned ON
; SAC 5/22/14 - added references to PropEqStd table values so that zeroed out capacities don't result in no heating/cooling settings
; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr" or "DR")
; SAC 11/13/18 - revise logic to prevent requirement of Cap17 > 0 to HaveHeating for VCHP equipment
   ; updated for new ResCentralHtgClgSys systems - SAC 03/16/22
	"Set ResHVACSys:HaveHeating"		ResHVACSys:HaveHeating	= {	if (Type < 1) then  0
																				else if (Type == 2)
																				then	if (NumHtPumpSystemTypes <= 0 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																		;				else if (AutoSizeHeat[1] > 0.5 .OR. (HPSysCap47 > 1 .AND. HPSysCap17 > 1)) then  1    - replaced this w/ below as part of GC issue 186 fix (SAC 9/29/13)
																						else if (IfValidAnd( AutoSizeHeatInp > 0.5 ) .OR. IfValidAnd( HtPumpSystem[1]:AutoSize > 0.5 ) .OR.
																						         ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr" .OR. ResProj:RunAbbrev == "DR" .OR.
																									((IfValidAnd( HPSysCap47 > 1 ) .AND. (IfValidAnd(HPSysCap17 > 1) .OR. IfValidAnd( HtPumpSystem[1]:IsPackaged > 0 ) .OR.
																									                                      IfValidAnd(HtPumpSystem[1]:Type == 12) .OR. IfValidAnd(HtPumpSystem[1]:Type == 22) .OR. IfValidAnd(HtPumpSystem[1]:Type == 33))) .OR.
																										T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5)) then  1
																						else  0
																						endif endif
                                                            else if (Type == 4)   ; ResCentralHtgClgSys
                                                            then  switch (ValidOr( HVACCentralRef[1]:Type, 0 ))
                                                                     case  1 :  1    ; "Four-pipe fan coil"
                                                                     case  2 :  1    ; "Water source heat pump"
                                                                     case  3 :  1    ; "Hydronic heating only"
                                                                     case  4 :  1    ; "Variable refrigerant flow"
                                                                     default :  0
                                                                  endswitch
																				else	if (NumHeatSystemTypes <= 0 .OR. LocalCompAssigned( HeatSystem[1] ) == 0) then  0
																						else if (IfValidAnd( AutoSizeHeat[1] > 0.5 ) .OR. IfValidAnd( HtSysCapacity > 1 ) .OR.
																									T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif
																				endif endif endif  } 
	"Set ResHVACSys:ServesHeating"	ResHVACSys:ServesHeating = {	if (HaveHeating .AND. FloorAreaServed[1] > 0.5) then  1  else  0  endif  }    ; SAC 5/14/19

 ; SAC 1/11/14 - added logic to set HaveCooling to 0 when cooling sys type = NoCooling																				
	"Set ResHVACSys:HaveCooling"		ResHVACSys:HaveCooling	= {	if (Type < 1) then  0
																				else if (Type == 2)
																				then	if (NumHtPumpSystemTypes <= 0 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
																						else if (IfValidAnd( AutoSizeCool[1] > 0.5 ) .OR. IfValidAnd( HtPumpSystem[1]:Type = 33 ) .OR. IfValidAnd( ClSysCapacity > 1 ) .OR.
																									T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif
                                                            else if (Type == 4)   ; ResCentralHtgClgSys
                                                            then  switch (ValidOr( HVACCentralRef[1]:Type, 0 ))
                                                                     case  1 :  1    ; "Four-pipe fan coil"
                                                                     case  2 :  1    ; "Water source heat pump"
                                                                     case  3 :  0    ; "Hydronic heating only"
                                                                     case  4 :  1    ; "Variable refrigerant flow"
                                                                     default :  0
                                                                  endswitch
																				else	if (NumCoolSystemTypes <= 0 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
																						else if (CoolSystem[1]:Type == 1) then  0		; NoCooling
																						else if (IfValidAnd( AutoSizeCool[1] > 0.5 ) .OR. IfValidAnd( ClSysCapacity > 1 ) .OR.
																									T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0.5) then  1
																						else  0
																						endif endif endif 
																				endif endif endif  } 
																				
	"Set ResHVACSys:ServesCooling"	ResHVACSys:ServesCooling = {	if (HaveCooling .AND. FloorAreaServed[1] > 0.5) then  1  else  0  endif  }    ; SAC 5/14/19

	"Set ResHVACSys:HaveHtPump"		ResHVACSys:HaveHtPump	= {	if ((Type == 2 .OR. (Type == 4 .AND. ( IfValidAnd( HVACCentralRef[1]:Type = 2 ) .OR. IfValidAnd( HVACCentralRef[1]:Type = 4 )))) .AND.
                                                                      HaveHeating .AND. HaveCooling) then  1  else  0  endif  }

  ; SAC 4/30/14 - revised rule to include logic unique to Heat Pump (Type==2) systems vs. other systems
	"Set ResHVACSys:HtOrClDucted - heat"	ResHVACSys:HtOrClDucted		= {	if (Type == 2)
																							then	if (HtPumpDucted > 0.5) then  1  else  0  endif
																							else if (HaveHeating)
																							then  if (HeatDucted > 0.5) then  1  else  0  endif
																							else  0  endif endif  }
	"Set ResHVACSys:HtOrClDucted - cool"	ResHVACSys:HtOrClDucted		= {	if (Type == 2)
																							then	if (HtPumpDucted > 0.5) then  HtOrClDucted + 2  else  UNCHANGED  endif
																							else if (HaveCooling)
																							then  if (CoolDucted > 0.5) then  HtOrClDucted + 2  else  UNCHANGED  endif
																							else  UNCHANGED  endif endif  }
;	"debug Duct Flag"		ResHVACSys:Action		= {	if (Type == 2) then	MessageBox( "check #2 HtPumpDucted %g   HtOrClDucted %g", ResHVACSys:HtPumpDucted, ResHVACSys:HtOrClDucted  )
;																					else	MessageBox( "check #2 CoolDucted %g   HtOrClDucted %g", ResHVACSys:CoolDucted, ResHVACSys:HtOrClDucted  )  endif  }

  ; SAC 1/14/16 - moved and combined rules that set ResHVACSys:MaxNumHVACEquipTypes from above in 'SetupHVACSys_Round1_*' rulelists to here since it is now also dependent on ResHVACSys:HtOrClDucted - done to ensure SCSysRpt objects created for existing ducted systems w/ altered ducts
  ; SAC 1/8/20 - revised logic to include output of heat, cool & ducts for Existing duct systems
	"Set ResHVACSys:MaxNumHVACEquipTypes"		ResHVACSys:MaxNumHVACEquipTypes	= {	if (FloorAreaServed[1] < 0.5) then  0
																										else 	if (Type == 2)
																												then  NumHtPumpSysUnits									; Project is New Cons .OR. HVACSys is New or Altered or HVACDist is New or Altered
                                                                                    else if (Type == 4)  ; central
                                                                                    then  ValidOr( NumCentralEqpUnits, 0 )
																												else	max( NumHeatSysUnits, NumCoolSysUnits )
																												endif endif
																										endif  }
;																										else if (ResProj:RunScope == 1 .OR. Status > 1 .OR. (IsExisting .AND. IsVerified) .OR.
;																													(IsExisting .AND. HtOrClDucted > 0.5 .AND. IfValidAnd( DistribSystem:Status > 1 )))

; SAC 9/4/13 - added logic to allow no ducts when distrib system's ResDistSys:Type = 12 ("LowLlCod - Verified low-leakage ducts in conditioned space") - GC issue 163
; SAC 5/21/14 - added 'LocalStatus( DistribSystem ) > 4' check to prevent bogus DuctMsg when DistribSystem created & assigned via ruleset (happens when simulated heat/cool system requires ducts even though user input system doesn't) - GC #312
	"Set ResHVACSys:DuctMsg"	ResHVACSys:DuctMsg	= {	if (HtOrClDucted > 0.5 .AND. LocalCompAssigned( DistribSystem ) == 0)
																	then	switch (HtOrClDucted)
																				case  1 : "Ducts required for heating system but not defined for this system."
																				case  2 : "Ducts required for cooling system but not defined for this system."
																				default : "Ducts required for heating & cooling systems but not defined for this system."
																			endswitch
																	else if (HtOrClDucted > 0.5 .AND. DistribSystem:DuctsPresent == 0 .AND. DistribSystem:Type != 7 .AND. DistribSystem:Type != 12)
																	then	switch (HtOrClDucted)
																				case  1 : "Ducts required for heating system but assigned distribution system lacks ducts."
																				case  2 : "Ducts required for cooling system but assigned distribution system lacks ducts."
																				default : "Ducts required for htg & clg systems but assigned distribution system lacks ducts."
																			endswitch
																	else if (HtOrClDucted < 0.5 .AND. LocalCompAssigned( DistribSystem ) > 0 .AND. LocalStatus( DistribSystem ) > 4)
																	then	if (DistribSystem:DuctsPresent > 0 .AND. ResProj:BypassRuleLimits < 0.5)
																			then  "Ducts not required for heating or cooling but included in assigned distribution system."
																			else  " "  endif
																	else  " "  endif endif endif  }


	"Rules to compare HVACSys vs. Standard design"		ResHVACSys:Action		= {	if (Type == 1 .OR. Type == 3)
																										then  EvalRulelist( "SetupHVACSys_HeatCoolVsStandard", 1 )
																										else if (Type == 2)
																										then	EvalRulelist( "SetupHVACSys_HtPumpVsStandard", 1 )
																										else	UNCHANGED  endif endif  }

; SAC 12/26/14 - logic to setup duct vs. std design enumeration
; mjb 1/29/15 - mods to lookup Std Duct Leakage & Rval from T24RClimateZoneCodeBase table
; mjb 1/29/15 - P.S. why do SAC rules check validity of DuctInsRvalue twice?  why do SAC rules use Rval = 6 when Stds vary between 6 and 8, by CZ?
;	"Set ResHVACSys:DuctsVsStandard"		ResHVACSys:DuctsVsStandard	= {	if (HtOrClDucted < 1)
;																						then  -1		; "Worse than Standard"
;																						else if (IfValidAnd( DistribSystem:DuctLeakageValUse = 8.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     = 6.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     = 6.0 ))
;																						then	 0		; "Equal to Standard"
;																						else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= 8.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     >= 6.0 ) .AND.
;																									IfValidAnd( DistribSystem:DuctInsRvalue     >= 6.0 ))
;																						then	 1		; "Better than Standard"
;																						else  -1		; "Worse than Standard"
;																						endif endif endif  }
; SAC 11/9/15 - revised thrid operation in each if/then to reference "Ret"DuctInsRvalue & added logic comparing altered inputs to ALTERED DuctRval values
	"Set ResHVACSys:DuctsVsStandard"		ResHVACSys:DuctsVsStandard	= {	if (HtOrClDucted < 1)
																						then  -1		; "Worse than Standard"
																						else if (DistribSystem:Status == 2)	; ALTERED
																						then	if (		IfValidAnd( DistribSystem:DuctLeakageValUse =  T24RClimateZoneCodeBase:DuctLkg(     "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     =  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  =  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 0		; "Equal to Standard"
																								else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= T24RClimateZoneCodeBase:DuctLkg(     "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 1		; "Better than Standard"
																								else  -1		; "Worse than Standard"
																								endif endif
																						else	if (		IfValidAnd( DistribSystem:DuctLeakageValUse =  T24RClimateZoneCodeBase:DuctLkg(  "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     =  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  =  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 0		; "Equal to Standard"
																								else if (IfValidAnd( DistribSystem:DuctLeakageValUse <= T24RClimateZoneCodeBase:DuctLkg(  "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:DuctInsRvalue     >= T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) .AND.
																											IfValidAnd( DistribSystem:RetDuctInsRvalue  >= T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ))
																								then	 1		; "Better than Standard"
																								else  -1		; "Worse than Standard"
																								endif endif
																						endif endif  }
	"Set ResHVACSys:DistribSystem:DuctsVsStandard"		ResHVACSys:DistribSystem:DuctsVsStandard	= {	DuctsVsStandard  }

;	"store BEMProc details"		ResHVACSys:Action = {  StoreBEMProc( "after setting HVACSys-HaveHeating", 0 )  }
;	"debugging"		ResHVACSys:Action		= {	MessageBox( "check BEMProc file for HVACSys '%s'", ResHVACSys:Name )  }
	
END


; SAC 12/26/14 - new rulelists to check for system performance vs. standard design
;*************************************************************************
RULELIST "SetupHVACSys_HeatCoolVsStandard" 0 0 0 0
;*************************************************************************
	"Set ResHVACSys:StdSysSEER & StdSysEER via subordinate rulelists"
			ResHVACSys:Action	= {	if (HaveCooling < 1 .OR. CoolSysType < 1)
										then  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdCoolViaCaliforniaSEERtoEERFormula", 1 )
										else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdCoolViaCaliforniaEERtoSEERFormula", 1 )
										else  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										endif endif endif  }
; mjb 1/30/15 - mods to lookup CFMperTon std from T24RClimateZoneCodeBase
;	"Set ResHVACSys:CoolEqpVsStandard"		ResHVACSys:CoolEqpVsStandard	= {	if (HaveCooling < 1 .OR. CoolSysType < 1) then  -1		; "Worse than Standard"
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) ==  0 .OR.
;																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) == -1 .AND. IfValidAnd( HtOrClDucted > 1 )))
;																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
;																											  (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon = 350 )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
;																													 (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon <= 350 )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								endif endif  }
	"Set ResHVACSys:CoolEqpVsStandard"		ResHVACSys:CoolEqpVsStandard	= {	if (HaveCooling < 1 .OR. CoolSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) ==  0 .OR.
																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) == -1 .AND. IfValidAnd( HtOrClDucted > 1 )))
																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
																											  (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon = T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
																													 (IfValidAnd( ClSysCFMperTon = 0 ) .OR. IfValidAnd( ClSysCFMperTon <= T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								endif endif  }

	"Set ResHVACSys:HeatEqpVsStandard"		ResHVACSys:HeatEqpVsStandard	= {	if (HaveHeating < 1 .OR. HeatSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RHeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0 .AND.
																											LocalStatus( HtSysAFUE ) > 0)
																								then	if (HtSysAFUE == T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HtSysAFUE > T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else if (T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0 .AND.
																											LocalStatus( HPSysHSPF ) > 0)
																								then	if (HPSysHSPF == T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HPSysHSPF > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else			-1		; "Worse than Standard"
																								endif endif endif  }
END
;*************************************************************************
RULELIST "SetupHVACSys_HtPumpVsStandard" 0 0 0 0
;*************************************************************************
	"Set ResHVACSys:StdSysSEER & StdSysEER via subordinate rulelists"
			ResHVACSys:Action	= {	if (HtPumpSysType < 1)
										then  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdHtPumpCoolViaCaliforniaSEERtoEERFormula", 1 )
										else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
										then  EvalRulelist( "Default_HVACSys_StdHtPumpCoolViaCaliforniaEERtoSEERFormula", 1 )
										else  EvalRulelist( "Default_HVACSys_StdCool_Undefined", 1 )
										endif endif endif  }
; mjb 1/30/15 - mods to lookup CFMperTon std. from T24RClimateZoneCodeBase
;	"Set ResHVACSys:CoolEqpVsStandard"		ResHVACSys:CoolEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) ==  0 .OR.
;																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND. HtOrClDucted > 1))
;																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
;																											  (ClSysCFMperTon == 0 .OR. ClSysCFMperTon == 350) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
;																													 (ClSysCFMperTon == 0 .OR. ClSysCFMperTon <= 350) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
;																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
;																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
;																										then	 0		; "Equal to Standard"
;																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
;																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
;																										then	 1		; "Better than Standard"
;																										else	-1		; "Worse than Standard"
;																										endif endif
;																								endif endif  }
	"Set ResHVACSys:CoolEqpVsStandard"		ResHVACSys:CoolEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) ==  0 .OR.
																										  (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == -1 .AND. HtOrClDucted > 1))
																								then	; System IS COOL DUCTED - so include CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) .AND.
																											  (ClSysCFMperTon == 0 .OR. ClSysCFMperTon == T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) .AND.
																													 (ClSysCFMperTon == 0 .OR. ClSysCFMperTon <= T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else	; System IS NOT COOL DUCTED - so EXclude CFMperTon in Std design comparison
																										if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER = ClSysSEER )) .AND.
																											  (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  = ClSysEER  )) )
																										then	 0		; "Equal to Standard"
																										else if ( (LocalStatus( StdSysSEER ) < 1 .OR. IfValidAnd( StdSysSEER <= ClSysSEER )) .AND.
																													 (LocalStatus( StdSysEER  ) < 1 .OR. IfValidAnd( StdSysEER  <= ClSysEER  )) )
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								endif endif  }

	"Set ResHVACSys:HeatEqpVsStandard"		ResHVACSys:HeatEqpVsStandard	= {	if (HtPumpSysType < 1) then  -1		; "Worse than Standard"
																								else if (T24RHeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
																								then	if (HPSysHSPF == T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HPSysHSPF > T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else if (T24RHeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
																								then	if (HtSysAFUE == T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
																										then	 0		; "Equal to Standard"
																										else if (HtSysAFUE > T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
																										then	 1		; "Better than Standard"
																										else	-1		; "Worse than Standard"
																										endif endif
																								else			-1		; "Worse than Standard"
																								endif endif endif  }
END


;*************************************************************************
RULELIST "BlastHVACSysUserInput_Heating" 1 0 0 0
   "Redefault ResHVACSys:AutoSizeHeatInp"		ResHVACSys:AutoSizeHeatInp		= {   UNDEFINED  }
   "Redefault ResHVACSys:HeatDucted"			ResHVACSys:HeatDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastHVACSysUserInput_Cooling" 1 0 0 0
   "Redefault ResHVACSys:AutoSizeCoolInp"		ResHVACSys:AutoSizeCoolInp		= {   UNDEFINED  }
   "Redefault ResHVACSys:CoolDucted"			ResHVACSys:CoolDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastHVACSysUserInput_HeatPump" 1 0 0 0
;   "Redefault ResHVACSys:AutoSizeHeatInp"		ResHVACSys:AutoSizeHeatInp		= {   UNDEFINED  }
;   "Redefault ResHVACSys:AutoSizeCoolInp"		ResHVACSys:AutoSizeCoolInp		= {   UNDEFINED  }
   "Redefault ResHVACSys:HtPumpDucted"			ResHVACSys:HtPumpDucted			= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_Heating" 1 0 0 0
;   "Redefault DwellUnitType:AutoSizeHeatInp"		DwellUnitType:AutoSizeHeatInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:HeatDucted"			DwellUnitType:HeatDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_Cooling" 1 0 0 0
;   "Redefault DwellUnitType:AutoSizeCoolInp"		DwellUnitType:AutoSizeCoolInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:CoolDucted"			DwellUnitType:CoolDucted			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastDwellUnitTypeUserInput_HeatPump" 1 0 0 0
;;   "Redefault DwellUnitType:AutoSizeHeatInp"		DwellUnitType:AutoSizeHeatInp		= {   UNDEFINED  }
;;   "Redefault DwellUnitType:AutoSizeCoolInp"		DwellUnitType:AutoSizeCoolInp		= {   UNDEFINED  }
;   "Redefault DwellUnitType:HtPumpDucted"			DwellUnitType:HtPumpDucted			= {	UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_HVACDist" 0 0 0 0
;*************************************************************************
   ; SAC 6/1/17 - tic #621
   "Default HVACDist properties that may impact default Type"  ResDistSys:Action  = {
         EvalRulelist( "Default_HVACDist_PriorToType", 1 )  }

   ; SAC 8/25/13 - added default for ResDistSys:Type
   ; SAC 5/22/14 - added logic to default to attic only if attic area above cond zone(s) >= 10% of CFA and in crawl space (also if >= 10% CFA)
   ; SAC 5/23/14 - revised defaulting to require user input if a valid attic is not present (per call w/ Bruce 5/23/14)
   ; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on ResProj:IsMFamDupOrTownhm)
   ; SAC 6/1/17 - added logic to prevent Type default of 1 (attic) if attic too small for default ducts (tic #621)
   ; revised logic to reference ResProj:AtticAreaOKForDucts - SAC 08/13/20 (tic #1062)
	"Set ResDistSys:Type"		ResDistSys:Type	 	= {	
    if( ( ResProj:IsMultiFamily == 0 .OR. ResProj:IsMFamDupOrTownhm > 0.5) .AND. 
        ComponentCount( Attic ) > 0.5 .AND. 
        SumAll( ResAttic:ClVentableArea ) > 0 .AND.
			  SumAll( ResAttic:FloorAreaOverCond ) > 0 .AND. 
        IfValidAnd( ResProj:CondFloorArea > 1 ))
    then  if (IfValidAnd( ResProj:AtticAreaOKForDucts > 0 ) .AND.
              IfValidAnd( DuctsTooLrgForAttic = 0 ))
      then	1		; "Ducts located in attic (Ventilated and Unventilated)"
      else  0		; "- select distribution system type -"
      endif
    else  	0		; "- select distribution system type -"
    endif  }

	"Set ResDistSys:DuctsCreatedForAnalysis"		ResDistSys:DuctsCreatedForAnalysis		= {	0  }	; SAC 7/12/14

; mjb 12/2/15 - need no duct losses in Design Rating model for RESNET harmonization
	"Reset ResDistSys:Type"		ResDistSys:Type	 	= {	if (ResProj:DRtgRefRunID == 2014) then  12
	                                                   else UNCHANGED endif }
	
;	"debug"		ResDistSys:Action	= {	PostMessageToLog( "inside Default_HVACDist - HVACDist '%s':  Type = '%s' (%g) (status %d)  ResAttic:FloorArea = %g  ResAttic:FloorAreaOverCond = %g  ResProj:CondFloorArea = %g",
;																		Name, EnumString( Type ), Type, LocalStatus( Type ), SumAll( ResAttic:FloorArea ), SumAll( ResAttic:FloorAreaOverCond ), ResProj:CondFloorArea )  }

	"Default remaining HVACDist properties"	ResDistSys:Action	= {	EvalRulelist( "Default_HVACDist_OtherThanType", 1 )  }
END
;*************************************************************************
RULELIST "Default_HVACDist_ForceTypeDefault" 1 0 1 0
;*************************************************************************
   ; SAC 6/1/17 - tic #621
   "Default HVACDist properties that may impact default Type"  ResDistSys:Action  = {
         EvalRulelist( "Default_HVACDist_PriorToType", 1 )  }

   ; SAC 8/25/13 - added default for ResDistSys:Type
   ; SAC 5/22/14 - added logic to default to attic only if attic area above cond zone(s) >= 10% of CFA and in crawl space (also if >= 10% CFA)
   ; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on ResProj:IsMFamDupOrTownhm)
   ; LDH 8/03/16 - updated priority for single-family and/or Duplex/Townhome - Attic, Crawl, Conditioned Space (tic 689)
   ; SAC 6/1/17 - added logic to prevent Type default of 1 (attic) if attic too small for default ducts (tic #621)
   ; revised logic to reference ResProj:AtticAreaOKForDucts & CrawlAreaOKForDucts - SAC 08/13/20 (tic #1062)
   "Set ResDistSys:Type"		ResDistSys:Type	 	= {	
    if ( ( ResProj:IsMultiFamily == 0 .OR. ResProj:IsMFamDupOrTownhm > 0.5 ) .AND. 
         IfValidAnd( ResProj:CondFloorArea > 1 ) )
    then  if( ComponentCount( Attic ) > 0.5 .AND. SumAll( ResAttic:ClVentableArea ) > 0 .AND.
              IfValidAnd( ResProj:AtticAreaOKForDucts > 0 ) .AND.
              IfValidAnd( DuctsTooLrgForAttic = 0 ) )
          then 1    ; "Ducts located in Attic (Ventilated and Unventilated)"
          else if (IfValidAnd( ResProj:CrawlAreaOKForDucts > 0 ))
          then 2    ; "Ducts located in a crawl space"
          else 7    ; "Ducts located entirely in conditioned space"
          endif endif
    else  		7    ; MFAM or Townhouse: "Ducts located entirely in conditioned space"
    endif }

	"Set ResDistSys:DuctsCreatedForAnalysis"		ResDistSys:DuctsCreatedForAnalysis		= {	1  }	; SAC 7/12/14

; mjb 12/2/15 - need no duct losses in Design Rating model for RESNET harmonization
	"Reset ResDistSys:Type"		ResDistSys:Type	 	= {	if (ResProj:DRtgRefRunID == 2014) then  12
	                                                   else UNCHANGED endif }
	
;	"debug"		ResDistSys:Action	= {	PostMessageToLog( "inside Default_HVACDist_ForceTypeDefault - HVACDist '%s':  Type = '%s' (%g) (status %d)  ResAttic:FloorArea = %g  ResAttic:FloorAreaOverCond = %g  ResProj:CondFloorArea = %g",
;																		Name, EnumString( Type ), Type, LocalStatus( Type ), SumAll( ResAttic:FloorArea ), SumAll( ResAttic:FloorAreaOverCond ), ResProj:CondFloorArea )  }

;  mjb   10/28/14 - mods for existing HVAC in Additions Alone or E+A+A
; SAC 12/22/14 - removed logic preventing 'Default_HVACDist_OtherThanType' from being called for Existing HVACSys objects, since this HVACDist JUST CREATED for analysis and therefore requires defaulting... (GC issue 451)
	"Default remaining HVACDist properties"	ResDistSys:Action	= {	; if ((ResProj:IsAddAlone > 0.5 .AND. MinRevRef( ResHVACSys:DistribSystem, ResHVACSys:Status ) < 2) .OR. (ResProj:RunScope == 2 .AND. MinRevRef( ResHVACSys:DistribSystem, ResHVACSys:Status ) < 2)) then UNCHANGED else EvalRulelist( "Default_HVACDist_OtherThanType", 1 ) endif }
																							EvalRulelist( "Default_HVACDist_OtherThanType", 1 )  }
END

; SAC 6/1/17 - broke up ...OtherThanType HVACDist defaulting into rules to be evaluated PRIOR to Type (enabling determination of Attic size prior to defaulting Type)
;*************************************************************************
RULELIST "Default_HVACDist_PriorToType" 0 0 0 0
;*************************************************************************
	"Set ResDistSys:FloorAreaServed"	ResDistSys:FloorAreaServed   	=              ; revised following rule to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACDistRef, DwellUnitType:DUFloorAreaServed )
         else  SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:FloorAreaServed )  endif  }
;	mjb	4/17/14	need to keep track of existing floor area served to weight-average duct Rvalue for new HVACDist Status = 4 (Existing + New)
	"Set ResDistSys:exFloorAreaServed"	ResDistSys:exFloorAreaServed   	= {  SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:exFloorAreaSrvd )  }
;	"debug"		ResDistSys:Action	= {	MessageBox( "Default -- HVACDist '%s':  FloorAreaServed = %g  exFloorAreaServed = %g", Name, FloorAreaServed, exFloorAreaServed )  }
	"Set ResDistSys:NumStoriesServed"	ResDistSys:NumStoriesServed		= {  SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:NumStoriesServed )  }

   ; default duct insulation R-values (for calculating default duct exterior surface areas) (tic #621) - SAC 6/1/17
   "Set ResDistSys:DfltSupDuctInsRval - Default R value of supply duct insulation (for calc of duct areas)"  ; SAC 6/1/17 - tic #621 
      ResDistSys:DfltSupDuctInsRval  = {
         if (IfValidAnd( DuctsPresent > 0 ) .AND. IfValidAnd( DefaultSystem = 0 ) .AND.
             IfValidAnd( DuctDesign   > 0 ) .AND. IfValidAnd( DuctDesignInsRvalue > 0 ))
         then  DuctDesignInsRvalue
         else if (ResProj:RunScope == 2 .AND. Status == 2)
         then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", ValidOr( Proj:CliZnNum, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", ValidOr( Proj:CliZnNum, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         endif endif  }
   "Adjust high ResDistSys:DfltSupDuctInsRval"    ResDistSys:DfltSupDuctInsRval  = {
         if (IfValidAnd( DfltSupDuctInsRval <= 4.2 )) then  UNCHANGED
         else	(100 / (85 / (DfltSupDuctInsRval + 0.7) + 3.061)) - 0.7
         endif  }

   "Adjust ResDistSys:DfltRetDuctInsRval - Default R value of return duct insulation (for calc of duct areas)"  ; SAC 6/1/17 - tic #621 
      ResDistSys:DfltRetDuctInsRval  = {
         if (IfValidAnd( DuctsPresent > 0 ) .AND. IfValidAnd( DefaultSystem = 0 ) .AND.
             IfValidAnd( DuctDesign   > 0 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 0 ))
         then  RetDuctDesignInsRvalue
         else if (ResProj:RunScope == 2 .AND. Status == 2)
         then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", ValidOr( Proj:CliZnNum, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", ValidOr( Proj:CliZnNum, 7 ), "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         endif endif  }
   "Adjust high ResDistSys:DfltRetDuctInsRval"    ResDistSys:DfltRetDuctInsRval  = {
         if (IfValidAnd( DuctDesign > 0.5 ) .OR. (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR.
             (ResProj:RunScope == 2 .AND. Status == 1) )
         then  if (IfValidAnd( DfltRetDuctInsRval <= 4.2 )) then  UNCHANGED
               else	(100 / (85 / (DfltRetDuctInsRval + 0.7) + 3.061)) - 0.7
               endif
         else DfltRetDuctInsRval	endif  }

   ; default duct areas assuming ducts located in attic - used to ensure attic contains sufficient area for locating ducts
   "Set ResDistSys:DefaultSupDuctArea"      ResDistSys:DefaultSupDuctArea  = {
         if (IfValidAnd( NumStoriesServed > 1.5))
         then  0.65 * 0.27 * ValidOr( FloorAreaServed, 0 )
         else         0.27 * ValidOr( FloorAreaServed, 0 )
         endif  }
   "Set ResDistSys:DefaultRetDuctArea"      ResDistSys:DefaultRetDuctArea  = {
         if (IfValidAnd( NumStoriesServed > 1.5))
         then  0.10 * ValidOr( FloorAreaServed, 0 )
         else  0.05 * ValidOr( FloorAreaServed, 0 )
         endif  }

   "Default ResDistSys:SupplyDuctDiam"		ResDistSys:SupplyDuctDiam	= {	 8  }
   "Default ResDistSys:ReturnDuctDiam"		ResDistSys:ReturnDuctDiam	= {	16  }

   ; rules to set supply & return duct surface areas (and max areas) to ensure they fit in the selected attic (if attic located) (tic #621) - SAC 6/1/17
   "Set ResDistSys:SupDuctSurfaceArea - Surface area of DEFAULT supply ducts (used in check for ducts too large for attic)"  ; SAC 6/1/17 - tic #621 
      ResDistSys:SupDuctSurfaceArea  = {
         if (SupplyDuctDiam <= 0 .OR. IfValidAnd( DfltSupDuctInsRval > 0 )==0)
         then  DefaultSupDuctArea
         else  DefaultSupDuctArea * ( (SupplyDuctDiam/12) + (2 * DfltSupDuctInsRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12)
         endif  }
   "Set ResDistSys:RetDuctSurfaceArea - Surface area of DEFAULT return ducts (used in check for ducts too large for attic)"  ; SAC 6/1/17 - tic #621
      ResDistSys:RetDuctSurfaceArea  = {
         if (ReturnDuctDiam <= 0 .OR. IfValidAnd( DfltRetDuctInsRval > 0 )==0)
         then  DefaultRetDuctArea
         else  DefaultRetDuctArea * ( (ReturnDuctDiam/12) + (2 * DfltRetDuctInsRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12)
         endif  }

   "Set ResDistSys:DuctsTooLrgForAttic - Flag indicating ducts too large for attic (0=they fit, 1=Supply too large, 2=Return too large, 3=No default Attic)"  ; SAC 6/1/17 - tic #621
      ResDistSys:DuctsTooLrgForAttic  = {
         if (IfValidAnd( ResProj:MaxDuctFracArea > 0 )==0 .OR. SupplyDuctDiam <= 0 .OR. 
             GlobalCompAssigned( ResProj:DefaultDuctAtticRef ) < 1)
         then  3
         else if ( SupDuctSurfaceArea /
                   ( ValidOr( ResProj:DefaultDuctAtticRef:DeckArea, 0 ) +
                     ValidOr( ResProj:DefaultDuctAtticRef:TrussArea, 0 ) +
                     SupDuctSurfaceArea + RetDuctSurfaceArea ) > ResProj:MaxDuctFracArea)
         then  1
         else if ( RetDuctSurfaceArea /
                   ( ValidOr( ResProj:DefaultDuctAtticRef:DeckArea, 0 ) +
                     ValidOr( ResProj:DefaultDuctAtticRef:TrussArea, 0 ) +
                     SupDuctSurfaceArea + RetDuctSurfaceArea ) > ResProj:MaxDuctFracArea)
         then  2
         else  0  endif endif endif  }
;"dbg" ResDistSys:Action = { PostMessageToLog( "   just set ResDistSys:DuctsTooLrgForAttic to %g for model '%s', HVACDist '%s' - SupDuctSurfaceArea %g / DefaultDuctAtticRef:DeckArea %g / DefaultDuctAtticRef:TrussArea %g / SupDuctSurfaceArea %g / RetDuctSurfaceArea %g / ResProj:MaxDuctFracArea %g", 
;                                                   DuctsTooLrgForAttic, ResProj:RunAbbrev, Name, SupDuctSurfaceArea, ValidOr( ResProj:DefaultDuctAtticRef:DeckArea, 0 ),
;                                                   ValidOr( ResProj:DefaultDuctAtticRef:TrussArea, 0 ), SupDuctSurfaceArea, RetDuctSurfaceArea, ResProj:MaxDuctFracArea ) }
END

;*************************************************************************
RULELIST "Default_HVACDist_OtherThanType" 0 0 0 0
;*************************************************************************
	"Set ResDistSys:TypeAbbrev"			ResDistSys:TypeAbbrev	 	= {  Local( Type )  }
	"Set ResDistSys:TypeAbbrevStr"		ResDistSys:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }
	"Set ResDistSys:IsAvailable"			ResDistSys:IsAvailable 	= {  1  }		; until flags setup to disable unimplemented distribution types...

; ResDistSys:Status,       	     		Default,   0,    1,   1,    1,  1,  1
	"Set ResDistSys:ShowStatus"			ResDistSys:ShowStatus		= {	if (ResProj:RunScope == 2 .OR. (ResProj:RunScope == 1 .AND. ResProj:IsAddAlone > 0.5)) then  1  else  0  endif  }		; SAC 4/10/15

; mjb - removed case options for ResDistSys:Type(s) no longer suported 8/20/13
	"Set ResDistSys:DuctsPresent"		ResDistSys:DuctsPresent = {	switch (Local( Type ))
																					case  0 :  0   ; "- select distribution system type -"
																					case  7 :  0   ; "Ducts located entirely in conditioned space"  - SAC 4/7/13 - added to prevent duct modeling for DuctsInAll (GC Issue #50)
																					case  8 :  0   ; "Distribution systems without ducts"
																	;				case 10 :  0   ; "Ductless-Furnaces - Heating equipment such as wall and floor furnaces"
																	;				case 11 :  0   ; "Ductless-Radiant - Radiant electric panels or fanless systems"
																					case 12 :  0   ; "Verified low-leakage ducts entirely in conditioned space"
																	;				case 14 :  0   ; "Baseboard - Electric or hydronic baseboards"
																					default :  1   ; all other system types
																				endswitch  }
	"Set ResDistSys:DuctsMayReqReport - flag value for tracking whether ducts may require compliance reporting" 		; SAC 4/28/15 - in part for issue 504
									ResDistSys:DuctsMayReqReport	= {	switch (Type)
																					case  0 :  0   ; "- select distribution system type -"
																	;				case  7 :  0   ; "DuctsInAll - HVAC system(s) with all HVAC ducts located in conditioned space"  - SAC 4/7/13 - added to prevent duct modeling for DuctsInAll (GC Issue #50)
																					case  8 :  0   ; "DuctsNone - Air distribution systems without ducts"
																	;				case 10 :  0   ; "Ductless-Furnaces - Heating equipment such as wall and floor furnaces"
																	;				case 11 :  0   ; "Ductless-Radiant - Radiant electric panels or fanless systems"
																	;				case 12 :  0   ; "LowLlCod - Verified low-leakage ducts in conditioned space"
																	;				case 14 :  0   ; "Baseboard - Electric or hydronic baseboards"
																					default :  1   ; all other system types
																				endswitch  }

  ; SAC 12/30/15 - added to force HVACDist defaulting when assigned to heat-only systems (tic 544)
  ; LDH  8/23/16 - removed rule to allow user input HeatingOnly HVACDist properties to reamin in proposed model (tic 689)
;	"Reset ResDistSys:DefaultSystem if serves heat-only system(s)"	ResDistSys:Action	= {
;				if (LocalStatus( DefaultSystem ) < 5 .OR. IfValidAnd( DefaultSystem > 0.5 )) then  UNCHANGED
;				else if (FloorAreaServed < 0.1 .OR. IfValidAnd( ResProj:CondFloorArea > 1 ) == 0) then  UNCHANGED
;				else if (SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:HaveHeating ) == SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:HaveCooling )) then  UNCHANGED
;				else	EvalRulelist( "ForceDefault_HVACDist_DefaultSystem", 1 )  endif endif endif  }

;   "Default ResDistSys:DefaultSystem"     ResDistSys:DefaultSystem   = {  if (Status == 1) then 0 else 1 endif }
   "Default ResDistSys:DefaultSystem"     ResDistSys:DefaultSystem   = {  1  }

  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
  ; SAC 7/15/14 - expanded HVACDist defaulting to be more consistent w/ hierarchical reset definitions (GC issue #327)
  ; SAC 12/27/14 - added logic to PRESERVE ALL data when defaulting Std design model for altered/verified system
  ; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
	"Ensure ResDistSys:DefaultSystem valid"		ResDistSys:Action	= {
						if (IfValidAnd( ResProj:EnergyCodeYearNum = 0 )) then  UNCHANGED   ; SAC 3/13/17 - do nothing for ExEDR
						else if ((ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr") .AND.
						         ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. IfValidAnd( DuctsVsStandard >= 0 )) then  UNCHANGED
						else if (ValidOr( DefaultSystem, 1 ) > 0.5) then	EvalRulelist( "ForceDefaults_HVACDist", 1 )
						else if (ValidOr( LowLkgAH, 0 ) < 0.5) then			EvalRulelist( "ForceDefaults_HVACDist_LowLkgAH", 1 )
						else if (IfValidAnd( DuctLeakage > 0 )) then			EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )
						else  UNCHANGED  endif endif endif endif endif  }
				;		then	if (	LocalStatus( DuctLeakage    ) > 4  .OR.  LocalStatus( DuctLeakageVal   ) > 4  .OR.  LocalStatus( DuctInsRvalOpt ) > 4  .OR.
				;						LocalStatus( DuctInsRvalue  ) > 4  .OR.  LocalStatus( SupplyDuctArea   ) > 4  .OR.  LocalStatus( ReturnDuctArea ) > 4  .OR.
				;						LocalStatus( SupplyDuctDiam ) > 4  .OR.  LocalStatus( ReturnDuctDiam   ) > 4  .OR.  LocalStatus( SupplyDuctLoc  ) > 4  .OR.
				;						LocalStatus( ReturnDuctLoc  ) > 4  .OR.  LocalStatus( RetDuctInsRvalue ) > 4  .OR.  LocalStatus( DuctDesign     ) > 4  .OR.  LocalStatus( LowLkgAH ) > 4 )
				;				then	EvalRulelist( "ForceDefaults_HVACDist", 1 )
				;				else	UNCHANGED  endif
				;		else	UNCHANGED  endif  }
	"Ensure valid ResDistSys:DuctDesign defaulting"		ResDistSys:Action	= {
	               if (DefaultSystem < 0.5 .AND. ValidOr( DuctDesign, 0 ) < 0.5) then	EvalRulelist( "ForceDefaults_HVACDist_DuctDesign", 1 )
						else  UNCHANGED  endif  }

	"Default ResDistSys:LowLkgAH"				ResDistSys:LowLkgAH				= {	0  }		; mjb 10/02/13 - need to ensure Low Leakage Air Handler is properly defaulted to zero

	"Default ResDistSys:DuctLeakage"			ResDistSys:DuctLeakage			= {	if (IfValidAnd( ResProj:EnergyCodeYearNum = 0 )) then  0   ; SAC 3/13/17 - ExEDR
	                                                                        else if ( FloorAreaServed  > 0 .AND. (Status == 1 .OR. (Status == 4 .AND. IfValidAnd(IsLessThanFortyFt > 0.5))) )
																									then  900		; "Existing (not specified)"		; mjb	8/1/14	- added for E+A+A reporting
																									else  800		; "Sealed and tested"
																									endif endif  }
; mjb 1/29/15 - mods to lookup Std Duct Leakage from T24RClimateZoneCodeBase table
; mjb 1/29/15 - I think DuctLeakageVal default actually only used for LowLkgAH default, which is why it is set to 6 not 8
;	"Default ResDistSys:DuctLeakageVal"		ResDistSys:DuctLeakageVal 	= {	6  }	
	"Default ResDistSys:DuctLeakageVal"		ResDistSys:DuctLeakageVal 	=   ; fix for Github issue #77 - was:  {	T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) - 2  }	
      {  if (Proj:IsComRuleset .AND. IfValidAnd( Proj:AnalysisVersion >= 220302 ))
         then  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 1
         else  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 2  endif  }

   ; SAC 10/30/19 - ensure buried duct inputs that were previously user inputs are defaulted for 2019+ code vintages (tic #1128)
   "Redefault AreBuried & AreDeeplyBuried flags if user-defined in 2019+ code vintages"   ResDistSys:Action  =
      {  if (Proj:StdDesignBase < 2019 .OR. (LocalStatus( AreBuried ) < 6 .AND. LocalStatus( AreDeeplyBuried ) < 6)) then  UNCHANGED
         else  EvalRulelist( "Blast_HVACDist_AreBuriedFlags", 1 )  endif  }

;	mjb	4/24/14	added defaulting for buried ducts
	"Default ResDistSys:DuctDesign"				ResDistSys:DuctDesign			= {	0  }		
	"Default ResDistSys:AreBuried"				ResDistSys:AreBuried			= {	0  }		
	"Default ResDistSys:AreDeeplyBuried"		ResDistSys:AreDeeplyBuried	= {	0  }		
	"Default ResDistSys:IsLessThanFortyFt"	ResDistSys:IsLessThanFortyFt	= {	0  }  ; SAC 6/15/18 - restore rule to default IsLessThanFortyFt so that it is VALID in future value checks (tic #981)

;    ResDistSys:DuctLeakage

  ; SAC 10/8/13 - mod to ensure that proper DuctLeakageVal defined when DuctLeakage set to something OTHER THAN '- specify -'  (GC issue #167)
   "Ensure ResDistSys:DuctLeakageVal reset when DuctLeakage != '- specify -'"	ResDistSys:Action	= {
						if (DefaultSystem < 0.5 .AND. DuctLeakage > 0 .AND. LocalStatus( DuctLeakageVal ) > 4)
						then  EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )  else  UNCHANGED  endif  }

;	mjb-10/9/13 ALWAYS default DuctLeakageVal to 8.0
; mjb-10/21/13 	EXCEPT when there is a LowLkgAH - then default to 6.0
;	mjb 5/6/14	except when ducts are existing
; SAC 12/26/14 - additional logic to handle altered/verified duct leakage
; mjb 1/29/15 - mods to lookup Std Duct Leakage from T24RClimateZoneCodeBase table
;	"Default ResDistSys:DuctLeakageValUse"			ResDistSys:DuctLeakageValUse	= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctLeakageValUse ) > 0)
;																											then	exDuctLeakageValUse
;																											else if ( ResProj:RunScope == 2 .AND. Status == 1 ) then 15 
;																											else if (LowLkgAH < 0.5 ) then 8.0 else DuctLeakageVal  endif endif endif	}
;	"Set ResDistSys:DuctLeakageValRpt"					ResDistSys:DuctLeakageValRpt	= { 	if ( ResProj:RunScope == 2 .AND. Status == 1 ) then 15
;																								 			else if (LowLkgAH < 0.5 ) then 6.0 else DuctLeakageValUse endif endif	}
; SAC 5/22/17 - mods to ensure use of higher T24RClimateZoneCodeBase:exDuctLkg setting for Existing+New ducts where IsLessThanFortyFt = 0 (tic #822)
; SAC 5/7/18 - added logic to treat AA models the same as EAA re: duct leakage (tic #986)
	"Default ResDistSys:DuctLeakageValUse"			ResDistSys:DuctLeakageValUse	= {
         if ((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND.
             Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctLeakageValUse ) > 0)
         then	exDuctLeakageValUse
         else if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND.
                   ( (Status == 4 .AND. IfValidAnd( IsLessThanFortyFt = 0 )) .OR.
                      Status == 1 ) ) then T24RClimateZoneCodeBase:exDuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) 
         else if (LowLkgAH > 0.5 .OR. (DuctLeakage < 1 .AND. IfValidAnd( ResProj:EnergyCodeYearNum = 0 ))) then  DuctLeakageVal
         else  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif endif	}
; SAC 2/19/20 - revised reporting value for MFam models to adjust by -1 for MFam models (vs. -2 for SFam) (tic #1168)
	"Set ResDistSys:DuctLeakageValRpt"					ResDistSys:DuctLeakageValRpt	= {
         if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND.
              ((Status == 4 .AND. IfValidAnd( IsLessThanFortyFt = 0 )) .OR.
                Status == 1) ) then T24RClimateZoneCodeBase:exDuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else if (LowLkgAH > 0.5 .OR. (DuctLeakage < 1 .AND. IfValidAnd( ResProj:EnergyCodeYearNum = 0 ))) then  DuctLeakageValUse
         else if (ResProj:IsMultiFamily > 0.5)
         then  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 1
         else  T24RClimateZoneCodeBase:DuctLkg( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )- 2  endif endif endif	}
;	"debug DuctLeakageValRpt"					ResDistSys:Action	= { 	if ( Status != 1 ) then UNCHANGED else
;																							MessageBox( "ResDistSys: '%s'  DuctLeakageValRpt %g", Name, DuctLeakageValRpt )
;																						endif	}
;	"Default ResDistSys:DuctLeakageVal"		ResDistSys:DuctLeakageVal	= {	if (DuctLeakage > 10) then  DuctLeakage / 100
;																								else  UNDEFINED  endif  }

	"Default ResDistSys:HasBypassDuct"			ResDistSys:HasBypassDuct	= {	0  }		; SAC 5/20/13 - added per Bruce request

   ; SAC 5/7/18 - force reset of ResDistSys:exDuctInsRvalOpt if not displayed (to fix problem where default in prior versions not set properly) (tic #986)
   "Force reset of ResDistSys:exDuctInsRvalOpt if not currently an input"
      ResDistSys:Action = {  if (LocalStatus( exDuctInsRvalOpt ) < 7) then  UNCHANGED    ; not user-defined
                           else if (ResProj:RunScope = 2 .AND.
                                    ((Status = 2 .AND. IsVerified > 0) .OR.
                                      Status = 4 )) then  UNCHANGED  ; currently a valid input
                           else  EvalRulelist( "ForceDefault_HVACDist_exDuctInsRvalOpt", 1 )  endif endif  }

;   "Default ResDistSys:DuctInsRvalue"     ResDistSys:DuctInsRvalue   = {  if (Global( Proj:CliZnNum ) < 0.5) then  UNDEFINED
;																							 else  ClimateZoneTable( Global( Proj:CliZnNum ), 4 )  endif  }
; SAC 12/27/14 - added logic to prevent setting DuctInsRvalOpt in cases where we need to retain a valid (previous) DuctInsRvalue in order to set an altered/verified ins r-val below (setting this causes a reset of DuctInsRvalue which prevents the rule below from working as designed)
; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - added call to new T24RClimateZoneCodeBase:AltDuctRval() for ALTERED analysis
; SAC 6/15/16 - added logic to set duct R-val to 0 when ducts are not present (no ducts or ducts in cond space) (tic #654)
; SAC 9/14/16 - expand (DuctsPresent < 0.5) logic to ensure proper 2016 default (mandatory requirement sec. 150.0(m)) of 4.2 (tic #749)
; SAC 9/30/16 - Similar mod to above (#749) but for 2013 - ensure un-modeled ducts report InsRVal of 6.0 (or 8 depending on CZ) to meet CalCerts requirement (tic #754)
;"dbg std dsgn ResDistSys:DuctInsRvalOpt"  ResDistSys:Action = {  if (IfValidAnd( ResProj:RunAbbrev = "s" )==0 .AND. IfValidAnd( ResProj:RunAbbrev = "zb" )==0) then  UNCHANGED
;      else  MessageBox( "setting HVACDist '%s' DuctInsRvalOpt (%g status %g):  ResDistSys:Status %g,  IsVerified %g,  DuctInsRvalue %g,  exDuctInsRvalue %g", Name, DuctInsRvalOpt, LocalStatus( DuctInsRvalOpt ), Status, IsVerified, DuctInsRvalue, exDuctInsRvalue )  endif  }
   "Default ResDistSys:DuctInsRvalOpt"		ResDistSys:DuctInsRvalOpt	= {
         if (Global( Proj:CliZnNum ) < 0.5) then  UNDEFINED
         else if (Status == 1) then UNCHANGED
         else if (IfValidAnd( DuctInsRvalue > 0 ) .AND. ResProj:RunScope == 2 .AND. Status == 2 .AND.
                  IsVerified .AND. IfValidAnd( exDuctInsRvalue > 0 )) then  UNCHANGED
;			else  ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) * 100  endif endif endif }
			else if (DuctsPresent < 0.5)
			then  if (Proj:StdDesignBase >= 2016 .AND. 
			            ( Type ==  7 .OR.   ; "Ducts located entirely in conditioned space"
			              Type == 12 ))     ; "Verified low-leakage ducts entirely in conditioned space"
			      then  420      ; ensures proper reporting w/out effecting analysis
			      else if (Proj:StdDesignBase < 2016 .AND. 
   			            ( Type ==  7 .OR.   ; "Ducts located entirely in conditioned space"
	   		              Type == 12 ))     ; "Verified low-leakage ducts entirely in conditioned space"
      		 	then  T24RClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100
			      else  0
			      endif endif
			else if (ResProj:RunScope == 2 .AND. Status == 2)
			then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100 
			else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) * 100  endif endif endif endif endif }
   "Default ResDistSys:DuctDesignInsRvalue"			ResDistSys:DuctDesignInsRvalue	= {	if (Global( Proj:CliZnNum ) < 0.5) then  UNDEFINED
;																							 					else  ClimateZoneTable( Global( Proj:CliZnNum ), 4 )  endif  }
																												else if (ResProj:RunScope == 2 .AND. Status == 2)
																											 	then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																							 					else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
   "Default ResDistSys:RetDuctDesignInsRvalue"		ResDistSys:RetDuctDesignInsRvalue	= {	if (Global( Proj:CliZnNum ) < 0.5) then  UNDEFINED
;																							 						else  ClimateZoneTable( Global( Proj:CliZnNum ), 4 )  endif  }
																													else if (ResProj:RunScope == 2 .AND. Status == 2)
																												 	then  T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																							 						else  T24RClimateZoneCodeBase:DuctRval(    "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
; mjb 5/6/14 - added outer-most if/then logic to properly account for Designed Ducts
; mjb 7/10/14 - only execute this rule for Ducts used in Project (FloorAreaServed > 0)
; mjb 10/28/14 - mods to work wtih existing Ducts in Additions Alone

;   "Default ResDistSys:Status for Additions Alone with existing HVCSys"
;                                          ResZn:HVACSystem:DistribSystem:Status   =  {  if ( ResProj:IsAddAlone > 0.5 .AND. HVACSysStatus == 1 ) then 1 else UNCHANGED endif   }
   "Default exDuctInsRvalue for Additions Alone with existing Ducts"
                                          ResDistSys:exDuctInsRvalue   =  {  if ( ResProj:IsAddAlone > 0.5 .AND. Status == 1 ) then DuctInsRvalOpt/100 else UNCHANGED endif   }

; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - switched T24RClimateZoneCodeBase:DuctRval() to ...:AltDuctRval() (ALTERED analysis)
; SAC 5/7/18 - added reference to new ExistDuctsInVerifSys property to prevent reset of DuctInsRvalue for Existing Ducts assigned to Altered & Verified HVACSystems (tic #986)
	"Default ResDistSys:DuctInsRvalue"			ResDistSys:DuctInsRvalue	= {
         if (IfValidAnd( DuctDesign < 0.5 ) ) then
				if ( ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exDuctInsRvalue
					else if ( IfValidAnd( DuctInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. Status == 1 .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then exDuctInsRvalue
				else if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctInsRvalOpt > -.1 ) ) then  DuctInsRvalOpt / 100	else  UNDEFINED  endif endif endif endif
			else
				if ( ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exDuctInsRvalue
					else if ( IfValidAnd( DuctDesignInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. Status == 1 .AND. LocalStatus( exDuctInsRvalue ) > 0 ) then exDuctInsRvalue
				else if ( (ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0.5) .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. LocalStatus( DuctDesignInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctDesignInsRvalue * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctDesignInsRvalue > -.1 ) ) then  DuctDesignInsRvalue	else  UNDEFINED  endif endif endif endif
			endif	}
;	mjb 1/12/15																					if ( IfValidAnd( DuctInsRvalue >= ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) ) ) then exDuctInsRvalue 
;	replaced these lines with new table in above rule								else ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) endif
;	would not compile with these lines commented out								if ( IfValidAnd( DuctDesignInsRvalue >= ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) ) ) then exDuctInsRvalue 
;																									else ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) endif
																								
;	"Check for buried ducts"					ResDistSys:DuctInsRvalue	= {	if ( AreBuried .AND. AreDeeplyBuried ) then
;																									((BuriedDuctRvalue * BuriedDuctLength) + (DeepBuriedDuctRvalue * DeepBuriedDuctLength))/(BuriedDuctLength + DeepBuriedDuctLength)
;																								else if ( AreBuried ) then
;																									BuriedDuctRvalue
;																								else if ( AreDeeplyBuried ) then
;																									DeepBuriedDuctRvalue
;																								else UNCHANGED endif	endif endif	}

;	mjb	4/17/14	on above rule, added E+A+A logic to floor-area weight average Duct R-value when Ducts have Status = 4 (Existing + New)
;	"debug Adjust DuctInsRvalue"				ResDistSys:Action	= { if ( Status != 4 ) then UNCHANGED else
;																						MessageBox( "Adjusted DuctInsRvalue in Default '%s' %g", Name, DuctInsRvalue )
;																					endif	}
; mjb	3/13/14	-.1 above used to be 50, but this won't work for zero insulation																								
;	"debug"		ResDistSys:Action	= {	if (FloorAreaServed > 0) then MessageBox( "Default -- HVACDist '%s':  ResProj:RunScope = %g,  Status = %g,  IsVerified = %g,  DuctInsRvalue = %g  exDuctInsRvalue = %g", Name, ResProj:RunScope, Status, IsVerified,	DuctInsRvalue, exDuctInsRvalue ) else UNCHANGED endif }
;	"debug"		ResDistSys:Action	= {	if (exFloorAreaServed > 0) then MessageBox( "Default -- HVACDist '%s':  ResProj:RunScope = %g,  Status = %g,  DuctInsRvalue = %g  DuctInsRvalOpt = %g exDuctInsRvalOpt = %g", Name, ResProj:RunScope, Status, DuctInsRvalue, DuctInsRvalOpt, exDuctInsRvalOpt ) else UNCHANGED endif  }

; 	mjb 4/28/14 replaced the following with equation for DuctInsAdjRval for ALL values of DuctInsRvalue						
;	"Set ResDistSys:DuctInsAdjRval"				ResDistSys:DuctInsAdjRval	= {	if (DuctInsRvalue == 4.2) then  4.2
;																									else if (DuctInsRvalue == 6  ) then  5.65
;																									else if (DuctInsRvalue == 8  ) then  7.09
;																								else  DuctInsRvalue  endif endif endif		}		; should throw error if no specific conversion to DuctInsAdjRval found
;	mjb	4/28/14	=(100/(85/(DuctInsRvalue+0.7)+3.061))-0.7  from Bruce's duct R-value correction spreadsheet (considers 15% of ductwork only able to have min insulation of R=4.2)
; SAC 10/24/14 - added if statement to prevent duct ins Rval adjustment if the user input is <= R4.2
; SAC 4/12/19 - added new InsAdjRval logic for 2019 rules - R-6 mandatory min duct R & new formula (from CB) taking into account this plus fraction of existing ducts (tic #874)					
	"Set ResDistSys:DuctInsAdjRval"				ResDistSys:DuctInsAdjRval	= {
	      if (ResProj:EnergyCodeYearNum < 2019)
	      then  if (IfValidAnd( DuctInsRvalue <= 4.2 )) then  DuctInsRvalue
					else	(100 / (85 / (DuctInsRvalue + 0.7) + 3.061)) - 0.7
					endif
         else  if ( IfValidAnd( DuctInsRvalue <= 4.2 ) .OR.
                   (IfValidAnd( DuctInsRvalue <= 6.0 ) .AND. IfValidAnd( SupplyDuctFracEx > 0)==0)) then  DuctInsRvalue
					else	(100 / (85/(DuctInsRvalue + 0.7) + ValidOr(SupplyDuctFracEx, 0) * 15/(4.2 + 0.7) + (1 - ValidOr(SupplyDuctFracEx, 0))*15/(6 + 0.7))) - 0.7
					endif
			endif  }

;	mjb - duplicate rules to default new return duct insulation	8/22/13
;	"Default ResDistSys:RetDuctInsRvalue"			ResDistSys:RetDuctInsRvalue	= {	if (DuctDesign > 0.5) then UNCHANGED else DuctInsRvalue endif	}
; SAC 8/29/13 - revised to ensure valid default whenever (GC issue 151)
; mjb 5/6/14 - added outer-most if/then logic to properly account for Designed Ducts
; mjb 7/10/14 - only execute this rule for Ducts used in Project (FloorAreaServed > 0)
; mjb 1/12/15 - use new T24RClimateZoneCodeBaseTable for code level lookups
; SAC 11/9/15 - switched T24RClimateZoneCodeBase:DuctRval() to ...:AltDuctRval() (ALTERED analysis)
; SAC 5/7/18 - added reference to new ExistDuctsInVerifSys property to prevent reset of DuctInsRvalue for Existing Ducts assigned to Altered & Verified HVACSystems (tic #986)
	"Default ResDistSys:RetDuctInsRvalue"			ResDistSys:RetDuctInsRvalue	= {
         if (IfValidAnd( DuctDesign < 0.5 ) ) then
				if ( ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exRetDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exRetDuctInsRvalue
					else if ( IfValidAnd( RetDuctInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exRetDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( ResProj:RunScope == 2 .AND. Status == 1 .AND. LocalStatus( exRetDuctInsRvalue ) > 0) then exRetDuctInsRvalue 
				else if ( ResProj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( DuctInsRvalOpt > -.1 ) ) then  DuctInsRvalOpt / 100	else  UNDEFINED  endif endif endif endif
			else
				if ( ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND. LocalStatus( exRetDuctInsRvalue ) > 0 ) then
					if (IfValidAnd( ExistDuctsInVerifSys > 0 )) then  exRetDuctInsRvalue
					else if ( IfValidAnd( RetDuctDesignInsRvalue >= T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) ) ) then exRetDuctInsRvalue 
					else T24RClimateZoneCodeBase:AltDuctRval( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif endif
				else if ( ResProj:RunScope == 2 .AND. Status == 1 .AND. LocalStatus( exRetDuctInsRvalue ) > 0) then exRetDuctInsRvalue 
				else if ( ResProj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. LocalStatus( RetDuctDesignInsRvalue ) > 0 .AND. FloorAreaServed > 0 ) then
					((RetDuctDesignInsRvalue * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
				else if ( IfValidAnd( RetDuctDesignInsRvalue > -.1 ) ) then  RetDuctDesignInsRvalue	else  UNDEFINED  endif endif endif endif
			endif	}
;	mjb 1/12/15  																						if ( IfValidAnd( RetDuctInsRvalue >= ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) ) ) then exRetDuctInsRvalue 
;	replaced these lines with new table in above rule										else ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) endif
;	would not compile with these lines commented out										if ( IfValidAnd( RetDuctDesignInsRvalue >= ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) ) ) then exRetDuctInsRvalue 
;																											else ClimateZoneTable( Global( Proj:CliZnNum ), 4 ) endif

; SAC 12/12/13 - added logic to ensure that RetDuctInsAdjRval is set based on RetDuctInsRvalue in Altered & Verified E+A+A scenario
; 	mjb 4/28/14 replaced the following with equation for DuctInsAdjRval for ALL values of DuctInsRvalue	
; SAC 10/24/14 - added if statement to prevent duct ins Rval adjustment if the user input is <= R4.2					
;	"Set ResDistSys:RetDuctInsAdjRval"				ResDistSys:RetDuctInsAdjRval	= {	if (IfValidAnd(DuctDesign > 0.5) .OR. (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR. (ResProj:RunScope == 2 .AND. Status == 1) )
;																										then	if (IfValidAnd( RetDuctInsRvalue <= 4.2 )) then  RetDuctInsRvalue
;																												else	(100 / (85 / (RetDuctInsRvalue + 0.7) + 3.061)) - 0.7
;																												endif
;															  											else DuctInsAdjRval	endif  }   ; should throw error if no specific conversion to DuctInsAdjRval found
;;															  if (RetDuctInsRvalue == 4.2) then  4.2
;;																else if (RetDuctInsRvalue == 6  ) then  5.65
;;															   else if (RetDuctInsRvalue == 8  ) then  7.09
;;																else     RetDuctInsRvalue  endif endif endif 
; SAC 4/12/19 - added new InsAdjRval logic for 2019 rules - R-6 mandatory min duct R & new formula (from CB) taking into account this plus fraction of existing ducts (tic #874)					
	"Set ResDistSys:RetDuctInsAdjRval"				ResDistSys:RetDuctInsAdjRval	= {
         if (IfValidAnd(DuctDesign > 0.5) .OR. (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified) .OR. (ResProj:RunScope == 2 .AND. Status == 1) )
         then	if (ResProj:EnergyCodeYearNum < 2019)
      	      then  if (IfValidAnd( RetDuctInsRvalue <= 4.2 )) then  RetDuctInsRvalue
                     else	(100 / (85 / (RetDuctInsRvalue + 0.7) + 3.061)) - 0.7
                     endif
               else  if ( IfValidAnd( RetDuctInsRvalue <= 4.2 ) .OR.
                         (IfValidAnd( RetDuctInsRvalue <= 6.0 ) .AND. IfValidAnd( ReturnDuctFracEx > 0)==0)) then  RetDuctInsRvalue
      					else	(100 / (85/(RetDuctInsRvalue + 0.7) + ValidOr(ReturnDuctFracEx, 0) * 15/(4.2 + 0.7) + (1 - ValidOr(ReturnDuctFracEx, 0))*15/(6 + 0.7))) - 0.7
		      			endif
               endif
         else DuctInsAdjRval	endif  }

; SAC 9/4/13 - added logic to not ever specify Attic for MFam ducts due to fire code restrictions (GC issue 164)
; SAC 4/15/15 - adjust for MFam duplex/townhomes options
; LDH 8/04/16 - updated ResDistSys:Type and ResDistSys:DuctLocation descriptions per current enums
	"Default ResDistSys:DuctLocation"      ResDistSys:DuctLocation    = {
		;	if (DuctsPresent < 0.5) then  0    - removed dependence on DuctsPresent, as leakage still needing to be modeled even when DuctsPresent = 0 (GC issue 162 - SAC 9/4/13)
		;	else	switch ( Type )
					switch ( Type )
						case  2 :  5  ; "Ducts located in a crawl space" -->> "Crawl Space"
				;		case  3 :  5  ; "DuctsCVC - Ducts located underfloor in a controlled ventilation crawl space"
						case  4 :  2  ; "Ducts located in a garage" -->> 
				;		case  5 :  4  ; "DuctsBasemt - Ducts located in an unconditioned basement"
						case  6 :     ; "Ducts located within the conditioned space (except < 12 lineal ft)" -->> "Outside" (MFAM) or "Attic"		; SAC 9/4/13 - was 3 - switched to 1 - related to GC issue 162 where duct leakage modeled TO attic zone
										if ((ResProj:IsMultiFamily > 0.5 .AND. ResProj:IsMFamDupOrTownhm < 0.5) .OR. MaxAll( ResAttic:FloorArea ) < 1) then  6  else  1  endif	  ; SAC 6/10/18 - apply same mod as below (check of attic area) to address tic #949
						case  7 :     ; "Ducts located entirely in conditioned space" -->>  "Outside" (MFAM or no Attic) or "Attic"		; SAC 9/4/13 - was 3 - switched to 1 - related to GC issue 162 where duct leakage modeled TO attic zone
										if ((ResProj:IsMultiFamily > 0.5 .AND. ResProj:IsMFamDupOrTownhm < 0.5) .OR. MaxAll( ResAttic:FloorArea ) < 1) then  6  else  1  endif	  ; SAC 10/7/13 - added check of attic area to if statement in attempt to fix comment #1 of GC issue #197
						case  8 :  3  ; "Distribution systems without ducts" -->> "Conditioned Zone"
						case  9 :  6  ; "Ducts located in outdoor locations" -->> "Outside"
						case  12 : 0  ; "Verified low-leakage ducts entirely in conditioned space" -->> "n/a"
						case  13 : 7  ; "Ducts located in multiple places"  -->>  "Multiple"
						default :  	  ; -else-  Attic  (iff allowed)
										1		; SAC 10/30/14 - removed logic to model attic ducts outside for MFam models - was:  if (ResProj:IsMultiFamily > 0.5) then  6  else  1  endif
					endswitch  }
	"Default ResDistSys:DuctLocation - round 2: Garage, Crawl, Uncond -> Attic if no garage/crawl"
			ResDistSys:DuctLocation	= {		  if (DuctLocation == 2 .AND. (ResProj:HasGarage < 0.5 .OR. MaxAll( ResGarage:Area ) < 1)) then  1
													else if (DuctLocation == 5 .AND.  MaxAll( ResCrawlSpc:Area      ) < 1 ) then  1
													else  UNCHANGED  endif endif  }
; SAC 7/17/14 - modified rule to relocate ducts from attic to conditioned space if insufficient attic area over conditioned space exists
	"Default ResDistSys:DuctLocation - round 3: Attic -> Cond if no attic"
			ResDistSys:DuctLocation	= {	if (DuctLocation == 1 .AND. (SumAll( ResAttic:FloorAreaOverCond ) / ResProj:CondFloorArea) <= 0.0999) then  3
													else  UNCHANGED  endif  }

; SAC 10/30/14 - removed logic to prevent ducts in attic for MFam models
;;	mjb - added Round 4 for MF change in Default	8/22/13
;	"Default ResDistSys:DuctLocation - round 4: Attic -> Cond if multi-family"
;			ResDistSys:DuctLocation	= {	if (DuctLocation == 1 .AND. ResProj:IsMultiFamily > 0.5) then  3
;													else  UNCHANGED  endif  }

   ; SAC 4/7/19 - added for UI mods associated w/ buried ducts work (tic #874)
   "Set ResDistSys:LocationLabels[1]-Supply"   ResDistSys:LocationLabels[1]  = {
         ; if (IfValidAnd( DuctDesign > 0 )) then  UNDEFINED
         if (Type > 12.5) then  "Supply Duct Location:"
         else if (Type = 1 .AND. IfValidAnd( DefaultSystem = 0 )) then  "Supply Duct ResAttic:"
         else  UNDEFINED  endif endif  }
   "Set ResDistSys:LocationLabels[2]-Return"   ResDistSys:LocationLabels[2]  = {
         ; if (IfValidAnd( DuctDesign > 0 )) then  UNDEFINED
         if (Type > 12.5) then  "Return Duct Location:"
         else if (Type = 1 .AND. IfValidAnd( DefaultSystem = 0 )) then  "Return Duct ResAttic:"
         else  UNDEFINED  endif endif  }

   ; SAC 5/6/15 - moved initial Attic defaulting from ResDistSys:*DuctLoc rules into new :*DuctAttic rules, then reference those data in the :*DuctLoc defaults
   ; SAC 6/1/17 - replaced Attic selection logic w/ reference to new ResProj:DefaultDuctAtticRef property (tic #621)
	"Default ResDistSys:SupplyDuctAttic"	ResDistSys:SupplyDuctAttic	= {
         if (DuctLocation != 1) then  UNDEFINED
         else  ResProj:DefaultDuctAtticRef
         endif  }
	"Default ResDistSys:ReturnDuctAttic"	ResDistSys:ReturnDuctAttic	= {	SupplyDuctAttic  }

;"dbg" ResDistSys:Action = { if (DuctLocation != 7) then UNCHANGED
;         else PostMessageToLog( "   locating '%s' ducts to multiple places:  DuctsTooLrgForAttic %g", Name, ValidOr( DuctsTooLrgForAttic, -1 ) ) endif }
   ;	mjb - modified case statement to match DuctLocation update 	8/22/13
   ; SAC 9/10/19 - added OtherZone logic (MFamProto)
   "Default ResDistSys:SupplyDuctLoc"		ResDistSys:SupplyDuctLoc =            ; added logic to prevent assignment to attic when DuctsTooLrgForAttic flag set - SAC 05/06/21
	   {  switch ( DuctLocation )
            case  1 :	SupplyDuctAttic                     ; "Attic"               
            case  2 :	MaxAllComp( ResGarage:Area          )  ; "Garage"              
            case  3 :	if (SumAll( ResOtherZn:CondFloorArea ) > 0 .AND. SumAll( ResZn:CondFloorArea ) > 0)
                        then  if (MaxAll( ResOtherZn:CondFloorArea ) > MaxAll( ResZn:CondFloorArea ))
                              then  MaxAllComp( ResOtherZn:CondFloorArea )
                              else  MaxAllComp(      ResZn:CondFloorArea )  endif
                        else  MaxAllComp(            ResZn:CondFloorArea )  endif  ; "Conditioned Zone"    
     ;       case  4 :	MaxAllComp( ResZn:UncondFloorArea )  ; "Unconditioned Zone"  
            case  5 :	MaxAllComp( ResCrawlSpc:Area      )  ; "Crawl Space"         
            case  7 :	     if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.        ; "Multiple"
                                 SumAll( ResAttic:ClVentableVolume ) > 0.1)  then  MaxAllComp( ResAttic:ClVentableVolume )
            				else if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.
                                 SumAll( ResAttic:FloorAreaOverCond ) > 0.1) then  MaxAllComp( ResAttic:FloorAreaOverCond )
								else if (SumAll( ResCrawlSpc:Area ) > 0)           then  MaxAllComp( ResCrawlSpc:Area )
								else if (SumAll( ResGarage:Area ) > 0 .AND.
											Global( ResProj:HasGarage ) > 0.1)          then  MaxAllComp( ResGarage:Area )
            				else if (IfValidAnd( DuctsTooLrgForAttic > 0 )==0 .AND.
                                 SumAll( ResAttic:FloorArea ) > 0.1 )        then  MaxAllComp( ResAttic:FloorArea )
								else if (SumAll( ResOtherZn:CondFloorArea ) > 0 .AND. SumAll( ResZn:CondFloorArea ) > 0)
                        then  if (MaxAll( ResOtherZn:CondFloorArea ) > MaxAll( ResZn:CondFloorArea ))
                              then  MaxAllComp( ResOtherZn:CondFloorArea )
                              else  MaxAllComp(      ResZn:CondFloorArea )  endif
                        else  MaxAllComp(            ResZn:CondFloorArea )    ; "Conditioned Zone"
								endif endif endif endif endif endif        
				default :	UNDEFINED
			endswitch  }
   "Default ResDistSys:ReturnDuctLoc"		ResDistSys:ReturnDuctLoc = {  SupplyDuctLoc  }

; SAC 5/6/15 - new properties that reference either (new) ResDistSys:*DuctAttic or :*DuctLoc to track the location actually used to simulate the duct location
	"Set ResDistSys:SupplyDuctLocUse"		ResDistSys:SupplyDuctLocUse	= {	switch ( DuctLocation )
																									case  1 :	SupplyDuctAttic    ; "Attic"
																									default :	SupplyDuctLoc      ; any other
																								endswitch  }
	"Set ResDistSys:ReturnDuctLocUse"		ResDistSys:ReturnDuctLocUse	= {	switch ( DuctLocation )
																									case  1 :	ReturnDuctAttic    ; "Attic"
																									default :	ReturnDuctLoc      ; any other
																								endswitch  }

   "Default ResDistSys:SupplyDuctDiam"		ResDistSys:SupplyDuctDiam	= {	 8  }
   "Default ResDistSys:ReturnDuctDiam"		ResDistSys:ReturnDuctDiam	= {	16  }

;   "Default ResDistSys:SupplyDuctArea"    ResDistSys:SupplyDuctArea  = {  0.27 * Local( FloorAreaServed )  }
;   "Default ResDistSys:ReturnDuctArea"    ResDistSys:ReturnDuctArea  = {  	if (Local( NumStoriesServed ) > 1.5)
;																								then  0.10 * Local( FloorAreaServed )
;																								else  0.05 * Local( FloorAreaServed )  endif  }
; SAC 9/4/13 - GC issue 162 - revised above rules to set *DuctAreas to 0 when DuctsPresent flag set to 0 - certain duct Types still require duct modeling w/ surfaces areas = 0
; SAC 9/4/13 - GC issue 164 - added logic to ensure ducts located outside still get proper area defined, but zero area for MFam models (GC issue 166)
   "Default ResDistSys:SupplyDuctArea"    ResDistSys:SupplyDuctArea	= {	if (DuctsPresent < 0.5 .OR. (ResProj:IsMultiFamily > 0.5 .AND. DuctLocation == 6)) then  0
																								else  if (Type == 6)										; "DuctsInEx12 - Ducts located within the conditioned space (except < 12 lineal ft)"
																										then	0.027 * Local( FloorAreaServed )
																										else	0.27  * Local( FloorAreaServed )  endif endif  }
; mjb 4/24/14 - GC issue 297 - added if home > 1 floor - mult SupDuctArea * 0.65
	"Adjust ResDistSys:SupplyDuctArea"		 ResDistSys:SupplyDuctArea	= {	if (Local( NumStoriesServed ) > 1.5)
																										then  0.65 * SupplyDuctArea
																										else  UNCHANGED  endif	}
   "Default ResDistSys:ReturnDuctArea"    ResDistSys:ReturnDuctArea	= {	if (DuctsPresent < 0.5 .OR. (ResProj:IsMultiFamily > 0.5 .AND. DuctLocation == 6)) then  0
																								else	if (Local( NumStoriesServed ) > 1.5)
																										then  0.10 * Local( FloorAreaServed )
																										else  0.05 * Local( FloorAreaServed )  endif
																								endif  }

   ; added rules to set supply & return duct surface areas (and max areas) to ensure they fit in the selected attic (if attic located) (tic #621) - SAC 5/31/17
   "Set ResDistSys:SupDuctSurfaceArea - Surface area of supply ducts (used in check for ducts too large for attic)"  ; SAC 5/31/17 - tic #621 
      ResDistSys:SupDuctSurfaceArea  = {
         if (SupplyDuctDiam <= 0 .OR. IfValidAnd( DuctInsAdjRval > 0 )==0)
         then  SupplyDuctArea
         else  SupplyDuctArea * ( (SupplyDuctDiam/12) + (2 * DuctInsAdjRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12)
         endif  }
   "Set ResDistSys:RetDuctSurfaceArea - Surface area of return ducts (used in check for ducts too large for attic)"  ; SAC 5/31/17 - tic #621
      ResDistSys:RetDuctSurfaceArea  = {
         if (ReturnDuctDiam <= 0 .OR. IfValidAnd( RetDuctInsAdjRval > 0 )==0)
         then  ReturnDuctArea
         else  ReturnDuctArea * ( (ReturnDuctDiam/12) + (2 * RetDuctInsAdjRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12)
         endif  }

   "Set ResDistSys:MaxSupDuctArea-1 - Max supply duct SURFACE area"  ; SAC 5/31/17 - tic #621 
      ResDistSys:MaxSupDuctArea  = {
         if (DuctsPresent < 0.5 .OR. IfValidAnd( ResProj:MaxDuctFracArea > 0 )==0 .OR. Type != 1 .OR.
             LocalCompAssigned( SupplyDuctAttic ) < 1 .OR. SupplyDuctDiam <= 0)
         then  -1
         else if (IfValidAnd( SupplyDuctAttic = ReturnDuctAttic ))
         then  (ValidOr( SupplyDuctAttic:DeckArea, 0 ) + ValidOr( SupplyDuctAttic:TrussArea, 0 ) + RetDuctSurfaceArea) /
               ((1/ResProj:MaxDuctFracArea)-1)
         else  (ValidOr( SupplyDuctAttic:DeckArea, 0 ) + ValidOr( SupplyDuctAttic:TrussArea, 0 )) /
               ((1/ResProj:MaxDuctFracArea)-1)
         endif endif  }
   "Set ResDistSys:MaxSupDuctArea-2 - Max supply duct area (to be simulated in selected location)"  ; SAC 5/31/17 - tic #621 
      ResDistSys:MaxSupDuctArea  = {
         if (MaxSupDuctArea < 0 .OR. IfValidAnd( DuctInsAdjRval > 0 )==0) then  UNCHANGED
         else  MaxSupDuctArea / 
               ( ( (SupplyDuctDiam/12) + (2 * DuctInsAdjRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (SupplyDuctDiam/12) )
         endif  }

   "Set ResDistSys:MaxRetDuctArea-1 - Max return duct SURFACE area"  ; SAC 5/31/17 - tic #621 
      ResDistSys:MaxRetDuctArea  = {
         if (DuctsPresent < 0.5 .OR. IfValidAnd( ResProj:MaxDuctFracArea > 0 )==0 .OR. Type != 1 .OR.
             LocalCompAssigned( ReturnDuctAttic ) < 1 .OR. ReturnDuctDiam <= 0)
         then  -1
         else if (IfValidAnd( SupplyDuctAttic = ReturnDuctAttic ))
         then  (ValidOr( ReturnDuctAttic:DeckArea, 0 ) + ValidOr( ReturnDuctAttic:TrussArea, 0 ) + SupDuctSurfaceArea) /
               ((1/ResProj:MaxDuctFracArea)-1)
         else  (ValidOr( ReturnDuctAttic:DeckArea, 0 ) + ValidOr( ReturnDuctAttic:TrussArea, 0 )) /
               ((1/ResProj:MaxDuctFracArea)-1)
         endif endif  }
   "Set ResDistSys:MaxRetDuctArea-2 - Max return duct area (to be simulated in selected location)"  ; SAC 5/31/17 - tic #621 
      ResDistSys:MaxRetDuctArea  = {
         if (MaxRetDuctArea < 0 .OR. IfValidAnd( RetDuctInsAdjRval > 0 )==0) then  UNCHANGED
         else  MaxRetDuctArea / 
               ( ( (ReturnDuctDiam/12) + (2 * RetDuctInsAdjRval / (ValidOr( ResProj:DuctInsRValPerInch, 3 ) * 12) ) ) / (ReturnDuctDiam/12) )
         endif  }

;	mjb - moved to HVAC:Cool 	8/21/13
;	"Set ResDistSys:ShowIsZonal"		ResDistSys:ShowIsZonal		= {	if (LocalStatus( Type ) < 2) then  0
;																					else	T24RDistributionSystemsTable( Type, 2 )  endif  }
;	"Default ResDistSys:IsZonal"		ResDistSys:IsZonal			= {	0  }

; SAC 10/23/14 - moved up into ProposedInput rules so that they are set prior to export of Proposed model for reporting
   ;--------------------------------------------------------------------
   ; Assign physical duct locations for reporting 	mjb-10/08/13
   ;--------------------------------------------------------------------
;0,    "n/a"
;1,    "Attic"
;2,    "Garage"
;3,    "Conditioned Zone"
;4,    "Unconditioned Zone"
;5,    "Crawl Space"
;6,    "Outside"
;7,    "Multiple"
;Type:
;0,    "- select distribution system type -"
;1,    "Ducts located in unconditioned attic"
;2,    "Ducts located in a crawl space"
;4,    "Ducts located in a garage"
;6,    "Ducts located within the conditioned space (except < 12 lineal ft)"
;7,    "Ducts located entirely in conditioned space"
;8,    "Distribution systems without ducts"
;9,    "Ducts located in outdoor locations"
;12,    "Verified low-leakage ducts entirely in conditioned space"
;13,    "Ducts located in multiple places"

   ; SAC 9/18/19 - revised to support OtherZone assignments
	"Assign supply duct physical location"		ResDistSys:SupplyRptLocation =      ; added logic to properly classify ResOtherZn as either Garage or CondZn - SAC 02/04/22
                     { switch (Type)
									case   1 :	1
									case   2 :	5
									case   3 :	5
									case   4 :	2
									case   5 :	4
									case   6 :	3
									case   7 :	3
									case   8 :	0
									case   9 :	6
									case  12 :	3
									case  13 :	  if (LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "ResOtherZn" ))
                                    then  if (IfValidAnd( SupplyDuctLocUse:SpcFunc = 355 ) .OR.
                                              IfValidAnd( SupplyDuctLocUse:SpcFunc = 356 ))   ; SAC 02/08/22 - was: = "Parking Garage Area (Parking Zone and Ramps)" ))
                                          then  2
                                          else  3  endif
                                    else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "ResZn"       ) ) then 3
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "ResAttic"    ) ) then 1
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "ResGarage"   ) ) then 2
												else if ( LocalCompAssigned( SupplyDuctLocUse ) = ComponentType( "ResCrawlSpc" ) ) then 5
												else UNDEFINED
											endif endif endif endif endif
									default  :	1
								endswitch }

	"Assign return duct physical location"		ResDistSys:ReturnRptLocation =      ; added logic to properly classify ResOtherZn as either Garage or CondZn - SAC 02/04/22
                     { switch (Type)
									case   1 :	1
									case   2 :	5
									case   3 :	5
									case   4 :	2
									case   5 :	4
									case   6 :	3
									case   7 :	3
									case   8 :	0
									case   9 :	6
									case  12 :	3
									case  13 :	  if (LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "ResOtherZn" ))
                                    then  if (IfValidAnd( ReturnDuctLocUse:SpcFunc = 355 ) .OR.
                                              IfValidAnd( ReturnDuctLocUse:SpcFunc = 356 ) )   ; SAC 02/08/22 - was: = "Parking Garage Area (Parking Zone and Ramps)" ))
                                          then  2
                                          else  3  endif
                                    else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "ResZn"       ) ) then 3
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "ResAttic"    ) ) then 1
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "ResGarage"   ) ) then 2
												else if ( LocalCompAssigned( ReturnDuctLocUse ) = ComponentType( "ResCrawlSpc" ) ) then 5
												else UNDEFINED
											endif endif endif endif endif
									default  :	1
								endswitch }

  ; SAC 1/3/16 - Screen message re: QII or high duct R-value (tic 597)
  ; SAC 4/18/19 - added logic to report 'cannot exceed R-8' messages for 2016 and earlier codes only, as new 2019 DuctSeg UI disallows this
	"Set ResDistSys:DuctScreenMsg"		ResDistSys:DuctScreenMsg	= {
				if (FloorAreaServed < 0.1 .OR. DefaultSystem > 0.5) then  " "
				else if (DuctDesign > 0.5 .AND. (IfValidAnd( AreBuried > 0 ) .OR. IfValidAnd( AreDeeplyBuried > 0 )))
				then	"QII is required for buried duct credits"
				else if (Status != 1 .AND. DuctDesign < 0.5 .AND. DuctInsRvalOpt > 801)
				then	Format( "Error: Duct R-value (R-%g) cannot exceed R-8 unless verified and buried", (DuctInsRvalOpt/100) )
				else if (Proj:StdDesignBase <= 2016 .AND. Status != 1 .AND. DuctDesign > 0.5 .AND. IfValidAnd( AreBuried < 0.5 ) .AND. IfValidAnd( AreDeeplyBuried < 0.5 ) .AND.
								(IfValidAnd( DuctDesignInsRvalue > 8 ) .OR. IfValidAnd( RetDuctDesignInsRvalue > 8 )))
				then	if (IfValidAnd( DuctDesignInsRvalue > 8 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 8 ))
						then	"Error: Supply and return duct R-values cannot exceed R-8 unless verified and buried"
						else if (IfValidAnd( DuctDesignInsRvalue > 8 ))
						then	Format( "Error: Supply duct R-value (R-%g) cannot exceed R-8 unless verified and buried",    DuctDesignInsRvalue )
						else	Format( "Error: Return duct R-value (R-%g) cannot exceed R-8 unless verified and buried", RetDuctDesignInsRvalue )
						endif endif
				else	" "  endif endif endif endif  }

END

;*************************************************************************
RULELIST "Default_HVACDist_VerifiedDuctDesign" 0 0 0 0
;*************************************************************************

;    "BuriedPerACM"  enum options: 0-No / 1-Yes "whether or not duct R-value to be determined based on ACM rules on buried ducts"    - SAC 4/11/19

   "Reset ResDuctSeg:InsulRValue if it's invalid"     ResDuctSeg:Action  = {
         if (LocalSymbolInvalid( InsulRValue )) then  EvalRulelist( "ForceReset_DuctSeg_InsulRValue", 1 )
         else  UNCHANGED  endif  }

   "Set ResDuctSeg:AtticInsulDepth"    ResDuctSeg:AtticInsulDepth  = {
         if (AtticInsulType > 0 .AND. AtticInsulRValue > 0)
         then  switch (AtticInsulType)
                  case  1 :  (AtticInsulRValue/10) / 2.5   ; Fiberglass @ R-2.5/in
                  case  2 :  (AtticInsulRValue/10) / 3.2   ; Cellulose  @ R-3.2/in
                  default :  0
               endswitch
         else  0  endif  }

   ; SAC 4/5/19 - added look-up table sand rules to set individual DuctSeg data
   "Set ResDuctSeg:EffectiveRValue"    ResDuctSeg:EffectiveRValue  = {
         if (BuriedPerACM = 0) then  InsulRValue/10
         else if (InsulRValue > 0 .AND. AtticInsulType > 0 .AND. AtticInsulRValue > 0 .AND. Diameter > 0)
         then  BuriedDuctEffectiveRValue:EffR( "CodeBase", Proj:StdDesignBase, "DuctInsul", EnumString( InsulRValue ), "Material", EnumString( AtticInsulType ),
                                                                               "AtticInsulR", AtticInsulRValue/10, "DuctDiam", EnumString( Diameter ) )
         else  UNDEFINED  endif endif  }
   "Set ResDuctSeg:BuriedLevel"        ResDuctSeg:BuriedLevel  = {
         if (BuriedPerACM = 0) then  0
         else if (InsulRValue > 0 .AND. IfValidAnd( EffectiveRValue > 0 ))
         then  BuriedDuctLevel:Level( "CodeBase", Proj:StdDesignBase, "DuctInsul", EnumString( InsulRValue ), "EffR", EffectiveRValue )
         else  UNDEFINED  endif endif  }
   "Set ResDuctSeg:BuriedLevelFlags[1]-Not flag"   ResDuctSeg:BuriedLevelFlags[1] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 0) then  1  else  UNDEFINED  endif  }
   "Set ResDuctSeg:BuriedLevelFlags[2]-Part flag"  ResDuctSeg:BuriedLevelFlags[2] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 1) then  1  else  UNDEFINED  endif  }
   "Set ResDuctSeg:BuriedLevelFlags[3]-Full flag"  ResDuctSeg:BuriedLevelFlags[3] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 2) then  1  else  UNDEFINED  endif  }
   "Set ResDuctSeg:BuriedLevelFlags[4]-Deep flag"  ResDuctSeg:BuriedLevelFlags[4] = {  if (BuriedPerACM > 0 .AND. BuriedLevel = 3) then  1  else  UNDEFINED  endif  }

   "Reset ResDuctSeg:ContainmentSystem if needed"     ResDuctSeg:Action =     ; SAC 4/10/19 - tic #874
      {  ; if (LocalStatus( ContainmentSystem ) < 5) then  UNCHANGED  else
         if ( (BuriedLevel != 3 .AND. ContainmentSystem > 0) .OR.
              (BuriedLevel == 3 .AND. ContainmentSystem < 1) )
         then  EvalRulelist( "ForceDefault_DuctSeg_ContainmentSystem", 1 )
         else  UNCHANGED  endif  }

   "Set ResDuctSeg:SupplyArea"         ResDuctSeg:SupplyArea  = {
         if (Type != 1 .OR. IfValidAnd( Length > 0 )==0 .OR. Diameter < 10) then  UNDEFINED
         else  Length * 3.14159 * (Diameter/120)
         endif  }
   "Set ResDuctSeg:ReturnArea"         ResDuctSeg:ReturnArea  = {
         if (Type != 2 .OR. IfValidAnd( Length > 0 )==0 .OR. Diameter < 10) then  UNDEFINED
         else  Length * 3.14159 * (Diameter/120)
         endif  }

   ; SAC 4/12/19 (tic #874)
   "Set ResDuctSeg:ExSupplyArea"       ResDuctSeg:ExSupplyArea  = {
         if (IfValidAnd( SupplyArea > 0 ) .AND. ResProj:RunScope == 2 .AND. Status == 1) then  SupplyArea
         else  UNDEFINED  endif  }
   "Set ResDuctSeg:ExReturnArea"       ResDuctSeg:ExReturnArea  = {
         if (IfValidAnd( ReturnArea > 0 ) .AND. ResProj:RunScope == 2 .AND. Status == 1) then  ReturnArea
         else  UNDEFINED  endif  }

   "Set ResDuctSeg:SupplyUA"           ResDuctSeg:SupplyUA  = {
         if (IfValidAnd( SupplyArea > 0 )==0 .OR. IfValidAnd( EffectiveRValue > 0 )==0) then  UNDEFINED
         else  SupplyArea / (EffectiveRValue + 0.7)
         endif  }
   "Set ResDuctSeg:ReturnUA"           ResDuctSeg:ReturnUA  = {
         if (IfValidAnd( ReturnArea > 0 )==0 .OR. IfValidAnd( EffectiveRValue > 0 )==0) then  UNDEFINED
         else  ReturnArea / (EffectiveRValue + 0.7)
         endif  }

   "Set ResDuctSeg:ErrorID"      ResDuctSeg:ErrorID  = {
         if (IfValidAnd( Length > 0 )==0) then  100
         else  0  endif  }

   "Set ResDuctSeg:DuctRTooHiError - flag 0/1 indicating this duct's R-value is too high (>8 w/ BuriedPerACM = Yes)"    ResDuctSeg:DuctRTooHiError  =   ; SAC 4/18/19
      {  if (BuriedPerACM > 0 .AND. BuriedLevel < 1 .AND. IfValidAnd( EffectiveRValue >= 8.01 ))
         then  1  else  0  endif  }

   "Set HVACDist Supply duct design data if DuctSeg data valid"     ResDistSys:Action  = {
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNCHANGED  ; do nothing if not doing duct design
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0 .OR. SumChildren( ResDuctSeg:SupplyArea ) < 0.1)
         then  EvalRulelist( "Blast_HVACDist_VerifiedDuctDesign_Supply", 1 )
         else  EvalRulelist( "Set_HVACDist_VerifiedDuctDesign_Supply", 1 )
         endif endif  }
   "Set ResDistSys:SupplyDuctFracEx"        ResDistSys:SupplyDuctFracEx  =     ; SAC 4/12/19 (tic #874)
      {  if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0 .OR. ChildCount( DuctSeg ) < 1) then  0
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0) then  0
         else if (IfValidAnd( SupplyDuctArea > 0 ) .AND. SumChildren( ResDuctSeg:SupplyArea ) > 0)
         then  SumChildren( ResDuctSeg:ExSupplyArea ) / SumChildren( ResDuctSeg:SupplyArea )
         else  0  endif endif endif  }

   "Set HVACDist Return duct design data if DuctSeg data valid"     ResDistSys:Action  = {
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNCHANGED  ; do nothing if not doing duct design
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0 .OR. SumChildren( ResDuctSeg:ReturnArea ) < 0.1)
         then  EvalRulelist( "Blast_HVACDist_VerifiedDuctDesign_Return", 1 )
         else  EvalRulelist( "Set_HVACDist_VerifiedDuctDesign_Return", 1 )
         endif endif  }
   "Set ResDistSys:ReturnDuctFracEx"        ResDistSys:ReturnDuctFracEx  =     ; SAC 4/12/19 (tic #874)
      {  if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0 .OR. ChildCount( DuctSeg ) < 1) then  0
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0) then  0
         else if (IfValidAnd( ReturnDuctArea > 0 ) .AND. SumChildren( ResDuctSeg:ReturnArea ) > 0)
         then  SumChildren( ResDuctSeg:ExReturnArea ) / SumChildren( ResDuctSeg:ReturnArea )
         else  0  endif endif endif  }

   "Set ResDistSys:DuctDesignDlgMsg"     ResDistSys:DuctDesignDlgMsg  =       ; added CBECC (lowrise MFam) label strings - SAC 09/28/22
   {  if (Proj:IsSFamResRuleset) then
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNDEFINED  ; do message if not doing duct design
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0)
         then  switch (MaxChild( ResDuctSeg:ErrorID ))
                  case  100 :  Format( "  Describe each duct segment of HVACDist '%s':  Invalid or missing DuctSeg Length(s)", Name )
                  default   :  Format( "  Describe each duct segment of HVACDist '%s':  DuctSeg error(s) encountered", Name )
               endswitch
         else if (SumChildren( ResDuctSeg:SupplyArea ) > 0.1 .AND. SumChildren( ResDuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Supply duct area %.0f, R-value %.1f / Return duct area %.0f, R-value %.1f",
                           Name, SupplyDuctArea, DuctDesignInsRvalue, ReturnDuctArea, RetDuctDesignInsRvalue )
         else if (SumChildren( ResDuctSeg:SupplyArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Supply duct area %.0f, R-value %.1f", Name, SupplyDuctArea, DuctDesignInsRvalue )
         else if (SumChildren( ResDuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of HVACDist '%s':  Return duct area %.0f, R-value %.1f", Name, ReturnDuctArea, RetDuctDesignInsRvalue )
         else  Format( "  Describe each duct segment of HVACDist '%s':", Name )
         endif endif endif endif endif
      else 
         if (IfValidAnd( DefaultSystem != 0 ) .OR. IfValidAnd( DuctsPresent > 0 )==0 .OR.
             IfValidAnd( DuctDesign > 0 )==0) then  UNDEFINED  ; do message if not doing duct design
         else if (MaxChild( ResDuctSeg:ErrorID ) > 0)
         then  switch (MaxChild( ResDuctSeg:ErrorID ))
                  case  100 :  Format( "  Describe each duct segment of ResDistSys '%s':  Invalid or missing ResDuctSeg Length(s)", Name )
                  default   :  Format( "  Describe each duct segment of ResDistSys '%s':  ResDuctSeg error(s) encountered", Name )
               endswitch
         else if (SumChildren( ResDuctSeg:SupplyArea ) > 0.1 .AND. SumChildren( ResDuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of ResDistSys '%s':  Supply duct area %.0f, R-value %.1f / Return duct area %.0f, R-value %.1f",
                           Name, SupplyDuctArea, DuctDesignInsRvalue, ReturnDuctArea, RetDuctDesignInsRvalue )
         else if (SumChildren( ResDuctSeg:SupplyArea ) > 0.1)
         then  Format( "  Describe each duct segment of ResDistSys '%s':  Supply duct area %.0f, R-value %.1f", Name, SupplyDuctArea, DuctDesignInsRvalue )
         else if (SumChildren( ResDuctSeg:ReturnArea ) > 0.1)
         then  Format( "  Describe each duct segment of ResDistSys '%s':  Return duct area %.0f, R-value %.1f", Name, ReturnDuctArea, RetDuctDesignInsRvalue )
         else  Format( "  Describe each duct segment of ResDistSys '%s':", Name )
         endif endif endif endif endif
      endif  }
END
;************************************************************************* - SAC 4/11/19
RULELIST "ForceReset_DuctSeg_InsulRValue" 1 0 0 0
   "Set valid ResDuctSeg:InsulRValue"     ResDuctSeg:InsulRValue  = {  EnsureSymbolExists()  }
END
;************************************************************************* - SAC 4/10/19
RULELIST "ForceDefault_DuctSeg_ContainmentSystem" 1 0 0 0
   "Force default of ResDuctSeg:ContainmentSystem"    ResDuctSeg:ContainmentSystem = {
         if (BuriedLevel = 3)
         then  1   ; "not required"
         else  0   ; "n/a"
         endif  }
END

;************************************************************************* SAC 03/25/22
RULELIST  "Blast_ResHVACSys_AutoSizeInputs"  1 0 0 1
   "Blast ResHVACSys:AutoSizeHeatInp"     ResHVACSys:AutoSizeHeatInp  = {  UNDEFINED  }
   "Blast ResHVACSys:AutoSizeCoolInp"     ResHVACSys:AutoSizeCoolInp  = {  UNDEFINED  }
END

;*************************************************************************
; SAC 10/30/19 - ensure buried duct inputs that were previously user inputs are defaulted for 2019+ code vintages (tic #1128)
RULELIST  "Blast_HVACDist_AreBuriedFlags"  1 0 0 1
	"Blast ResDistSys:AreBuried"				ResDistSys:AreBuried			= {	UNDEFINED  }		
	"Blast ResDistSys:AreDeeplyBuried"		ResDistSys:AreDeeplyBuried	= {	UNDEFINED  }		
END
;************************************************************************* - SAC 4/9/19
RULELIST "Set_HVACDist_VerifiedDuctDesign_Supply" 1 0 1 0
   "Set ResDistSys:SupplyDuctArea"          ResDistSys:SupplyDuctArea  = {
         SumChildren( ResDuctSeg:SupplyArea ) * 1.1765  }   ; SAC 4/12/19 - apply 17.65% increase to represent plenums, etc. (tic #874)
   "Set ResDistSys:DuctDesignInsRvalue"     ResDistSys:DuctDesignInsRvalue  = {
         if (SumChildren( ResDuctSeg:SupplyUA ) < 0.001) then  UNDEFINED
         else  (SumChildren( ResDuctSeg:SupplyArea ) / SumChildren( ResDuctSeg:SupplyUA )) - 0.7  endif  }  ; SAC 4/12/19 - calc based on UN-adjusted area (tic #874)
   "Set ResDistSys:AreBuried"         ResDistSys:AreBuried        = {  if (SumChildren( ResDuctSeg:BuriedLevelFlags[2] ) .OR.
                                                                       SumChildren( ResDuctSeg:BuriedLevelFlags[3] )) then  1  else  UNCHANGED  endif  }  ; SAC 4/18/19 - revised to set AreBuried for either Partially or Fully buried (tic #874)
   "Set ResDistSys:AreDeeplyBuried"   ResDistSys:AreDeeplyBuried  = {  if (SumChildren( ResDuctSeg:BuriedLevelFlags[4] )) then  1  else  UNCHANGED  endif  }
END
;************************************************************************* - SAC 4/18/19
RULELIST "Blast_HVACDist_VerifiedDuctDesign_Supply" 1 0 0 0
   "Blast ResDistSys:SupplyDuctArea"       ResDistSys:SupplyDuctArea       = {  UNDEFINED  }
   "Blast ResDistSys:DuctDesignInsRvalue"  ResDistSys:DuctDesignInsRvalue  = {  UNDEFINED  }
END
;************************************************************************* - SAC 4/9/19
RULELIST "Set_HVACDist_VerifiedDuctDesign_Return" 1 0 1 0
   "Set ResDistSys:ReturnDuctArea"          ResDistSys:ReturnDuctArea  = {
         SumChildren( ResDuctSeg:ReturnArea ) * 1.1765  }   ; SAC 4/12/19 - apply 17.65% increase to represent plenums, etc. (tic #874)
   "Set ResDistSys:RetDuctDesignInsRvalue"  ResDistSys:RetDuctDesignInsRvalue  = {
         if (SumChildren( ResDuctSeg:ReturnUA ) < 0.001) then  UNDEFINED
         else  (SumChildren( ResDuctSeg:ReturnArea ) / SumChildren( ResDuctSeg:ReturnUA )) - 0.7  endif  }  ; SAC 4/12/19 - calc based on UN-adjusted area (tic #874)
   "Set ResDistSys:AreBuried"         ResDistSys:AreBuried        = {  if (SumChildren( ResDuctSeg:BuriedLevelFlags[2] ) .OR.
                                                                       SumChildren( ResDuctSeg:BuriedLevelFlags[3] )) then  1  else  UNCHANGED  endif  }  ; SAC 4/18/19 - revised to set AreBuried for either Partially or Fully buried (tic #874)
   "Set ResDistSys:AreDeeplyBuried"   ResDistSys:AreDeeplyBuried  = {  if (SumChildren( ResDuctSeg:BuriedLevelFlags[4] )) then  1  else  UNCHANGED  endif  }
END
;************************************************************************* - SAC 4/18/19
RULELIST "Blast_HVACDist_VerifiedDuctDesign_Return" 1 0 0 0
   "Blast ResDistSys:ReturnDuctArea"          ResDistSys:ReturnDuctArea          = {  UNDEFINED  }
   "Blast ResDistSys:RetDuctDesignInsRvalue"  ResDistSys:RetDuctDesignInsRvalue  = {  UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Fan" 0 0 0 0
;*************************************************************************
	"Default ResFanSys:Type"	ResFanSys:Type	= {	if (MaxRevRef( ResHVACSys:Fan, ResHVACSys:HasCentralFurnace ) > 0.5)
																then  1		; "Single Speed Fan"
										; later add check for IAQ system assignment => Fan:Type = 3: "Single Speed Stand Alone IAQ Fan"
																else  0  endif  }
	"Set ResFanSys:TypeAbbrev"		ResFanSys:TypeAbbrev		= {  Local( Type )  }
	"Set ResFanSys:TypeAbbrevStr"	ResFanSys:TypeAbbrevStr	= {  EnumString( TypeAbbrev )  }
	"Set ResFanSys:IsAvailable"		ResFanSys:IsAvailable		= {  1  }		; until flags setup to disable unimplemented fan types...
	"Set ResFanSys:FloorAreaServed"  	ResFanSys:FloorAreaServed   =         ; revised following rules to base *AreaServed on DwellUnitType data (iff MFam model AND no HVACSys assigned to Zones (yet)) - SAC 04/08/21
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUFloorAreaServed )
         else  SumRevRef( ResHVACSys:Fan, ResHVACSys:FloorAreaServed[1] )  endif  }
	"Set ResFanSys:ClFlrAreaServed"  	ResFanSys:ClFlrAreaServed   =
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUClFlrAreaServed ) + SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed )
         else  SumRevRef( ResHVACSys:Fan, ResHVACSys:ClFlrAreaServed    ) + SumRevRef( ResHVACSys:Fan, ResHVACSys:HtPmpFlrAreaServed[1] )  endif  }		; GC issue 450
	"Set ResFanSys:GasFurnAreaServed"  ResFanSys:GasFurnAreaServed =
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUGasFurnAreaServed )
         else  SumRevRef( ResHVACSys:Fan, ResHVACSys:GasFurnAreaServed  )  endif  }		; 2019 code (tic #928) - SAC 2/5/18
	"Set ResFanSys:HtPumpAreaServed"   ResFanSys:HtPumpAreaServed  =
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUHtPmpFlrAreaServed )
         else  SumRevRef( ResHVACSys:Fan, ResHVACSys:HtPmpFlrAreaServed[1]  )  endif  }	; 2019 fan power defaulting (tic #1074) - SAC 5/16/19
	"Set ResFanSys:SDHVAreaServed"     ResFanSys:SDHVAreaServed    =
      {  if (ResProj:IsMultiFamily .AND. SumAll( ResHVACSys:FloorAreaServed[1] ) < 1)
         then  SumRevRef( DwellUnitType:HVACFanRef, DwellUnitType:DUSDHVFlrAreaServed )
         else  SumRevRef( ResHVACSys:Fan, ResHVACSys:SDHVFlrAreaServed      )  endif  }	; 2019 fan power defaulting (tic #1041) - SAC 8/19/19

	"Call subordinate rulelist to default fan data"
		ResFanSys:Action = {	switch (Local( Type ))
										case  1 :  EvalRulelist( "Default_Fan_PSCFurnace", 1 )      ; "Single Speed Fan"
							;			case  2 :  EvalRulelist( "Default_Fan_WholeHouse", 1 )      ; "Whole House Fan"
							;			case  3 :  EvalRulelist( "Default_Fan_StandAloneIAQ", 1 )   ; "Single Speed Stand Alone IAQ Fan"
										default :  EvalRulelist( "Default_Fan_unknown", 1 )
									endswitch  }
END

;*************************************************************************
RULELIST "Setup_HVACDistFan" 1 0 1 0
;*************************************************************************
	"Set ResFanSys:Type"	ResFanSys:Type	= {	1  }		; Single Speed Fan
	"Default Fan"			ResFanSys:Action	= {	EvalRulelist( "Default_Fan", 1 )  }
; mjb	6/12/14	set TypeRpt = 0 for HVAC Fan when no cooling in Proposed Design
	"Set Fan TypeRpt"		ResFanSys:TypeRpt	= { 0 }
;	"DBG msg" ResFanSys:Action = { MessageBox( "Setup_HVACDistFan -- HVACFan '%s' TypeRpt = %g", Name, TypeRpt ) }
END
;*************************************************************************
RULELIST "Setup_HVACDist" 1 0 1 0
;*************************************************************************
	"Default HVACDist"			ResDistSys:Action	= {	EvalRulelist( "Default_HVACDist_ForceTypeDefault", 1 )  }
;	"Set HVACDist TypeRpt"		ResDistSys:TypeRpt	= { 0 }
;	"DBG msg" ResDistSys:Action = { MessageBox( "Setup_HVACDist -- HVACDist '%s' TypeRpt = %g", Name, TypeRpt ) }
END

; SAC 12/30/15 - added to force HVACDist defaulting when assigned to heat-only systems (tic 544)
;*************************************************************************
RULELIST "ForceDefault_HVACDist_DefaultSystem" 1 0 0 0
;*************************************************************************
	"Post message to log alerting to ResDistSys:DefaultSystem reset"
			ResDistSys:Action	= {	PostMessageToLog( "HVACDist '%s' being reset to default settings.  Duct performance trade-offs not allowed for heating-only systems.", Name )  }
	"Force reset of ResDistSys:DefaultSystem"	ResDistSys:DefaultSystem	= {  1  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACDist" 1 0 0 0
;*************************************************************************
	"Force Default of ResDistSys:DuctLeakage"    		ResDistSys:DuctLeakage     = {	if (LocalStatus( DuctLeakage    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:DuctLeakageVal" 		ResDistSys:DuctLeakageVal  = {  if (LocalStatus( DuctLeakageVal ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:DuctInsRvalOpt" 		ResDistSys:DuctInsRvalOpt  = {  if (LocalStatus( DuctInsRvalOpt ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:DuctInsRvalue"  		ResDistSys:DuctInsRvalue   = {  if (LocalStatus( DuctInsRvalue  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:RetDuctInsRvalue"  	ResDistSys:RetDuctInsRvalue   = {  if (LocalStatus( RetDuctInsRvalue  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResDistSys:SupplyDuctArea" 		ResDistSys:SupplyDuctArea  = {  if (LocalStatus( SupplyDuctArea ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResDistSys:ReturnDuctArea" 		ResDistSys:ReturnDuctArea  = {  if (LocalStatus( ReturnDuctArea ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:SupplyDuctDiam" 		ResDistSys:SupplyDuctDiam  = {  if (LocalStatus( SupplyDuctDiam ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:ReturnDuctDiam" 		ResDistSys:ReturnDuctDiam  = {  if (LocalStatus( ReturnDuctDiam ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:SupplyDuctLoc"  		ResDistSys:SupplyDuctLoc   = {  if (LocalStatus( SupplyDuctLoc  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:ReturnDuctLoc"  		ResDistSys:ReturnDuctLoc   = {  if (LocalStatus( ReturnDuctLoc  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:SupplyDuctAttic"  	ResDistSys:SupplyDuctAttic = {  if (LocalStatus( SupplyDuctAttic ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:ReturnDuctAttic"  	ResDistSys:ReturnDuctAttic = {  if (LocalStatus( ReturnDuctAttic ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	mjb - moved to HVACCool	8/21/13
;	"Force Default of ResDistSys:IsZonal"  				ResDistSys:IsZonal   		 = {  if (LocalStatus( IsZonal        ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
; SAC 8/29/13 - added for consistency
; remove default of bypass duct setting
;	"Force Default of ResDistSys:HasBypassDuct"  		ResDistSys:HasBypassDuct   = {  if (LocalStatus( HasBypassDuct  ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:DuctDesign"  			ResDistSys:DuctDesign      = {  if (LocalStatus( DuctDesign     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:LowLkgAH"		  		ResDistSys:LowLkgAH        = {  if (LocalStatus( LowLkgAH       ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Defaulting of LowLkgAH dependencies"		ResDistSys:Action          = {  EvalRulelist( "ForceDefaults_HVACDist_LowLkgAH", 1 )  }
	"Force Defaulting of DuctDesign dependencies"	ResDistSys:Action          = {  EvalRulelist( "ForceDefaults_HVACDist_DuctDesign", 1 )  }
;	"Force Default of ResDistSys:IsLessThanFortyFt"	ResDistSys:IsLessThanFortyFt	= {  if (LocalStatus( IsLessThanFortyFt ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_LowLkgAH" 1 0 0 0
	"Force Default of ResDistSys:DuctLeakage"			ResDistSys:DuctLeakage		= {  if (LocalStatus( DuctLeakage ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Defaulting of DuctLeakage dependencies"	ResDistSys:Action			= {  EvalRulelist( "ForceDefaults_HVACDist_DuctLeakage", 1 )  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_DuctLeakage" 1 0 0 0
	"Force Default of ResDistSys:DuctLeakageVal"		ResDistSys:DuctLeakageVal	= {  if (LocalStatus( DuctLeakageVal ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_DuctDesign" 1 0 0 0
	"Force Default of ResDistSys:SupplyDuctArea"			ResDistSys:SupplyDuctArea				= {  if (LocalStatus( SupplyDuctArea         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResDistSys:ReturnDuctArea"			ResDistSys:ReturnDuctArea				= {  if (LocalStatus( ReturnDuctArea         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of ResDistSys:DuctDesignInsRvalue"		ResDistSys:DuctDesignInsRvalue		= {  if (LocalStatus( DuctDesignInsRvalue    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of ResDistSys:RetDuctDesignInsRvalue"	ResDistSys:RetDuctDesignInsRvalue	= {  if (LocalStatus( RetDuctDesignInsRvalue ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of ResDistSys:AreBuried"					ResDistSys:AreBuried					= {  if (LocalStatus( AreBuried              ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
   "Force Default of ResDistSys:AreDeeplyBuried"			ResDistSys:AreDeeplyBuried			= {  if (LocalStatus( AreDeeplyBuried        ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************   ; SAC 5/7/18 - (tic #986)
RULELIST "ForceDefault_HVACDist_exDuctInsRvalOpt" 1 0 0 0
   "Force Default of ResDistSys:exDuctInsRvalOpt"    ResDistSys:exDuctInsRvalOpt  = {  UNDEFINED  }
END


;*************************************************************************
RULELIST "Default_HVACHeat" 0 0 0 0
;*************************************************************************
;"dbg"  ResHtgSys:Action = {  if (Type == 9 .AND. IfValidAnd( CHWHeater:HeaterElementType = 0 ))
;         then  PostMessageToLog( "setting '%s' ResHtgSys:TypeAbbrev = 'ElecCombHydro' (29) for ResProj:RunAbbrev '%s'", Name, ResProj:RunAbbrev )  else  UNCHANGED  endif  }
; SAC 6/12/18 - modified special logic setting TypeAbbrev to 'ElecCombHydro' (29) to EXCLUDE standard or design rating runs (tic #942)
	"Set ResHtgSys:TypeAbbrev"				ResHtgSys:TypeAbbrev = { if( ResProj:RunAbbrev != "s" .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf" .AND. ResProj:RunAbbrev != "dr" .AND. Type == 9 .AND. IfValidAnd( CHWHeater:HeaterElementType = 0 )) ; SAC 1/6/16 - map CombHydro & Elec DHW -> ElecCombHydro (tic 374)
	                                                           then 29 else	Local( Type )  endif  }
	"Set ResHtgSys:TypeAbbrevStr"			ResHtgSys:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set ResHtgSys:IsAvailable"				ResHtgSys:IsAvailable 		= {  T24RHeatingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
  ; SAC 5/13/13
;	"Default ResHtgSys:Ducted"				ResHtgSys:Ducted				= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) == 1) then  1
;																								else  0  endif endif  }
;	"Default ResHtgSys:DuctedEditable"	ResHtgSys:DuctedEditable		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RHeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 0) then  1
;																								else  0  endif endif  }

;	"Set ResHtgSys:FloorAreaServed"		ResHtgSys:FloorAreaServed 	= {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:FloorAreaServed )  }
	"Set ResHtgSys:FloorAreaServed"		ResHtgSys:FloorAreaServed 	= {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:HtFlrAreaServed )  }		; SAC 12/23/13
	"Set ResHtgSys:ExFlrAreaServed"		ResHtgSys:ExFlrAreaServed 	= {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:HtExFlrAreaServed )  }	; SAC 12/23/14
	"Set ResHtgSys:AltFlrAreaServed"		ResHtgSys:AltFlrAreaServed 	= {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:HtAltFlrAreaServed )  }
	"Set ResHtgSys:NewFlrAreaServed"		ResHtgSys:NewFlrAreaServed 	= {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:HtNewFlrAreaServed )  }

;	"Set ResHtgSys:NumStoriesServed"		ResHtgSys:NumStoriesServed  = {  SumRevRef( ResHVACSys:HeatSystem,    ResHVACSys:NumStoriesServed )  }
   "Default DisplayAFUE flag"				ResHtgSys:DisplayAFUE			= {	0  }

; SAC 8/23/13 - moved ConstHtgSetpt to HVACHeat as part of HVAHeat array mods
;   "Default ResHtgSys:ConstHtgSetpt"		ResHtgSys:ConstHtgSetpt		= {  T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }

   "Default ResHtgSys:AutoSize"			ResHtgSys:AutoSize				= {	MinRevRef( ResHVACSys:HeatSystem, ResHVACSys:AutoSizeHeat, ResHVACSys:NumHeatSystemTypes )  }
   "Default ResHtgSys:AutoSize - 2"		ResHtgSys:AutoSize				= {	if (LocalStatus( AutoSize ) < 1) then  1  else  UNCHANGED  endif  }
   "Default ResHtgSys:SizingFactor"		ResHtgSys:SizingFactor		= {	2  }   ; BAW changed from 1.5 to 2 130508

; SAC 5/13/13 - properties for combined hydronic
;	"Default ResHtgSys:DisplayCHData"		ResHtgSys:DisplayCHData		= {	-1  }
;	"Default ResHtgSys:HydronicWHType"	ResHtgSys:HydronicWHType		= {	UNDEFINED  }
	"Default ResHtgSys:CHUCndPipeLength"	ResHtgSys:CHUCndPipeLength	= {	UNDEFINED  }
	"Default ResHtgSys:CHRecoveryEff"		ResHtgSys:CHRecoveryEff		= {	UNDEFINED  }
	"Set ResHtgSys:CHFloorAreaServed"		ResHtgSys:CHFloorAreaServed	 = {	if (Type == 9) then  FloorAreaServed   else  0  endif  }
	"Set ResHtgSys:CHExFlrAreaServed"		ResHtgSys:CHExFlrAreaServed	 = {	if (Type == 9) then  ExFlrAreaServed   else  0  endif  }
	"Set ResHtgSys:CHAltFlrAreaServed"	ResHtgSys:CHAltFlrAreaServed = {	if (Type == 9) then  AltFlrAreaServed  else  0  endif  }
	"Set ResHtgSys:CHNewFlrAreaServed"	ResHtgSys:CHNewFlrAreaServed = {	if (Type == 9) then  NewFlrAreaServed  else  0  endif  }

END

;*************************************************************************
RULELIST "Default_HVACHeatPump" 0 0 0 0
;*************************************************************************
	"Set ResHtPumpSys:TypeAbbrev"					ResHtPumpSys:TypeAbbrev  			= {  Local( Type )  }
	"Set ResHtPumpSys:TypeAbbrevStr"			ResHtPumpSys:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set ResHtPumpSys:IsAvailable"				ResHtPumpSys:IsAvailable 			= {  T24RHeatingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
	"Set ResHtPumpSys:CanBeDHWHtr"				ResHtPumpSys:CanBeDHWHtr 			= {  T24RHeatingEquipment:CanDHW(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }		; SAC 4/20/14
   "Set ResHtPumpSys:IsPackaged"   ResHtPumpSys:IsPackaged  =
      {  switch ( Type )
            case 26 :  1  	   ; "PkgTermHeatPump - Packaged terminal heat pump (PTHP)"          ; SAC 6/24/20 (tic #1225)
            case 24 :  1  	   ; "SglPkgVertHeatPump - Single package vertical heat pump"        ; SAC 6/24/20 (tic #1226)
            default :  0
         endswitch  }
   "Set ResHtPumpSys:ShowCapLabel"    ResHtPumpSys:ShowCapLabel  =       ; VCHP2 - SAC 07/26/21
      {  if (IsAvailable > 0 .AND. (IfValidAnd( AutoSize > 0 )==0 .OR. Type = 33)) then  1  else  0  endif  }
	"Set ResHtPumpSys:Show4717COPs"				ResHtPumpSys:Show4717COPs			=        ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)   ; VCHP2 - SAC 11/01/20
      {  if (ResProj:ResAnalysisType < 3 .OR. Type = 11 .OR. Type = 12 .OR. Type = 26 .OR. Type = 24 .OR. Type = 33) then  1  else  0  endif  }
	"Set ResHtPumpSys:Show4717Labels"			ResHtPumpSys:Show4717Labels		=        ; VCHP2 - SAC 11/10/20
      {  if (IsAvailable > 0 .AND. Type != 12 .AND. (IfValidAnd( AutoSize > 0 )==0 .OR. Show4717COPs > 0)) then  1  else  0  endif  }
	"Set ResHtPumpSys:Show17COP"				   ResHtPumpSys:Show17COP			   =        ; VCHP2 - SAC 11/02/20
      {  if (Show4717COPs > 0 .AND. (Type = 11 .OR. Type == 33)) then  1  else  0  endif  }
	"Set ResHtPumpSys:Show35Props"				ResHtPumpSys:Show35Props			=        ; VCHP2 - SAC 11/02/20
      {  0  }
   ;   {  if (ResProj:ResAnalysisType == 0 .OR. Type = 33) then  1  else  0  endif  }   ; VCHP2 now uses 47, 17 & 5 - SAC 07/24/21
	"Set ResHtPumpSys:ShowVCHPDucts"			ResHtPumpSys:ShowVCHPDucts		=        ; VCHP2 - SAC 11/02/20  ; toggled OFF for VCHP2 - SAC 08/02/21
      {  if (Type == 22) then  1  else  0  endif  }
	"Set ResHtPumpSys:ShowHSPF"						ResHtPumpSys:ShowHSPF				=     ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)
      {  if (IsAvailable > 0 .AND. Type != 11 .AND. Type != 12 .AND. Type != 26 .AND. Type != 24 .AND. Type != 7) then  1  else  0  endif  }
	"Set ResHtPumpSys:ShowHeatPower"				ResHtPumpSys:ShowHeatPower		=     ; SAC 08/19/20 (tic #1003)
      {  if (IsAvailable > 0 .AND. Type == 7) then  1  else  0  endif  }
	"Set ResHtPumpSys:ShowUseEER"					ResHtPumpSys:ShowUseEER			=     ; SAC 6/22/20 - PkgTermHeatPump & SglPkgVertHeatPump (tic #1225 & #1226)
      {  if (IsAvailable > 0 .AND. Type != 22 .AND. Type != 33 .AND. Type != 26 .AND. Type != 24) then  1  else  0  endif  }    ; SAC 11/2/18 - VCHP   ; VCHP2 - SAC 11/01/20
	"Set ResHtPumpSys:ShowCEER"					   ResHtPumpSys:ShowCEER		      =     ; SAC 08/19/20 (tic #1003)
      {  if (IsAvailable > 0 .AND. (Type == 7 .OR. Type == 33) .AND.
             T24RCoolingEquipment:CEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set ResHtPumpSys:ShowSEER"					   ResHtPumpSys:ShowSEER		      =     ; VCHP2 - SAC 11/02/20
      {  if ((Show4717COPs < 1 .AND. ShowCEER < 1) .OR. Type == 33)  then  1  else  0  endif  }

   "Set ResHtPumpSys:ShowEffMetric"      ResHtPumpSys:ShowEffMetric =       ; SAC 10/09/22 (tic #3431)
      {  if (Type < 1 .OR. Type == 6 .OR. Type == 7)     ; LrgPkgHeatPump, RoomHeatPump
         then  0  else  1  endif  }
   "Default ResHtPumpSys:EffMetric"      ResHtPumpSys:EffMetric = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 220000 )) then  2  else  1  endif  }
   "Set ResHtPumpSys:EffLabel1 - HSPF*"     ResHtPumpSys:EffLabel1 =
      {  if (EffMetric == 1) then  "HSPF"  else  "HSPF2"  endif  }
   "Set ResHtPumpSys:EffLabel2 - EER*"      ResHtPumpSys:EffLabel2 =
      {  if (EffMetric == 1) then  "EER"   else  "EER2"   endif  }

	"Set ResHtPumpSys:SEERCEERLabel"			   ResHtPumpSys:SEERCEERLabel	   =     ; SAC 08/19/20 (tic #1003)  ; SAC 10/09/22 (tic #3431)
      {  if (ShowCEER) then  "CEER:"
         else if (IsAvailable > 0 .AND. ShowSEER > 0)
         then  if (EffMetric == 1) then  "SEER:"
               else  "SEER2:"  endif
         else  UNDEFINED  endif endif  }
	"Set ResHtPumpSys:MinCEER"			ResHtPumpSys:MinCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (ShowCEER == 0) then  UNDEFINED
         else  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
   "Set ResHtPumpSys:ShowCFMperTon - whether or not to display the CFM per Ton"   ResHtPumpSys:ShowCFMperTon =     ; SAC 08/19/20 (tic #1003)
      {  if (Type == 24) then  1    ; SglPkgVertHeatPump
         else if (Show4717COPs < 1 .AND. Type !=10 .AND. Type < 20 .AND. Type != 7) then  1
         else  0  endif endif  }
   "Set ResHtPumpSys:ShowRefrigerant - whether or not to display Refrigerant"     ResHtPumpSys:ShowRefrigerant =   ; SAC 08/31/20 (tic #1003)
      {  if (Show4717COPs < 1 .AND. Type !=10 .AND. Type != 7 .AND. Type < 20 .AND. IsPackaged < 1)
         then  1  else  0  endif  }

   "Set ResHtPumpSys:ShowPerfDetails - whether or not to show 'Performance Details' dialog tab"      ResHtPumpSys:ShowPerfDetails =     ; SAC 09/21/21
      {  if (Type == 33) then  1  else  0  endif  }
   "Set ResHtPumpSys:PerfDetailsMsgs[1]"    ResHtPumpSys:PerfDetailsMsgs[1] =
      {  switch (ShowPerfDetails)
            case  1 :  "(enter details on 'Performance Details Data' tab)"
            default :  UNDEFINED  endswitch  }
   "Set ResHtPumpSys:PerfDetailsMsgs[2]"    ResHtPumpSys:PerfDetailsMsgs[2] =
      {  switch (ShowPerfDetails)
            case  1 :  UNDEFINED
            default :  "Performance Data entered on first tab"  endswitch  }
            
; SAC 1/8/16 - added code vintage-specific values for SEER input range check warning
; SAC 1/13/16 - removed check for heat pumps, since this requirement is NOT based on INSTALLED DATE (which is the focus of the CEC request to add it)
;	"Set ResHtPumpSys:MinSEER_1501"		ResHtPumpSys:MinSEER_1501		= {	if (IsAvailable < 0.5 .OR. ResProj:StdsVersionYr < 2015) then  UNDEFINED
;																							else if (Type ==  4 .OR.	; "SplitHeatPump - Central split heat pump"
;																										Type ==  5 .OR.	; "PkgHeatPump - Central packaged heat pump"
;																										Type == 10 .OR.	; "DuctlessHeatPump - Ductless mini-split heat pump"
;																										Type == 11 .OR.	; "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
;																										Type == 12 )		; "GroundSourceHeatPump - Ground source heat pump (able to heat DHW)"
;																							then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
;																							else	UNDEFINED  endif endif  }

	"Set ResHtPumpSys:FloorAreaServed"			ResHtPumpSys:FloorAreaServed 	= {  SumRevRef( ResHVACSys:HtPumpSystem,    ResHVACSys:HtPmpFlrAreaServed )  }	; SAC 12/23/13

	"Default ResHtPumpSys:RefrigChgAdjFctr"	ResHtPumpSys:RefrigChgAdjFctr	= {	UNDEFINED  }

   "Default ResHtPumpSys:ClSizingFactor"		ResHtPumpSys:ClSizingFactor		= {	1.2  }      ; SAC 02/25/22

	"Set ResHtPumpSys:ShowMultiSpeed"			ResHtPumpSys:ShowMultiSpeed		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
																										else  T24RCoolingEquipment:ShowMultSpd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:IsMultiSpeed"		ResHtPumpSys:IsMultiSpeed			= {	0  }

	"Set ResHtPumpSys:ShowIsZonal"		ResHtPumpSys:ShowIsZonal	= {	if (CountRefs( ResHVACSys:HtPumpSystem, ResHVACSys:NumHtPumpSystemTypes ) < 1) then  0
																						else if (SumRevRef( ResHVACSys:HtPumpSystem, ResHVACSys:HtPumpDucted ) < 1) then  0  else	1  endif endif  }		; SAC 11/19/15 - CoolDucted -> HtPumpDucted
	"Default ResHtPumpSys:IsZonal"		ResHtPumpSys:IsZonal		= {	0  }
;	"debug HVACHtPump"			ResHtPumpSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "Default HVACHtPump  Name:  '%s'  Type: %g  TypeAbbrevStr: '%s'",  Name, Type, TypeAbbrevStr ) else UNCHANGED endif  }

   "Init ResHtPumpSys:VCHPFanPower"   ResHtPumpSys:VCHPFanPower = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_HVACCool" 0 0 0 0
;*************************************************************************
	"Set ResClgSys:TypeAbbrev"				ResClgSys:TypeAbbrev  		= {  Local( Type )  }
	"Set ResClgSys:TypeAbbrevStr"			ResClgSys:TypeAbbrevStr 		= {  EnumString( TypeAbbrev )  }
	"Set ResClgSys:IsAvailable"				ResClgSys:IsAvailable 		= {  T24RCoolingEquipment:SysAvail( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
  ; SAC 5/13/13
;	"Default ResClgSys:Ducted"				ResClgSys:Ducted				= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) == 1) then  1
;																								else  0  endif endif  }
;	"Default ResClgSys:DuctedEditable"	ResClgSys:DuctedEditable		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
;																								else if (T24RCoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 0) then  1
;																								else  0  endif endif  }

;	"Set ResClgSys:FloorAreaServed"		ResClgSys:FloorAreaServed	= {  SumRevRef( ResHVACSys:CoolSystem,    ResHVACSys:FloorAreaServed )  }
	"Set ResClgSys:FloorAreaServed"		ResClgSys:FloorAreaServed	= {  SumRevRef( ResHVACSys:CoolSystem,    ResHVACSys:ClFlrAreaServed )  }		; SAC 12/23/13

;	"Set ResClgSys:NumStoriesServed"		ResClgSys:NumStoriesServed  = {  SumRevRef( ResHVACSys:CoolSystem,    ResHVACSys:NumStoriesServed )  }
;   "Default DisplayHPData flag"			ResClgSys:DisplayHPData		= {	0  }
;   "Default ResClgSys:ConstClgSetpt"		ResClgSys:ConstClgSetpt		= {	UNDEFINED  }

   "Default ResClgSys:AutoSize"			ResClgSys:AutoSize				= {	MinRevRef( ResHVACSys:CoolSystem, ResHVACSys:AutoSizeCool, ResHVACSys:NumCoolSystemTypes )  }
   "Default ResClgSys:AutoSize - 2"		ResClgSys:AutoSize				= {	if (LocalStatus( AutoSize ) < 1) then  1  else  UNCHANGED  endif  }

   "Default ResClgSys:SizingFactor"		ResClgSys:SizingFactor		= {	1.2  }      ; SAC 02/25/22
  ; SAC 3/4/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }

	"Set ResClgSys:ShowMultiSpeed"			ResClgSys:ShowMultiSpeed		= {	if (Type < 1 .OR. IsAvailable < 0.5) then  0
																								else  T24RCoolingEquipment:ShowMultSpd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResClgSys:IsMultiSpeed"		ResClgSys:IsMultiSpeed		= {	0  }

;	mjb - moved from HVAC:Dist 	8/21/13
;	"Set ResClgSys:ShowIsZonal"		ResClgSys:ShowIsZonal		= {	if (ResClgSys:Ducted < 1) then  0  else	1  endif  }
	"Set ResClgSys:ShowIsZonal"		ResClgSys:ShowIsZonal		= {	if (CountRefs( ResHVACSys:CoolSystem, ResHVACSys:NumCoolSystemTypes ) < 1) then  0
																					else if (SumRevRef( ResHVACSys:CoolSystem, ResHVACSys:CoolDucted ) < 1) then  0  else	1  endif endif  }
	"Default ResClgSys:IsZonal"		ResClgSys:IsZonal		= {	0  }

	"Set ResClgSys:ShowEER"			ResClgSys:ShowEER		=              ; SAC 6/20/20 - replaced Type value checks w/ EERValid look-up (tic #1225)
      {  if (IsAvailable > 0 .AND. T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }	; SAC 1/7/16
	"Set ResClgSys:ShowSEER"			ResClgSys:ShowSEER		=              ; SAC 6/20/20 - replaced Type value checks w/ SEERValid look-up (tic #1225)
      {  if (ShowEER > 0 .AND. T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set ResClgSys:ShowCEER"			ResClgSys:ShowCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (T24RCoolingEquipment:CEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
         then  1  else  0  endif  }
	"Set ResClgSys:MinCEER"			ResClgSys:MinCEER		=              ; SAC 08/19/20 (tic #1003)
      {  if (ShowCEER == 0) then  UNDEFINED
         else  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }

   "Default ResClgSys:EffMetric"  ResClgSys:EffMetric =       ; SAC 10/09/22 (tic #3431)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 220000 )) then  2  else  1  endif  }
   "Set ResClgSys:EffLabel1 (SEER/SEER2/EERa/EER2a)"      ResClgSys:EffLabel1 =  
      {  if (IfValidAnd( IsAvailable > 0 ) .AND. Type == 14)
         then  if (EffMetric == 1)
               then  "EERa"
               else  "EER2a"  endif
         else if (IfValidAnd( ShowSEER > 0 ))
         then  if (EffMetric == 1)
               then  "SEER"
               else  "SEER2"  endif
         else  UNDEFINED
         endif endif  }
   "Set ResClgSys:EffLabel2 (EER/EER2/EERb/EER2b)"        ResClgSys:EffLabel2 =
      {  if (IfValidAnd( IsAvailable > 0 ) .AND. Type == 14)
         then  if (EffMetric == 1)
               then  "EERb"
               else  "EER2b"  endif
         else if (IfValidAnd( ShowEER > 0 ))
         then  if (EffMetric == 1)
               then  "EER"
               else  "EER2"  endif
         else  UNDEFINED
         endif endif  }

; SAC 1/8/16 - added code vintage-specific values for SEER & EER input range check warnings
; SAC 1/13/16 - REMOVED these checks for DuctlessSplitAirCond (based on CEC request)
; SAC 1/13/16 - Hard coded spilt EER check value to 12.2, since anything less than that MAY violate DOE requirements based on equipment size
	"Set ResClgSys:MinSEER_Split1501"		ResClgSys:MinSEER_Split1501		= {	if (ShowSEER < 0.5 .OR. ResProj:StdsVersionYr < 2015) then  UNDEFINED
																									else if (Type ==  2) ; .OR.	; "SplitAirCond - Split air conditioning system"
																												; Type == 16)			; "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
																									then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set ResClgSys:MinSEER_Pckg1501"		ResClgSys:MinSEER_Pckg1501		= {	if (ShowSEER < 0.5 .OR. ResProj:StdsVersionYr < 2015) then  UNDEFINED
																									else if (Type ==  3)			; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
																									then	T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set ResClgSys:MinEER_Split1501"		ResClgSys:MinEER_Split1501		= {	if (ShowEER < 0.5 .OR. ResProj:StdsVersionYr < 2015 .OR. IfValidAnd( UseEERInAnalysis > 0.5 )==0) then  UNDEFINED
																									else if (Type ==  2) ; .OR.	; "SplitAirCond - Split air conditioning system"
																												; Type == 16)			; "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
																									then	12.2  ; T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
	"Set ResClgSys:MinEER_Pckg1501"		ResClgSys:MinEER_Pckg1501		= {	if (ShowEER < 0.5 .OR. ResProj:StdsVersionYr < 2015 .OR. IfValidAnd( UseEERInAnalysis > 0.5 )==0) then  UNDEFINED
																									else if (Type ==  3)			; "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
																									then	T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
																									else	UNDEFINED  endif endif  }
END


;*************************************************************************
RULELIST "Default_PreCooling" 0 0 0 0
;*************************************************************************
  ; SAC 8/1/17 - re-enable pre-cooling following 2019.0.4 release
  ; ; SAC 6/14/17 - toggled OFF Precooling access for 2019.0.4 release
  ; "Force ResProj:UsePreCooling off for 2019.0.4 release"   ResProj:Action  = {
  ;       if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
  ;           IfValidAnd( UsePreCooling > 0 )==0) then  UNCHANGED
  ;       else   EvalRulelist( "ForceDefault_UsePreCooling" )  endif  }
; PreCooling properties - SAC 4/3/17  - updated 4/7/17
   "Default ResProj:UsePreCooling"        ResProj:UsePreCooling      = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0) then  UNDEFINED
         else   0  endif  }
   "Force Precooling OFF for 2022 releases, until updated for 2022 tstats & TDV"  ResProj:Action =
      {  if (IfValidAnd( UsePreCooling > 0 )==0 .OR.
             IfValidAnd( EnergyCodeYearNum < 2022 )) then  UNCHANGED
         else  EvalRulelist( "ForceDefault_UsePreCooling" )  endif  }
   "Default ResProj:PreCl_TDVThreshold"   ResProj:PreCl_TDVThreshold = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  10  endif  }
   "Default ResProj:PreCl_PCsetTstat"     ResProj:PreCl_PCsetTstat   = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  "MAX(78-0.25*(@Weather.taDbpk-82),73)   // Cooling setpoint down to 73 with peak taDB > 101"
         endif  }
      ;   else  "MAX(((78-(@Weather.taDbAvg-78)/2)),73)   // Cooling setpoint down to 73 on hottest days"  - previous version implemented 4/3/17
   "Default ResProj:PreCl_ZnCoolSetpt"    ResProj:PreCl_ZnCoolSetpt  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0 .OR.
             IfValidAnd( UsePreCooling     >     0 )==0) then  UNDEFINED
         else  "select( $dsDay==1, 83, $dsDay==2, 78, @Weather.tdvElecAvg>10&&@Weather.tdvElec<25&&@Weather.taDbAvg>78&&$hour>6, PCset, default hourval(78,78,78,78,78,78,78,83,83,83,83,83,83,82,81,80,79,78,78,78,78,78,78,78))"
         endif  }
      ;   else  "select( $dsDay==1, 83, $dsDay==2, 78, @Weather.tdvElecAvg>10&&@Weather.taDbAvg>78&&$hour<18&&$hour>7, PCset, default hourval(78,78,78,78,78,78,78,83,83,83,83,83,83,82,81,80,79,78,78,78,78,78,78,78))"  - previous version implemented 4/3/17

   "Set ResProj:PreCl_DataMsg"      ResProj:PreCl_DataMsg      = {
         if (IfValidAnd( UsePreCooling > 0 )==0) then  UNDEFINED
         else if (IfValidAnd( EnergyCodeYearNum >= 2019 )==0)
         then  "PreCooling implemented only for 2019 (and later) code vintages" 
         else if ( (ResProj:IsMultiFamily > 0.5 .AND. SumAcrossIf( DwellUnitType:HaveCooling, DwellUnitType:AssignedDUFlrArea > 1 ) < 1) .OR.
                   (ResProj:IsMultiFamily < 0.5 .AND. SumAcrossIf( ResHVACSys:HaveCooling,       ResHVACSys:FloorAreaServed[1]      > 1 ) < 1) )
         then  "Mechanical cooling equipment must exist in model to use PreCooling" 
         else if (IfValidAnd( PreCl_TDVThreshold > 0 )==0)
         then  "PreCooling Average Hourly TDV Threshold (ResProj:PreCl_TDVThreshold) must be > 0" 
         else if (strlen( PreCl_PCsetTstat ) < 1)
         then  "Cooling Setpoint for Precool hours (ResProj:PreCl_PCsetTstat) expression must be defined"
         else if (strlen( PreCl_ZnCoolSetpt ) < 1)
         then  "Cooling Setpoint (ResProj:PreCl_ZnCoolSetpt) expression must be defined"
         else  UNDEFINED  endif endif endif endif endif endif  }
   "Set ResProj:PreCl_DataValid"    ResProj:PreCl_DataValid    = {
         if (IfValidAnd( UsePreCooling > 0 ) .AND. LocalStatus( PreCl_DataMsg ) < 1)
         then  1  else  0  endif  }
END


; SAC 3/10/14 - added rulelists designed to setup and default SCSysRpt reporting objects
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
;*************************************************************************
RULELIST "Setup_SCSysReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all SCSysRpt objects currently in building description"									ResProj:Action		= {	DeleteAllComps( SCSysRpt )  }
	"Create new SCSysRpt objects and populate w/ initial object references & indexes/counts"	ResProj:Action		= {	CreateSCSysRptObjects()  }
	"Evaluate rules to summarize building model for reporting purposes"		ResProj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
	"Default SCSysRpt properties - general"		ResSCSysRpt:Action	= {	EvalRulelist( "Default_SCSysReportObject", 1 )  }
;	"Default SCSysRpt properties - general"		ResSCSysRpt:Action	= {	if (ParentComponentType() == "ResHVACSys" .OR. ParentComponentType() == "DwellUnit")
;																								then  EvalRulelist( "Default_SCSysReportObject", 1 )
;																								else	UNCHANGED  endif  }

;	"debug RefCounts"		ResProj:Action	= {	MessageBox( "Run Number %g - SCSysRpt equipment counts:\n   %g  Heating\n   %g  Cooling\n   %g  Heat Pumps", ValidOr( RunNumber, -1 ),
;																SumAll( ResSCSysRpt:RefCountByType[1] ), SumAll( ResSCSysRpt:RefCountByType[2] ), SumAll( ResSCSysRpt:RefCountByType[3] ) )  }
END

; SAC 11/14/14 - revised for new SCSysRpt structure/data model
;;*************************************************************************
;RULELIST "Default_SCSysReportObject" 0 0 0 0
;;*************************************************************************
;	"Default SCSysRpt properties - general"		ResSCSysRpt:Action	= {	     if (ParentComponentType() == "ResHVACSys"  ) then  EvalRulelist( "Default_SCSysReportObject_HVACSysParent", 1 )
;																								else if (ParentComponentType() == "DwellUnit") then  EvalRulelist( "Default_SCSysReportObject_DwellUnitParent", 1 )
;																								else	UNCHANGED  endif endif  }
;
;	"Default SCSysRpt properties - heating"		ResSCSysRpt:Action	= {	if (SCSysTypeVal == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_HtPump", 1 )
;																								else if (SCSysTypeVal != 2 .AND. LocalCompAssigned( HeatSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_Heat"  , 1 )
;																								else  UNCHANGED  endif endif  }
;	"Default SCSysRpt properties - cooling"		ResSCSysRpt:Action	= {	if (SCSysTypeVal != 2 .AND. LocalCompAssigned( CoolSystem ))
;																								then	EvalRulelist( "Default_SCSysReportObject_Cool"  , 1 )
;																								else  UNCHANGED  endif  }
;
;;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSAirFltrRptMsg  DistribSystem:HERSCheck:AirFltrRptMsg: '%s'",  DistribSystem:HERSCheck:AirFltrRptMsg )  }
;END

;*************************************************************************
; SAC 11/14/14 - revised for new SCSysRpt structure/data model
RULELIST "Default_SCSysReportObject" 0 0 0 0
;RULELIST "Default_SCSysReportObject_HVACSysParent" 0 0 0 0
;*************************************************************************
;	"Default ResSCSysRpt:SCSysType"		ResSCSysRpt:SCSysType		= {	Parent( TypeAbbrevStr )  }
;	"Default ResSCSysRpt:SCSysName"		ResSCSysRpt:SCSysName		= {	if (Parent( Type ) == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																							then	Format( "Space Conditioning Unit (%g/%g)", HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )
;																						else if (Parent( Type ) != 2 .AND. LocalCompAssigned( HeatSystem ))
;																							then	Format( "Space Conditioning Unit (%.0f/%.0f)", HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )
;																						else  UNCHANGED  endif endif }
;	"Set ResSCSysRpt:SCSysTypeVal"		ResSCSysRpt:SCSysTypeVal	= {	Parent( Type )  }
;	"Default ResSCSysRpt:DwellingUnit"	ResSCSysRpt:DwellingUnit	= {	if (Parent( Type ) == 2 .AND. LocalCompAssigned( HtPumpSystem ))
;																							then	Format( "Dwelling Unit %.0f/%.0f", HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )
;																						else if (Parent( Type ) != 2 .AND. LocalCompAssigned( HeatSystem ))
;																							then	Format( "Dwelling Unit %.0f/%.0f", HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )
;																						else  UNCHANGED  endif endif }

	"Default ResSCSysRpt:FanType"			ResSCSysRpt:FanType			= {	if (LocalCompAssigned( HVACFanRef  ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACFanRef:TypeAbbrevStr  ) < 1 ) then UNDEFINED else HVACFanRef:TypeAbbrevStr  endif endif  }
	"Default ResSCSysRpt:DistribType"	ResSCSysRpt:DistribType		= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACDistRef:TypeAbbrevStr ) < 1 ) then UNDEFINED else HVACDistRef:TypeAbbrevStr endif  endif	}

	"Default ResSCSysRpt:DistribType"	ResSCSysRpt:DistribType		= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  UNDEFINED
																						else	if (LocalStatus( HVACDistRef:TypeAbbrevStr ) < 1 ) then UNDEFINED else HVACDistRef:TypeAbbrevStr endif  endif	}
	; SAC 6/21/16 - ReferenceCount added to provide count of these equipment combinations locally (tic #
	;"Set ResSCSysRpt:ReferenceCount"		ResSCSysRpt:ReferenceCount		= {	if (ResProj:IsMultiFamily > 0.5)
	;																						then	SumRevRef( DwellUnitType:SCSysRptRef, DwellUnitType:SCSysRptDUCount )
   ; revised for parent = DwellUnitType - SAC 10/09/22 (tic #3393)
	"Set ResSCSysRpt:ReferenceCount"		ResSCSysRpt:ReferenceCount		= {	if (ParentComponentType() == "DwellUnit")
																							then	ValidOr( DUEquipCnt, 1 )
                                                                     else if (ParentComponentType() == "DwellUnitType")
																							then	Parent( NumAssigningDUs )
																							else	SumRevRef( ResHVACSys:SCSysRptRef, ResHVACSys:SCSysRptCount )
																							endif endif  }

	; SAC 4/30/15 - to be set via direct assignment of ResDistSys:Type (issue 517)
	"Set ResSCSysRpt:DuctLocationRpt"	ResSCSysRpt:DuctLocationRpt	= {	if (LocalCompAssigned( HVACDistRef ) < 1) then  8
																							else	if (LocalStatus( HVACDistRef:Type ) < 1 ) then  8  else  HVACDistRef:Type  endif endif	}

	"Default ResSCSysRpt:LLAHUStatus"			ResSCSysRpt:LLAHUStatus			= {	if (IfValidAnd( HVACDistRef:LowLkgAH > 0.5 )) then "Has Low Leakage Air Handler" else "None" endif }
	"Default ResSCSysRpt:BypassDuctStatus"		ResSCSysRpt:BypassDuctStatus	= {	if (IfValidAnd( HVACDistRef:HasBypassDuct > 0.5 )) then "Has Bypass Duct" else "None" endif  }
	"Default ResSCSysRpt:LLAHUStatus"			ResSCSysRpt:LLAHUStatus			= {	if (IfValidAnd( HVACDistRef:LowLkgAH > 0.5 )) then "Has Low Leakage Air Handler" else "None" endif }
	"Default ResSCSysRpt:BypassDuctStatus"		ResSCSysRpt:BypassDuctStatus	= {	if (IfValidAnd( HVACDistRef:HasBypassDuct > 0.5 )) then "Has Bypass Duct" else "None" endif  }

	"Default ResSCSysRpt:MinDistribInsRval"	ResSCSysRpt:MinDistribInsRval	= {	if (IfValidAnd( HVACDistRef:DuctInsRvalue >= 0 )) then HVACDistRef:DuctInsRvalue else UNDEFINED endif  }

;	"debug"		ResSCSysRpt:Action	= {	MessageBox( "SCSysRpt -- DistribSystem:HERSCheck:DuctLocation: %g", DistribSystem:HERSCheck:DuctLocation )  }

	"Assign HERSDuctLeakage"			ResSCSysRpt:HERSDuctLeakage 		= {	ValidOr( HVACDistRef:HERSCheck:DuctLeakage, -1 )  }
	"Assign HERSDuctLkgRptMsg"			ResSCSysRpt:HERSDuctLkgRptMsg 	= {	if (IfValidAnd( HERSDuctLeakage > 0.5 )) then  HVACDistRef:HERSCheck:DuctLkgRptMsg  else  "none"  endif  }
	"Assign HERSDuctLocation"			ResSCSysRpt:HERSDuctLocation 		= {	ValidOr( HVACDistRef:HERSCheck:DuctLocation, -1 )  }
	"Assign HERSDuctLocRptMsg"			ResSCSysRpt:HERSDuctLocRptMsg 	= {	if (IfValidAnd( HERSDuctLocation > -1 )) then  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )  else  "none"  endif  }
;	; SAC 6/27/16 - added custom messages for certain selections (tic #627)
;	"Assign HERSDuctLocRptMsg"			ResSCSysRpt:HERSDuctLocRptMsg 	= {	if (IfValidAnd( HERSDuctLocation > -1 )) then  ;  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )  else  "none"  endif  }
;																									switch ( HVACDistRef:HERSCheck:DuctLocRptMsg )
;																										case  7 : "Ducts located entirely in conditioned space confirmed by duct leakage testing"
;																										case 12 : "Verified low-leakage ducts in conditioned space must meet maximum 25 cfm leakage to outside (RA3.1.4.3.8)"
;																										default :  EnumString( HVACDistRef:HERSCheck:DuctLocRptMsg )
;																									endswitch
;																								else  "none"  endif  }
	"Assign HERSRetDuctDesign"			ResSCSysRpt:HERSRetDuctDesign 	= {	ValidOr( HVACDistRef:HERSCheck:RetDuctDesign, -1 )  }
	"Assign HERSRetDuctRptMsg"			ResSCSysRpt:HERSRetDuctRptMsg 	= {	if (IfValidAnd( HERSRetDuctDesign > 0.5 )) then  HVACDistRef:HERSCheck:RetDuctRptMsg  else  "none"  endif  }
	"Assign HERSSupDuctDesign"			ResSCSysRpt:HERSSupDuctDesign 	= {	ValidOr( HVACDistRef:HERSCheck:SupDuctDesign, -1 )  }
	"Assign HERSSupDuctRptMsg"			ResSCSysRpt:HERSSupDuctRptMsg 	= {	if (IfValidAnd( HERSSupDuctDesign > 0.5 )) then  HVACDistRef:HERSCheck:SupDuctRptMsg  else  "none"  endif  }
;	"Assign HERSAirFilterDesign"		ResSCSysRpt:HERSAirFilterDesign 	= {	ValidOr( HVACDistRef:HERSCheck:AirFilterDesign, -1 )  }
;	"Assign HERSAirFltrRptMsg"			ResSCSysRpt:HERSAirFltrRptMsg 	= {	if (IfValidAnd( HERSAirFilterDesign > 0.5 )) then  HVACDistRef:HERSCheck:AirFltrRptMsg  else  "none"  endif  }
	"Assign HERSFanEff"					ResSCSysRpt:HERSFanEff 				= {	ValidOr( HVACFanRef:HERSCheck:AHUFanEff, -1 )  }
	"Assign HERSFanEffRptMsg"			ResSCSysRpt:HERSFanEffRptMsg	 	= {	if (IfValidAnd( HERSFanEff > 0.5 )) then  HVACFanRef:HERSCheck:FanEffRptMsg  else  "none"  endif  }

	"Default SCSysRpt properties - heating"		ResSCSysRpt:Action	= {	if (SCSysTypeVal == 4 .AND. LocalCompAssigned( CentralHtgClgSystem ))
																								then	switch (ValidOr( CentralHtgClgSystem:Type, 0 ))
                                                                                 case  4 :  EvalRulelist( "Default_SCSysReportObject_CentralHtgClg_VRF",  1 )    ; SAC 10/13/22
                                                                                 case  2 :  EvalRulelist( "Default_SCSysReportObject_CentralHtgClg_WSHP", 1 ) 
                                                                              ;   case  1 :  EvalRulelist( "Default_SCSysReportObject_CentralHtgClg_FPFC", 1 ) 
                                                                                 default :  UNCHANGED  endswitch
																								else if (SCSysTypeVal == 2 .AND. LocalCompAssigned( HtPumpSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_HtPump", 1 )
																								else if (SCSysTypeVal != 2 .AND. LocalCompAssigned( HeatSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_Heat"  , 1 )
																								else  UNCHANGED  endif endif endif  }
	"Default SCSysRpt properties - cooling"		ResSCSysRpt:Action	= {	if (SCSysTypeVal != 2 .AND. SCSysTypeVal != 4 .AND. LocalCompAssigned( CoolSystem ))
																								then	EvalRulelist( "Default_SCSysReportObject_Cool"  , 1 )
																								else  UNCHANGED  endif  }

;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSAirFltrRptMsg  DistribSystem:HERSCheck:AirFltrRptMsg: '%s'",  DistribSystem:HERSCheck:AirFltrRptMsg )  }
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_HtPump" 0 0 0 0
;*************************************************************************
	"Set ResSCSysRpt:RefCountByType[3]-HtPump"	ResSCSysRpt:RefCountByType[3]	= {	ReferenceCount  }
	"Default ResSCSysRpt:HeatingType"				ResSCSysRpt:HeatingType			= {	HtPumpSystem:TypeAbbrevStr  }
;	"Default ResSCSysRpt:HeatSysName"				ResSCSysRpt:HeatSysName			= {	Format( "%s (%.0f/%.0f)", HtPumpSystem:Name, HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )  }
	"Default ResSCSysRpt:CoolingType"				ResSCSysRpt:CoolingType			= {	if ( LocalStatus(HeatingType) < 1 ) then UNDEFINED else HeatingType endif  }
	"Default ResSCSysRpt:CoolSysName"				ResSCSysRpt:CoolSysName			= {	if ( LocalStatus(HeatSysName) < 1 ) then UNDEFINED else HeatSysName endif  }
	"Default ResSCSysRpt:TStatType"					ResSCSysRpt:TStatType			= {	"Constant Heating"  }
	"Default ResSCSysRpt:ZonalCoolingType"			ResSCSysRpt:ZonalCoolingType	= {	if (IfValidAnd( HtPumpSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default ResSCSysRpt:CoolCompType"				ResSCSysRpt:CoolCompType		= {	if (IfValidAnd( HtPumpSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }
   ; mods/additions for SEER2/EER2/HSPF2 - SAC 10/09/22 (tic #3431)
	"Default ResSCSysRpt:MinHeatEffic"				ResSCSysRpt:HeatEfficType		= {	if (IfValidAnd( HtPumpSystem:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem:Show4717COPs > 0 ) .AND. IfValidAnd( HtPumpSystem:ShowHSPF < 1 ))
																										then	"COP"
																										else	if (IfValidAnd( HtPumpSystem:EffMetric = 1 ))
                                                                                    then  "HSPF"
                                                                                    else  "HSPF2"  endif endif  }
	"Default ResSCSysRpt:MinHeatEffic"				ResSCSysRpt:MinHeatEffic		= {	if (IfValidAnd( HtPumpSystem:IsAvailable > 0 ) .AND. IfValidAnd( HtPumpSystem:Show4717COPs > 0 ) .AND. IfValidAnd( HtPumpSystem:ShowHSPF < 1 ))
																										then	if ( LocalStatus(HtPumpSystem:COP47) < 1 ) then UNDEFINED else HtPumpSystem:COP47 endif
																										else	if (IfValidAnd( HtPumpSystem:EffMetric = 1 ))
                                                                                    then  if ( LocalStatus(HtPumpSystem:HSPF ) < 1 ) then UNDEFINED else HtPumpSystem:HSPF   endif
                                                                                    else  if ( LocalStatus(HtPumpSystem:HSPF2) < 1 ) then UNDEFINED else HtPumpSystem:HSPF2  endif   endif endif  }

   "Set ResSCSysRpt:SuppHeatEfficType"          ResSCSysRpt:SuppHeatEfficType =     ; SAC 10/10/22
      {  if (IfValidAnd( HtPumpSystem:AllowDualFuel > 0 ) .AND.
             IfValidAnd( HtPumpSystem:IsDualFuel > 0 ))
         then  "AFUE"  else  UNDEFINED  endif  }
   "Set ResSCSysRpt:MinSuppHeatEffic"           ResSCSysRpt:MinSuppHeatEffic = 
      {  if (LocalStatus( SuppHeatEfficType ) > 0 .AND.
             IfValidAnd( HtPumpSystem:AFUE > 0 ))
         then  HtPumpSystem:AFUE  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:CoolEfficType[1]"		ResSCSysRpt:CoolEfficType[1]  =     ; SAC 10/10/22 (tic #3431)
      {  if (IfValidAnd( HtPumpSystem:ShowCEER > 0 ))  
         then  "CEER"
         else if (IfValidAnd( HtPumpSystem:EffMetric = 2 ))
         then  if (IfValidAnd( HtPumpSystem:ShowSEER > 0 ))
               then  "SEER2"
               else  "EER2"   endif 
         else  if (IfValidAnd( HtPumpSystem:ShowSEER > 0 ))
               then  "SEER"
               else  "EER"    endif 
         endif endif  }
	"Default ResSCSysRpt:CoolEfficType[2]"		ResSCSysRpt:CoolEfficType[2]  =  
      {  if (IfValidAnd( HtPumpSystem:ShowCEER > 0 ) .OR.
             IfValidAnd( HtPumpSystem:ShowSEER > 0 )==0)  
         then  UNDEFINED
         else if (IfValidAnd( HtPumpSystem:EffMetric = 2 ))
         then  "EER2"
         else  "EER"
         endif endif  }

	"Default ResSCSysRpt:MinCoolCEER"			ResSCSysRpt:MinCoolCEER				=
      {	if (IfValidAnd( CoolEfficType[1] = "CEER" ) .AND. LocalStatus(HtPumpSystem:CEER ) > 0) then  HtPumpSystem:CEER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolEER"				ResSCSysRpt:MinCoolEER				= 
      {	if ( (IfValidAnd( CoolEfficType[1] = "EER" ) .OR. IfValidAnd( CoolEfficType[2] = "EER" )) .AND.
              LocalStatus(HtPumpSystem:EER ) > 0 ) then  HtPumpSystem:EER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolEER2"			ResSCSysRpt:MinCoolEER2			   =
      {	if ( (IfValidAnd( CoolEfficType[1] = "EER2" ) .OR. IfValidAnd( CoolEfficType[2] = "EER2" )) .AND.
              LocalStatus(HtPumpSystem:EER2 ) > 0 ) then  HtPumpSystem:EER2  else  UNDEFINED  endif  }       ; SAC 10/09/22 (tic #3431)
	"Default ResSCSysRpt:MinCoolSEER"			ResSCSysRpt:MinCoolSEER				=
      {	if ( (IfValidAnd( CoolEfficType[1] = "SEER" ) .OR. IfValidAnd( CoolEfficType[2] = "SEER" )) .AND.
              LocalStatus(HtPumpSystem:SEER ) > 0 ) then  HtPumpSystem:SEER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolSEER2"			ResSCSysRpt:MinCoolSEER2			=
      {	if ( (IfValidAnd( CoolEfficType[1] = "SEER2" ) .OR. IfValidAnd( CoolEfficType[2] = "SEER2" )) .AND.
              LocalStatus(HtPumpSystem:SEER2 ) > 0 ) then  HtPumpSystem:SEER2  else  UNDEFINED  endif  }     ; SAC 10/09/22 (tic #3431)
;	"Default ResSCSysRpt:MinCoolEER"					ResSCSysRpt:MinCoolEER			= {	if ( LocalStatus(HtPumpSystem:EER ) < 1 .OR. IfValidAnd( HtPumpSystem:EffMetric = 1 )==0 ) then UNDEFINED else HtPumpSystem:EER  endif  }
;	"Default ResSCSysRpt:MinCoolEER2"				ResSCSysRpt:MinCoolEER2			= {	if ( LocalStatus(HtPumpSystem:EER2) < 1 .OR. IfValidAnd( HtPumpSystem:EffMetric = 2 )==0 ) then UNDEFINED else HtPumpSystem:EER2 endif  }  
;	"Default ResSCSysRpt:MinCoolSEER"				ResSCSysRpt:MinCoolSEER			= {	if ( LocalStatus(HtPumpSystem:SEER ) < 1 .OR. IfValidAnd( HtPumpSystem:EffMetric = 1 )==0 ) then UNDEFINED else HtPumpSystem:SEER  endif  }
;	"Default ResSCSysRpt:MinCoolSEER2"				ResSCSysRpt:MinCoolSEER2		= {	if ( LocalStatus(HtPumpSystem:SEER2) < 1 .OR. IfValidAnd( HtPumpSystem:EffMetric = 2 )==0 ) then UNDEFINED else HtPumpSystem:SEER2 endif  }

	"Default ResSCSysRpt:HtPumpCap17"				ResSCSysRpt:HtPumpCap17			= {	if ( LocalStatus(HtPumpSystem:Cap17) < 1 ) then UNDEFINED else HtPumpSystem:Cap17 endif  }
	"Default ResSCSysRpt:HtPumpCap47"				ResSCSysRpt:HtPumpCap47			= {	if ( LocalStatus(HtPumpSystem:Cap47) < 1 ) then UNDEFINED else HtPumpSystem:Cap47 endif  }
	"Default ResSCSysRpt:MinCoolCFMperTon"			ResSCSysRpt:MinCoolCFMperTon	= {	if ( LocalStatus(HtPumpSystem:CFMperTon) < 1 ) then UNDEFINED else HtPumpSystem:CFMperTon endif  }
	"Assign HERSAHUAirFlow"							ResSCSysRpt:HERSAHUAirFlow 	= {	HtPumpSystem:HERSHtPumpRef:AHUAirFlow	}        ; HERSCheck -> HERSHtPumpRef - SAC 04/18/23 (LMCC tic #133)
	"Assign HERSAirFlowRptMsg"						ResSCSysRpt:HERSAirFlowRptMsg = {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
																										HtPumpSystem:HERSHtPumpRef:AirFlowRptMsg
																										else "none" endif	}
	"Assign HERSSEER"									ResSCSysRpt:HERSSEER 			= {	HtPumpSystem:HERSHtPumpRef:SEER	}              ; HERSCheck -> HERSHtPumpRef - SAC 04/18/23 (LMCC tic #133)
	"Assign HERSSEERRptMsg"							ResSCSysRpt:HERSSEERRptMsg 	= {	if (IfValidAnd( HERSSEER > 0.5 )) then
																										HtPumpSystem:HERSHtPumpRef:SEERRptMsg
																										else "none" endif	}
	"Assign HERSEER"									ResSCSysRpt:HERSEER 				= {	HtPumpSystem:HERSHtPumpRef:EER	}              ; HERSCheck -> HERSHtPumpRef - SAC 04/18/23 (LMCC tic #133)
	"Assign HERSEERRptMsg"							ResSCSysRpt:HERSEERRptMsg 		= {	if (IfValidAnd( HERSEER > 0.5 )) then
																										HtPumpSystem:HERSHtPumpRef:EERRptMsg
																										else "none" endif	}
	"Assign HERSACCharg"								ResSCSysRpt:HERSACCharg 		= {	HtPumpSystem:HERSHtPumpRef:ACCharg	}           ; HERSCheck -> HERSHtPumpRef - SAC 04/18/23 (LMCC tic #133)
	"Assign HERSACChargRptMsg"						ResSCSysRpt:HERSACChargRptMsg = {	if (IfValidAnd( HERSACCharg > 0.5 )) then
																										EnumString( HtPumpSystem:HERSHtPumpRef:ACChargRptMsg ) 
																										else "none" endif	}
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_Heat" 0 0 0 0
;*************************************************************************
	"Set ResSCSysRpt:RefCountByType[1]-Heat"	ResSCSysRpt:RefCountByType[1]	= {	ReferenceCount  }
	"Default ResSCSysRpt:HeatingType"			ResSCSysRpt:HeatingType			= {	if ( LocalStatus(HeatSystem:TypeAbbrevStr) < 1 ) then UNDEFINED else HeatSystem:TypeAbbrevStr endif	}
;	"Default ResSCSysRpt:HeatSysName"			ResSCSysRpt:HeatSysName			= {	Format( "%s (%.0f/%.0f)", HeatSystem:Name, HeatSysUnitTypeIdx, HeatSysUnitTypeCnt )  }
	"Default ResSCSysRpt:TStatType"				ResSCSysRpt:TStatType			= {	"Constant Heating"  }
   ; SAC 11/14/17 - revisions to report "3.413 HSPF" for Electric heating systems (tic #926)
   ; SAC 11/28/17 - revisions to report "3.413 HSPF" for ElecCombHydro heating systems (tic #910)
	"Default ResSCSysRpt:HeatEfficType"		ResSCSysRpt:HeatEfficType	= 
      {  if (IfValidAnd( HeatSystem:TypeAbbrev =  8 ) .OR.  ; Electric
             IfValidAnd( HeatSystem:TypeAbbrev = 29 ))      ; ElecCombHydro
         then  "HSPF"
         else  "AFUE"  endif  }
	"Default ResSCSysRpt:MinHeatEffic"		ResSCSysRpt:MinHeatEffic	= {
         if (IfValidAnd( HeatSystem:TypeAbbrev =  8 ) .OR.  ; Electric
             IfValidAnd( HeatSystem:TypeAbbrev = 29 ))      ; ElecCombHydro
         then  3.413
         else if ( LocalStatus(HeatSystem:AFUE) < 1 )
         then  UNDEFINED
         else  HeatSystem:AFUE
         endif endif  }
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Default ResSCSysRpt:DistribType  '%s'",  DistribSystem:TypeAbbrevStr )  }
END

;*************************************************************************
RULELIST "Default_SCSysReportObject_Cool" 0 0 0 0
;*************************************************************************
	"Set ResSCSysRpt:RefCountByType[2]-Cool"	ResSCSysRpt:RefCountByType[2]		= {	ReferenceCount  }
	"Default ResSCSysRpt:CoolingType"			ResSCSysRpt:CoolingType				= {	CoolSystem:TypeAbbrevStr  }
;	"Default ResSCSysRpt:CoolSysName"			ResSCSysRpt:CoolSysName				= {	Format( "%s (%.0f/%.0f)", CoolSystem:Name, CoolSysUnitTypeIdx, CoolSysUnitTypeCnt )  }
	"Default ResSCSysRpt:ZonalCoolingType"		ResSCSysRpt:ZonalCoolingType		= {	if (IfValidAnd( CoolSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default ResSCSysRpt:CoolCompType"			ResSCSysRpt:CoolCompType			= {	if (IfValidAnd( CoolSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }

	"Default ResSCSysRpt:CoolEfficType[1]"		ResSCSysRpt:CoolEfficType[1]  =     ; SAC 10/10/22 (tic #3431)       ; added CEER - SAC 10/12/22
      {  if (IfValidAnd( CoolSystem:Type = 5 ))   ; RoomAirCond
         then  "CEER"
         else if (IfValidAnd( CoolSystem:EffMetric = 2 ))
         then  if (IfValidAnd( CoolSystem:Type = 14 ))   ; EvapCondenser
               then  "EER2a"
               else if (IfValidAnd( CoolSystem:ShowSEER > 0 ))
               then  "SEER2"
               else  "EER2"   endif endif
         else  if (IfValidAnd( CoolSystem:Type = 14 ))   ; EvapCondenser
               then  "EERa"
               else if (IfValidAnd( CoolSystem:ShowSEER > 0 ))
               then  "SEER"
               else  "EER"    endif endif
         endif endif  }
	"Default ResSCSysRpt:CoolEfficType[2]"		ResSCSysRpt:CoolEfficType[2]  =  
      {  if (IfValidAnd( CoolSystem:EffMetric = 2 ))
         then  if (IfValidAnd( CoolSystem:Type = 14 ))   ; EvapCondenser
               then  "EER2b"
               else if (IfValidAnd( CoolSystem:ShowSEER > 0 ) .AND.
                        IfValidAnd( CoolSystem:ShowEER  > 0 ))
               then  "EER2"
               else  UNDEFINED   endif endif
         else  if (IfValidAnd( CoolSystem:Type = 14 ))   ; EvapCondenser
               then  "EERb"
               else if (IfValidAnd( CoolSystem:ShowSEER > 0 ) .AND.
                        IfValidAnd( CoolSystem:ShowEER  > 0 ))
               then  "EER"
               else  UNDEFINED   endif endif
         endif  }

	"Default ResSCSysRpt:MinCoolCEER"			ResSCSysRpt:MinCoolCEER				=
      {	if (IfValidAnd( CoolSystem:Type = 5 ) .AND. LocalStatus(CoolSystem:CEER ) > 0) then  CoolSystem:CEER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolEER"				ResSCSysRpt:MinCoolEER				= 
      {	if ( (IfValidAnd( CoolEfficType[1] = "EER" ) .OR. IfValidAnd( CoolEfficType[2] = "EER" )) .AND.
              LocalStatus(CoolSystem:EER ) > 0 ) then  CoolSystem:EER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolEER2"			ResSCSysRpt:MinCoolEER2			   =
      {	if ( (IfValidAnd( CoolEfficType[1] = "EER2" ) .OR. IfValidAnd( CoolEfficType[2] = "EER2" )) .AND.
              LocalStatus(CoolSystem:EER2 ) > 0 ) then  CoolSystem:EER2  else  UNDEFINED  endif  }       ; SAC 10/09/22 (tic #3431)
	"Default ResSCSysRpt:MinCoolSEER"			ResSCSysRpt:MinCoolSEER				=
      {	if ( (IfValidAnd( CoolEfficType[1] = "SEER" ) .OR. IfValidAnd( CoolEfficType[2] = "SEER" )) .AND.
              LocalStatus(CoolSystem:SEER ) > 0 ) then  CoolSystem:SEER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolSEER2"			ResSCSysRpt:MinCoolSEER2			=
      {	if ( (IfValidAnd( CoolEfficType[1] = "SEER2" ) .OR. IfValidAnd( CoolEfficType[2] = "SEER2" )) .AND.
              LocalStatus(CoolSystem:SEER2 ) > 0 ) then  CoolSystem:SEER2  else  UNDEFINED  endif  }     ; SAC 10/09/22 (tic #3431)

	"Set ResSCSysRpt:MinCoolEERa"		   ResSCSysRpt:MinCoolEERa	   =     ; SAC 10/15/22
      {	if ((IfValidAnd( CoolEfficType[1] = "EERa"  ) .OR. IfValidAnd( CoolEfficType[2] = "EERa"  )) .AND. IfValidAnd( CoolSystem:EERa > 0  )) then  CoolSystem:EERa   else  UNDEFINED  endif  }
	"Set ResSCSysRpt:MinCoolEERb"		   ResSCSysRpt:MinCoolEERb	   = 
      {	if ((IfValidAnd( CoolEfficType[1] = "EERb"  ) .OR. IfValidAnd( CoolEfficType[2] = "EERb"  )) .AND. IfValidAnd( CoolSystem:EERb > 0  )) then  CoolSystem:EERb   else  UNDEFINED  endif  }
	"Set ResSCSysRpt:MinCoolEER2a"	   ResSCSysRpt:MinCoolEER2a   = 
      {	if ((IfValidAnd( CoolEfficType[1] = "EER2a" ) .OR. IfValidAnd( CoolEfficType[2] = "EER2a" )) .AND. IfValidAnd( CoolSystem:EER2a > 0 )) then  CoolSystem:EER2a  else  UNDEFINED  endif  }
	"Set ResSCSysRpt:MinCoolEER2b"	   ResSCSysRpt:MinCoolEER2b   = 
      {	if ((IfValidAnd( CoolEfficType[1] = "EER2b" ) .OR. IfValidAnd( CoolEfficType[2] = "EER2b" )) .AND. IfValidAnd( CoolSystem:EER2b > 0 )) then  CoolSystem:EER2b  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:MinCoolCFMperTon"		ResSCSysRpt:MinCoolCFMperTon		= {	if ( LocalStatus(CoolSystem:CFMperTon) < 1 ) then UNDEFINED else CoolSystem:CFMperTon endif  }
	"Assign HERSAHUAirFlow"						ResSCSysRpt:HERSAHUAirFlow 		= {	CoolSystem:HERSCheck:AHUAirFlow	}
	"Assign HERSAirFlowRptMsg"					ResSCSysRpt:HERSAirFlowRptMsg 	= {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
																										CoolSystem:HERSCheck:AirFlowRptMsg
																										else "none" endif	}
	"Assign HERSSEER"								ResSCSysRpt:HERSSEER 				= {	CoolSystem:HERSCheck:SEER	}
	"Assign HERSSEERRptMsg"						ResSCSysRpt:HERSSEERRptMsg 		= {	if (IfValidAnd( HERSSEER > 0.5 )) then
																										CoolSystem:HERSCheck:SEERRptMsg
																										else "none" endif	}
	"Assign HERSEER"								ResSCSysRpt:HERSEER 					= {	CoolSystem:HERSCheck:EER	}
	"Assign HERSEERRptMsg"						ResSCSysRpt:HERSEERRptMsg 			= {	if (IfValidAnd( HERSEER > 0.5 )) then
																										CoolSystem:HERSCheck:EERRptMsg
																										else "none" endif	}
	"Assign HERSACCharg"							ResSCSysRpt:HERSACCharg 			= {	CoolSystem:HERSCheck:ACCharg	}
	"Assign HERSACChargRptMsg"					ResSCSysRpt:HERSACChargRptMsg 	= {	if (IfValidAnd( HERSACCharg > 0.5 )) then
																										EnumString( CoolSystem:HERSCheck:ACChargRptMsg ) 
																										else "none" endif	}
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSAHUAirFlow  %g",  CoolSystem:HERSCheck:AHUAirFlow )  }
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSAirFlowRptMsg  CoolSystem:HERSCheck:AirFlowRptMsg: '%s'",  CoolSystem:HERSCheck:AirFlowRptMsg )  }
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSSEERRptMsg  CoolSystem:HERSCheck:SEERRptMsg: '%s'",  CoolSystem:HERSCheck:SEERRptMsg )  }
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSACChargRptMsg  CoolSystem:HERSCheck:ACChargRptMsg: '%s'",  CoolSystem:HERSCheck:ACChargRptMsg )  }
;	"debug SCSysRpt"			ResSCSysRpt:Action = { PostWarning( "Assign HERSEERRptMsg  CoolSystem:HERSCheck:EERRptMsg: '%s'",  CoolSystem:HERSCheck:EERRptMsg )  }
END

;************************************************************************* SAC 10/13/22
RULELIST "Default_SCSysReportObject_CentralHtgClg_VRF" 0 0 0 0
;*************************************************************************

	"Set ResSCSysRpt:RefCountByType[3]-HtPump"	ResSCSysRpt:RefCountByType[3]	= {	ReferenceCount  }
	"Default ResSCSysRpt:HeatingType"				ResSCSysRpt:HeatingType			= {	EnumString( CentralHtgClgSystem:Type )  }
	"Default ResSCSysRpt:HeatSysName"				ResSCSysRpt:HeatSysName			= {	CentralHtgClgSystem:VRFSysRef:Name  }  ; Format( "%s (%.0f/%.0f)", HtPumpSystem:Name, HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )  }
	"Default ResSCSysRpt:CoolingType"				ResSCSysRpt:CoolingType			= {	HeatingType  }
	"Default ResSCSysRpt:CoolSysName"				ResSCSysRpt:CoolSysName			= {	if ( LocalStatus(HeatSysName) < 1 ) then UNDEFINED else HeatSysName endif  }
	"Default ResSCSysRpt:TStatType"					ResSCSysRpt:TStatType			= {	"Constant Heating"  }  ; ??
	"Default ResSCSysRpt:ZonalCoolingType"			ResSCSysRpt:ZonalCoolingType	= {	"Not Zonal"     }  ; if (IfValidAnd( HtPumpSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default ResSCSysRpt:CoolCompType"				ResSCSysRpt:CoolCompType		= {	"Single Speed"  }  ; if (IfValidAnd( HtPumpSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }

      ; "dbg" ResSCSysRpt:Action = { PostMessageToLog( "ResSCSysRpt '%s':  ClgCapTotNetRtd %g / COP %g / HSFP %g", Name, CentralHtgClgSystem:ClgCapTotNetRtd, CentralHtgClgSystem:VRFSysRef:COP, CentralHtgClgSystem:VRFSysRef:HSPF ) }
	"Default ResSCSysRpt:HeatEfficType[1]"			ResSCSysRpt:HeatEfficType[1]	= {	if (IfValidAnd( CentralHtgClgSystem:ClgCapTotNetRtd > 65000 ) .AND.
                                                                                        IfValidAnd( CentralHtgClgSystem:VRFSysRef:COP > 0 ))
																										then	"COP"
																										else if (IfValidAnd( CentralHtgClgSystem:VRFSysRef:HSPF > 0 ))
                                                                              then  "HSPF"
                                                                              else  UNDEFINED  endif endif  }
	"Default ResSCSysRpt:MinHeatEffic[1]"			ResSCSysRpt:MinHeatEffic[1]	= {	if (IfValidAnd( HeatEfficType[1] = "COP"  )) then  CentralHtgClgSystem:VRFSysRef:COP
                                                                              else if ( IfValidAnd( HeatEfficType[1] = "HSPF" )) then  CentralHtgClgSystem:VRFSysRef:HSPF
                                                                              else  UNDEFINED  endif endif  }

   "Set ResSCSysRpt:SysHtPumpCap47"    ResSCSysRpt:SysHtPumpCap47  = {  if (IfValidAnd( CentralHtgClgSystem:VRFSysRef:HtgCapNetRtd > 0 ))
                                                                        then  CentralHtgClgSystem:VRFSysRef:HtgCapNetRtd  else  UNDEFINED  endif  }      ; SAC 10/14/22
   "Set ResSCSysRpt:SysClgCapNetRtd"   ResSCSysRpt:SysClgCapNetRtd = {  if (IfValidAnd( CentralHtgClgSystem:VRFSysRef:ClgCapNetRtd > 0 ))
                                                                        then  CentralHtgClgSystem:VRFSysRef:ClgCapNetRtd  else  UNDEFINED  endif  }

;   "Set ResSCSysRpt:SuppHeatEfficType"          ResSCSysRpt:SuppHeatEfficType = 
;      {  if (IfValidAnd( HtPumpSystem:AllowDualFuel > 0 ) .AND.
;             IfValidAnd( HtPumpSystem:IsDualFuel > 0 ))
;         then  "AFUE"  else  UNDEFINED  endif  }
;   "Set ResSCSysRpt:MinSuppHeatEffic"           ResSCSysRpt:MinSuppHeatEffic = 
;      {  if (LocalStatus( SuppHeatEfficType ) > 0 .AND.
;             IfValidAnd( HtPumpSystem:AFUE > 0 ))
;         then  HtPumpSystem:AFUE  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:CoolEfficType[1]"		ResSCSysRpt:CoolEfficType[1]  = 
      {  if (IfValidAnd( CentralHtgClgSystem:ClgCapTotNetRtd > 65000 ) .AND.
             IfValidAnd( CentralHtgClgSystem:VRFSysRef:EER > 0 ))  
         then  "EER"
         else if (IfValidAnd( CentralHtgClgSystem:VRFSysRef:SEER > 0 ))
         then  "SEER"
         else  UNDEFINED  endif endif  }

	"Default ResSCSysRpt:MinCoolEER"				ResSCSysRpt:MinCoolEER				= 
      {	if (IfValidAnd( CoolEfficType[1] = "EER" ))  
         then  CentralHtgClgSystem:VRFSysRef:EER  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinCoolSEER"			ResSCSysRpt:MinCoolSEER				=
      {	if (IfValidAnd( CoolEfficType[1] = "SEER" ))  
         then  CentralHtgClgSystem:VRFSysRef:SEER  else  UNDEFINED  endif  }

;	"Default ResSCSysRpt:HtPumpCap17"				ResSCSysRpt:HtPumpCap17			= {	if ( LocalStatus(HtPumpSystem:Cap17) < 1 ) then UNDEFINED else HtPumpSystem:Cap17 endif  }
	"Default ResSCSysRpt:HtPumpCap47"				ResSCSysRpt:HtPumpCap47			=
      {	if (IfValidAnd( CentralHtgClgSystem:HtgCapTotNetRtd > 0 ))  
         then  CentralHtgClgSystem:HtgCapTotNetRtd  else  UNDEFINED  endif  }
;	"Default ResSCSysRpt:MinCoolCFMperTon"			ResSCSysRpt:MinCoolCFMperTon	=
;      {	if (IfValidAnd( CentralHtgClgSystem:??? > 0 ))  
;         then  CentralHtgClgSystem:???  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:ClgCapNetRtd"			ResSCSysRpt:ClgCapNetRtd			= 
      {	if (IfValidAnd( CentralHtgClgSystem:ClgCapTotNetRtd > 0 ))  
         then  CentralHtgClgSystem:ClgCapTotNetRtd  else  UNDEFINED  endif  }

;	"Assign HERSAHUAirFlow"							ResSCSysRpt:HERSAHUAirFlow 	= {	HtPumpSystem:HERSCheck:AHUAirFlow	}
;	"Assign HERSAirFlowRptMsg"						ResSCSysRpt:HERSAirFlowRptMsg = {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
;																										HtPumpSystem:HERSCheck:AirFlowRptMsg
;																										else "none" endif	}
;	"Assign HERSSEER"									ResSCSysRpt:HERSSEER 			= {	HtPumpSystem:HERSCheck:SEER	}
;	"Assign HERSSEERRptMsg"							ResSCSysRpt:HERSSEERRptMsg 	= {	if (IfValidAnd( HERSSEER > 0.5 )) then
;																										HtPumpSystem:HERSCheck:SEERRptMsg
;																										else "none" endif	}
;	"Assign HERSEER"									ResSCSysRpt:HERSEER 				= {	HtPumpSystem:HERSCheck:EER	}
;	"Assign HERSEERRptMsg"							ResSCSysRpt:HERSEERRptMsg 		= {	if (IfValidAnd( HERSEER > 0.5 )) then
;																										HtPumpSystem:HERSCheck:EERRptMsg
;																										else "none" endif	}
;	"Assign HERSACCharg"								ResSCSysRpt:HERSACCharg 		= {	HtPumpSystem:HERSCheck:ACCharg	}
;	"Assign HERSACChargRptMsg"						ResSCSysRpt:HERSACChargRptMsg = {	if (IfValidAnd( HERSACCharg > 0.5 )) then
;																										EnumString( HtPumpSystem:HERSCheck:ACChargRptMsg ) 
;																										else "none" endif	}

END
;************************************************************************* SAC 10/13/22
RULELIST "Default_SCSysReportObject_CentralHtgClg_WSHP" 0 0 0 0
;*************************************************************************

	"Set ResSCSysRpt:RefCountByType[3]-HtPump"	ResSCSysRpt:RefCountByType[3]	= {	ReferenceCount  }
	"Default ResSCSysRpt:HeatingType"				ResSCSysRpt:HeatingType			= {	EnumString( CentralHtgClgSystem:Type )  }
	"Default ResSCSysRpt:HeatSysName"				ResSCSysRpt:HeatSysName			= {	CentralHtgClgSystem:Name  }  ; Format( "%s (%.0f/%.0f)", HtPumpSystem:Name, HtPumpSysUnitTypeIdx, HtPumpSysUnitTypeCnt )  }
	"Default ResSCSysRpt:CoolingType"				ResSCSysRpt:CoolingType			= {	HeatingType  }
	"Default ResSCSysRpt:CoolSysName"				ResSCSysRpt:CoolSysName			= {	if ( LocalStatus(HeatSysName) < 1 ) then UNDEFINED else HeatSysName endif  }
	"Default ResSCSysRpt:TStatType"					ResSCSysRpt:TStatType			= {	"Constant Heating"  }  ; ??
	"Default ResSCSysRpt:ZonalCoolingType"			ResSCSysRpt:ZonalCoolingType	= {	"Not Zonal"     }  ; if (IfValidAnd( HtPumpSystem:IsZonal > 0.5 )) then "Zonally Controlled" else "Not Zonal" endif  }
	"Default ResSCSysRpt:CoolCompType"				ResSCSysRpt:CoolCompType		= {	"Single Speed"  }  ; if (IfValidAnd( HtPumpSystem:IsMultiSpeed > 0.5 )) then "Multi-speed" else "Single Speed" endif   }
	"Default ResSCSysRpt:HeatEfficType[1]"			ResSCSysRpt:HeatEfficType[1]	= {	if (IfValidAnd( CentralHtgClgSystem:WSHPCOP > 0 ))
																										then	"COP"  else  UNDEFINED  endif  }
	"Default ResSCSysRpt:MinHeatEffic[1]"			ResSCSysRpt:MinHeatEffic[1]	= {	if (IfValidAnd( HeatEfficType[1] = "COP" )) then  CentralHtgClgSystem:WSHPCOP
                                                                              else  UNDEFINED  endif  }

;   "Set ResSCSysRpt:SuppHeatEfficType"          ResSCSysRpt:SuppHeatEfficType = 
;      {  if (IfValidAnd( HtPumpSystem:AllowDualFuel > 0 ) .AND.
;             IfValidAnd( HtPumpSystem:IsDualFuel > 0 ))
;         then  "AFUE"  else  UNDEFINED  endif  }
;   "Set ResSCSysRpt:MinSuppHeatEffic"           ResSCSysRpt:MinSuppHeatEffic = 
;      {  if (LocalStatus( SuppHeatEfficType ) > 0 .AND.
;             IfValidAnd( HtPumpSystem:AFUE > 0 ))
;         then  HtPumpSystem:AFUE  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:CoolEfficType[1]"		ResSCSysRpt:CoolEfficType[1]  = 
      {  if (IfValidAnd( CentralHtgClgSystem:WSHPEER > 0 ))  
         then  "EER"  else  UNDEFINED  endif  }

	"Default ResSCSysRpt:MinCoolEER"				ResSCSysRpt:MinCoolEER				= 
      {	if (IfValidAnd( CoolEfficType[1] = "EER" ))  
         then  CentralHtgClgSystem:WSHPEER  else  UNDEFINED  endif  }

;	"Default ResSCSysRpt:HtPumpCap17"				ResSCSysRpt:HtPumpCap17			= {	if ( LocalStatus(HtPumpSystem:Cap17) < 1 ) then UNDEFINED else HtPumpSystem:Cap17 endif  }
;	"Default ResSCSysRpt:HtPumpCap47"				ResSCSysRpt:HtPumpCap47			=
;      {	if (IfValidAnd( CentralHtgClgSystem:HtgCapNetRtd > 0 ))  
;         then  CentralHtgClgSystem:HtgCapNetRtd  else  UNDEFINED  endif  }
;	"Default ResSCSysRpt:MinCoolCFMperTon"			ResSCSysRpt:MinCoolCFMperTon	=
;      {	if (IfValidAnd( CentralHtgClgSystem:HtgCapNetRtd > 0 ))  
;         then  CentralHtgClgSystem:HtgCapNetRtd  else  UNDEFINED  endif  }

;	"Default ResSCSysRpt:ClgCapNetRtd"			ResSCSysRpt:ClgCapNetRtd			= 
;      {	if (IfValidAnd( CentralHtgClgSystem:ClgCapNetRtd > 0 ))  
;         then  CentralHtgClgSystem:ClgCapNetRtd  else  UNDEFINED  endif  }

;	"Assign HERSAHUAirFlow"							ResSCSysRpt:HERSAHUAirFlow 	= {	HtPumpSystem:HERSCheck:AHUAirFlow	}
;	"Assign HERSAirFlowRptMsg"						ResSCSysRpt:HERSAirFlowRptMsg = {	if (IfValidAnd( HERSAHUAirFlow > 0.5 )) then 
;																										HtPumpSystem:HERSCheck:AirFlowRptMsg
;																										else "none" endif	}
;	"Assign HERSSEER"									ResSCSysRpt:HERSSEER 			= {	HtPumpSystem:HERSCheck:SEER	}
;	"Assign HERSSEERRptMsg"							ResSCSysRpt:HERSSEERRptMsg 	= {	if (IfValidAnd( HERSSEER > 0.5 )) then
;																										HtPumpSystem:HERSCheck:SEERRptMsg
;																										else "none" endif	}
;	"Assign HERSEER"									ResSCSysRpt:HERSEER 				= {	HtPumpSystem:HERSCheck:EER	}
;	"Assign HERSEERRptMsg"							ResSCSysRpt:HERSEERRptMsg 		= {	if (IfValidAnd( HERSEER > 0.5 )) then
;																										HtPumpSystem:HERSCheck:EERRptMsg
;																										else "none" endif	}
;	"Assign HERSACCharg"								ResSCSysRpt:HERSACCharg 		= {	HtPumpSystem:HERSCheck:ACCharg	}
;	"Assign HERSACChargRptMsg"						ResSCSysRpt:HERSACChargRptMsg = {	if (IfValidAnd( HERSACCharg > 0.5 )) then
;																										EnumString( HtPumpSystem:HERSCheck:ACChargRptMsg ) 
;																										else "none" endif	}

END
;*************************************************************************


; mjb 3/24/14 - added rulelists designed to setup and default DHWSysRpt objects
;*************************************************************************
RULELIST "Setup_DHWSysReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all DHWSysRpt objects currently in building description"									ResProj:Action		= {	DeleteAllComps( ResDHWSysRpt )  }
	"Create new DHWSysRpt objects and populate w/ initial object references & indexes/counts"	ResProj:Action		= {	CreateDHWRptObjects()  }
	"Evaluate rules to summarize building model for reporting purposes"		ResProj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
	"Default DHWSysRpt properties - general"		ResDHWSysRpt:Action	= {	     if (ParentComponentType() == "ResDHWSys") then  EvalRulelist( "Default_DHWSysReportObject_DHWSysParent", 1 )
																								else if (ParentComponentType() == "DwellUnit" .AND. LocalCompAssigned( DHWSysRef )) then  EvalRulelist( "Default_DHWSysReportObject_DwellUnitParent", 1 )
																								else  UNCHANGED  endif endif  }
END

;*************************************************************************
RULELIST "Default_DHWSysReportObject_DHWSysParent" 0 0 0 0
;*************************************************************************
	"Default ResDHWSysRpt:DHWSysName"				ResDHWSysRpt:DHWSysName		= {	Format( "%s - %g/%g", Parent(Name), DHWHeaterIdx, DHWHeaterCnt ) }
	"Default ResDHWSysRpt:DwellingUnit"				ResDHWSysRpt:DwellingUnit	= {	Format( "Dwelling Unit served by %s", DHWSysName )  }
	"Default ResDHWSysRpt:DHWSysRef"					ResDHWSysRpt:DHWSysRef		= {	Parent( Name )  }
	"Default ResDHWSysRpt:Status"						ResDHWSysRpt:Status			= {	Parent( Status )  }		; SAC 12/14/15
	"Set remaining DHWSysRpt properties"		ResDHWSysRpt:Action			= {	EvalRulelist( "Default_DHWSysReportObject", 1 )  }
END
;*************************************************************************
RULELIST "Default_DHWSysReportObject_DwellUnitParent" 0 0 0 0
;*************************************************************************
	"Default ResDHWSysRpt:DHWSysName"				ResDHWSysRpt:DHWSysName		= {	Format( "%s - %g/%g", DHWSysRef:Name, DHWHeaterIdx, DHWHeaterCnt )  }
	"Default ResDHWSysRpt:DwellingUnit"				ResDHWSysRpt:DwellingUnit	= {	Parent( Name )  }
	"Default ResDHWSysRpt:DwellUnitRef"				ResDHWSysRpt:DwellUnitRef	= {	Parent( Name )  }   ; SAC 10/23/19 (tic #1159)
	"Default ResDHWSysRpt:Status"						ResDHWSysRpt:Status			= {	Parent2( DHWSys1Status )  }		; SAC 12/14/15
	"Set remaining DHWSysRpt properties"		ResDHWSysRpt:Action			= {	EvalRulelist( "Default_DHWSysReportObject", 1 )  }
END

;*************************************************************************
RULELIST "Default_DHWSysReportObject" 0 0 0 0
;*************************************************************************

	"Default ResDHWSysRpt:DHWSysType"				ResDHWSysRpt:DHWSysType		= {	if (IfValidAnd( DHWSysRef:IsHydronic > 0.5 )) then "Combined Hydronic" else "DHW" endif  }
   "Set ResDHWSysRpt:IsCentralHPWH"             ResDHWSysRpt:IsCentralHPWH =        ; SAC 2/20/20 (tic #1197)
      {  if (IfValidAnd( DHWSysRef:CentralDHW > 0 ) .AND.
             IfValidAnd( DHWSysRef:CentralDHWType = 2 ))
         then  1  else  0  endif  }
   "Set ResDHWSysRpt:DwellUnitTypeRef"          ResDHWSysRpt:DwellUnitTypeRef  =    ; SAC 2/20/20 (tic #1197)
      {  if (LocalCompAssigned( DwellUnitRef )) then  DwellUnitRef:DwellUnitTypeRef
         else  UNDEFINED  endif  }

   "Set ResDHWSysRpt:NonCntrlDHWHeaterCnt"      ResDHWSysRpt:NonCntrlDHWHeaterCnt  =      ; SAC 6/14/20 (tic #1185)
      {  if (IfValidAnd( DHWSysRef:CentralDHW > 0 )) then  0
         else  DHWHeaterCnt  endif  }

	"Default ResDHWSysRpt:DwellUnitDistType"		ResDHWSysRpt:DwellUnitDistType 	= {	if (IfValidAnd( DHWSysRef:SystemType > 0.5 )) then
																												EnumString( DHWSysRef:SystemType ) 
																											else "none" endif	}

	"Default ResDHWSysRpt:MFamDistType"				ResDHWSysRpt:MFamDistType	= {	if (IfValidAnd( DHWSysRef:CentralDHW > 0.5 )) then EnumString( DHWSysRef:MFamDistType ) else "None" endif	}
  ; SAC 2/20/20 - updated all following rules for IsCentralHPWH (tic #1197)
	; SAC 4/15/16 - switch check on HeaterElementType from > 0.5 to >= 0 to ensure that 'Electric Resistance' (=0) works properly
	"Default ResDHWSysRpt:HeaterElementType"		ResDHWSysRpt:HeaterElementType 	= {	if (IsCentralHPWH) then  "Heat Pump"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if (IfValidAnd( DHWHeaterRef:DHWHeaterElementType >= 0 ))
																													then	EnumString( DHWHeaterRef:DHWHeaterElementType ) 
																													else	"none"  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType >= 0 ))
																													then	EnumString( DHWHeaterRef:HeaterElementType ) 
																													else	"none"  endif  endif  endif  }
   ; SAC 6/19/18 - switch TankType range checks from > 0.5 to >= 0 (tic #871)
	"Default ResDHWSysRpt:TankType"					ResDHWSysRpt:TankType 	= {	if (IsCentralHPWH) then  "NA"
	                                                                     else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																								then	if (IfValidAnd( DHWHeaterRef:DHWTankType >= 0 ))
																										then	EnumString( DHWHeaterRef:DHWTankType ) 
																										else	"none"  endif
																								else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																										else if (IfValidAnd( DHWHeaterRef:TankType >= 0 ))
																										then	EnumString( DHWHeaterRef:TankType ) 
																										else	"none"  endif  endif  endif  endif  }
	"Default ResDHWSysRpt:InputRating"				ResDHWSysRpt:InputRating			= {	if (IsCentralHPWH) then  12000
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWInputRating) < 1 ) then UNDEFINED else DHWHeaterRef:DHWInputRating endif
																											else	if ( LocalStatus(DHWHeaterRef:InputRating   ) < 1 ) then UNDEFINED else DHWHeaterRef:InputRating    endif  endif  endif  }
	"Default ResDHWSysRpt:InputRatingUnits"		ResDHWSysRpt:InputRatingUnits		= {	if (IsCentralHPWH) then  "watts"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	switch (DHWHeaterRef:DHWHeaterElementType)
																														case  0 :	"watts"   ; "Electric Resistance" 
																														case  1 :   "Btu/hr"  ; "Natural Gas"   
																														case  2 :   "Btu/hr"  ; "Propane"             
																														case  3 :   "watts"   ; "Air-Source Heat Pump"           
																														case  6 :   "watts"   ; "Ground-Source Heat Pump"           
																														case  4 :   "Btu/hr"  ; "Oil"   
																														default :	" "
																													endswitch
																											else	if ( LocalStatus(DHWHeaterRef:InputRatingUnits) < 1 ) then "  "
																													else DHWHeaterRef:InputRatingUnits
																													endif
																											endif endif  }
   ; SAC 6/13/18 - revised logic to prevent reporting of InputRating for heaters where InputRating not user defined (tic #940)
   ; SAC 6/27/18 - another round of mods to ensure InputRating size RANGES listed for reference (tic #940)
	"Default ResDHWSysRpt:InputRatingRpt"			ResDHWSysRpt:InputRatingRpt		= {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
		then	"<= 12 kW"     ; AWHP doesn't allow input of DHWInputRating
		else
		switch (DHWHeaterRef:HeaterElementType)
			case  0 :	      	; (watts)   "Electric Resistance" 
                     switch (DHWHeaterRef:HeaterType)
               			case  2 :    "> 12 kW"		; "Large Instantaneous" 
               			case  3 :            		; "Large Storage" 
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 12 kW"  endif
               			case  5 :    "<= 12 kW"		; "Small Instantaneous" 
               			case  6 :    "<= 12 kW"		; "Small Storage" 
               			case 10 :    "<= 12 kW"		; "Consumer Instantaneous (UEF)"             
               			case 11 :     "> 12 kW"		; "Commercial Instantaneous (TE)"            
               			case 12 :    "<= 12 kW"		; "Consumer Storage (UEF)" 
               			case 13 :            		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 12 kW"  endif
                        case 15 :     "> 12 kW to <= 58.6 kW"      ; "Residential-Duty Commercial Instantaneous (UEF)"
							   default :	 "<= 12 kW" 
							endswitch
			case  1 :   			; (Btu/hr)  "Natural Gas"   
                     switch (DHWHeaterRef:HeaterType)
                        case  0 :   "NA"      ; "Boiler"  
                        case  1 :   "NA"      ; "Indirect"  
                        case  2 :    "> 200 kBtu/hr"      ; "Large Instantaneous"  
                        case  3 :                         ; "Large Storage"  
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 75 kBtu/hr"  endif
                        case  9 :   "<= 200 kBtu/hr"	   ; "UEF-rated Instantaneous"
							   case  5 :   "<= 200 kBtu/hr"		; "Small Tankless"
               			case 10 :   "<= 200 kBtu/hr"		; "Consumer Instantaneous (UEF)"             
               			case 11 :    "> 200 kBtu/hr"		; "Commercial Instantaneous (TE)"            
               			case 12 :   "<= 75 kBtu/hr"		; "Consumer Storage (UEF)"                   
               			case 13 :                  		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  Format( "%s %s", FltToStr( InputRating ), InputRatingUnits )
               			           else  "> 75 kBtu/hr"  endif
               			case 14 :    "> 75 kBtu/hr to <= 105 kBtu/hr"		; "Residential-Duty Commercial Storage (UEF)"
                        case 16 :   ">= 300 kBtu/hr to <= 2.5 MBtu/hr"     ; "Commercial Packaged Boiler"      ; SAC 12/19/19 - to facilitate new central gas std design DHW system (tic #862)
							   default :	"<= 75 kBtu/hr"		; "Small Storage"
							endswitch
			case  2 :   			; (Btu/hr)  "Propane"             
							if (DHWHeaterRef:HeaterType == 5) then  "<= 200 kBtu/hr"		; "Small Tankless"
							else	"<= 75 kBtu/hr"  endif							; "Small Storage"
			case  3 :    "<= 12 kW"   ; (watts)   "Heat Pump"           
			case  4 :   			; (Btu/hr)  "Oil"   
							if (DHWHeaterRef:HeaterType == 5) then  "<= 200 kBtu/hr"		; "Small Tankless"
							else	"<= 75 kBtu/hr"  endif							; "Small Storage"
			case  5 :    	      ; (watts)  "Heat Pump"
			            if (IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 )) then  "NA"
			            else  "<= 12 kW"  endif
			default :	UNDEFINED
		endswitch  endif endif  }
   ; SAC 7/5/17 - disable Efficiency reporting for NEEA-rated HPWHs (tic #805)
	"Default ResDHWSysRpt:Efficiency"				ResDHWSysRpt:Efficiency				= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWEnergyFactor) < 1 ) then UNDEFINED else DHWHeaterRef:DHWEnergyFactor endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) .OR.
																													     LocalStatus(DHWHeaterRef:EnergyFactor) < 1 ) then UNDEFINED else DHWHeaterRef:EnergyFactor endif endif endif  }
	"Default ResDHWSysRpt:EfficiencyUnits"			ResDHWSysRpt:EfficiencyUnits		= {	if (IsCentralHPWH) then  "EF"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	"EF"
																											else
																												if ( LocalStatus(DHWHeaterRef:EfficiencyUnits) < 1 ) then " " else DHWHeaterRef:EfficiencyUnits endif endif endif  }
	"Reset ResDHWSysRpt:EfficiencyUnits to 'effic.'"	ResDHWSysRpt:EfficiencyUnits	= {
	      if (IfValidAnd( EfficiencyUnits = "frac" ))
	      then  "effic."  else  UNCHANGED  endif  }    ; SAC 4/13/18 - tic #871
   ; SAC 7/5/17 - set EfficiencyRpt for NEEA-rated HPWHs to 'NEEA Rated' (tic #805)
	"Default ResDHWSysRpt:EfficiencyRpt"			ResDHWSysRpt:EfficiencyRpt			= {	if (IsCentralHPWH) then  "NEEA Rated"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if (LocalStatus( Efficiency ) < 1) then  " "
																													else	Format( "%g %s", Efficiency, EfficiencyUnits )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 ) .AND.
																														 IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0.5 )) then  "NEEA Rated"
																													else if (LocalStatus( Efficiency ) < 1) then  " "
																													else	Format( "%g %s", Efficiency, EfficiencyUnits )  endif endif
																											endif endif  }

;"debug"	ResDHWSysRpt:Action	= {
;   if (ResProj:RunNumber < 1 .OR. LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ) .OR.
;       IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 )==0) then  UNCHANGED
;   else  MessageBox( "performing HPWHData_NEEA:TankVolume look-up - RunID: '%s' - HPWHModel: %g", ResProj:RunID, DHWHeaterRef:HPWHModel )  endif  }
   ; SAC 7/5/17 - added table look-up for TankVolume of NEEA-rated HPWHs (tic #805)
	"Default ResDHWSysRpt:TankVolume"				ResDHWSysRpt:TankVolume				= {	if (IsCentralHPWH) then  ValidOr( DHWSysRef:CHPWHTotTankVol, 0 )
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWTankVolume) < 1 ) then UNDEFINED else DHWHeaterRef:DHWTankVolume endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) )
																											      then  HPWHData_NEEA:TankVolume( "ModelNum", DHWHeaterRef:HPWHModel )
																											      else if ( LocalStatus(DHWHeaterRef:TankVolume) < 1 ) then UNDEFINED else DHWHeaterRef:TankVolume endif endif	endif endif  }
	"Default ResDHWSysRpt:TankVolumeRpt"			ResDHWSysRpt:TankVolumeRpt			= {   if (LocalStatus( TankVolume ) < 1) then  " "
                                                                                 else	FltToStr( TankVolume )  endif  }
                                                                              ; SAC 8/17/17 - revised logic to report TankVolume for NEEA-rated HPWHs (revised when reviewing reporting for Com)
	                                                                           ;	if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																										;	then	if (LocalStatus( TankVolume ) < 1) then  " "
																										;			else	FltToStr( TankVolume )  endif
																										;	else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 ) .AND.
																										;				 IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0.5 )) then  "NA"
																										;			else if (LocalStatus( TankVolume ) < 1) then  " "
																										;			else	FltToStr( TankVolume )  endif endif
																										;	endif  }
   ; SAC 7/5/17 - disable ExtInsulRVal reporting for NEEA-rated HPWHs (tic #805)
	"Default ResDHWSysRpt:ExtInsulRVal"				ResDHWSysRpt:ExtInsulRVal			= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWExtInsulRVal) < 1 ) then UNDEFINED else DHWHeaterRef:DHWExtInsulRVal endif
																											else	if ( IfValidAnd( DHWHeaterRef:IsNEEAHtPumpWtrHtr > 0 ) .OR.
																													     LocalStatus(DHWHeaterRef:ExtInsulRVal) < 1 ) then UNDEFINED else DHWHeaterRef:ExtInsulRVal endif 	endif	endif  }
	"Default ResDHWSysRpt:ExtInsulRpt"				ResDHWSysRpt:ExtInsulRpt			= {	if (IsCentralHPWH) then  "NA"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if (LocalStatus( ExtInsulRVal ) < 1) then  " "
																													else	Format( "%g", ExtInsulRVal )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																													else if (LocalStatus( ExtInsulRVal ) < 1) then  " "
																													else	Format( "%g", ExtInsulRVal )  endif endif
																											endif endif  }
	"Default ResDHWSysRpt:StandbyLossFrac"			ResDHWSysRpt:StandbyLossFrac		= {	if (IsCentralHPWH) then  UNDEFINED
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if ( LocalStatus(DHWHeaterRef:DHWStandbyLossFrac) < 1 ) then UNDEFINED else DHWHeaterRef:DHWStandbyLossFrac endif
																											else	if ( LocalStatus(DHWHeaterRef:StandbyLossFrac) < 1 ) then UNDEFINED else DHWHeaterRef:StandbyLossFrac endif	endif endif  }
	"Default ResDHWSysRpt:StandbyLossRpt"			ResDHWSysRpt:StandbyLossRpt		= {	if (IsCentralHPWH) then  "NA"
	                                                                              else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
																											then	if (LocalStatus( StandbyLossFrac ) < 1) then  " "
																													else	Format( "%g", StandbyLossFrac )  endif
																											else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )) then  "NA"
																													else if (LocalStatus( StandbyLossFrac ) < 1) then  " "
																													else	Format( "%g", StandbyLossFrac )  endif endif
																											endif endif  }
	; SAC 4/29/16 - added new properties to handle reporting of latest HPWH (& elec reistance) equipment
	; SAC 4/24/17 - updated label w/ HPWH Brand/Model enums (tic #829)
	; SAC 6/1/20 - expand reporting for central HPWH compressor & NEEA types
   ; new mapping for NEEA brand = '(generic)' (new NEEA/AWHS tier 3 selections) - SAC 06/17/21
	"Default ResDHWSysRpt:MakeAndModel"				ResDHWSysRpt:MakeAndModel			= {
	      if (IsCentralHPWH)
	      then  if (IfValidAnd( DHWSysRef:CHPWHSysDescrip = 1 ))
	            then  EnumString( DHWSysRef:CHPWHNEEABrand ) + " / " +
	                  EnumString( DHWSysRef:CHPWHNEEAModel )
	            else  EnumString( DHWSysRef:CHPWHCompType )  endif
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )==0) then  "NA"
					else if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated < 0.5 ) .OR.
								IfValidAnd( DHWHeaterRef:ASHPType > 0 )==0) then  "NA"
					else	if (IfValidAnd( DHWHeaterRef:HPWHBrand > 2 ) .AND.
					          IfValidAnd( DHWHeaterRef:HPWHModel > 1 ))
					      then  EnumString( DHWHeaterRef:HPWHBrand ) + " / " +
					            EnumString( DHWHeaterRef:HPWHModel )
                     else if (IfValidAnd( DHWHeaterRef:HPWHBrand = 99 ))   ; generic
                     then  "AWHS " + EnumString( DHWHeaterRef:HPWHModel )
					      else  EnumString( DHWHeaterRef:ASHPType )
					      endif endif
					endif endif 
			endif endif  }
   "Set ResDHWSysRpt:SimulatedEquip - Description of simulated equipment (currently only HPWHs)"  ; SAC 7/5/17 - tic #805
      ResDHWSysRpt:SimulatedEquip  = {
	      if (IsCentralHPWH) then  MakeAndModel
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:HeaterElementType = 5 )==0) then  "NA"
					else if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated < 0.5 ) .OR.
								IfValidAnd( DHWHeaterRef:ASHPType > 0 )==0) then  "NA"
					else  EnumString( DHWHeaterRef:ASHPType )
					endif endif 
			endif endif  }

   ; SAC 7/19/17 - switched return values of ' ' to 'NA' and 'outside' to 'Outside or Exterior closet' (tic #866)
   ; SAC 7/20/17 - switched to using UI's ShowTankLocation flag to determine when tank location should be reported (tic #858)
   ;                 note: 'unknown' can still be reported, but this should only happen in an error situation, where a zone should be assigned but isn't
	"Default ResDHWSysRpt:TankLocation"				ResDHWSysRpt:TankLocation			= {
	      if (IsCentralHPWH) then  "Unconditioned"
	      else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResHVACSys" ))
			then	"NA"
			else	if (IfValidAnd( DHWHeaterRef:ShowTankLocation > 0 )==0) then  "NA"
			      else if (IfValidAnd( DHWHeaterRef:TankOutside > 0.5 )) then  "Outside or Exterior closet"
					else if (LocalCompAssigned( DHWHeaterRef:TankZone ) < 1) then  "unknown"
					else	DHWHeaterRef:TankZone:Name
					endif endif endif
			endif endif  }

   ; SAC 7/20/17 - added for reporting of UEF-rated equipment (tic #858)
   "Set ResDHWSysRpt:RecovEffRpt"         ResDHWSysRpt:RecovEffRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResWtrHtr" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                              case 10 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 14 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                              case 10 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:RecovEff ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g %", DHWHeaterRef:RecovEff )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 15 :    ; "Residential-Duty Commercial Instantaneous (UEF)"
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  "NA"
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set ResDHWSysRpt:FirstHourRatingRpt"  ResDHWSysRpt:FirstHourRatingRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResWtrHtr" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                         ;     case 10 :    ; "Consumer Instantaneous (UEF)"
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 14 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                         ;     case 10 :    ; "Consumer Instantaneous (UEF)"
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                              case 12 :  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED  ; "Consumer Storage (UEF)"
                                          else	Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 15 :    ; "Residential-Duty Commercial Instantaneous (UEF)"
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  if (LocalStatus( DHWHeaterRef:FirstHourRating ) < 1) then  UNDEFINED
                                 else  Format( "%g gal", DHWHeaterRef:FirstHourRating )  endif
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set ResDHWSysRpt:RatedFlowRpt"        ResDHWSysRpt:RatedFlowRpt  = {
      if (IsCentralHPWH) then  "NA"
	   else if (LocalCompAssigned( DHWHeaterRef ) == ComponentType( "ResWtrHtr" ))
      then  switch ( DHWHeaterRef:HeaterElementType )
               case  1 :   switch ( DHWHeaterRef:TankType )    ; Gas
                              case 10 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                         ;     case 12 :    ; "Consumer Storage (UEF)"
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                         ;     case 14 :    ; "Residential-Duty Commercial Storage (UEF)"
                              default :  "NA"
                           endswitch
               case  0 :   switch ( DHWHeaterRef:TankType )    ; Electric Resistance
                              case 10 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Consumer Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                         ;     case 11 :    ; "Commercial Instantaneous (TE)"
                         ;     case 12 :    ; "Consumer Storage (UEF)"
                         ;     case 13 :    ; "Commercial Storage (TE & SBL)"
                              case 15 :  if (LocalStatus( DHWHeaterRef:RatedFlow ) < 1) then  UNDEFINED  ; "Residential-Duty Commercial Instantaneous (UEF)"
                                          else	Format( "%g GPM", DHWHeaterRef:RatedFlow )  endif
                              default :  "NA"
                           endswitch
               case  5 :   if (IfValidAnd( DHWHeaterRef:HPWH_NEEARated > 0 )==0 .AND.    ; Heat Pump
                               IfValidAnd( DHWHeaterRef:IsUEFHtPump > 0 ))
                           then  "NA"
                           else  "NA"  endif
               default :  "NA"
            endswitch
      else  "NA"  endif endif  }

   "Set ResDHWSysRpt:ShwrDrnWtrHtRecovRpt - Shower drain water heat recovery (for report)"   ; SAC 2/19/18 (tic #978)
      ResDHWSysRpt:ShwrDrnWtrHtRecovRpt  =
         {  if (LocalCompAssigned( DwellUnitTypeRef ))
            then  if ( IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[1] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[2] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[3] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[4] > 0 ) .OR.
                       IfValidAnd( DwellUnitTypeRef:DWHRSysDevicesSim[5] > 0 ) )
                  then  "Yes"  else  "NA"  endif
            else  DHWSysRef:ShwrDrnWtrHtRecovRpt  endif  }
      ;   "NA"  }
      ; SAC 4/29/19 - removed references to old ShwrDRAINHREFF input
      ;   if (IfValidAnd( ResProj:HaveShwrDrnHtRecov > 0 ) .AND. IfValidAnd( ResProj:ShwrDRAINHREFF > 0 ))
      ;   then  Format( "%g", ResProj:ShwrDRAINHREFF )
      ;   else  "NA"  endif  }


	"Assign HERSAllPipesIns"						ResDHWSysRpt:HERSAllPipesIns 		= {	DHWSysRef:HERSCheck:AllPipesIns	}
	"Assign HERSPipeInsRptMsg"						ResDHWSysRpt:HERSPipeInsRptMsg 	= {	if (IfValidAnd( HERSAllPipesIns > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:PipeInsRptMsg ) 
																											else "none" endif	}
	"Assign HERSParallelPipe"						ResDHWSysRpt:HERSParallelPipe		= {	DHWSysRef:HERSCheck:ParallelPipe	}
	"Assign HERSParaPipeRptMsg"					ResDHWSysRpt:HERSParaPipeRptMsg 	= {	if (IfValidAnd( HERSParallelPipe > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:ParaPipeRptMsg ) 
																											else "none" endif	}
;	"Assign HERSBelowGrade"							ResDHWSysRpt:HERSBelowGrade		= {	DHWSysRef:HERSCheck:BelowGrade	}
;	"Assign HERSBelowGradeRptMsg"					ResDHWSysRpt:HERSBelowGradeRptMsg 	= {	if (IfValidAnd( HERSBelowGrade > 0.5 )) then
;																													EnumString( DHWSysRef:HERSCheck:BelowGradeRptMsg ) 
;																												else "none" endif	}
	"Assign HERSPushBtnRecirc"						ResDHWSysRpt:HERSPushBtnRecirc	= {	DHWSysRef:HERSCheck:PushBtnRecirc	}
	"Assign HERSPushBtnRptMsg"						ResDHWSysRpt:HERSPushBtnRptMsg 	= {	if (IfValidAnd( HERSPushBtnRecirc > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:PushBtnRptMsg ) 
																											else "none" endif	}
	"Assign HERSOccRecirc"							ResDHWSysRpt:HERSOccRecirc			= {	DHWSysRef:HERSCheck:OccRecirc	}
	"Assign HERSOccRptMsg"							ResDHWSysRpt:HERSOccRptMsg 		= {	if (IfValidAnd( HERSOccRecirc > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:OccRptMsg ) 
																											else "none" endif	}
	"Assign HERSPointOfUse"							ResDHWSysRpt:HERSPointOfUse		= {	DHWSysRef:HERSCheck:PointOfUse	}
	"Assign HERSPOURptMsg"							ResDHWSysRpt:HERSPOURptMsg 		= {	if (IfValidAnd( HERSPointOfUse > 0.5 )) then
																												EnumString( DHWSysRef:HERSCheck:POURptMsg ) 
																											else "none" endif	}

;"dbg" ResDHWSysRpt:Action = {
;   if (ParentCompAssigned( DwellUnitTypeRef ) < 1 .OR. ResProj:EnergyCodeYearNum < 2019)
;   then  PostMessageToLog( "  DHWSysRpt '%s' DwellingUnit unattached or wrong code vintage", Name )
;   else if (IfValidAnd( DHWSysIdx > 0 )==0) then  PostMessageToLog( "  DHWSysRpt '%s' -error- DHWSysIdx invalid (%g)", Name, ValidOr( DHWSysIdx, -999 ) )
;   else  switch (DHWSysIdx)
;         case  1 :   PostMessageToLog( "  DHWSysRpt '%s' CD:  DHWSysIdx %g / CD %g / CFactor %g / CDCompatible[1] %g",
;                           Name, DHWSysIdx, ParentRef( DwellUnitTypeRef:CompactDistrib ), ParentRef( DwellUnitTypeRef:CompactFactor ), ParentRef( DwellUnitTypeRef:CDCompatible[1] ) )
;         case  2 :   PostMessageToLog( "  DHWSysRpt '%s' CD:  DHWSysIdx %g / CD %g / CFactor %g / CDCompatible[2] %g",
;                           Name, DHWSysIdx, ParentRef( DwellUnitTypeRef:CompactDistrib ), ParentRef( DwellUnitTypeRef:CompactFactor ), ParentRef( DwellUnitTypeRef:CDCompatible[2] ) )
;         default :   PostMessageToLog( "  DHWSysRpt '%s' DHWSysIdx (%g)", Name, DHWSysIdx )
;         endswitch
;   endif endif  }
   ; remove reference to SFamUserSpecCmpctDist - now valid for compliance analysis - SAC 09/29/21 (tic #1277)
   "Set ResDHWSysRpt:CompactDistribDescrip"     ResDHWSysRpt:CompactDistribDescrip  =     ; SAC 5/13/19 - to facilitate 2019 HERS reporting   
      {  if (ParentComponentType() == "ResDHWSys" .OR. ResProj:EnergyCodeYearNum < 2019)
         then  if (ResProj:EnergyCodeYearNum < 2019 .AND. IfValidAnd( DHWSysRef:HERSCheck:Compact > 0 ))
               then  "Basic"
               else if (ResProj:EnergyCodeYearNum >= 2019)
               then  if (IfValidAnd( ResProj:SFamCompactDistrib > 0 ) .AND.
                         IfValidAnd( ResProj:SFamCompactFactor > 0 ) .AND. IfValidAnd( ResProj:SFamCompactFactor < 1 ))
                     then  switch (ResProj:SFamCompactDistrib)
                              case  1 :  "Basic"
                              case  2 :  "Expanded"
                              default :  UNDEFINED
                           endswitch
                     else  UNDEFINED  endif
               else  UNDEFINED  endif endif
         else  if (ParentComponentType() != "DwellUnit" .OR. IfValidAnd( DHWSysIdx > 0 )==0) then  UNDEFINED
               else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) > 0 .AND.
                        ParentRef( DwellUnitTypeRef:CompactFactor ) > 0 .AND. ParentRef( DwellUnitTypeRef:CompactFactor ) < 1)
               then  switch (DHWSysIdx)
                        case  1 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[1] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  2 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[2] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  3 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[3] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  4 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[4] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        case  5 :   if (ParentRef( DwellUnitTypeRef:CDCompatible[5] ) < 1) then  UNDEFINED
                                    else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) = 2) then  "Expanded"  else  "Basic"  endif endif
                        default :   UNDEFINED
                     endswitch
               else  UNDEFINED  endif endif
         endif  }
	"Assign HERSCompact"								ResDHWSysRpt:HERSCompact			=        ; SAC 5/13/19 - revisions for MFam DwellUnit models (HERS reporting of Compact Distrib)
      {  if (ParentComponentType() == "ResDHWSys" .OR. ResProj:EnergyCodeYearNum < 2019)
         then  DHWSysRef:HERSCheck:Compact
         else  if (ParentComponentType() != "DwellUnit" .OR. IfValidAnd( DHWSysIdx > 0 )==0) then  0
               else if (ParentRef( DwellUnitTypeRef:CompactDistrib ) < 2 ) then  0
               else if (ParentRef( DwellUnitTypeRef:CompactFactor ) > 0 .AND. ParentRef( DwellUnitTypeRef:CompactFactor ) < 1)
               then  switch (DHWSysIdx)
                        case  1 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[1] ) > 0) then  1  else  0  endif
                        case  2 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[2] ) > 0) then  1  else  0  endif
                        case  3 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[3] ) > 0) then  1  else  0  endif
                        case  4 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[4] ) > 0) then  1  else  0  endif
                        case  5 :  if (ParentRef( DwellUnitTypeRef:CDCompatible[5] ) > 0) then  1  else  0  endif
                        default :  0
                     endswitch
               else  0  endif endif endif
         endif  }
	"Assign HERSCompactRptMsg"						ResDHWSysRpt:HERSCompactRptMsg 	=        ; SAC 5/13/19
      {  if (IfValidAnd( HERSCompact < 0.5 )) then  "none"
         else if (ParentComponentType() == "ResDHWSys" .OR. ResProj:EnergyCodeYearNum < 2019)
         then  EnumString( DHWSysRef:HERSCheck:CompactRptMsg ) 
         else  "Compact Distribution System"
         endif endif	}
;8/25/16 - CG added following DHW report properties
	"Assign HERSMFCtrlRecircDualLp"								
	 ResDHWSysRpt:HERSMFCtrlRecircDualLp			= {	
	  DHWSysRef:HERSCheck:MFCtrlRecircDualLp	}
	"Assign HERSMFCtrlRecircDualLpRptMsg"						
	 ResDHWSysRpt:HERSMFCtrlRecircDualLpRptMsg 	= {	
	  if (IfValidAnd( HERSMFCtrlRecircDualLp > 0.5 )) 
	  then EnumString( DHWSysRef:HERSCheck:MFCtrlRecircDualLpRptMsg ) 
		else "none" 
		endif	}
		
;	"Assign HERSMFNoControl"						ResDHWSysRpt:HERSMFNoControl		= {	DHWSysRef:HERSCheck:MFNoControl	}
;	"Assign HERSMFNoCtrlRptMsg"					ResDHWSysRpt:HERSMFNoCtrlRptMsg 	= {	if (IfValidAnd( HERSMFNoControl > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFNoCtrlRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFDemandControl"					ResDHWSysRpt:HERSMFDemandControl	= {	DHWSysRef:HERSCheck:MFDemandControl	}
;	"Assign HERSMFDCRptMsg"							ResDHWSysRpt:HERSMFDCRptMsg 		= {	if (IfValidAnd( HERSMFDemandControl > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFDCRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFTempMod"							ResDHWSysRpt:HERSMFTempMod			= {	DHWSysRef:HERSCheck:MFTempMod	}
;	"Assign HERSMFTmpModRptMsg"					ResDHWSysRpt:HERSMFTmpModRptMsg 	= {	if (IfValidAnd( HERSMFTempMod > 0.5 )) then
;																												EnumString( DHWSysRef:HERSCheck:MFTmpModRptMsg ) 
;																											else "none" endif	}
;	"Assign HERSMFTempModMon"						ResDHWSysRpt:HERSMFTempModMon		= {	DHWSysRef:HERSCheck:MFTempModMon	}
;	"Assign HERSMFTmpModMonRptMsg"				ResDHWSysRpt:HERSMFTmpModMonRptMsg 	= {	if (IfValidAnd( HERSMFTempModMon > 0.5 )) then
;																													EnumString( DHWSysRef:HERSCheck:MFTmpModMonRptMsg ) 
;																												else "none" endif	}
END

; SAC 3/26/14 - added rulelists designed to setup and default IAQVentRpt objects
;*************************************************************************
RULELIST "Setup_IAQVentReportingObjects" 1 0 1 0
;*************************************************************************
	"Delete all IAQVentRpt objects currently in building description"										ResProj:Action		= {	DeleteAllComps( IAQVentRpt )  }
	"Create new IAQVentRpt objects and populate w/ initial object references & indexes/counts"	ResProj:Action		= {	CreateIAQRptObjects()  }
	"Default IAQVentRpt properties - general"		ResIAQVentRpt:Action	= {	EvalRulelist( "Default_IAQVentReportObject", 1 )  }
END

;*************************************************************************
RULELIST "Default_IAQVentReportObject" 0 0 0 0
;*************************************************************************
   ; SAC 12/17/19 - revised ResIAQVentRpt:IAQVentName & :IAQFanType for new MFam default balanced & min exhaust IAQ options
	"Default ResIAQVentRpt:IAQVentName"				ResIAQVentRpt:IAQVentName		= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											Format( "%s - %g/%g", IAQFanRef:Name, IAQFanIdx, IAQFanCnt )
																										else if (LocalCompAssigned( DwellUnitRef )) then
																											if (IfValidAnd( DwellUnitTypeRef:IAQOption = 4 ))
																										   then  Format( "Default Balanced IAQ Fan - %s", DwellUnitRef:Name )
																											else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 5 ))
																										   then  Format( "Minimum Exhaust IAQ Fan - %s", DwellUnitRef:Name )
																										   else  Format( "Default IAQ Fan - %s", DwellUnitRef:Name )
																										   endif endif
																										else if (ValidOr( DwellingUnitIdx, -1 ) >= 0 .AND. ValidOr( DwellingUnitCnt, -1 ) >= 1) then
																											Format( "Default IAQ Fan - %g/%g", DwellingUnitIdx, DwellingUnitCnt )
																										else
																											Format( "Default IAQ Fan - %g", ComponentIndex() )
																										endif endif endif }
	"Default ResIAQVentRpt:DwellingUnit"			ResIAQVentRpt:DwellingUnit		= {	if (LocalCompAssigned( DwellUnitRef ))
																										then	DwellUnitRef:Name
																										else	Format( "Dwelling Unit %g/%g", DwellingUnitIdx, DwellingUnitCnt )  endif  }
	"Default ResIAQVentRpt:IAQFanType"				ResIAQVentRpt:IAQFanType		= {	if (IfValidAnd( IAQFanRef:IAQFanType > 0.5 )) then
																											EnumString( IAQFanRef:IAQFanType )
	                                                                           else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 4 ))
																										then  "Balanced"
																										else if (IfValidAnd( DwellUnitTypeRef:IAQOption = 5 ))
																										then  "Exhaust"
																										else  "Default"  endif endif endif }
   ; SAC 4/24/19 - renumbered switch to run 0-15, consistent w/ DwellingUnitIdx set in source code (tic #1010)
	"Default ResIAQVentRpt:IAQCFM"					ResIAQVentRpt:IAQCFM				= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											if ( LocalStatus(IAQFanRef:IAQCFM	) < 1 ) then UNDEFINED else IAQFanRef:IAQCFM	 endif
																										else if (LocalCompAssigned( DwellUnitRef ))
																										then	if (ValidOr( DwellUnitRef:Count, 0 ) < 0.5) then  0
																												else	DwellUnitRef:MinIAQCFM / DwellUnitRef:Count  endif
																										else 
																											switch (Local( DwellingUnitIdx ))
																												case  0 : ResProj:UnitMinIAQCFM[1]
																												case  1 : ResProj:UnitMinIAQCFM[2]
																												case  2 : ResProj:UnitMinIAQCFM[3]
																												case  3 : ResProj:UnitMinIAQCFM[4]
																												case  4 : ResProj:UnitMinIAQCFM[5]
																												case  5 : ResProj:UnitMinIAQCFM[6]
																												case  6 : ResProj:UnitMinIAQCFM[7]
																												case  7 : ResProj:UnitMinIAQCFM[8]
																												case  8 : ResProj:UnitMinIAQCFM[9]
																												case  9 : ResProj:UnitMinIAQCFM[10]
																												case 10 : ResProj:UnitMinIAQCFM[11]
																												case 11 : ResProj:UnitMinIAQCFM[12]
																												case 12 : ResProj:UnitMinIAQCFM[13]
																												case 13 : ResProj:UnitMinIAQCFM[14]
																												case 14 : ResProj:UnitMinIAQCFM[15]
																												case 15 : ResProj:UnitMinIAQCFM[16]
																												default : ResProj:UnitMinIAQCFM[1]
																											endswitch endif endif	}
   ; SAC 8/12/16 - added rule to round reported IAQCFM to nearest integer (tic #729)
   "Round ResIAQVentRpt:IAQCFM to nearest integer"    ResIAQVentRpt:IAQCFM    = {
      if (IfValidAnd( IAQCFM > 0 )) then  int( IAQCFM + 0.5 )  else  UNCHANGED  endif  }
   ; SAC 2/12/20 - added new std design ResIAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam (tic #1174)      ; SAC 7/20/20 (tic #1174)
   ; revised DefaultIAQFanPwr unbal 0.3->0.35 & bal 0.6->0.7 - SAC 01/19/21 (tic #1243) 
	"Default ResIAQVentRpt:WperCFMIAQ"				ResIAQVentRpt:WperCFMIAQ		=        ; updated w/ data from 2022.1.0 Multifamily IAQ Summary writeup from OB360/DR - SAC 06/07/22
      {  if (LocalCompAssigned( IAQFanRef ))
         then  if (LocalStatus(IAQFanRef:WperCFMIAQ) < 1) then  UNDEFINED
               else  IAQFanRef:WperCFMIAQ  endif
         else if (Proj:IsComRuleset .AND. IfValidAnd( Proj:AnalysisVersion >= 220100 ))
         then  if (IfValidAnd( ResProj:MostDUIAQ_Exhaust > 0 ) .OR. IfValidAnd( ResProj:MostDUIAQ_Supply > 0 ))
               then  0.35
               else if (IfValidAnd( Proj:CliZnNum <= 2 ) .OR. (IfValidAnd( Proj:CliZnNum >= 11 ) .AND. IfValidAnd( Proj:CliZnNum <= 16 )))
               then  0.6   ; bal w/ HtRecov
               else if (IfValidAnd( ResProj:NumStories < 4 ) .AND. (IfValidAnd( Proj:CliZnNum >= 4 ) .AND. IfValidAnd( Proj:CliZnNum <= 10 )))
               then  0.4
               else  0.7
               endif endif endif
         else if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  if (IAQFanType == "Balanced")
		         then  0.7  else  0.35  endif
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif endif endif  }
	"Default ResIAQVentRpt:IAQRecovEffect"			ResIAQVentRpt:IAQRecovEffect	= {	if ( LocalCompAssigned( IAQFanRef ) ) then
																											if ( LocalStatus(IAQFanRef:IAQRecovEffect) < 1 ) then UNDEFINED else IAQFanRef:IAQRecovEffect endif
																										else 0 endif }

   "Default ResIAQVentRpt:SensRecovEff"               ResIAQVentRpt:SensRecovEff            =            ; SAC 2/10/20 (tic #1174)
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SensRecovEff > 0 )==0) then  UNDEFINED
         else  IAQFanRef:SensRecovEff  endif  }
   "Default ResIAQVentRpt:AdjSensRecovEff"            ResIAQVentRpt:AdjSensRecovEff         = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:AdjSensRecovEff > 0 )==0) then  UNDEFINED
         else  IAQFanRef:AdjSensRecovEff  endif  }
   "Default ResIAQVentRpt:SetPerfByHVIInterp"         ResIAQVentRpt:SetPerfByHVIInterp      = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. LocalStatus( IAQFanRef:SetPerfByHVIInterp ) < 1) then  UNDEFINED
         else  IAQFanRef:SetPerfByHVIInterp  endif  }
   "Default ResIAQVentRpt:HVIListedInterpCFM[1]-lo"   ResIAQVentRpt:HVIListedInterpCFM[1]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpCFM[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpCFM[1]  endif  }
   "Default ResIAQVentRpt:HVIListedInterpCFM[2]-hi"   ResIAQVentRpt:HVIListedInterpCFM[2]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpCFM[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpCFM[2]  endif  }
   "Default ResIAQVentRpt:HVIListedInterpSRE[1]-lo"   ResIAQVentRpt:HVIListedInterpSRE[1]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpSRE[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpSRE[1]  endif  }
   "Default ResIAQVentRpt:HVIListedInterpSRE[2]-hi"   ResIAQVentRpt:HVIListedInterpSRE[2]   = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpSRE[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpSRE[2]  endif  }
   "Default ResIAQVentRpt:HVIListedInterpASRE[1]-lo"  ResIAQVentRpt:HVIListedInterpASRE[1]  = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpASRE[1] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpASRE[1]  endif  }
   "Default ResIAQVentRpt:HVIListedInterpASRE[2]-hi"  ResIAQVentRpt:HVIListedInterpASRE[2]  = 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( IAQFanRef:IAQFanType = 3 )==0 .OR.
             IfValidAnd( IAQFanRef:IncludesRecov > 0 )==0 .OR. IfValidAnd( IAQFanRef:SetPerfByHVIInterp > 0 )==0 .OR.
             IfValidAnd( IAQFanRef:HVIListedInterpASRE[2] > 0 )==0) then  UNDEFINED
         else  IAQFanRef:HVIListedInterpASRE[2]  endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Heat_CntrlFurnace" 0 0 0 1      ; defaulting for ResHtgSys:Type = "CntrlFurnace - Fuel-fired central furnace"
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_CF.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WallFurnaceFan"         0 0 0 1      ; defaulting for ResHtgSys:Type = "WallFurnaceFan - Ductless fan forced wall furnace"                      
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_WFF.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	ResHtgSys:DisplayTotalCapacity	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WallFurnaceGravity"         0 0 0 1      ; defaulting for ResHtgSys:Type = "WallFurnaceGravity - Ductless gravity flowed wall furnace"       
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_WFG.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	ResHtgSys:DisplayTotalCapacity	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_FloorFurnace"         0 0 0 1      ; defaulting for ResHtgSys:Type = "FloorFurnace - Ductless floor heating system"                 
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_FF.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	ResHtgSys:DisplayTotalCapacity	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_RoomHeater"         0 0 0 1      ; defaulting for ResHtgSys:Type = "RoomHeater - Ductless non-central space heater"                      
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_RH.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	ResHtgSys:DisplayTotalCapacity	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_Boiler"         0 0 0 1      ; defaulting for ResHtgSys:Type = "Boiler - Gas or oil boiler"                                         
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_B.rtf" }
	; SAC 4/15/15 - toggled ON AFUE default and DisplayAFUE for Boiler systems
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_WoodHeat"         0 0 0 1    ; defaulting for ResHtgSys:Type = "WoodHeat - Wood heat meeting exceptional method criteria"                                        
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_WoodHeat.rtf" }
  "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	 0 }
END

;*************************************************************************
RULELIST "Default_Heat_PkgGasFurnace"         0 0 0 1      ; defaulting for ResHtgSys:Type = "PkgGasFurnace - Packaged gas furnace"           ; SAC 6/22/20 (tic #1227)
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_PkgGasFurnace.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtgSys:AFUE (via ExEDR defaulting rules)"		ResHtgSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHeat_AFUE", 1 )  else  UNCHANGED  endif  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	1  }
;   "Set DisplayTotalCapacity flag"	ResHtgSys:DisplayTotalCapacity	= {	1  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE  =        ; SAC 08/24/20 (tic #1227)
      {  if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( AFUE ) < 6) then  UNCHANGED
         else  T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
END

;*************************************************************************
RULELIST "Default_Heat_Electric"       0 0 0 1     ; defaulting for ResHtgSys:Type = "Electric - All electric heating systems other than heat pump" 
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_E.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {  UNDEFINED  }
  "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	0  }
END

;*************************************************************************
RULELIST "Default_Heat_CombHydro"      0 0 0 1      ; defaulting for ResHtgSys:Type = "CombHydro - Water heating system can be storage gas/elec/ht pump"   
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"		ResHtgSys:TypeDescrip	= { "RTF\Ht_CH.rtf" }

;	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {  UNDEFINED  }
  "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	0  }

; SAC 5/13/13 - properties for combined hydronic
;	"Default ResHtgSys:HydronicWHType"	ResHtgSys:HydronicWHType		= {	1     }		; Natural Gas
;	"Default ResHtgSys:DisplayCHData"		ResHtgSys:DisplayCHData		= {	HydronicWHType  }
	"Default ResHtgSys:CHUCndPipeLength"	ResHtgSys:CHUCndPipeLength	= {	10    }
; SAC 1/6/14 moved rule logic up from PostProposedInput rules here to incorporate into normal system efficiency defaulting (and fix GC issue #254)
;	"Default ResHtgSys:CHRecoveryEff"		ResHtgSys:CHRecoveryEff		= {	76    }   ; SAC 7/8/13 - switched default from fraction to % (0.76 -> 76)
	"Default ResHtgSys:CHRecoveryEff"		ResHtgSys:CHRecoveryEff		= {	if (ResHtgSys:Type = 9 .AND. LocalCompAssigned( CHWHeater ))
																								then	if (LocalStatus( CHWHeater:RecovEff ) > 0) 
																										then  CHWHeater:RecovEff
																										else  70  endif
																								else  70  endif  }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {  CHRecoveryEff  }
	"Set ResHtgSys:CombHydronicMsg"		ResHtgSys:CombHydronicMsg	= {	if (CHUCndPipeLength > 10)
																								then  "Current pipe length limit is 10 ft."  else  " "  endif  }
END

; SAC 11/3/14 - added to ensure that AFUE left over from previous model edits don't impact future runs (GC issue 396)
RULELIST "ForceDefault_Heat_CombHydro_AFUE"  1 0 0 1      
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {  CHRecoveryEff  }
END   

; SAC 6/14/17 - toggled OFF Precooling access for 2019.0.4 release
RULELIST "ForceDefault_UsePreCooling"  1 0 0 1      
   "Blast ResProj:UsePreCooling"   ResProj:UsePreCooling  = {  UNDEFINED  }
END


;*************************************************************************
RULELIST "Default_Heat_unknown" 0 0 0 1
;*************************************************************************
	"Default ResHtgSys:TotalCapacity"   	ResHtgSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtgSys:TypeDescrip"				ResHtgSys:TypeDescrip		= { "RTF\blank.rtf" }
	"Default ResHtgSys:AFUE"		ResHtgSys:AFUE			= {  UNDEFINED  }
   "Set DisplayAFUE flag"		ResHtgSys:DisplayAFUE	= {	0  }
   "Set ResHtgSys:MinAFUE"     ResHtgSys:MinAFUE     = {  UNDEFINED  }          ; SAC 08/24/20 (tic #1227)
END


;*************************************************************************
RULELIST "Default_HtPump_SplitHeatPump"  0 0 0 1      ; defaulting for ResHtPumpSys:Type = "SplitHeatPump - Heating side of central split heat pump"            
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_SHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
  "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #3431)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
  "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
  "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
  "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_HtPump_* rulelist
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END

;*************************************************************************
RULELIST "Default_HtPump_PkgTermHeatPump"  0 0 0 1      ; defaulting for ResHtPumpSys:Type = "PkgTermHeatPump - Packaged terminal heat pump (PTHP)" -AND- "SglPkgVertHeatPump - Single package vertical heat pump"  ; SAC 6/22/20 (tic #1225 & #1226)
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= 
	   {  switch (Type)
	         case  26 :  "RTF\Ht_PTHP.rtf"             ; SAC 7/3/20 (tic #1225)
	         case  24 :  "RTF\Ht_SglPkgVertHP.rtf"     ; SAC 7/3/20 (tic #1226)
	         default  :  UNDEFINED  endswitch  }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
   "Default HSPF"				   ResHtPumpSys:HSPF				= {  UNDEFINED  }
   "Default HSPF2"				ResHtPumpSys:HSPF2			= {  UNDEFINED  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
  "Default COP47"			   ResHtPumpSys:COP47				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( COP47 ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:COP47( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
  "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"		ResHtPumpSys:AuxHtgCap			= {	UNDEFINED  }   ; if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   UNDEFINED  }   ; T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {   UNDEFINED  }
	"Default ResHtPumpSys:EER"            		ResHtPumpSys:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	1  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif } 
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {  0.96  }         ; was: switch (ACCharge) -> 0.96 or 0.9 - SAC 08/21/20 (tic #1003)
END

;*************************************************************************
RULELIST "Default_HtPump_SDHVSplitHeatPump"  0 0 0 1      ; defaulting for ResHtPumpSys:Type = "SDHVSplitHeatPump - Small duct, high velocity, central split heat pump"            
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"  ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"			ResHtPumpSys:TypeDescrip	= { "RTF\Ht_SDHVSHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
  "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #3431)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
  "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
  "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
  "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_HtPump_* rulelist
	; SAC 8/19/19 - added logic to set SDHV default CFMperTon to 250 for 2019+ models (tic #1041)   - SAC 10/27/19 - added logic to ensure results for 2019.1.1 consistent w/ 2019.1.0
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
	                                                                           else if (Proj:StdDesignBase >= 2019 .AND. IfValidAnd( Proj:AnalysisVersion > 190101 )) then  250
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END

; SAC 6/22/20 - revised rulelist to handle prior DuctlessMultiSplitHeatPump and new types DuctedMiniSplitHeatPump, DuctedMultiSplitHeatPump & Ducted+DuctlessMultiSplitHeatPump (tic #1229)
;*************************************************************************
RULELIST "Default_HtPump_DuctlessMiniSplitHeatPump"  0 0 0 1      ; defaulting for ResHtPumpSys:Type = "DuctlessHeatPump - Heating side of ductless mini-split heat pump"
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	=
	   {  switch (Type)
	         case  10 :  "RTF\Ht_DuctlessMiniSHP.rtf"
	         case  20 :  "RTF\Ht_DuctlessMultiSHP.rtf"
	         case  28 :  "RTF\Ht_DuctedMiniSHP.rtf"
	         case  30 :  "RTF\Ht_DuctedMultiSHP.rtf"
	         case  32 :  "RTF\Ht_DuctedDuctlessMultiSHP.rtf"
	         default  :  UNDEFINED  endswitch  }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
   "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #1331)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
  "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
  "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
  "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
  "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {  UNDEFINED  }	; mjb 8/26/14 - mini-splits don't include this in the user input spec
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  UNDEFINED  }   ; mjb 8/26/14 - mini-splits don't include this in the user input spec
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_HtPump_DuctlessVRFHeatPump"  0 0 0 1    ; defaulting for ResHtPumpSys:Type = "DuctlessVRFHeatPump"
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		      ResHtPumpSys:TypeDescrip	  = { "RTF\Ht_DuctlessVRFHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
  "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #1331)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
  "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
  "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
  "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
  "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
  "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
  "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
  "Default AuxHtgCap"		 ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {  UNDEFINED  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  UNDEFINED  }
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	UNDEFINED  }

END

;*************************************************************************
RULELIST "Default_HtPump_PkgHeatPump"    0 0 0 1    ; defaulting for ResHtPumpSys:Type = "PkgHeatPump - Heating side of central packaged heat pump"
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_PHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
  "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #1331)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {  if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_LrgPkgHeatPump" 0 0 0 1      ; defaulting for ResHtPumpSys:Type = "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit" 
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_LPHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }

; DR: This system is not available, so rules have been commented until the system is made available
;	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  };
;   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
;                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
;                                                                              else  UNDEFINED  endif  }
;	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {  if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
;																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
;																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
;	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
;	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
;	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_RoomHeatPump"   0 0 0 1      ; defaulting for ResHtPumpSys:Type = "RoomHeatPump - Heating side of non-central room A/C system"         
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_RHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }

;	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
;                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
;                                                                              else  UNDEFINED  endif  }
;	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {	EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }     ; SAC 08/19/20 (tic #1003)
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {  350  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  "Verified"  }   ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_HtPump_AirToWaterHeatPump"   0 0 0 1      ; defaulting for ResHtPumpSys:Type = "AirToWaterHeatPump - Air to water heat pump (able to heat DHW)"
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_AWHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }
;	"Default HSPF"				   ResHtPumpSys:HSPF				= {	T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {  UNDEFINED  }
	"Default ResHtPumpSys:EER"            		ResHtPumpSys:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
END

;*************************************************************************
RULELIST "Default_HtPump_GroundSourceHeatPump"  0 0 0 1
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"		ResHtPumpSys:TypeDescrip	= { "RTF\Ht_GSHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }

   "Default HSPF"				   ResHtPumpSys:HSPF				= {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
  "Default HSPF2"				   ResHtPumpSys:HSPF2				=                    ; SAC 10/09/22 (tic #1331)
	   {  if ( (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF2 ) < 6) .OR.
              T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1 ) then  UNCHANGED
	      else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif  }
	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
   "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
   "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
   "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
   "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                              else  UNDEFINED  endif  }
	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	0  }
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }
END
;*************************************************************************    ; SAC 11/2/18 - VCHP
RULELIST "Default_HtPump_VariableCapHeatPump" 0 0 0 1
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"			ResHtPumpSys:TypeDescrip	= { "RTF\Ht_VCHP.rtf" }
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  0  }

   "Default HSPF"				   ResHtPumpSys:HSPF				= {  8.2  }
;	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
;	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
;	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
   "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
   "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
   "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
   "Reset AuxHtgCap"			   ResHtPumpSys:AuxHtgCap			= {	UNDEFINED  }
;   "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {  14  }  ; SAC 11/4/18 - based on inputs specified in e-mail from CB 11/2/18
; ???
;   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
;                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
;                                                                              else  UNDEFINED  endif  }
;	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:EER"            		ResHtPumpSys:EER              = {  11.6  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	1  }     ; SAC 11/13/18 - toggled to 1 to allow edits in UI
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  "Verified"  }    ; SAC 11/13/18 - always verified for VCHP
;	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	0.96	}

; SAC 11/4/18 - added for VCHP
   ; defaulted via enums: ResHtPumpSys:VCHPDucts =  0: Unducted / 1: Ducted / 2: Partially Ducted
   "Default ResHtPumpSys:VCHPCertAutoFan"      ResHtPumpSys:VCHPCertAutoFan  = {  0  }
   "Set ResHtPumpSys:VCHPFanPower"    ResHtPumpSys:VCHPFanPower = {
         if (IfValidAnd( Cap47 > 0 )==0 .OR. VCHPCertAutoFan > 0) then  0
         else  switch (VCHPDucts)
                  case  1 :  50 * Cap47 / 12000  ; ducted
                  case  2 :  25 * Cap47 / 12000  ; partially ducted
                  default :  0
               endswitch endif  }
; RJH 2/13/20 tic #1176
   "Set ResHtPumpSys:SpeclFeatrs_ComplianceOptionVCHP"    ResHtPumpSys:SpeclFeatrs_ComplianceOptionVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then 1
           else UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace"    ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_DuctsInConditionedSpaceTested"    ResHtPumpSys:HERS_DuctsInConditionedSpaceTested = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowStaticVCHP"    ResHtPumpSys:HERS_LowStaticVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_AirToHabitableRoomsVCHP"    ResHtPumpSys:HERS_AirToHabitableRoomsVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_MinimumAirflowVCHP"    ResHtPumpSys:HERS_MinimumAirflowVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_WallThermostatVCHP"    ResHtPumpSys:HERS_WallThermostatVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP"    ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 0
                     case "Partially Ducted"  : 0
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_FilterSizeVCHP"    ResHtPumpSys:HERS_FilterSizeVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_FilterPressureDropVCHP"    ResHtPumpSys:HERS_FilterPressureDropVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace"    ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
END
;*************************************************************************    ; VCHP2 - SAC 11/01/20
RULELIST "Default_HtPump_VariableCapHeatPump2" 0 0 0 1
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"			ResHtPumpSys:TypeDescrip	= { "RTF\Ht_VCHPdetailed.rtf" }     ; SAC 09/22/21
   "Default AutoSize"         ResHtPumpSys:AutoSize        = {  if (IfValidAnd( ResProj:EnableHPAutosize > 0 )) then  1  else  0  endif  }     ; VCHP2 - SAC 11/10/20

   "Default HSPF"				   ResHtPumpSys:HSPF				= {  8.2  }
;	"Default ResHtPumpSys:HSPF (via ExEDR defaulting rules)"		ResHtPumpSys:Action  = {
;	      if (IfValidAnd( ResProj:ExEDR_Defaults > 0 ) .AND. LocalStatus( HSPF ) < 6)
;	      then  EvalRulelist( "ExEDRDefault_HVACHtPump_HSPF", 1 )  else  UNCHANGED  endif  }
;	"Default ConstHtgSetpt"		ResHtPumpSys:ConstHtgSetpt	= {	T24RHeatingEquipment:ConstHtgSetpt( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }   - already done above
   "Default Cap47"			   ResHtPumpSys:Cap47				= {	UNDEFINED  }
   "Default Cap35"			   ResHtPumpSys:Cap35				= {	UNDEFINED  }
   "Default Cap17"			   ResHtPumpSys:Cap17				= {	UNDEFINED  }
   "Default COP47"			   ResHtPumpSys:COP47				= {	UNDEFINED  }
   "Default COP35"			   ResHtPumpSys:COP35				= {	UNDEFINED  }
   "Default COP17"			   ResHtPumpSys:COP17				= {	UNDEFINED  }
   "Reset AuxHtgCap"			   ResHtPumpSys:AuxHtgCap			= {	UNDEFINED  }
;   "Default AuxHtgCap"			ResHtPumpSys:AuxHtgCap			= {	if (LocalStatus( Cap47 ) < 2) then  UNDEFINED  else  (Cap47 * 10)  endif  }   ; SAC 8/29/13 - per Bruce e-mail

	"Default ResHtPumpSys:SEER"            		ResHtPumpSys:SEER             = {  14  }  ; SAC 11/4/18 - based on inputs specified in e-mail from CB 11/2/18
; ???
;   "Default ResHtPumpSys:SEER2"                 ResHtPumpSys:SEER2            = {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
;                                                                              then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
;                                                                              else  UNDEFINED  endif  }
;	"Default ResHtPumpSys:EER (via rulelist)"	ResHtPumpSys:Action           = {		EvalRulelist( "Default_HtPump_CaliforniaSEERtoEERFormula", 1 )  }
	"Default ResHtPumpSys:EER"            		ResHtPumpSys:EER              = {  11.6  }
	"Default ResHtPumpSys:UseEERinAnalysis"		ResHtPumpSys:UseEERinAnalysis = {	1  }     ; SAC 11/13/18 - toggled to 1 to allow edits in UI
   "Default ResHtPumpSys:CEER"            	   ResHtPumpSys:CEER             = {  UNDEFINED  }      ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
	"Default ResHtPumpSys:CFMperTon"       		ResHtPumpSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																													IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																										else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  "Verified"  }    ; SAC 11/13/18 - always verified for VCHP
;	"Default ResHtPumpSys:ACCharge"        		ResHtPumpSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResHtPumpSys:RefrigerantType" 		ResHtPumpSys:RefrigerantType  = {  "R410A"         }
	"Default ResHtPumpSys:RefrigChgAdjFctr"		ResHtPumpSys:RefrigChgAdjFctr = {	switch (ACCharge)
																											case  2 :  0.96		; "Verified"
																											case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																											default :  0.90		; "Not Verified" (or any other setting)
																										endswitch    }

; removed for VCHP2 - SAC 08/02/21
;; SAC 11/4/18 - added for VCHP
;   ; defaulted via enums: ResHtPumpSys:VCHPDucts =  0: Unducted / 1: Ducted / 2: Partially Ducted
;   "Default ResHtPumpSys:VCHPCertAutoFan"      ResHtPumpSys:VCHPCertAutoFan  = {  0  }
;   "Set ResHtPumpSys:VCHPFanPower"    ResHtPumpSys:VCHPFanPower = {
;         if (IfValidAnd( Cap47 > 0 )==0 .OR. VCHPCertAutoFan > 0) then  0
;         else  switch (VCHPDucts)
;                  case  1 :  50 * Cap47 / 12000  ; ducted
;                  case  2 :  25 * Cap47 / 12000  ; partially ducted
;                  default :  0
;               endswitch endif }

         ; VCHP2 additions - SAC 11/10/20
;   "Default ResHtPumpSys:VCHPTurndnRat"        ResHtPumpSys:VCHPTurndnRat   = {   0.3  }
   "Default ResHtPumpSys:CapMin47"             ResHtPumpSys:CapMin47        = {   UNDEFINED  }   ; SAC 07/24/21
   "Default ResHtPumpSys:CapMin17"             ResHtPumpSys:CapMin17        = {   UNDEFINED  }
   "Default ResHtPumpSys:CapMin05"             ResHtPumpSys:CapMin05        = {   UNDEFINED  }

   "Default ResHtPumpSys:COPMin47"             ResHtPumpSys:COPMin47        = {   UNDEFINED  }
   "Default ResHtPumpSys:COPMin17"             ResHtPumpSys:COPMin17        = {   UNDEFINED  }
   "Default ResHtPumpSys:COPMin05"             ResHtPumpSys:COPMin05        = {   UNDEFINED  }   ; SAC 07/24/21
   "Default ResHtPumpSys:Cap1747Ratio"         ResHtPumpSys:Cap1747Ratio    =
      {  if (IfValidAnd( Cap47 > 0 ) .AND. IfValidAnd( Cap17 > 0 ))
         then  Cap17 / Cap47
         else  UNDEFINED  endif  }
   "Default ResHtPumpSys:Cap0547Ratio"         ResHtPumpSys:Cap0547Ratio    =     ; SAC 07/24/21
      {  if (IfValidAnd( Cap47 > 0 ) .AND. IfValidAnd( Cap05 > 0 ))
         then  Cap05 / Cap47
         else  UNDEFINED  endif  }

   "FORCE all 115deg VCHP2 inputs to be defaulted by rules"    ResHtPumpSys:Action =     ; SAC 03/22/22
      {  if (LocalStatus( CapMin115 ) > 5 .OR. LocalStatus( Cap115 ) > 5 .OR.
             LocalStatus( COPMin115 ) > 5 .OR. LocalStatus( COP115 ) > 5)
         then  EvalRulelist( "ForceDefaults_HVACHtPump_VCHP2_115DegreeInputs", 1 )
         else  UNCHANGED  endif  }

   "Default ResHtPumpSys:Cap82"           ResHtPumpSys:Cap82          = {  UNDEFINED  }    ; SAC 09/22/21
   "Default ResHtPumpSys:Cap95"           ResHtPumpSys:Cap95          = {  UNDEFINED  }
   ; 115 deg defaults from CB, noting 33 = (115 - 82), 13 = (95 - 82) - SAC 09/22/21
   "Default ResHtPumpSys:Cap115"          ResHtPumpSys:Cap115         =     ; modified Cap115 to never exceed Cap95 (fix from CB) - SAC 03/22/22
      {  if (IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( Cap95 > 0 )==0) then  UNDEFINED
         else  min( (Cap82 + ((33/13) * (Cap95 - Cap82))), Cap95 )
         endif  }
   "Default ResHtPumpSys:COP82"           ResHtPumpSys:COP82          = {  UNDEFINED  }
   "Default ResHtPumpSys:COP95"           ResHtPumpSys:COP95          = {  UNDEFINED  }
   "Default ResHtPumpSys:COP115"          ResHtPumpSys:COP115         =     ; modified COP115 to never exceed COP95 (fix from CB) - SAC 03/22/22
      {  if (IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( Cap95 > 0 )==0 .OR.
             IfValidAnd( COP82 > 0 )==0 .OR. IfValidAnd( COP95 > 0 )==0) then  UNDEFINED
         else  min( (Cap115 /
                     ((Cap82 / COP82) + ((33/13) * ((Cap95 / COP95) -
                                                    (Cap82 / COP82))))), COP95 )
         endif  }

   "Default ResHtPumpSys:CapMin82"        ResHtPumpSys:CapMin82       = {  UNDEFINED  }
   "Default ResHtPumpSys:CapMin95"        ResHtPumpSys:CapMin95       = {  UNDEFINED  }
   "Default ResHtPumpSys:CapMin115"       ResHtPumpSys:CapMin115      =                    ; SAC 09/23/21
      {  if (IfValidAnd( CapMin95 < Cap95 ) .AND. IfValidAnd( Cap115 > 0 ))
         then  Cap115 * CapMin95 / Cap95
         else if (IfValidAnd( CapMin82 > 0 ) .AND. IfValidAnd( CapMin95 > 0 ))
         then  CapMin82 + ((33/13) * (CapMin95 - CapMin82))
         else  UNDEFINED  endif endif  }
   "Default ResHtPumpSys:COPMin82"        ResHtPumpSys:COPMin82       = {  UNDEFINED  }
   "Default ResHtPumpSys:COPMin95"        ResHtPumpSys:COPMin95       = {  UNDEFINED  }
   "Default ResHtPumpSys:COPMin115"       ResHtPumpSys:COPMin115      =
      {  if (IfValidAnd( CapMin82 > 0 )==0 .OR. IfValidAnd( CapMin95 > 0 )==0 .OR.
             IfValidAnd( COPMin82 > 0 )==0 .OR. IfValidAnd( COPMin95 > 0 )==0) then  UNDEFINED
         else  CapMin115 /
               ((CapMin82 / COPMin82) + ((33/13) * ((CapMin95 / COPMin95) -
                                                    (CapMin82 / COPMin82))))
         endif  }

   "Default ResHtPumpSys:Cap8295Ratio"    ResHtPumpSys:Cap8295Ratio   = 
      {  if (IfValidAnd( Cap95 > 0 ) .AND. IfValidAnd( Cap82  > 0 ))
         then  Cap82  / Cap95
         else  UNDEFINED  endif  }
   "Default ResHtPumpSys:Cap11595Ratio"   ResHtPumpSys:Cap11595Ratio  = 
      {  if (IfValidAnd( Cap95 > 0 ) .AND. IfValidAnd( Cap115 > 0 ))
         then  Cap115 / Cap95
         else  UNDEFINED  endif  }

   "Default ResHtPumpSys:VCHPFanPwrHC[1]-h"    ResHtPumpSys:VCHPFanPwrHC[1] = {   0.1  }
   "Default ResHtPumpSys:VCHPFanPwrHC[2]-c"    ResHtPumpSys:VCHPFanPwrHC[2] = {   0.1  }
   "Default ResHtPumpSys:HtgSizingFactor"      ResHtPumpSys:HtgSizingFactor = {   1.2  }      ; updated from 1.2 to 1.1 - SAC 02/11/22 (VCHP2)  ; roll BACK to 1.2 - SAC 02/25/22 (VCHP2)
   "Default ResHtPumpSys:HtgAuxSizingFactor"   ResHtPumpSys:HtgAuxSizingFactor = {   1.2  }      ; SAC 03/03/22 (VCHP2)
   ; set to undef for 2022+ analysis crankcase htrs (rsParElec) (to force use of new default) - SAC 03/06/23
   "Default ResHtPumpSys:ParElecExprs"         ResHtPumpSys:ParElecExprs    =     ; added AnalysisVersion dependence to rollback for 22.2.1 SP1 release - SAC 05/08/23
      {  if (IfValidAnd( ResProj:StdsVersionYr >= 2022 ) .AND. IfValidAnd( Proj:AnalysisVersion >= 220202 ))
         then  UNDEFINED
         else  "($tdboHrAv < 50) * 40"
         endif  }

   "Override ResHtPumpSys:TempLabels[1]"     ResHtPumpSys:TempLabels[1] = {  "@   47F:"  }    ; SAC 07/24/21
   "Override ResHtPumpSys:TempLabels[2]"     ResHtPumpSys:TempLabels[2] = {  "@   17F:"  }
   "Override ResHtPumpSys:TempLabels[3]"     ResHtPumpSys:TempLabels[3] = {  "@     5F:"  }
   "Set ResHtPumpSys:TempLabels[4]"          ResHtPumpSys:TempLabels[4] = {  "@   82F:"  }    ; SAC 09/22/21
   "Set ResHtPumpSys:TempLabels[5]"          ResHtPumpSys:TempLabels[5] = {  "@   95F:"  }
   "Set ResHtPumpSys:TempLabels[6]"          ResHtPumpSys:TempLabels[6] = {  "@ 115F:"  }

   "Set ResHtPumpSys:PerfDetailsErrMsg"     ResHtPumpSys:PerfDetailsErrMsg =         ; catch errors for display on screen - SAC 09/23/21
      {  if (IfValidAnd( Cap47 > 0 )==0 .OR. IfValidAnd( CapMin47 > 0 )==0 .OR.
             IfValidAnd( Cap17 > 0 )==0 .OR. IfValidAnd( CapMin17 > 0 )==0 .OR.
             IfValidAnd( Cap05 > 0 )==0 .OR. IfValidAnd( CapMin05 > 0 )==0 .OR.
             IfValidAnd( Cap82 > 0 )==0 .OR. IfValidAnd( CapMin82 > 0 )==0 .OR.
             IfValidAnd( Cap95 > 0 )==0 .OR. IfValidAnd( CapMin95 > 0 )==0 .OR.
             IfValidAnd( Cap115> 0 )==0 .OR. IfValidAnd( CapMin115> 0 )==0)
         then  if (IfValidAnd( AutoSize > 0 ))
               then  "Valid capacities must be entered for each combination of outdoor dry bulb and Min/Max speed (even w/ autosizing activated)"
               else  "Valid capacities must be entered for each combination of outdoor dry bulb and Min/Max speed"
               endif
         else if (IfValidAnd( COP47 > 0 )==0 .OR. IfValidAnd( COPMin47 > 0 )==0 .OR.
                  IfValidAnd( COP17 > 0 )==0 .OR. IfValidAnd( COPMin17 > 0 )==0 .OR.
                  IfValidAnd( COP05 > 0 )==0 .OR. IfValidAnd( COPMin05 > 0 )==0 .OR.
                  IfValidAnd( COP82 > 0 )==0 .OR. IfValidAnd( COPMin82 > 0 )==0 .OR.
                  IfValidAnd( COP95 > 0 )==0 .OR. IfValidAnd( COPMin95 > 0 )==0 .OR.
                  IfValidAnd( COP115> 0 )==0 .OR. IfValidAnd( COPMin115> 0 )==0)
         then  "Valid COPs must be entered for each combination of outdoor dry bulb and Min/Max speed"
         else if (IfValidAnd( CapMin05  > Cap05  )) then  "Capacity at 5F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin17  > Cap17  )) then  "Capacity at 17F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin47  > Cap47  )) then  "Capacity at 47F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin82  > Cap82  )) then  "Capacity at 82F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin95  > Cap95  )) then  "Capacity at 95F and Min speed must be less than capacity @ Max speed"
         else if (IfValidAnd( CapMin115 > Cap115 )) then  "Capacity at 115F and Min speed must be less than capacity @ Max speed"
         else  UNDEFINED  endif endif endif endif endif endif endif endif  }
   "Set ResHtPumpSys:PerfDetailsError - flag indicating 'Performance Details' error"     ResHtPumpSys:PerfDetailsError =    ; SAC 09/23/21
      {  if (LocalStatus( PerfDetailsErrMsg ) < 1) then  UNDEFINED
         else if (strlen( PerfDetailsErrMsg ) < 1) then  UNDEFINED
         else  1  endif endif  }

; RJH 2/13/20 tic #1176
   "Set ResHtPumpSys:SpeclFeatrs_ComplianceOptionVCHP"    ResHtPumpSys:SpeclFeatrs_ComplianceOptionVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then 1
           else UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace"    ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_DuctsInConditionedSpaceTested"    ResHtPumpSys:HERS_DuctsInConditionedSpaceTested = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowStaticVCHP"    ResHtPumpSys:HERS_LowStaticVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_AirToHabitableRoomsVCHP"    ResHtPumpSys:HERS_AirToHabitableRoomsVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_MinimumAirflowVCHP"    ResHtPumpSys:HERS_MinimumAirflowVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_WallThermostatVCHP"    ResHtPumpSys:HERS_WallThermostatVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP"    ResHtPumpSys:HERS_DuctlessInConditionedSpaceVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 1
                     case "Ducted"            : 0
                     case "Partially Ducted"  : 0
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_FilterSizeVCHP"    ResHtPumpSys:HERS_FilterSizeVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_FilterPressureDropVCHP"    ResHtPumpSys:HERS_FilterPressureDropVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace"    ResHtPumpSys:HERS_LowLeakageDuctsInConditionedSpace = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : 1
                     case "Partially Ducted"  : 1
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
   "Set ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP"    ResHtPumpSys:HERS_CertifiedNonContinuousFanVCHP = {
           if ( FloorAreaServed > 0 .AND. TypeAbbrevStr == "VCHP" )
           then ( switch( EnumString( VCHPDucts ) )
                     case "Unducted"          : 0
                     case "Ducted"            : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     case "Partially Ducted"  : if ( VCHPCertAutoFan > 0 )
					                            then 1
												else 0 endif
                     default  :  UNDEFINED
                  endswitch  )
           else  UNCHANGED
           endif  }
END
;*************************************************************************
RULELIST "Default_HtPump_unknown" 0 0 0 1
;*************************************************************************
	"Default ResHtPumpSys:TotalCapacity"   	ResHtPumpSys:TotalCapacity  = {  UNDEFINED  }
	"Set ResHtPumpSys:TypeDescrip"				ResHtPumpSys:TypeDescrip		= { "RTF\blank.rtf" }
   "Default ResHtPumpSys:AutoSize"          ResHtPumpSys:AutoSize        = {  0  }
	"Default ResHtPumpSys:SEER"            	ResHtPumpSys:SEER             = {  UNDEFINED  }
	"Default ResHtPumpSys:SEER2"            	ResHtPumpSys:SEER2            = {  UNDEFINED  }
	"Default ResHtPumpSys:EER"             	ResHtPumpSys:EER              = {  UNDEFINED  }
	"Default ResHtPumpSys:CEER"             	ResHtPumpSys:CEER             = {  UNDEFINED  }
	"Default ResHtPumpSys:CFMperTon"       	ResHtPumpSys:CFMperTon        = {  UNDEFINED  }
	"Default ResHtPumpSys:ACCharge"        	ResHtPumpSys:ACCharge         = {  UNDEFINED  }
	"Default ResHtPumpSys:RefrigerantType" 	ResHtPumpSys:RefrigerantType  = {  UNDEFINED  }
	"Default ResHtPumpSys:RefrigChgAdjFctr"	ResHtPumpSys:RefrigChgAdjFctr = {  UNDEFINED  }
	"Default ResHtPumpSys:UseEERinAnalysis"	ResHtPumpSys:UseEERinAnalysis = {	0  }
END

;*************************************************************************
RULELIST "Default_HtPump_CaliforniaSEERtoEERFormula" 0 0 0 1      ; defaulting for ResHtPumpSys:EER
;*************************************************************************
	"Default ResHtPumpSys:EER"		ResHtPumpSys:EER	= {
			if (LocalStatus( SEER ) < 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
			then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER >= 16) then  13
			else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
			else								10   + (0.84 * (SEER - 11.5))
			endif endif endif endif  }

	"Default ResHtPumpSys:EER2"		ResHtPumpSys:EER2	=           ; SAC 10/09/22 (tic #3431)
		{	if (LocalStatus( SEER2 ) < 1 .OR. EffMetric != 2 .OR. ResProj:StdsVersionYr < 2019) then  UNCHANGED
			else if (	 T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER2 == T24RCoolingEquipment:SEER2(     "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
			then		    T24RCoolingEquipment:EER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
         then   13                         * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
         then  (11.3 + (0.57 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                                 - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else	(10   + (0.84 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )) 
                                 - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			endif endif endif endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Default_Cool_CaliforniaSEERtoEERFormula" 0 0 0 1      ; defaulting for ResClgSys:EER
;*************************************************************************
	"Default ResClgSys:EER"		ResClgSys:EER	= {
			if (LocalStatus( SEER ) < 1 .OR. EffMetric != 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
			then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER >= 16) then  13
			else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
			else								10   + (0.84 * (SEER - 11.5))
			endif endif endif endif  }

	"Default ResClgSys:EER2"		ResClgSys:EER2	=           ; SAC 10/09/22 (tic #3431)
		{	if (LocalStatus( SEER2 ) < 1 .OR. EffMetric != 2 .OR. ResProj:StdsVersionYr < 2019) then  UNCHANGED
			else if (	 T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
				 SEER2 == T24RCoolingEquipment:SEER2(     "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
			then		    T24RCoolingEquipment:EER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
         then   13                         * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else if (SEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
         then  (11.3 + (0.57 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                                 - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			else	(10   + (0.84 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )) 
                                 - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_Cool_CaliforniaEERtoSEERFormula" 0 0 0 1      ; defaulting for ResClgSys:SEER
;*************************************************************************
	"Default ResClgSys:SEER"		ResClgSys:SEER	= {
			if (LocalStatus( EER ) < 1) then  UNCHANGED
			else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
				 EER == T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
			then	1.07 * EER 
			else UNCHANGED
			endif  endif  }
END

; SAC 12/26/14 -  lists similar to above but designed to set new ResHVACSys:StdSysSEER & EER
;*************************************************************************
RULELIST "Default_HVACSys_StdCoolViaCaliforniaSEERtoEERFormula" 1 0 0 1
	"Default ResHVACSys:StdSysSEER"		ResHVACSys:StdSysSEER	= {	T24RCoolingEquipment:SEER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )  }
	"Default ResHVACSys:StdSysEER"		ResHVACSys:StdSysEER	= {
			if (LocalStatus( StdSysSEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0 .AND.
				 StdSysSEER == T24RCoolingEquipment:SEER(     "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ))
			then					T24RCoolingEquipment:EER(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )
			else if (StdSysSEER >= 16) then  13
			else if (StdSysSEER >= 13)	then  11.3 + (0.57 * (StdSysSEER - 13  ))
			else										10   + (0.84 * (StdSysSEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_HVACSys_StdCoolViaCaliforniaEERtoSEERFormula" 1 0 0 1
	"Default ResHVACSys:StdSysEER"		ResHVACSys:StdSysEER		= {	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )  }
	"Default ResHVACSys:StdSysSEER"		ResHVACSys:StdSysSEER	= {
			if (LocalStatus( StdSysEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0 .AND.
				  StdSysEER == T24RCoolingEquipment:EER(       "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ))
			then  				T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )
			else	1.07 * StdSysEER 
			endif  endif}
END
;*************************************************************************
RULELIST "Default_HVACSys_StdHtPumpCoolViaCaliforniaSEERtoEERFormula" 1 0 0 1
	"Default ResHVACSys:StdSysSEER"		ResHVACSys:StdSysSEER	= {	T24RCoolingEquipment:SEER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  }
	"Default ResHVACSys:StdSysEER"		ResHVACSys:StdSysEER	= {
			if (LocalStatus( StdSysSEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0 .AND.
				 StdSysSEER == T24RCoolingEquipment:SEER(     "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
			then					T24RCoolingEquipment:EER(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
			else if (StdSysSEER >= 16) then  13
			else if (StdSysSEER >= 13)	then  11.3 + (0.57 * (StdSysSEER - 13  ))
			else										10   + (0.84 * (StdSysSEER - 11.5))
			endif endif endif endif  }
END
;*************************************************************************
RULELIST "Default_HVACSys_StdHtPumpCoolViaCaliforniaEERtoSEERFormula" 1 0 0 1
	"Default ResHVACSys:StdSysEER"		ResHVACSys:StdSysEER		= {	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  }
	"Default ResHVACSys:StdSysSEER"		ResHVACSys:StdSysSEER	= {
			if (LocalStatus( StdSysEER ) < 1) then  UNDEFINED
			else if (			T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0 .AND.
				  StdSysEER == T24RCoolingEquipment:EER(       "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ))
			then  				T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
			else	1.07 * StdSysEER 
			endif  endif}
END
;*************************************************************************
RULELIST "Default_HVACSys_StdCool_Undefined" 1 0 0 1
	"Default ResHVACSys:StdSysEER"		ResHVACSys:StdSysEER		= {	UNDEFINED  }
	"Default ResHVACSys:StdSysSEER"		ResHVACSys:StdSysSEER	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_Cool_None" 0 0 0 1    
;*************************************************************************
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Not Verified"  }		; mjb 10/30/14 - switched default enum to 'Not Verified' (issue #403)
END
;*************************************************************************
RULELIST "Default_Cool_SplitAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "SplitAirCond - Split air conditioning system"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:SEER2"                 ResClgSys:SEER2            = {   if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                          then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                          else  UNDEFINED  endif  }
	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_Cool_* rulelist
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  UNDEFINED   }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_PkgTermAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "PkgTermAirCond - Packaged terminal air conditioner (PTAC)" & "SglPkgVertAirCond - Single package vertical A/C system"      ; SAC 6/20/20 (tic #1225)
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   UNDEFINED  }
	"Default ResClgSys:SEER2"            		ResClgSys:SEER2            = {   UNDEFINED  }
	"Default ResClgSys:EER"            		ResClgSys:EER              = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if (IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND. IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"     }
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {  0.96  }         ; was: switch (ACCharge) -> 0.96 or 0.9 - SAC 08/21/20 (tic #1003)
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	1  }
END

;*************************************************************************
RULELIST "Default_Cool_SDHVSplitAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "SDHVSplitAirCond - Small duct, high velocity, split A/C system"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:SEER2"                 ResClgSys:SEER2            = {   if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                          then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                          else  UNDEFINED  endif  }
	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	; SAC 1/5/16 - added logic to set default CFMperTon to 150 for CEC 2013/16 & IsZonal & NOT IsMultiSpeed (tic 140, comment 6/22/15) - same change to each Default_Cool_* rulelist
	; SAC 8/18/19 - added logic to set SDHV default CFMperTon to 250 for 2019+ models (tic #1041)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
	                                                                     else if (Proj:StdDesignBase >= 2019) then  250
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif endif  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  UNDEFINED   }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_PkgAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type "PkgAirCond - Central packaged A/C system (< 65 kBtuh)"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:SEER2"                 ResClgSys:SEER2            = {   if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                          then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                          else  UNDEFINED  endif  }
	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  UNDEFINED   }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_LrgPkgAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "LrgPkgAirCond - Large packaged A/C system (>= 65 kBtuh)"
;*************************************************************************
; DR: This system is not available, so commenting out rules
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
;	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
;																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
;																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
;	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
;	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  UNDEFINED   }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

; SAC 6/22/20 - revised to ALSO handle DuctlessMultiSplitAirCond as well as DuctedMiniSplitAirCond, DuctedMultiSplitAirCond and Ducted+DuctlessMultiSplitAirCond (tic #1229)
;*************************************************************************
RULELIST "Default_Cool_DuctlessMiniSplitAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "DuctlessSplitAirCond - Ductless mini-split and multi-split heat A/C"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:SEER2"                 ResClgSys:SEER2            = {   if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                          then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                          else  UNDEFINED  endif  }
	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {		EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  UNDEFINED  }		
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  UNDEFINED  }   
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_DuctlessVRFAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "DuctlessVRFAirCond - variable refrigerant flow A/C, ductless"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {  UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
   "Default ResClgSys:SEER2"                 ResClgSys:SEER2            = {   if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
                                                                          then  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
                                                                          else  UNDEFINED  endif  }
	"Default ResClgSys:EER (via rulelist)"	ResClgSys:Action           = {	EvalRulelist( "Default_Cool_CaliforniaSEERtoEERFormula", 1 )  }
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  UNDEFINED  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  UNDEFINED  }
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"    }
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	 UNDEFINED  }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	 0  }
END

;*************************************************************************
RULELIST "Default_Cool_RoomAirCond" 0 0 0 1      ; defaulting for ResClgSys:Type = "RoomAirCond - Non-central room A/C system"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {   UNDEFINED  }
;	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;	"Default ResClgSys:EER"					ResClgSys:Action           = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;	"Default ResClgSys:EER"					ResClgSys:EER           = {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }
;	"Default ResClgSys:SEER (via rulelist)"  ResClgSys:Action             = {		EvalRulelist( "Default_Cool_CaliforniaEERtoSEERFormula", 1 )  } ;SEER is not available for Room A/C 11/2/14 TC
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:SEER2"            		ResClgSys:SEER2             = {  UNDEFINED  } 
	"Default ResClgSys:EER"            		ResClgSys:EER              = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:EER2"            		ResClgSys:EER2              = {  UNDEFINED  }   
   "Default ResClgSys:CEER"                ResClgSys:CEER             = {  T24RCoolingEquipment:CEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  }     ; SAC 08/19/20 (tic #1003)
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  UNDEFINED  }		; mjb	8/26/14 - shouldn't be a default for the user model
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  UNDEFINED  }     ; mjb	8/26/14 - shouldn't be a default for the user model
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  "R410A"         }
  ; SAC 3/4/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  UNDEFINED   }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END

;*************************************************************************
RULELIST "Default_Cool_EvapCondenser" 0 0 0 1      ; defaulting for ResClgSys:Type = "EvapCondenser - Evaporatively-cooled condenser for split AC systems"
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity		= {   UNDEFINED  }
	"Default ResClgSys:EERb"            		ResClgSys:EERb					= {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) 	}
	"Default ResClgSys:EERa"            		ResClgSys:EERa					= {   T24RCoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) 	}
	"Default ResClgSys:EER2b"            		ResClgSys:EER2b				=                 ; SAC 10/09/22 (tic #3431)
      {  if (T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1) then  UNCHANGED
         else  T24RCoolingEquipment:SEER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )  endif	}
	"Default ResClgSys:EER2a"            		ResClgSys:EER2a				=
      {  if (T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) < 1) then  UNCHANGED
         else  T24RCoolingEquipment:EER2(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) 	endif  }

; mjb 1/30/15 - mods to lookup CFMperTon and ACCharge from T24RClimateZoneCodeBase
;	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  350  }
;	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  "Verified"  }		; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	; SAC 2/21/15 - fixed bug in following rules where obejct being set were HVACHtPump but should have been HVACCool ! (during debugging of GC issue 473)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {	if ((Proj:StdDesignBase == 2013 .OR. Proj:StdDesignBase >= 2016) .AND. IfValidAnd( ShowMultiSpeed > 0 ) .AND. IsMultiSpeed < 0.5 .AND.
																											IfValidAnd( ShowIsZonal > 0 ) .AND. IsZonal > 0.5 ) then  150
																								else	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  endif  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  if ( T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 ) then "Verified" else "Not Verified" endif }    ; SAC 4/1/13 - switched default enum to 'Verified' (issue #59)
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType	= {  "R410A"     }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	switch (ACCharge)
																										case  2 :  0.96		; "Verified"
																										case  3 :  0.96		; 2013: "CID (charge indicator)"  2016: "FID (fault indicator)"
																										default :  0.90		; "Not Verified" (or any other setting)
																									endswitch    }
;	"Default ResClgSys:EvapCondEff" 			ResClgSys:EvapCondEff  		= {  0.60     }
	"Default ResClgSys:EvapCondEff"			ResClgSys:Action	= {	if (EffMetric < 2)
                                                                  then  EvalRulelist( "ForceDefaults_HVACCool_EvapCondenser", 1 )
                                                                  else  EvalRulelist( "ForceDefaults_HVACCool_EvapCondenser2", 1 )  endif	}
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	1  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACCool_EvapCondenser" 1 0 0 0    
;*************************************************************************
	"Force Default of EERaAdjust"							ResClgSys:EERaAdjust		=	{ 1 }
	"Force Default of EERbAdjust"							ResClgSys:EERbAdjust		=	{ 1 }
	"Force Default of ResClgSys:SEER"            	ResClgSys:SEER             = {   if ( IfValidAnd(EERaAdjust > 0) ) then EERb * EERbAdjust else EERb endif }
	"Force Default of ResClgSys:EER"            		ResClgSys:EER              = {   if ( IfValidAnd(EERbAdjust > 0) ) then EERa * EERaAdjust else EERa endif }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACCool_EvapCondenser2" 1 0 0 0    
;*************************************************************************
	"Force Default of EERaAdjust"							ResClgSys:EERaAdjust		=	{ 1 }
	"Force Default of EERbAdjust"							ResClgSys:EERbAdjust		=	{ 1 }
	"Force Default of ResClgSys:SEER2"            	ResClgSys:SEER2             = {   if ( IfValidAnd(EERaAdjust > 0) ) then EER2b * EERbAdjust else EER2b endif }
	"Force Default of ResClgSys:EER2"            	ResClgSys:EER2              = {   if ( IfValidAnd(EERbAdjust > 0) ) then EER2a * EERaAdjust else EER2a endif }
END

;************************************************************************* SAC 03/22/22
RULELIST "ForceDefaults_HVACHtPump_VCHP2_115DegreeInputs" 1 0 0 0    
;*************************************************************************
   "Blast ResHtPumpSys:CapMin115"     ResHtPumpSys:CapMin115  = {  UNDEFINED  }
   "Blast ResHtPumpSys:COPMin115"     ResHtPumpSys:COPMin115  = {  UNDEFINED  }
   "Blast ResHtPumpSys:Cap115"        ResHtPumpSys:Cap115     = {  UNDEFINED  }
   "Blast ResHtPumpSys:COP115"        ResHtPumpSys:COP115     = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "Default_Cool_unknown" 0 0 0 1
;*************************************************************************
	"Default ResClgSys:TotalCapacity"   		ResClgSys:TotalCapacity    = {  UNDEFINED  }
	"Default ResClgSys:SEER"            		ResClgSys:SEER             = {  UNDEFINED  }
	"Default ResClgSys:SEER2"            		ResClgSys:SEER2            = {  UNDEFINED  }
	"Default ResClgSys:EER"             		ResClgSys:EER              = {  UNDEFINED  }
	"Default ResClgSys:EER2"             		ResClgSys:EER2             = {  UNDEFINED  }
   "Default ResClgSys:CEER"                  ResClgSys:CEER             = {  UNDEFINED  }     ; SAC 08/19/20 (tic #1003)
	"Default ResClgSys:CFMperTon"       		ResClgSys:CFMperTon        = {  UNDEFINED  }
	"Default ResClgSys:ACCharge"        		ResClgSys:ACCharge         = {  UNDEFINED  }
	"Default ResClgSys:RefrigerantType" 		ResClgSys:RefrigerantType  = {  UNDEFINED  }
  ; SAC 3/4/13
	"Default ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	UNDEFINED  }
	"Default ResClgSys:UseEERinAnalysis"		ResClgSys:UseEERinAnalysis	= {	0  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_Fan_PSCFurnace" 0 0 0 1      ; "Single Speed Fan"
;*************************************************************************
; mjb 1/29/15 - mods to lookup WperCFM from T24RClimateZoneCodeBase table
   "Default ResFanSys:DefaultSystem"     ResFanSys:DefaultSystem  = {  0     }
;   "Default ResFanSys:WperCFMCool"			ResFanSys:WperCFMCool    = {  0.58  }
   ; SAC 5/16/19 - added logic to default ResFanSys:WperCFMCool based on assigned system area (tic #1074)
   ; SAC 8/19/19 - added logic to default ResFanSys:WperCFMCool for SDHV (small duct high velocity) systems (tic #1041, #1130)   - SAC 10/27/19 & SAC 10/28/19 - added logic to ensure results for 2019.1.1 consistent w/ 2019.1.0
   "Default ResFanSys:WperCFMCool"			ResFanSys:WperCFMCool    = {
         if (IfValidAnd( Proj:AnalysisVersion > 190101 ))
         then  if (FloorAreaServed < 1 .OR. SDHVAreaServed = FloorAreaServed) 
               then  T24RClimateZoneCodeBase:SDHVWperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else if (FloorAreaServed < 1 .OR. GasFurnAreaServed = FloorAreaServed)
               then  T24RClimateZoneCodeBase:GFurnWperCFM(      "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else  T24RClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               endif endif
         else  ; 2019.1.0 and earlier logic
               if (FloorAreaServed < 1 .OR. HtPumpAreaServed = FloorAreaServed)
               then  T24RClimateZoneCodeBase:WperCFM(      "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               else  T24RClimateZoneCodeBase:GFurnWperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
               endif
         endif  }
;   "Set ResFanSys:MinIAQCFM"					ResFanSys:MinIAQCFM      = {  0  }
END

;*************************************************************************
RULELIST "Default_Fan_unknown" 0 0 0 1
;*************************************************************************
   "Default ResFanSys:DefaultSystem"     ResFanSys:DefaultSystem  = {  1  }
  ; SAC 1/28/13 - added check and rulelist call to ensure system defaults ARE in fact all defaulted if/when DefaultSystem selected
	"Ensure ResFanSys:DefaultSystem valid"		ResFanSys:Action	= {
						if (DefaultSystem > 0.5)
						then	if (	LocalStatus( WperCFMCool ) > 4 )
				;		then	if (	LocalStatus( WperCFMCool ) > 4  .OR.  LocalStatus( CoolingVent ) > 4  .OR.  LocalStatus( IAQCFM         ) > 4  .OR.
				;						LocalStatus( WperCFMIAQ  ) > 4  .OR.  LocalStatus( IAQFanType  ) > 4  .OR.  LocalStatus( IAQRecovEffect ) > 4 )
								then	EvalRulelist( "ForceDefaults_HVACFan", 1 )
								else	UNCHANGED  endif
						else	UNCHANGED  endif  }

;   "Set ResFanSys:MinIAQCFM"					ResFanSys:MinIAQCFM      = {  0  }
   "Default ResFanSys:WperCFMCool"			ResFanSys:WperCFMCool    = {  UNDEFINED  }
;   "Default ResFanSys:CoolingVent"			ResFanSys:CoolingVent    = {  UNDEFINED  }
;   "Default ResFanSys:IAQCFM"				ResFanSys:IAQCFM         = {  UNDEFINED  }
;   "Default ResFanSys:WperCFMIAQ"			ResFanSys:WperCFMIAQ     = {  UNDEFINED  }
;   "Default ResFanSys:IAQFanType"			ResFanSys:IAQFanType     = {  UNDEFINED  }
;   "Default ResFanSys:IAQRecovEffect"		ResFanSys:IAQRecovEffect = {  UNDEFINED  }
END

;*************************************************************************
RULELIST "ForceDefaults_HVACFan" 1 0 0 0
;*************************************************************************
	"Force Default of ResFanSys:WperCFMCool"   		ResFanSys:WperCFMCool      = {	if (LocalStatus( WperCFMCool    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResFanSys:CoolingVent"   		ResFanSys:CoolingVent      = {  if (LocalStatus( CoolingVent    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResFanSys:IAQCFM"        		ResFanSys:IAQCFM           = {  if (LocalStatus( IAQCFM         ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResFanSys:WperCFMIAQ"    		ResFanSys:WperCFMIAQ       = {  if (LocalStatus( WperCFMIAQ     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResFanSys:IAQFanType"    		ResFanSys:IAQFanType       = {  if (LocalStatus( IAQFanType     ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
;	"Force Default of ResFanSys:IAQRecovEffect"		ResFanSys:IAQRecovEffect   = {  if (LocalStatus( IAQRecovEffect ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "ForceDefaults_ClVentFan" 1 0 0 0
;*************************************************************************
	"Force Default of ResClVentFan:WperCFMCool"   	ResClVentFan:WperCFMCool	= {	if (LocalStatus( WperCFMCool    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
	"Force Default of ResClVentFan:CoolingVent"   	ResClVentFan:CoolingVent	= {	if (LocalStatus( CoolingVent    ) > 4) then  UNDEFINED  else  UNCHANGED  endif  }
END
;*************************************************************************


; SAC 5/27/14 - added to facilitate CF1R reporting (particularly where No Cooling inputs are replaced by cooling systems for proposed simulation)
;*************************************************************************
RULELIST "SetupHVACCoolCF1RReportVariables" 1 0 0 0
; start by setting all reporting properties to the input HVACCool properties
	"Default ResClgSys:TypeRpt"		ResClgSys:TypeRpt	= {	Type  }
	"Default ResClgSys:SEERRpt"		ResClgSys:SEERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd( SEER > 0 )==0) then  "N/A"
																			else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))  then  FltToStr( SEER, 11 )	; '11' causes decimal precision defined by value in database
																			else  "N/A"  endif endif }
	"Default ResClgSys:EERRpt"		ResClgSys:EERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd(  EER > 0 )==0) then  "N/A"
																			else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))  then  FltToStr(  EER, 11 )	; '11' causes decimal precision defined by value in database
																			else  "N/A"  endif endif }

; then revise settings for specific HVACCool objects created to simulate no-cooling proposed systems
	"Override ResHVACSys:CoolSystem[1]:TypeRpt (if needed)"		ResHVACSys:CoolSystem[1]:TypeRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then      1      else  UNCHANGED  endif  }
	"Override ResHVACSys:CoolSystem[1]:SEERRpt (if needed)"		ResHVACSys:CoolSystem[1]:SEERRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then  UNDEFINED  else  UNCHANGED  endif  }
	"Override ResHVACSys:CoolSystem[1]:EERRpt (if needed)"		ResHVACSys:CoolSystem[1]:EERRpt	= {	if (IfValidAnd( CoolSysPropCr8 > 0.1 )) then  UNDEFINED  else  UNCHANGED  endif  }

; SAC 11/18/14 - added rules to do same reporting for HVACHtPump SEER & EER as with HVACCool...
	"Default ResHtPumpSys:SEERRpt"	ResHtPumpSys:SEERRpt	= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd( SEER > 0 )==0) then  "N/A"
																				else if (T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))  then  FltToStr( SEER, 11 )	; '11' causes decimal precision defined by value in database
																				else  "N/A"  endif endif }
	"Default ResHtPumpSys:EERRpt"	ResHtPumpSys:EERRpt		= {	if (IfValidAnd( Type > 0 )==0 .OR. IfValidAnd(  EER > 0 )==0) then  "N/A"
																				else if (T24RCoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))  then  FltToStr(  EER, 11 )	; '11' causes decimal precision defined by value in database
																				else  "N/A"  endif endif }
END
;*************************************************************************


;*************************************************************************
RULELIST "PostProposedInput_HVAC" 1 0 0 1
;*************************************************************************
	; SAC 9/24/14 - extracted HVAC rules from PostProposedInput rulelist

   ;--------------------------------------------------------------------
   ; Override certain Proposed Heat/Cool/HtPump systems w/ Std Design performance 		- SAC 4/22/14
   ;--------------------------------------------------------------------
   "Set ResHVACSys:PropEqStd flag (1-htg) indicating system type change for all analysis simulations"      ResHVACSys:PropEqStd =     ; SAC 04/29/21
      {  if (FloorAreaServed[1] < 0.1) then  0
         else if (Type == 2 .AND. LocalStatus( HtPumpSysTypeAbbrev ) > 0)
         then  T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
         else if (Type != 2 .AND. LocalStatus( HeatSysTypeAbbrev   ) > 0)
         then  T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev )
         else  0  endif endif endif  }
   "Set ResHVACSys:PropEqStd flag (2-clg)"      ResHVACSys:PropEqStd =
      {  if (PropEqStd > 0 .OR. FloorAreaServed[1] < 0.1) then  UNCHANGED
         else if (Type == 2 .AND. LocalStatus( HtPumpSysTypeAbbrev ) > 0)
         then  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
         else if (Type != 2 .AND. LocalStatus( CoolSysTypeAbbrev   ) > 0)
         then  T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev )
         else  UNCHANGED  endif endif endif  }

;	"store BEMProc details"		ResHVACSys:Action = {  StoreBEMProc( "b4 Dist-Fan for Prop-Std sys", 0 )  }
  ; SAC 5/6/14 - START by creating HVACDist and/or HVACFan if they are required to model the proposed (like standard) system (GC #312)
  ; SAC 8/7/14 - added logic to create & assign HVACDist if Dist required but currently assigned ResDistSys:Type = 8 (NoDucts) - GC #352
  ; prevent following setup mods for Existing systems - SAC 06/28/23 (tic #3479)
	"Create ResHVACSys:DistribSystem when required to model standard-like heating system"
			ResHVACSys:DistribSystem	= {	if (Status < 2 .OR. Type == 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
													else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
													else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }
	"Create ResHVACSys:DistribSystem when required to model standard-like cooling system"
			ResHVACSys:DistribSystem	= {	if (Status < 2 .OR. Type == 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
													else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
													else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }
	"Create ResHVACSys:DistribSystem when required to model standard-like heat pump system"
			ResHVACSys:DistribSystem	= {	if (Status < 2 .OR. Type != 2 .OR. (LocalCompAssigned( DistribSystem ) > 0.5 .AND. IfValidAnd( DistribSystem:Type != 8 )) .OR. FloorAreaServed[1] < 0.1 .OR.
															LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
													else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
																T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Default_HVACDist_ForceTypeDefault" )
													else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
																T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
													then	CreateComp( HVACDist, Local( Name ) + "-dist", "Setup_HVACDist" )
													else  UNCHANGED  endif endif endif  }

	"Create ResHVACSys:Fan when required to model standard-like heating system"
			ResHVACSys:Fan	= {	if (Status < 2 .OR. Type == 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }
	"Create ResHVACSys:Fan when required to model standard-like cooling system"
			ResHVACSys:Fan	= {	if (Status < 2 .OR. Type == 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }
	"Create ResHVACSys:Fan when required to model standard-like heat pump system"
			ResHVACSys:Fan	= {	if (Status < 2 .OR. Type != 2 .OR. LocalCompAssigned( Fan ) > 0.5 .OR. FloorAreaServed[1] < 0.1 .OR.
											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
												T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.5 .AND.
												T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
									then	CreateComp( HVACFan, Local( Name ) + "-fan", "Setup_HVACDistFan" )
									else  UNCHANGED  endif endif endif  }

  ; SAC 5/6/14 - reset ResHVACSys:HtOrClDucted flag when modeling proposed (like standard) system (GC #312)
	"Adjust ResHVACSys:HtOrClDucted - heat-Htg"	ResHVACSys:HtOrClDucted		= {	if (HtOrClDucted == 1 .OR. HtOrClDucted == 3 .OR. Type == 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( ResHVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( ResHVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HeatSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
																									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
																									then	HtOrClDucted + 1		else  0  endif endif endif  }
	"Adjust ResHVACSys:HtOrClDucted - heat-HP"	ResHVACSys:HtOrClDucted		= {	if (HtOrClDucted == 1 .OR. HtOrClDucted == 3 .OR. Type != 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( ResHVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( ResHVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdHeatingType ) < 1) then  UNCHANGED
																									else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RHeatingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) > 0.5)
																									then	HtOrClDucted + 1		else  0  endif endif endif  }

	"Adjust ResHVACSys:HtOrClDucted - cool-Clg"	ResHVACSys:HtOrClDucted		= {	if (HtOrClDucted == 2 .OR. HtOrClDucted == 3 .OR. Type == 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( ResHVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( ResHVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( CoolSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
																									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
																									then	HtOrClDucted + 2		else  0  endif endif endif  }
	"Adjust ResHVACSys:HtOrClDucted - cool-HP"	ResHVACSys:HtOrClDucted		= {	if (HtOrClDucted == 2 .OR. HtOrClDucted == 3 .OR. Type != 2 .OR. FloorAreaServed[1] < 0.1 .OR.
																											LocalCompAssigned( ResHVACSys:DistribSystem ) < 0.5 .OR. LocalCompAssigned( ResHVACSys:Fan ) < 0.5 .OR.
																											LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. LocalStatus( StdCoolingType ) < 1) then  UNCHANGED
																									else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) < 0.5) then  UNCHANGED
																									else if (T24RCoolingEquipment:DuctFlag(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0.5)
																									then	HtOrClDucted + 2		else  0  endif endif endif  }

	"Setup Standard heating system properties - HVACHeat"
			ResHVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HeatSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdHeatingType)
														case  1 :	EvalRulelist( "Setup_HVACSys_Heat_CntrlFurnace" , 1 )
														case  2 :	EvalRulelist( "Setup_HVACSys_Heat_WallFurnaceFan"      , 1 )
														case  3 :	EvalRulelist( "Setup_HVACSys_Heat_Boiler"       , 1 )
														case 14 :	EvalRulelist( "Setup_HVACSys_Heat_WallFurnaceGravity", 1 )		; SAC 11/25/14 - value 4->14
														case 15 :	EvalRulelist( "Setup_HVACSys_Heat_FloorFurnace"      , 1 )		; SAC 11/25/14 - value 5->15
														case 16 :	EvalRulelist( "Setup_HVACSys_Heat_RoomHeater"      , 1 )			; SAC 11/25/14 - value 6->16													
														case  8 :	EvalRulelist( "Setup_HVACSys_Heat_Electric"     , 1 )
														case  9 :	EvalRulelist( "Setup_HVACSys_Heat_CombHydro"    , 1 )
														default :	PostError( "Unexpected standard design heating system type (%g) encountered", StdHeatingType )
													endswitch  endif endif  }
	"Setup Standard heating system properties - HVACHtPump"
			ResHVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdHeatingType)
														case  1 :	UNCHANGED		; CntrlFurnace
														case  2 :	UNCHANGED		; Heater
														case  3 :	UNCHANGED		; Boiler
		  											case  4 :	EvalRulelist( "Setup_HVACSys_HtPump_SplitHeatPump", 1 )
														case 19 :	EvalRulelist( "Setup_HVACSys_HtPump_SDHVSplitHeatPump", 1 )
														case 10 :	EvalRulelist( "Setup_HVACSys_HtPump_DuctlessMiniSplitHeatPump", 1 )
														case  7 :	EvalRulelist( "Setup_HVACSys_HtPump_RoomHeatPump" , 1 )
														case  8 :	UNCHANGED		; Electric
														case  9 :	UNCHANGED		; CombHydro
														default :	PostError( "Unexpected standard design heat pump (heating) system type (%g) encountered", StdHeatingType )
													endswitch  endif endif  }
	"Setup Standard cooling system properties - HVACCool"
			ResHVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( CoolSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdCoolingType)
														case  2 :	Evalrulelist( "Setup_HVACSys_Cool_SplitAirCond" , 1 )
														case  5 :	Evalrulelist( "Setup_HVACSys_Cool_RoomAirCond"  , 1 )
														case  6 :	UNCHANGED		; SplitHeatPump
														case 10 :	UNCHANGED		; RoomHeatPump
														default :	PostError( "Unexpected standard design cooling system type (%g) encountered", StdCoolingType )
													endswitch  endif endif  }
	"Setup Standard cooling system properties - HVACHtPump"
			ResHVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1) then  UNCHANGED
											else if (T24RCoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) == 0) then  UNCHANGED
											else	switch (StdCoolingType)
														case  2 :	UNCHANGED		; SplitAirCond
														case  5 :	UNCHANGED		; RoomAirCond
														case  6 :	Evalrulelist( "Setup_HVACSys_Cool_SplitHeatPump", 1 )
														case 10 :	Evalrulelist( "Setup_HVACSys_Cool_RoomHeatPump" , 1 )
														default :	PostError( "Unexpected standard design heat pump (cooling) system type (%g) encountered", StdCoolingType )
													endswitch  endif endif  }
   ; SAC 8/16/19 - added rule to force Proposed model VCHP performance to Std design levels (tic #1148)
	"Force Proposed VCHP heat/cool efficiencies to std design levels"
			ResHVACSys:Action		= {	if (FloorAreaServed < 0.1 .OR. LocalStatus( HtPumpSysTypeAbbrev ) < 1 .OR. Status == 1) then  UNCHANGED
			                        else if (IfValidAnd( HtPumpSysTypeAbbrev = "VCHP" ))
			                        then  Evalrulelist( "Setup_HVACSys_ProposedVCHP", 1 )
			                        else  UNCHANGED  endif endif  }
;	"debug HVAC"			ResHVACSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "PostProposedInput  ResHVACSys: '%s'  StdHeatingType: %g   StdCoolingType: %g",  Name, StdHeatingType, StdCoolingType ) else UNCHANGED endif  }

   "Reset ResHVACSys:GasFurnAreaServed - area served iff heating type is Gas Furnace"     ResHVACSys:GasFurnAreaServed =      ; SAC 04/29/21
      {  if (PropEqStd > 0 .AND. Type != 2 .AND. (StdHeatingType == 1 .OR. StdHeatingType == 18)) then  FloorAreaServed[1]    ; CntrlFurnace or PkgGasFurnace
         else  UNCHANGED  endif  }
   "RE-default all HVACfans iff PropEqStd changes made above"     ResProj:Action	=        ; SAC 04/29/21
      {	if (SumAll( ResHVACSys:PropEqStd ) < 1) then  UNCHANGED  else  EvalRulelist( "Default_Fan" )  endif  }


   ;--------------------------------------------------------------------
   ; Assign SimDHWSys to send to DHWDLL 	mjb-12/18/13
   ;--------------------------------------------------------------------

   "Assign SimDHWSys"          ResDHWSys:SimDHWSys  =       ; SAC 10/2/19 - revised to handle central laundry (MFamProto)
      {  if ( FloorAreaServed > 0 ) then  1
         else if (Proj:IsComRuleset .AND.
                  SumRevRef( ResOtherZn:ActiveDHWSystem, ResOtherZn:WasherDwellUnits ) > 0) then  1
         else  0  endif endif  }


   ;--------------------------------------------------------------------
   ; Building Summary setup
   ;--------------------------------------------------------------------
;	"Evaluate rules to summarize building model for reporting purposes"		ResProj:Action	= {	EvalRulelist( "Reporting_SummarizeModel" )  }
;	mjb	6/13/14	make sure Fan and Dist TypeRpt assigned
	"Set HVACFan TypeRpt"		ResFanSys:TypeRpt	=	{	if ( TypeRpt == 0 ) then UNCHANGED else 1 endif	}
;	"Set HVACDist TypeRpt"		ResDistSys:TypeRpt	=	{	if ( TypeRpt == 0 ) then UNCHANGED else 1 endif	}
;	"DBG msg" ResDistSys:Action = { MessageBox( "Post Proposed -- HVACDist '%s' TypeRpt = %g", Name, TypeRpt ) }
END
;*************************************************************************


; rulelist designed to be evaluated immediately before generic (numeric range...) checks, to ensure those checks are performed ony on valid/analyzed model components - SAC 5/18/20 (tic #1187)
;*************************************************************************
RULELIST "ModelErrorCheckPrep" 1 0 0 0
;*************************************************************************

   "Blast DHWHeater:EFRangeChkID for unreferenced heaters"     ResWtrHtr:EFRangeChkID  =     ; SAC 5/18/20 (tic #1187)
      {  if (IfValidAnd( EFRangeChkID > 0 ) .AND. IfValidAnd( FloorAreaServed > 0.1 )==0) then  0
         else  UNCHANGED  endif  }

END
;*************************************************************************


; SAC 6/28/14 - rulelist designed to prepare Multifamily models for analysis
;*************************************************************************
RULELIST "MultiFamilyAnalysisPrep" 1 0 0 0
;*************************************************************************

;"store BEMProc details"		ResProj:Action = {  StoreBEMProc( "Before HVAC re-gen", 0 )  }

	;"Blast all HVACSys objects"														ResProj:Action	= {	DeleteAllComps( HVACSys )  }
	; SAC 9/23/19 - replaced above w/ following to prevent deletion of HVACSys objects that are refefenced by OtherZone objects (MFamProto)
   "Blast all HVACSys objects (not assigned by OtherZones)"	   ResHVACSys:Action	=
      {  if (SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:CondFloorArea ) > 0) then   UNCHANGED
         else  DeleteComp()  endif  }

   ; rules to ensure 1-to-1 ResOtherZn/ResHVACSys assignments (VRF-related) - SAC 06/04/22
   "Set ResOtherZn:CompIdx"   ResOtherZn:CompIdx = {  ComponentIndex()  } 
   "Set ResHVACSys:MinResOtherZnCompIdx"     ResHVACSys:MinResOtherZnCompIdx =
      {  if (SumRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:CondFloorArea ) > 0)
         then  MinRevRef( ResOtherZn:ActiveHVACSystem, ResOtherZn:CompIdx )
         else  -1  endif  }
   ; revised logic to NOT copy Existing HVAC systems - SAC 06/28/23
   "Create copy of ResHVACSys if not first ResOtherZn assigned"   ResotherZn:Action =
      {  if (LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "ResHVACSys" ) .AND.
             (Proj:ResCompOpt < 2 .OR. HVACSysStatus > 1))
         then  if (IfValidAnd( CompIdx > ActiveHVACSystem:MinResOtherZnCompIdx ))
               then  if (HVACSysStatus == 3)
                     then  EvalRulelist( "CreateUnique_ResOtherZn_ResHVACSys_New", 1 )
                     else  EvalRulelist( "CreateUnique_ResOtherZn_ResHVACSys_Alt", 1 )  endif
               else  UNCHANGED  endif
         else  UNCHANGED  endif  }

	"Generate HVACSys objects based on DwellUnit equipment assignments"	ResProj:Action	= {	CreateDwellUnitHVACSysObjects()  }

   ; set flag indicating ResZn HVAC creation for Dwellings is complete - SAC 10/16/22
   "Set Proj:ResZnHVACSysCreated to 1"    Proj:ResZnHVACSysCreated = { 1 }

   ; SAC 05/05/23 (LMCC github issues #133 / #60)
   "Delete all HERSCool   objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSCool   ) }
   "Delete all HERSHeat   objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSHeat   ) }
   "Delete all HERSHtPump objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSHtPump ) }
   "Delete all HERSDist   objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSDist   ) }
   "Delete all HERSFan    objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSFan    ) }
   "Delete all HERSDHWSys objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSDHWSys ) }
   "Delete all HERSOther  objects which, if left in place, may cause reporting issues"   Proj:Action = { DeleteAllComps( HERSOther  ) }

;"store BEMProc details"		ResProj:Action = {  StoreBEMProc( "After HVAC re-gen", 0 )  }
;"debug"		ResProj:Action	= {	MessageBox( "Multifamily HVACSys RE-generation complete" )  }
	
END
;*************************************************************************

;************************************************************************* SAC 06/04/22
RULELIST "CreateUnique_ResOtherZn_ResHVACSys_New" 1 0 1 0
   "Create copy of currently assigned ResHVACSys - ResotherZn:ozHVACSystem"   ResotherZn:ozHVACSystem =
      {  CreateComp( ResHVACSys, Format( "%s hvac", Name ), "none", 1, ozHVACSystem:Name )  }
   "Default ResOtherZn:ActiveHVACSystem via rulelist"  ResOtherZn:Action =
      {  EvalRulelist( "Default_ResOtherZn_ActiveHVACSys_New", 1 )  }
END
RULELIST "Default_ResOtherZn_ActiveHVACSys_New" 1 0 0 0
   "Default ResOtherZn:ActiveHVACSystem"  ResOtherZn:ActiveHVACSystem = {  ozHVACSystem  }
END
;************************************************************************* SAC 06/28/23
RULELIST "CreateUnique_ResOtherZn_ResHVACSys_Alt" 1 0 1 0
   "Create copy of currently assigned ResHVACSys - ResotherZn:AltHVACSystem"   ResotherZn:AltHVACSystem =
      {  CreateComp( ResHVACSys, Format( "%s hvac", Name ), "none", 1, AltHVACSystem:Name )  }
   "Default ResOtherZn:ActiveHVACSystem via rulelist"  ResOtherZn:Action =
      {  EvalRulelist( "Default_ResOtherZn_ActiveHVACSys_Alt", 1 )  }
END
RULELIST "Default_ResOtherZn_ActiveHVACSys_Alt" 1 0 0 0
   "Default ResOtherZn:ActiveHVACSystem"  ResOtherZn:ActiveHVACSystem = {  AltHVACSystem  }
END
;*************************************************************************


; rulelist designed to be evaluated only once per round of analysis (even for All Orientation runs)  - SAC 9/10/13 added
;*************************************************************************
RULELIST "OneTimeAnalysisPrep" 1 0 0 0
;*************************************************************************

   ; SAC 4/10/17 - setup Target Design Rating if entered and allowed
   ; SAC 12/12/17 - added check to ensure PV system size (PVWDCSysTotal) > 0 in order to calc TDR (tic #888)
   ; SAC 6/8/19 - added logic to prevent Target Design Rating for 2022 code (until calcs updated to handle it)
   "Set ResProj:TargetDesignRtg - Target Design Rating (100 * Prop / DesignRtg TDV)"
      ResProj:TargetDesignRtg  = {
         if (IfValidAnd( EnergyCodeYearNum >= 2016 ) .AND. IfValidAnd( EnergyCodeYearNum < 2022 ) .AND. 
             IfValidAnd( AllowDesignRating  > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs  > 0.5 ) .AND.
             IfValidAnd( SpecifyTargetDRtg  > 0.5 ) .AND. LocalStatus( TargetDesignRtgInp ) > 0 .AND.
             IfValidAnd( PVWDCSysTotal > 0 ))
         then  TargetDesignRtgInp
         else  UNDEFINED  endif  }

   ; SAC 1/27/18 - ResProj:CondFloorArea-dependent CO2 emissions unit conversion multipliers
   "Set ResProj:CO2FuelUnitLabel - text label for CO2 emissions by fuel type"
       ResProj:CO2FuelUnitLabel   = {  "kg"  }
   "Set ResProj:CO2FuelUnitMult - conversion factor from EnergyUse units (tonne/ft2-yr) to CO2FuelUnitLabel"
       ResProj:CO2FuelUnitMult    = {  CondFloorAreaWithMult * 1000  }
   "Set ResProj:CO2TotalUnitLabel - text label for total (summary) CO2 emissions"
       ResProj:CO2TotalUnitLabel  = {  "kg"  }
;       ResProj:CO2TotalUnitLabel  = {  "g/ft2-yr"  }
   "Set ResProj:CO2TotalUnitMult - conversion factor from EnergyUse units (tonne/ft2-yr) units to CO2TotalUnitLabel"
       ResProj:CO2TotalUnitMult   = {  CondFloorAreaWithMult * 1000  }
;       ResProj:CO2TotalUnitMult   = {  1000000  }

  ; LDH 07/28/2016 - Rules to Blast Dwelling Units for Single Family
  "Blast Dwelling Units for Single Family"  DwellUnit:Action = {
    if( ResProj:IsMultiFamily = 0 )
    then EvalRulelist( "BlastDwellingUnit", 1 )
    else UNCHANGED
    endif }

  ; LDH 07/29/16 - Rulelists to Reset Status Properties based on Compliance Type (tic 602)

; ---------- Call Rulelist to Reset ResZn:Status and ResAttic:Status for 'Newly Constructed' --------------------
  "Reset ResZn:Status based on ResProj:RunType"  ResProj:Action = {
    if( ResProj:RunScope = 1 ) then EvalRulelist( "ResetZoneStatus_New", 0 ) else UNCHANGED endif }

; ---------- Call Rulelist to Reset Env:Status based on ResZn:Status -----------------------------------------  SAC 9/20/19 - revised rule to set ResProj:Action vs. ResZn: since rules not restricted to a single ResZn: properties
  "Reset Envelope:Status based on ResZn:Status"  ResProj:Action = { 
    EvalRulelist( "ResetEnvelopeObjectStatus_New", 0 ) }

; ---------- Call Rulelist to Reset Mechanical Status properties for 'Newly Constructed' + NOT Addition/Alteration
  "Reset Mechanical Status Properties based on ResProj:RunType"  ResProj:Action = {
    if( ResProj:RunScope = 1 .AND. ResProj:IsAddAlone = 0 )
    then EvalRulelist( "ResetMechStatus_New", 0 ) 
    else UNCHANGED 
    endif }

   ;--------------------------------------------------------------------
   ; Ensure no invalid ADU data present in analysis or report
   ;--------------------------------------------------------------------
   "Remove any old/invalid ADU data"      ResProj:Action  =          ; SAC 5/15/20 (tic #1199)
      {  if (IsMultiFamily > 0 .OR. IfValidAnd( SFamADUType > 0 )) then  UNCHANGED
         else  EvalRulelist( "OneTimeAnalysisPrep_RemoveADUInputs" )  endif  }

; SAC 12/23/15 - MOVED from PostProposedInput to get it done BEFORE it is used to set final people heat gains
  ; SAC 8/20/14 - rule to force reset of ResProj:NumBedrooms for MFam models (GC #354 note#1)
	"Set ResProj:NumBedrooms"		ResProj:NumBedrooms		= {	if (IfValidAnd( IsMultiFamily > 0.5 )) then  SumAll( DwellUnit:TotalNumBedroomsWithMult )
																			else  UNCHANGED  endif  }
	"Set ResProj:NumAddBedrooms"	ResProj:NumAddBedrooms	= {	if (IfValidAnd( IsMultiFamily > 0.5 )) then  0		; SAC 12/28/15 - added - will need updates to properly handle MFam Addition Alone
																			else  UNCHANGED  endif  }

  ; SAC 12/30/15 - added to ensure HVACDist not assigned to both heat+cool & heat-only systems (tic 544)
  ; SAC 5/14/19 - replaced use of ResHVACSys:HaveHeating/Cooling with ServesHeating/Cooling to ignore presences of assignments to systems w/ no served floor area
	"Set ResDistSys:ServesHeating"		ResDistSys:ServesHeating	= {	SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:ServesHeating )  }
	"Set ResDistSys:ServesCooling"		ResDistSys:ServesCooling	= {	SumRevRef( ResHVACSys:DistribSystem, ResHVACSys:ServesCooling )  }

  ; SAC 1/4/16 - for SFam models, if any zone assigns DHW system, then make sure ALL zones are modeled w/ DHW
  ; SAC 2/29/16 - extended assignment of DHWSys1/2, AltDHWSys1/2 & exDHWSys1/2 to include EAA models (tic #607)
	"Set ResZn:DHWSys1 (if SFam w/ DHW when not already assigned)"
			ResZn:DHWSys1	= {	if (ResProj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( ResProj:MaxDHWSysByCateg[1] ) < 1 .OR. DHWSys1Status != 3 .OR. LocalCompAssigned( DHWSys1 ) > 0) then  UNCHANGED
										else if ((DHWSys2Status == 3 .AND. LocalCompAssigned( DHWSys2 ) > 0) .OR.
													((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0) .AND.
															((DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) .OR. (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0))) .OR.
													((ResProj:RunScope == 2 .OR. ResProj:IsAddAlone > 0) .AND.
															((DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) .OR. (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0))) )
										then  UNCHANGED
										else	ResProj:MaxDHWSysByCateg[1]  endif endif  }
	"Set ResZn:AltDHWSys1 (if SFam & altered DHW not already assigned)"
			ResZn:AltDHWSys1	= {	if ((ResProj:RunScope == 1 .AND. ResProj:IsAddAlone < 1) .OR. ResProj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( ResProj:MaxDHWSysByCateg[2] ) < 1 .OR.
													DHWSys1Status != 2 .OR. LocalCompAssigned( AltDHWSys1 ) > 0)
											then  UNCHANGED
											else if ((DHWSys1Status == 3 .AND. LocalCompAssigned(    DHWSys1 ) > 0) .OR. (DHWSys2Status == 3 .AND. LocalCompAssigned(    DHWSys2 ) > 0) .OR.
																																				  (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) .OR.
														(DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) .OR. (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) )
											then  UNCHANGED
											else	ResProj:MaxDHWSysByCateg[2]  endif endif  }
	"Set ResZn:exDHWSys1 (if SFam & existing DHW not already assigned)"
			ResZn:exDHWSys1		= {	if ((ResProj:RunScope == 1 .AND. ResProj:IsAddAlone < 1) .OR. ResProj:IsMultiFamily > 0.5 .OR. GlobalCompAssigned( ResProj:MaxDHWSysByCateg[3] ) < 1 .OR.
													DHWSys1Status != 1 .OR. LocalCompAssigned( exDHWSys1 ) > 0)
											then  UNCHANGED
											else if ((DHWSys1Status == 3 .AND. LocalCompAssigned(    DHWSys1 ) > 0) .OR. (DHWSys2Status == 3 .AND. LocalCompAssigned(    DHWSys2 ) > 0) .OR.
														(DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) .OR. (DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) .OR.
																																				  (DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) )
											then  UNCHANGED
											else	ResProj:MaxDHWSysByCateg[3]  endif endif  }

	; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
	"Special prep for DwellUnitType objects that have HVAC htg equip serving as DHW heaters"
			ResProj:Action		= {	if (IsMultiFamily < 0.5) then  UNCHANGED
										else if (SumAcrossIf( DwellUnitType:HtEqpUsedAsDHWHtr, DwellUnitType:AssignedDUFlrArea > 1 ) < 0.5) then  UNCHANGED
										else	EvalRulelist( "OneTimeAnalysisPrep_DwellUnitDHW" )  endif endif  }

   ; SAC 6/27/18 - ensure valid DHW InputRating data for use by HERS providers (tic #940)
   ; SAC 6/28/18 - further mods to leave InputRating UNCHANGED in scenarios where user input accepted (so that status not changed to Rule-defined) (tic #940)
   "Ensure proper reporting value for DHWHeater:InputRating"   ResWtrHtr:InputRating  = {
		switch (HeaterElementType)
			case  0 :	      	; (watts)   "Electric Resistance" 
                     switch (HeaterType)
               			case  2 :    12001		; "Large Instantaneous" 
               			case  3 :         		; "Large Storage" 
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  12001  endif
               			case  5 :    12000		; "Small Instantaneous" 
               			case  6 :    12000		; "Small Storage" 
               			case 10 :    12000		; "Consumer Instantaneous (UEF)"             
               			case 11 :    12001		; "Commercial Instantaneous (TE)"            
               			case 12 :    12000		; "Consumer Storage (UEF)" 
               			case 13 :         		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  12001  endif
                        case 15 :    36000      ; "Residential-Duty Commercial Instantaneous (UEF)"
							   default :	 12000  
							endswitch
			case  1 :   			; (Btu/hr)  "Natural Gas"   
                     switch (HeaterType)
                        case  0 :   200000      ; "Boiler"  
                        case  1 :   200000      ; "Indirect"  
                        case  2 :   200001      ; "Large Instantaneous"  
                        case  3 :               ; "Large Storage"  
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  75001  endif
                        case  9 :   200000	   ; "UEF-rated Instantaneous"
							   case  5 :   200000		; "Small Tankless"
               			case 10 :   200000		; "Consumer Instantaneous (UEF)"             
               			case 11 :   200001		; "Commercial Instantaneous (TE)"            
               			case 12 :    75000		; "Consumer Storage (UEF)"                   
               			case 13 :         		; "Commercial Storage (TE & SBL)"            
               			           if (IfValidAnd( InputRating > 0 )) then  UNCHANGED
               			           else  75001  endif
               			case 14 :    76000		; "Residential-Duty Commercial Storage (UEF)"
                        case 16 :   300000      ; "Commercial Packaged Boiler"      ; SAC 12/19/19 - to facilitate new central gas std design DHW system (tic #862)
							   default :	 75000		; "Small Storage"
							endswitch
			case  2 :   			; (Btu/hr)  "Propane"             
							if (HeaterType == 5) then  200000		; "Small Tankless"
							else	75000  endif							; "Small Storage"
			case  3 :    12000   ; (watts)   "Heat Pump"           
			case  4 :   			; (Btu/hr)  "Oil"   
							if (HeaterType == 5) then  200000		; "Small Tankless"
							else	75000  endif							; "Small Storage"
			case  5 :    12000	; (watts)  "Heat Pump"              
			default :	UNCHANGED
		endswitch  }

	; SAC 10/23/14 - moved evaluation of  rulelist out of source code and into this spot to solve other reporting issues
	"Eval ProposedReportPrep rules"	ResProj:Action	= {	EvalRulelist( "ProposedReportPrep" )  }

; SAC 10/23/14 - moved these rules from PostProposedInput_HVAC to OneTimeAnalysisPrep rulelist to be set prior to Proposed model reporting export
   ;--------------------------------------------------------------------
   ; Adjust DuctInsRValue if E+A+A and Ducts are Status = 4 (Existing + New)
   ;--------------------------------------------------------------------
	"Set ResDistSys:exDuctInsRvalue"			ResDistSys:exDuctInsRvalue		= {	if (ResProj:RunScope == 2 .AND. Status == 4) then
																											exDuctInsRvalOpt / 100
																										else  UNDEFINED  endif	 }
; mjb 7/10/14 - only execute this rule for Ducts used in ResProject (FloorAreaServed > 0)
	"Set ResDistSys:DuctInsRvalue"				ResDistSys:DuctInsRvalue	= {	if ( ResProj:RunScope == 2 .AND. Status == 4 .AND. LocalStatus( exDuctInsRvalue ) > 0 .AND. FloorAreaServed > 0) then
																									((DuctInsRvalOpt/100 * (FloorAreaServed - exFloorAreaServed)) + (exDuctInsRvalue * exFloorAreaServed))/FloorAreaServed
																								else  UNCHANGED endif  }

   ;--------------------------------------------------------------------
   ; IAQFan - NumAssignments setting		SAC 9/10/13
   ;--------------------------------------------------------------------
; SAC 2/5/20 - moved ResIAQFan:NumAssignments up into defaulting rules in order to take into account for backward compatibility (tic #1174)
;	"Init all ResIAQFan:NumAssignments"							ResIAQFan:NumAssignments	= {	0  }
;  ; SAC 1/14/15 - updated rules for latest DwellUnitType structure and eliminate references to old (proj-based) MFam inputs
;	"Incrament ResProj:UnitIAQFan1[1]:NumAssignments"		ResProj:UnitIAQFan1[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt1[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan1[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament ResProj:UnitIAQFan2[1]:NumAssignments"		ResProj:UnitIAQFan2[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt2[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan2[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament ResProj:UnitIAQFan3[1]:NumAssignments"		ResProj:UnitIAQFan3[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt3[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan3[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament ResProj:UnitIAQFan4[1]:NumAssignments"		ResProj:UnitIAQFan4[1]:NumAssignments	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1] == 2 .AND. UnitIAQFanCnt4[1] > 0.5 .AND. IAQDisabled < 0.5) then  UnitIAQFan4[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;
;	"Incrament DwellUnitType:IAQFanRef[1]:NumAssignments"		DwellUnitType:IAQFanRef[1]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[1]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[2]:NumAssignments"		DwellUnitType:IAQFanRef[2]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[2]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[3]:NumAssignments"		DwellUnitType:IAQFanRef[3]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[3]:NumAssignments + 1  else  UNCHANGED  endif  }
;	"Incrament DwellUnitType:IAQFanRef[4]:NumAssignments"		DwellUnitType:IAQFanRef[4]:NumAssignments	= {	if (ResProj:IsMultiFamily > 0.5 .AND. IAQOption == 2 .AND. AssignedDUFlrArea > 0.5) then  IAQFanRef[4]:NumAssignments + 1  else  UNCHANGED  endif  }

	; GENERATE NEW IAQFan objects when default minimum CFM selections are active (for reporting purposes)
	"Create SFam ResProj:UnitIAQFan1[1] (when necessary)"			ResProj:UnitIAQFan1[1]	= {	if (IsMultiFamily < 0.5 .AND. UnitIAQOption[1]  == 1 .AND. IAQDisabled < 0.5) then  CreateComp( IAQFan, "IAQ Fan", "SetupDefaultIAQFan_1"  )   else  UNCHANGED  endif  }
; SAC 6/25/14 - TO DO ?? create default IAQ fans for each DwellUnit ??
;		"Create MFam-1 ResProj:UnitIAQFan1[1] (when necessary)"		ResProj:UnitIAQFan1[1]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[1]  > 0.5 .AND. UnitIAQOption[1]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #1 IAQ Fan",  "SetupDefaultIAQFan_1"  )   else  UNCHANGED  endif  }
;		"Create MFam-2 ResProj:UnitIAQFan1[2] (when necessary)"		ResProj:UnitIAQFan1[2]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[2]  > 0.5 .AND. UnitIAQOption[2]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #2 IAQ Fan",  "SetupDefaultIAQFan_2"  )   else  UNCHANGED  endif  }
;		"Create MFam-3 ResProj:UnitIAQFan1[3] (when necessary)"		ResProj:UnitIAQFan1[3]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[3]  > 0.5 .AND. UnitIAQOption[3]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #3 IAQ Fan",  "SetupDefaultIAQFan_3"  )   else  UNCHANGED  endif  }
;		"Create MFam-4 ResProj:UnitIAQFan1[4] (when necessary)"		ResProj:UnitIAQFan1[4]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[4]  > 0.5 .AND. UnitIAQOption[4]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #4 IAQ Fan",  "SetupDefaultIAQFan_4"  )   else  UNCHANGED  endif  }
;		"Create MFam-5 ResProj:UnitIAQFan1[5] (when necessary)"		ResProj:UnitIAQFan1[5]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[5]  > 0.5 .AND. UnitIAQOption[5]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #5 IAQ Fan",  "SetupDefaultIAQFan_5"  )   else  UNCHANGED  endif  }
;		"Create MFam-6 ResProj:UnitIAQFan1[6] (when necessary)"		ResProj:UnitIAQFan1[6]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[6]  > 0.5 .AND. UnitIAQOption[6]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #6 IAQ Fan",  "SetupDefaultIAQFan_6"  )   else  UNCHANGED  endif  }
;		"Create MFam-7 ResProj:UnitIAQFan1[7] (when necessary)"		ResProj:UnitIAQFan1[7]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[7]  > 0.5 .AND. UnitIAQOption[7]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #7 IAQ Fan",  "SetupDefaultIAQFan_7"  )   else  UNCHANGED  endif  }
;		"Create MFam-8 ResProj:UnitIAQFan1[8] (when necessary)"		ResProj:UnitIAQFan1[8]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[8]  > 0.5 .AND. UnitIAQOption[8]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #8 IAQ Fan",  "SetupDefaultIAQFan_8"  )   else  UNCHANGED  endif  }
;		"Create MFam-9 ResProj:UnitIAQFan1[9] (when necessary)"		ResProj:UnitIAQFan1[9]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[9]  > 0.5 .AND. UnitIAQOption[9]  == 1) then  CreateComp( IAQFan, "Dwelling Unit #9 IAQ Fan",  "SetupDefaultIAQFan_9"  )   else  UNCHANGED  endif  }
;		"Create MFam-10 ResProj:UnitIAQFan1[10] (when necessary)"	ResProj:UnitIAQFan1[10]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[10] > 0.5 .AND. UnitIAQOption[10] == 1) then  CreateComp( IAQFan, "Dwelling Unit #10 IAQ Fan", "SetupDefaultIAQFan_10" )   else  UNCHANGED  endif  }
;		"Create MFam-11 ResProj:UnitIAQFan1[11] (when necessary)"	ResProj:UnitIAQFan1[11]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[11] > 0.5 .AND. UnitIAQOption[11] == 1) then  CreateComp( IAQFan, "Dwelling Unit #11 IAQ Fan", "SetupDefaultIAQFan_11" )   else  UNCHANGED  endif  }
;		"Create MFam-12 ResProj:UnitIAQFan1[12] (when necessary)"	ResProj:UnitIAQFan1[12]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[12] > 0.5 .AND. UnitIAQOption[12] == 1) then  CreateComp( IAQFan, "Dwelling Unit #12 IAQ Fan", "SetupDefaultIAQFan_12" )   else  UNCHANGED  endif  }
;		"Create MFam-13 ResProj:UnitIAQFan1[13] (when necessary)"	ResProj:UnitIAQFan1[13]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[13] > 0.5 .AND. UnitIAQOption[13] == 1) then  CreateComp( IAQFan, "Dwelling Unit #13 IAQ Fan", "SetupDefaultIAQFan_13" )   else  UNCHANGED  endif  }
;		"Create MFam-14 ResProj:UnitIAQFan1[14] (when necessary)"	ResProj:UnitIAQFan1[14]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[14] > 0.5 .AND. UnitIAQOption[14] == 1) then  CreateComp( IAQFan, "Dwelling Unit #14 IAQ Fan", "SetupDefaultIAQFan_14" )   else  UNCHANGED  endif  }
;		"Create MFam-15 ResProj:UnitIAQFan1[15] (when necessary)"	ResProj:UnitIAQFan1[15]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[15] > 0.5 .AND. UnitIAQOption[15] == 1) then  CreateComp( IAQFan, "Dwelling Unit #15 IAQ Fan", "SetupDefaultIAQFan_15" )   else  UNCHANGED  endif  }
;		"Create MFam-16 ResProj:UnitIAQFan1[16] (when necessary)"	ResProj:UnitIAQFan1[16]	= {	if (IsMultiFamily > 0.5 .AND. UnitInputValid[16] > 0.5 .AND. UnitIAQOption[16] == 1) then  CreateComp( IAQFan, "Dwelling Unit #16 IAQ Fan", "SetupDefaultIAQFan_16" )   else  UNCHANGED  endif  }

   ;--------------------------------------------------------------------
   ; ClVentFan - NumAssignments setting		SAC 9/11/13
   ;--------------------------------------------------------------------
	"Init all ResClVentFan:NumAssignments"							ResClVentFan:NumAssignments	= {	0  }
	; SAC 5/9/19 - added logic that accounts for ability to specify ClVent fans to Outside even when no cool-ventable attic exists (tic #1040)
	"Incrament ResProj:UnitClVentFan[1]:NumAssignments"		ResProj:UnitClVentFan[1]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[1]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitClVentFan[2]:NumAssignments"		ResProj:UnitClVentFan[2]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[2]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitClVentFan[3]:NumAssignments"		ResProj:UnitClVentFan[3]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[3]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitClVentFan[4]:NumAssignments"		ResProj:UnitClVentFan[4]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[4]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitClVentFan[5]:NumAssignments"		ResProj:UnitClVentFan[5]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[5]:NumAssignments + 1  else  UNCHANGED  endif  }
	"Incrament ResProj:UnitClVentFan[6]:NumAssignments"		ResProj:UnitClVentFan[6]:NumAssignments	= {	if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2) then  UnitClVentFan[6]:NumAssignments + 1  else  UNCHANGED  endif  }

   "Init all ResClVentFan:AssignedArea"                     ResClVentFan:AssignedArea   = {   0  }
   ; SAC 5/1/19 - rules similar to NumAssignments above but that tally assigned area in order to report CFM/ft2 in CF1R
   "Incrament ResProj:UnitClVentFan[1]:AssignedArea"      ResProj:UnitClVentFan[1]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[1] )) then  UnitClVentFan[1]:AssignedArea + ValidOr( UnitClVentZone[1]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament ResProj:UnitClVentFan[2]:AssignedArea"      ResProj:UnitClVentFan[2]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[2] )) then  UnitClVentFan[2]:AssignedArea + ValidOr( UnitClVentZone[2]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament ResProj:UnitClVentFan[3]:AssignedArea"      ResProj:UnitClVentFan[3]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[3] )) then  UnitClVentFan[3]:AssignedArea + ValidOr( UnitClVentZone[3]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament ResProj:UnitClVentFan[4]:AssignedArea"      ResProj:UnitClVentFan[4]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[4] )) then  UnitClVentFan[4]:AssignedArea + ValidOr( UnitClVentZone[4]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament ResProj:UnitClVentFan[5]:AssignedArea"      ResProj:UnitClVentFan[5]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[5] )) then  UnitClVentFan[5]:AssignedArea + ValidOr( UnitClVentZone[5]:CondFloorArea, 0 )  else  UNCHANGED  endif  }
   "Incrament ResProj:UnitClVentFan[6]:AssignedArea"      ResProj:UnitClVentFan[6]:AssignedArea   = {   if ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentZone[6] )) then  UnitClVentFan[6]:AssignedArea + ValidOr( UnitClVentZone[6]:CondFloorArea, 0 )  else  UNCHANGED  endif  }

	; GENERATE NEW ClVentFan objects when default minimum CFM selections are active (for reporting purposes)
	; SAC 8/17/19 - added logic to ensure WHF CFM > 0 for default prescrip. fan (tic #880)
	"Create new ResProj:UnitClVentFan[1] (when necessary)"	ResProj:UnitClVentFan[1]	=           ; SAC 5/9/19 - added logic that accounts for ability to specify ClVent fans to Outside even when no cool-ventable attic exists (tic #1040)
      {  if ( ( (EnableClVent .AND. UnitClVentOption == 1) .OR. ((EnableClVent .OR. LimitedClVent) .AND. UnitClVentOption == 5) ) .AND.
               T24RClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0 ); JP 7/30/19 - added logic that prevent the creation of ClVent when using default fan and DefCFM = 0 (tic #1091)
         then  CreateComp( ClVentFan, "Whole House Fan", "SetupDefaultClVentFan" )
         else  UNCHANGED  endif  }

	; GENERATE NEW ClVentFan objects associated w/ individual 'CFI' HVACSys objects (for reporting purposes)
	"Create new ResHVACSys:CFIClVentFan (when necessary)"		ResHVACSys:CFIClVentFan		= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CreateComp( ClVentFan, Name + " - CFI", "SetupCFIHVACSysClVentFan" )   else  UNCHANGED  endif  }
   "Set ResHVACSys:CFIClVentFan:AssignedArea"   ResHVACSys:CFIClVentFan:AssignedArea   = {   ValidOr( FloorAreaServed[1], 0 )  }    ; SAC 5/1/19

	"Specify ResHVACSys:CFIClVentFan:* properties (when necessary)"	ResProj:Action		= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3) then  EvalRulelist( "SetupCFIHVACSysClVentFan_UserInputs" )  else  UNCHANGED  endif  }

   ; SAC 2/22/18 - added ClVentFan:HERSVerification to facilitate CF1R population (tic #977)
   "Set ResClVentFan:HERSVerification"    ResClVentFan:HERSVerification = {
         if (ResProj:EnergyCodeYearNum >= 2019 .AND. NumAssignments > 0 .AND.
             (IfValidAnd( ResProj:ClVentVerified > 0 ) .OR. ResProj:UnitClVentOption == 3 .OR.
              ResProj:UnitClVentOption == 2))  ; SAC 4/23/19 - force verification when specifying indiv fans (tic #1023)
         then  1  else  0  endif  }

	; SAC 6/4/14 - per instruction from BAW - setup GSHP DHWHeater as a standard design electric htr
	"Setup Standard DHW Heater properties for GSHP HVAC system used as DWHtr"
			ResHVACSys:Action		= {	if (	TypeOK < 0.5 .OR. HtEqpCanBeDHWHtr < 0.5 .OR. ServesAsDHWHtr < 0.5 .OR. 
													IfValidAnd( Type = 2 )==0 .OR. IfValidAnd( HtPumpSysType = 12 )==0 ) then  UNCHANGED
											else	Evalrulelist( "SetupHVACSysDWHeater_GSHP", 1 )  endif  }

   ; SAC 1/19/18 - moved deletion of EUseSummary & EnergyUse objects from results processing rulelists to HERE (tic #966)
   "Blast all EUseSummary components prior to analysis"  ResProj:Action  = {  DeleteAllComps( EUseSummary )  }
   "Blast all EnergyUse components prior to analysis"    ResProj:Action  = {  DeleteAllComps( EnergyUse   )  }

END
;*************************************************************************

; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_DwellUnitDHW" 1 0 0 0
;*************************************************************************
	"Initiate creation of DHWSys & DHWHeater for DwellUnitType objects that have HVAC heating-based DHW"
			DwellUnitType:Action		= {	if (HtEqpUsedAsDHWHtr < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
													else	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW", 1 )  endif  }

	"Eval ProposedInput rules to re-default all DHWSys & DwellUnit properties effected by the above DHWSys/Heater creation/assignment"
			ResProj:Action	= {	EvalRulelist( "ProposedInput" )  }
END

; SAC 9/3/15 - added new rules to prep model for DHW - DwellUnitType objects that have HVAC htg equip serving as DHW heaters
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW" 1 0 1 0
;*************************************************************************
	"Set DwellUnitType:NumDHWSysTypes to 1"		DwellUnitType:NumDHWSysTypes	= {	1  }
	"Create new DHWSys to serve this DUT"			DwellUnitType:DHWSysRef[1]		= {	CreateComp( ResDHWSys, Name + "-dhwsys" )  }

	"Set new DUT DHWSys:SystemType"			DwellUnitType:DHWSysRef[1]:SystemType		= {	DHWSystemType  }
	"Set new DUT DHWSys:SolFracType"			DwellUnitType:DHWSysRef[1]:SolFracType		= {	DHWSolFracType  }
	"Set new DUT DHWSys:SolFracAnn"			DwellUnitType:DHWSysRef[1]:SolFracAnn		= {	DHWSolFracAnn   }
	"Set new DUT DHWSys:SolFracMon[1]"		DwellUnitType:DHWSysRef[1]:SolFracMon[1]	= {	DHWSolFracMon[1]   }
	"Set new DUT DHWSys:SolFracMon[2]"		DwellUnitType:DHWSysRef[1]:SolFracMon[2]	= {	DHWSolFracMon[2]   }
	"Set new DUT DHWSys:SolFracMon[3]"		DwellUnitType:DHWSysRef[1]:SolFracMon[3]	= {	DHWSolFracMon[3]   }
	"Set new DUT DHWSys:SolFracMon[4]"		DwellUnitType:DHWSysRef[1]:SolFracMon[4]	= {	DHWSolFracMon[4]   }
	"Set new DUT DHWSys:SolFracMon[5]"		DwellUnitType:DHWSysRef[1]:SolFracMon[5]	= {	DHWSolFracMon[5]   }
	"Set new DUT DHWSys:SolFracMon[6]"		DwellUnitType:DHWSysRef[1]:SolFracMon[6]	= {	DHWSolFracMon[6]   }
	"Set new DUT DHWSys:SolFracMon[7]"		DwellUnitType:DHWSysRef[1]:SolFracMon[7]	= {	DHWSolFracMon[7]   }
	"Set new DUT DHWSys:SolFracMon[8]"		DwellUnitType:DHWSysRef[1]:SolFracMon[8]	= {	DHWSolFracMon[8]   }
	"Set new DUT DHWSys:SolFracMon[9]"		DwellUnitType:DHWSysRef[1]:SolFracMon[9]	= {	DHWSolFracMon[9]   }
	"Set new DUT DHWSys:SolFracMon[10]"		DwellUnitType:DHWSysRef[1]:SolFracMon[10]	= {	DHWSolFracMon[10]  }
	"Set new DUT DHWSys:SolFracMon[11]"		DwellUnitType:DHWSysRef[1]:SolFracMon[11]	= {	DHWSolFracMon[11]  }
	"Set new DUT DHWSys:SolFracMon[12]"		DwellUnitType:DHWSysRef[1]:SolFracMon[12]	= {	DHWSolFracMon[12]  }

	"Create new DHWHeater to serve this DUT"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]	= {	CreateComp( ResWtrHtr, Name + "-dhwhtr" )  }

   ; SAC 1/13/16 - separated out DHWHeater settings to handle air to water heat pump (AWHP) source DHW for MFam models (tic 560)
   ; SAC 7/29/18 - removed all logic pertaining to DHWCalcMethod (related to transition from T24DHW DLLs to CSE)
	"Set DHWHeater properties for this DwellUnitType"	DwellUnitType:Action		= {	if (IfValidAnd( HVACSysType == 2 ) .AND. IfValidAnd( HVACHtPumpRef[1]:Type == 11 ) .AND.
																													 IfValidAnd( ServesAsDHWHtr > 0.5 ) )
																												then	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW_AWHP",   1 )
																												else	EvalRulelist( "OneTimeAnalysisPrep_CreateDwellUnitDHW_Normal", 1 )  endif  }
END

; SAC 1/13/16 - separated out DHWHeater settings to handle air to water heat pump (AWHP) source DHW for MFam models (tic 560)
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW_AWHP" 1 0 1 0
	"Set new DUT DHWHeater:HeaterElementType"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HeaterElementType		= {	5  }	; "Heat Pump"     ; SAC 10/29/19 - switch AWHP sim type from 3 (old) to 5 (new model) (tic #1134)
	"Set new DUT DHWHeater:HPWH_NEEARated flag"	DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HPWH_NEEARated			= {	0  }	; fixes problem where NEEA Brand & Model required - SAC 6/14/20 (tic #1185)
	"Set new DUT DHWHeater:IsHydronic flag"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IsHydronic					= {	1  }	; setting this flag should cause proper setup of CSE input for AWHP DHW
	"Set new DUT DHWHeater:TankType"					DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankType					= {	1  }	; "Indirect"
;	"Set new DUT DHWHeater:InputRating"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRating				= {	DHWInputRating  }
;;	"Set new DUT DHWHeater:InputRatingUnits"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRatingUnits			= {	DHWInputRatingUnits  }
;	"Set new DUT DHWHeater:EnergyFactor"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:EnergyFactor				= {	DHWEnergyFactor  }
	"Set new DUT DHWHeater:TankVolume"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankVolume					= {	DHWTankVolume  }
	"Set new DUT DHWHeater:IntInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IntInsulRVal				= {	DHWIntInsulRVal  }
	"Set new DUT DHWHeater:ExtInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:ExtInsulRVal				= {	DHWExtInsulRVal  }
	"Set new DUT DHWHeater:AmbientCond"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:AmbientCond				= {	DHWAmbientCond  }
;	"Set new DUT DHWHeater:StandbyLossFrac"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:StandbyLossFrac			= {	DHWStandbyLossFrac  }
END
;*************************************************************************
RULELIST "OneTimeAnalysisPrep_CreateDwellUnitDHW_Normal" 1 0 1 0
	"Set new DUT DHWHeater:HeaterElementType"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:HeaterElementType		= {	DHWHeaterElementType  }
	"Set new DUT DHWHeater:TankType"					DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankType					= {	DHWTankType  }
	"Set new DUT DHWHeater:InputRating"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRating				= {	DHWInputRating  }
;	"Set new DUT DHWHeater:InputRatingUnits"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:InputRatingUnits			= {	DHWInputRatingUnits  }
	"Set new DUT DHWHeater:EnergyFactor"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:EnergyFactor				= {	DHWEnergyFactor  }
	"Set new DUT DHWHeater:TankVolume"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:TankVolume					= {	DHWTankVolume  }
	"Set new DUT DHWHeater:IntInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:IntInsulRVal				= {	DHWIntInsulRVal  }
	"Set new DUT DHWHeater:ExtInsulRVal"			DwellUnitType:DHWSysRef[1]:DHWHeater[1]:ExtInsulRVal				= {	DHWExtInsulRVal  }
	"Set new DUT DHWHeater:AmbientCond"				DwellUnitType:DHWSysRef[1]:DHWHeater[1]:AmbientCond				= {	DHWAmbientCond  }
	"Set new DUT DHWHeater:StandbyLossFrac"		DwellUnitType:DHWSysRef[1]:DHWHeater[1]:StandbyLossFrac			= {	DHWStandbyLossFrac  }
		;	0,  "DHWHeater",  "Water Heater",  "Water Heater <i>",      0,  0,  0, "",        "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   8000
		;	1,           "Status",             BEMP_Sym,  1,  0,  0, "",             0,  0,                        3008, "Status"                                      
		;	1,           "EfficiencyUnits",    BEMP_Str,  1,  0,  0, "",             0,  0,                        1003, "DHW heater energy factor or efficiency units"   
		;	1,           "AltEnergyFactor",    BEMP_Flt,  1,  0,  0, "",             0,  0,                        1003, "Altered reqs. for DHW system energy factor or efficiency"   
END

;*************************************************************************
RULELIST "SetupHVACSysDWHeater_GSHP" 1 0 1 1
;*************************************************************************
;	"Set ResHVACSys:DHWHeaterElementType"		ResHVACSys:DHWHeaterElementType	= {      0  }			; Electric Resistance
;	"Set ResHVACSys:DHWEnergyFactor"				ResHVACSys:DHWEnergyFactor			= {  0.97	}			; "Small Storage" 
; SAC 4/24/15 - revised GSHP DHW inputs to reflect performance based on HPWH inputs supplied in GC 514 issue
	"Set ResHVACSys:DHWHeaterElementType"		ResHVACSys:DHWHeaterElementType	= {      3  }			; Air-Source Heat Pump
	"Set ResHVACSys:DHWEnergyFactor"				ResHVACSys:DHWEnergyFactor			= {	if (ResProj:Fuel_HaveNatGas > 0.5) then  2.8  else  1.85  endif	}		; EF 		; SAC 11/10/15

;	"Set ResHVACSys:DHWEfficiencyUnits"			ResHVACSys:DHWEfficiencyUnits		= {   "EF"  }			; "Small Storage" 
	"Set ResHVACSys:DHWInputRating"				ResHVACSys:DHWInputRating			= {	8000  }			; (watts)
	"Set ResHVACSys:DHWInputRatingUnits"		ResHVACSys:DHWInputRatingUnits	= {  "watts"  }
	"Set ResHVACSys:DHWTankType"					ResHVACSys:DHWTankType				= {  "Small Storage"  }		; %WHTYPE_SSTOR = 6
	"Set ResHVACSys:DHWTankVolume"				ResHVACSys:DHWTankVolume			= {	  50  }			; "Small Storage" 
	"Set ResHVACSys:DHWIntInsulRVal"				ResHVACSys:DHWIntInsulRVal			= {	   0  }
	"Set ResHVACSys:DHWExtInsulRVal"				ResHVACSys:DHWExtInsulRVal			= {	   0  }
	"Set ResHVACSys:DHWStandbyLossFrac"			ResHVACSys:DHWStandbyLossFrac		= {	   0  }
END
;*************************************************************************

;*************************************************************************
RULELIST "SetupDefaultClVentFan" 1 0 1 1
   "Set ResClVentFan:DefaultSystem"			ResClVentFan:DefaultSystem		= {	1     }
   ; SAC 2/12/18 - replaced 'hard-coded' 0.1 W/CFM default WHF power value w/ look-up table entry to accommodate 2019 update (tic #977)
   ;"Set ResClVentFan:WperCFMCool"			ResClVentFan:WperCFMCool		= {	0.10  }
   "Set ResClVentFan:WperCFMCool"			ResClVentFan:WperCFMCool		= {	T24RClimateZoneCodeBase:WHFWperCFM( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
   "Set ResClVentFan:CoolingVent"			ResClVentFan:CoolingVent		= {	ResProj:UnitClVentCFMTot  }
   "Set ResClVentFan:NumAssignments"		ResClVentFan:NumAssignments	= {	1  }
   "Set ResClVentFan:AssignedArea"		   ResClVentFan:AssignedArea	   = {	ValidOr( ResProj:CondFloorArea, 0 )  }    ; SAC 5/1/19
END
;*************************************************************************
RULELIST "SetupCFIHVACSysClVentFan" 1 0 1 1
   "Set ResClVentFan:DefaultSystem"			ResClVentFan:DefaultSystem		= {	0  }
   "Set ResClVentFan:NumAssignments"		ResClVentFan:NumAssignments	= {	1  }
END
;*************************************************************************
RULELIST "SetupCFIHVACSysClVentFan_UserInputs" 1 0 1 1
	"Specify ResHVACSys:CFIClVentFan:CoolingVent"	ResHVACSys:CFIClVentFan:CoolingVent	= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CFIClVentFlow  else  UNCHANGED  endif  }
	"Specify ResHVACSys:CFIClVentFan:WperCFMCool"	ResHVACSys:CFIClVentFan:WperCFMCool	= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3 .AND.
																															(Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0.5)))
																													then  CFIClVentPwr  else  UNCHANGED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "SetupDefaultIAQFan_1" 1 0 1 1
   "Set #1 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[1]  }
   "Set #1 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_2" 1 0 1 1
   "Set #2 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[2]  }
   "Set #2 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_3" 1 0 1 1
   "Set #3 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[3]  }
   "Set #3 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_4" 1 0 1 1
   "Set #4 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[4]  }
   "Set #4 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_5" 1 0 1 1
   "Set #5 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[5]  }
   "Set #5 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_6" 1 0 1 1
   "Set #6 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[6]  }
   "Set #6 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_7" 1 0 1 1
   "Set #7 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[7]  }
   "Set #7 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_8" 1 0 1 1
   "Set #8 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[8]  }
   "Set #8 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_9" 1 0 1 1
   "Set #9 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[9]  }
   "Set #9 ResIAQFan:*"					ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_10" 1 0 1 1
   "Set #10 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[10]  }
   "Set #10 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_11" 1 0 1 1
   "Set #11 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[11]  }
   "Set #11 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_12" 1 0 1 1
   "Set #12 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[12]  }
   "Set #12 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_13" 1 0 1 1
   "Set #13 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[13]  }
   "Set #13 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_14" 1 0 1 1
   "Set #14 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[14]  }
   "Set #14 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_15" 1 0 1 1
   "Set #15 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[15]  }
   "Set #15 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_16" 1 0 1 1
   "Set #16 ResIAQFan:IAQCFM"			ResIAQFan:IAQCFM		= {	ResProj:UnitMinIAQCFM[16]  }
   "Set #16 ResIAQFan:*"				ResIAQFan:Action		= {	EvalRulelist( "SetupDefaultIAQFan_ALL", 1 )  }
END
;*************************************************************************
RULELIST "SetupDefaultIAQFan_ALL" 1 0 1 1
   ; revised 2019.2.0+ ResIAQFan:WperCFMIAQ to be based on other vs. balanced rather than SFam vs. MFam - SAC 7/20/20 (tic #1174)
   ; SAC 2/12/20 - installed new std design ResIAQFan:WperCFMIAQ of 0.3 & 0.6 for SFam/MFam as new defaults (tic #1174)
   "Set SFam ResIAQFan:WperCFMIAQ"			ResIAQFan:WperCFMIAQ     =       ; revised DefaultIAQFanPwr unbal 0.3->0.35 - SAC 01/19/21 (tic #1243) 
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
		   then  0.35
		   else  0.25     ; Stand Alone IAQ Fan (prior to 2019.2.0)
		   endif  }
   "Set SFam ResIAQFan:IAQFanType"			ResIAQFan:IAQFanType     = {  1  }    ; "Exhaust"
   "Set SFam ResIAQFan:IAQRecovEffect"		ResIAQFan:IAQRecovEffect = {  0  }    ; No Heat Recovery ...MJB 4/22/13	
   "Set SFam ResIAQFan:IncludesRecov"     ResIAQFan:IncludesRecov  = {  0  }    ; SAC 2/5/20 (tic #1174)
   "Set SFam ResIAQFan:IAQFanTypeStr"		ResIAQFan:IAQFanTypeStr  = {  EnumString( IAQFanType )  }
   "Set SFam ResIAQFan:NumAssignments"		ResIAQFan:NumAssignments = {	1  }
   "Default ResIAQFan:HERSVerified"       ResIAQFan:HERSVerified     = {  0  }   ; SAC 7/21/20 (tic #1174)
   "Set ResIAQFan:FanPowerMult"           ResIAQFan:FanPowerMult     = {  1  }   ; not used for SFam
   "Set ResIAQFan:FanHeatRecovMult"       ResIAQFan:FanHeatRecovMult = {  1  }   ; not used for SFam
END
;*************************************************************************


; SAC 12/5/13 - replaced individual equipment-based HVACHeat budget conversion mechanism w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_CntrlFurnace" 1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
   "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
; "DBG msg" ResHVACSys:Action = { MessageBox( "Setup_HVACSys_Heat_CntrlFurnace -> ResHVACSys:HtSysAFUE = %g  (status = %g)", HtSysAFUE, LocalStatus( HtSysAFUE ) ) }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WallFurnaceFan"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_Boiler"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		  ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor" 	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		    ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set ResHVACSys:HtSysAFUE"				    ResHVACSys:HtSysAFUE				= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WoodHeat"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		  ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"   ResHVACSys:HtSysSizingFactor	= {	2  }   
	"Set ResHVACSys:HtSysCapacity"		    ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set ResHVACSys:HtSysAFUE"				    ResHVACSys:HtSysAFUE				= {	78  } ; See tic 632, wood heat 
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_WallFurnaceGravity"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_FloorFurnace"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_RoomHeater"       1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif  endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_Electric"     1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Heat_CombHydro"    1 0 1 0
	"Set ResHVACSys:AutoSizeHeat[1]"		ResHVACSys:AutoSizeHeat[1]		= {	1  }
  "Set ResHVACSys:HtSysSizingFactor"	ResHVACSys:HtSysSizingFactor	= {	2  }   ; BAW changed from 1.5 to 2 130508
	"Set ResHVACSys:HtSysCapacity"		ResHVACSys:HtSysCapacity		= {	UNDEFINED  }
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HtSysAFUE"				ResHVACSys:HtSysAFUE				= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																									HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE ) > 10)
																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingAFUE )
																							else	
																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																								else
																									T24RHeatingEquipment:AFUE( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																								endif endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACHeat_CntrlFurnace" 1 0 1 0
  "Set ResHtgSys:Type to CntrlFurnace" 	ResHtgSys:Type	= {	1  }	; "CntrlFurnace"
	"Call subordinate rulelist to default generic heating system data"			ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_CntrlFurnace"  , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_WallFurnaceFan"       1 0 1 0
  "Set ResHtgSys:Type to WallFurnaceFan"       	ResHtgSys:Type	= {	2  }	; "WallFurnaceFan"
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_WallFurnaceFan"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_Boiler"       1 0 1 0
  "Set ResHtgSys:Type to Boiler"       	ResHtgSys:Type	= {	3  }	; "Boiler"
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
  "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_Boiler"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_WallFurnaceGravity"       1 0 1 0
   "Set ResHtgSys:Type to Heater"       	ResHtgSys:Type	= {	14  }	; "WallFurnaceGravity"		- SAC 11/25/14 - value 4->14
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_WallFurnaceGravity"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_FloorFurnace"       1 0 1 0
   "Set ResHtgSys:Type to Heater"       	ResHtgSys:Type	= {	15  }	; "FloorFurnace"		- SAC 11/25/14 - value 5->15
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_FloorFurnace"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_RoomHeater"       1 0 1 0
   "Set ResHtgSys:Type to Heater"       	ResHtgSys:Type	= {	16  }	; "RoomHeater"			- SAC 11/25/14 - value 6->16
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_RoomHeater"        , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_Electric"     1 0 1 0
   "Set ResHtgSys:Type to Electric"     	ResHtgSys:Type	= {	8  }	; "Electric"
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_Electric"      , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHeat_CombHydro"    1 0 1 0
   "Set ResHtgSys:Type to CombHydro"    	ResHtgSys:Type	= {	9  }	; "CombHydro"
	"Call subordinate rulelist to default generic heating system data"	      ResHtgSys:Action = {	EvalRulelist( "Default_HVACHeat", 1 )  }
   "Call subordinate rulelist to default type-specific heating system data"	ResHtgSys:Action = {	EvalRulelist( "Default_Heat_CombHydro"     , 1 )  }
END
;*************************************************************************


; SAC 1/13/14 - sdded rulelsit to facilitate change of overall ResHVACSys:Type from Other to HtPump (for GC #265)
;*************************************************************************
RULELIST "SwitchSystemToHeatPump"		1 0 1 1   ; prevent Resets so that HtPumpSystem assignment(s) do not get blown away

	"Set ResHVACSys:Type"		ResHVACSys:Type	= {	2  }	; "Heat Pump Heating and Cooling System"
; MANUALLY RESET certain HVACSys properties based on change of ResHVACSys:Type to Heat Pump
	"Blast ResHVACSys:CFIClVentOption     "		ResHVACSys:CFIClVentOption     	= {	UNDEFINED  }
	"Blast ResHVACSys:CFIClVentFan        "		ResHVACSys:CFIClVentFan        	= {	UNDEFINED  }
	"Blast ResHVACSys:AutoSizeHeatInp     "		ResHVACSys:AutoSizeHeatInp     	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSysTypeSetup    "		ResHVACSys:HeatSysTypeSetup    	= {	UNDEFINED  }
	"Blast ResHVACSys:ConstHtgSetpt       "		ResHVACSys:ConstHtgSetpt       	= {	UNDEFINED  }
	"Blast ResHVACSys:AutoSizeCoolInp     "		ResHVACSys:AutoSizeCoolInp     	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSysTypeSetup    "		ResHVACSys:CoolSysTypeSetup    	= {	UNDEFINED  }
	"Blast ResHVACSys:ConstClgSetpt       "		ResHVACSys:ConstClgSetpt       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[1]       "		ResHVACSys:HeatSystem[1]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[2]       "		ResHVACSys:HeatSystem[2]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[3]       "		ResHVACSys:HeatSystem[3]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[4]       "		ResHVACSys:HeatSystem[4]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[5]       "		ResHVACSys:HeatSystem[5]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[6]       "		ResHVACSys:HeatSystem[6]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[7]       "		ResHVACSys:HeatSystem[7]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[8]       "		ResHVACSys:HeatSystem[8]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[9]       "		ResHVACSys:HeatSystem[9]       	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatSystem[10]      "		ResHVACSys:HeatSystem[10]      	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[1]       "		ResHVACSys:CoolSystem[1]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[2]       "		ResHVACSys:CoolSystem[2]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[3]       "		ResHVACSys:CoolSystem[3]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[4]       "		ResHVACSys:CoolSystem[4]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[5]       "		ResHVACSys:CoolSystem[5]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[6]       "		ResHVACSys:CoolSystem[6]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[7]       "		ResHVACSys:CoolSystem[7]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[8]       "		ResHVACSys:CoolSystem[8]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[9]       "		ResHVACSys:CoolSystem[9]       	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolSystem[10]      "		ResHVACSys:CoolSystem[10]      	= {	UNDEFINED  }
	"Blast ResHVACSys:HeatDucted          "		ResHVACSys:HeatDucted         	= {	UNDEFINED  }
	"Blast ResHVACSys:CoolDucted          "		ResHVACSys:CoolDucted         	= {	UNDEFINED  }
	"Blast ResHVACSys:HtPumpDucted        "		ResHVACSys:HtPumpDucted       	= {	UNDEFINED  }
	"Blast ResHVACSys:NumHeatSystemTypes  "		ResHVACSys:NumHeatSystemTypes  	= {	UNDEFINED  }
	"Blast ResHVACSys:NumHtPumpSystemTypes"		ResHVACSys:NumHtPumpSystemTypes	= {	UNDEFINED  }
	"Blast ResHVACSys:NumCoolSystemTypes  "		ResHVACSys:NumCoolSystemTypes  	= {	UNDEFINED  }
	; NOT defaulted above:
   ;	 ResHVACSys:HtPumpSystem[ALL]

	"Default ResHVACSys:NumHtPumpSystemTypes"	ResHVACSys:NumHtPumpSystemTypes	= {	if (IfValidAnd( Type == 2 )==0) then  0		; Type invalid or NOT = 2
																										else if (LocalCompAssigned( HtPumpSystem[10] )) then  10
																										else if (LocalCompAssigned( HtPumpSystem[9]  )) then   9
																										else if (LocalCompAssigned( HtPumpSystem[8]  )) then   8
																										else if (LocalCompAssigned( HtPumpSystem[7]  )) then   7
																										else if (LocalCompAssigned( HtPumpSystem[6]  )) then   6
																										else if (LocalCompAssigned( HtPumpSystem[5]  )) then   5
																										else if (LocalCompAssigned( HtPumpSystem[4]  )) then   4
																										else if (LocalCompAssigned( HtPumpSystem[3]  )) then   3
																										else if (LocalCompAssigned( HtPumpSystem[2]  )) then   2  else  1  endif endif endif endif endif endif endif endif endif endif  }

	"Initialize HVACSys HtPump properties"		ResHVACSys:Action		= {	EvalRulelist( "SetupHVACSys_Round1_HeatPump", 1 )  }
	"Call subordinate rulelist to default generic heat pump system data"
		ResHtPumpSys:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
	"Call subordinate rulelist to default type-specific heat pump system data"
		ResHtPumpSys:Action = {	switch (Local( Type ))
											case  4 :  EvalRulelist( "Default_HtPump_SplitHeatPump"   , 1 )   ; "SplitHeatPump - Heating side of central split heat pump"
											case 10 :  EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump", 1 )   ; "DuctlessHeatPump - Heating side of ductless mini-split heat pump"
											case  5 :  EvalRulelist( "Default_HtPump_PkgHeatPump"     , 1 )   ; "PkgHeatPump - Heating side of central packaged heat pump"
											case  6 :  EvalRulelist( "Default_HtPump_LrgPkgHeatPump"  , 1 )   ; "LrgPkgHeatPump - Heating side of large (>= 65 kBtuh) packaged unit"
											case  7 :  EvalRulelist( "Default_HtPump_RoomHeatPump"    , 1 )   ; "RoomHeatPump - Heating side of non-central room A/C system"
											default :  EvalRulelist( "Default_HtPump_unknown", 1 )
										endswitch  }
	"Round2 of HVACSys HtPump property init"		ResHVACSys:Action		= {	EvalRulelist( "SetupHVACSys_Round2_HeatPump", 1 )  }
END

; SAC 12/5/13 - replaced individual equipment-based HVACHtPump budget conversion mechanism (above) w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_SplitHeatPump"       1 0 1 0
; SAC 1/13/14 - added rule to switch system type to HtPump (if it isn't already set)
	"Ensure ResHVACSys:Type set to HtPump"		ResHVACSys:Action	= {	if (Type != 2 && LocalCompAssigned( HtPumpSystem[1] ) > 0)
																					then  EvalRulelist( "SwitchSystemToHeatPump", 1 )  else  UNCHANGED  endif  }

   "Set ResHVACSys:EffMetric depending on StandardsVersion"    ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if (ResProj:StdsVersionYr < 2022) then  1
         else  2 endif  }

   ; mjb	12/9/13 - added logic for E+A+A
   "Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

   ; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL heating equipment beter/equal/worse status (rather than only a comparison of AFUE or HSPF)
	"Set ResHVACSys:HPSysHSPF"						ResHVACSys:HPSysHSPF			= {	if (EffMetric > 1) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF	( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																									endif endif endif  }
	"Set ResHVACSys:HPSysHSPF2"					ResHVACSys:HPSysHSPF2		=                 ; SAC 10/09/22 (tic #3431)
                                                                     {	if (EffMetric < 2) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																									endif endif endif  }
   "Set ResHVACSys:HPSysHSPF2perHSPF"     ResHVACSys:HPSysHSPF2perHSPF     = {	if (EffMetric < 2 .OR. T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) < 1) then  0
                                                                           else  T24RHeatingEquipment:HSPF2perHSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  endif  }      ; SAC 10/09/22 (tic #3431)

   "Set ResHVACSys:HPSysAutoSize"            ResHVACSys:HPSysAutoSize         = {  0  }
   "Set ResHVACSys:HPSysCap47"					ResHVACSys:HPSysCap47				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysMinCap47"				ResHVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set ResHVACSys:HPSysCap35"					ResHVACSys:HPSysCap35				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCap17"					ResHVACSys:HPSysCap17				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP47"					ResHVACSys:HPSysCOP47				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP35"					ResHVACSys:HPSysCOP35				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP17"					ResHVACSys:HPSysCOP17				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysAuxHtgCap"				ResHVACSys:HPSysAuxHtgCap			= {	0  }  ; if (LocalStatus( HPSysCap47 ) < 2) then  UNDEFINED  else  (HPSysCap47 * 10)  endif  }
   "Set ResHVACSys:HPModelDualFuel"			   ResHVACSys:HPModelDualFuel		   = {	0  }     ; SAC 12/08/20
;	"debug Setup Split HP"	ResHVACSys:Action	=	{ if (FloorAreaServed > 0.5) then PostWarning( "Setup_HVACSys_HtPump_SplitHeatPump -> ResHVACSys:HPSysHSPF = %g", HPSysHSPF ) else UNCHANGED endif }
END
; SAC 1/7/16 - added SDHVSplitHeatPump (small duct, high velocity) heating type (tic 598)
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_SDHVSplitHeatPump"       1 0 1 0
	"Ensure ResHVACSys:Type set to HtPump"		ResHVACSys:Action	= {	if (Type != 2 && LocalCompAssigned( HtPumpSystem[1] ) > 0)
																					then  EvalRulelist( "SwitchSystemToHeatPump", 1 )  else  UNCHANGED  endif  }

   "Set ResHVACSys:EffMetric depending on StandardsVersion"    ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if (ResProj:StdsVersionYr < 2022) then  1
         else  2 endif  }

   "Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

	"Set ResHVACSys:HPSysHSPF"						ResHVACSys:HPSysHSPF			= {	if (EffMetric > 1) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF	( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																									endif endif endif  }
	"Set ResHVACSys:HPSysHSPF2"					ResHVACSys:HPSysHSPF2		=                 ; SAC 10/09/22 (tic #3431)
                                                                     {	if (EffMetric < 2) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										HeatEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 ) > 5)	; SAC 12/23/14 - updated limit from 10 to 5 per mjb advice
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingHSPF	 )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  
																									endif endif endif  }
   "Set ResHVACSys:HPSysHSPF2perHSPF"     ResHVACSys:HPSysHSPF2perHSPF     = {	if (EffMetric < 2 .OR. T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) < 1) then  0
                                                                           else  T24RHeatingEquipment:HSPF2perHSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  endif  }      ; SAC 10/09/22 (tic #3431)

   "Set ResHVACSys:HPSysAutoSize"            ResHVACSys:HPSysAutoSize         = {  0  }
   "Set ResHVACSys:HPSysCap47"					ResHVACSys:HPSysCap47				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysMinCap47"				ResHVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set ResHVACSys:HPSysCap35"					ResHVACSys:HPSysCap35				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCap17"					ResHVACSys:HPSysCap17				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP47"					ResHVACSys:HPSysCOP47				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP35"					ResHVACSys:HPSysCOP35				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysCOP17"					ResHVACSys:HPSysCOP17				= {	0  }  ; UNDEFINED  }
   "Set ResHVACSys:HPSysAuxHtgCap"				ResHVACSys:HPSysAuxHtgCap			= {	0  }  ; if (LocalStatus( HPSysCap47 ) < 2) then  UNDEFINED  else  (HPSysCap47 * 10)  endif  }
   "Set ResHVACSys:HPModelDualFuel"			   ResHVACSys:HPModelDualFuel		   = {	0  }     ; SAC 12/08/20
;	"debug Setup Split HP"	ResHVACSys:Action	=	{ if (FloorAreaServed > 0.5) then PostWarning( "Setup_HVACSys_HtPump_SplitHeatPump -> ResHVACSys:HPSysHSPF = %g", HPSysHSPF ) else UNCHANGED endif }
END
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_DuctlessMiniSplitHeatPump"       1 0 1 0
   "Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22

   "Set ResHVACSys:EffMetric depending on StandardsVersion"    ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if (ResProj:StdsVersionYr < 2022) then  1
         else  2 endif  }

   "Set ResHVACSys:HPSysHSPF"					ResHVACSys:HPSysHSPF					= {  if (EffMetric > 1) then  UNCHANGED
                                                                           else  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  endif  }
   "Set ResHVACSys:HPSysHSPF2"				ResHVACSys:HPSysHSPF2				= {	if (EffMetric < 2) then  UNCHANGED
                                                                           else  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  endif  }
   "Set ResHVACSys:HPSysHSPF2perHSPF"     ResHVACSys:HPSysHSPF2perHSPF     = {	if (EffMetric < 2 .OR. T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) ) < 1) then  0
                                                                           else  T24RHeatingEquipment:HSPF2perHSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdHeatingType ) )  endif  }      ; SAC 10/09/22 (tic #3431)

   "Set ResHVACSys:HPSysAutoSize"         ResHVACSys:HPSysAutoSize         = {  0  }
   "Set ResHVACSys:HPSysCap47"					ResHVACSys:HPSysCap47				= {	0  }  
   "Set ResHVACSys:HPSysMinCap47"				ResHVACSys:HPSysMinCap47			= {	0  }     ; SAC 03/11/21
   "Set ResHVACSys:HPSysCap35"					ResHVACSys:HPSysCap35				= {	0  }  
   "Set ResHVACSys:HPSysCap17"					ResHVACSys:HPSysCap17				= {	0  }  
   "Set ResHVACSys:HPSysCOP47"					ResHVACSys:HPSysCOP47				= {	0  }  
   "Set ResHVACSys:HPSysCOP35"					ResHVACSys:HPSysCOP35				= {	0  }  
   "Set ResHVACSys:HPSysCOP17"					ResHVACSys:HPSysCOP17				= {	0  }  
   "Set ResHVACSys:HPSysAuxHtgCap"			ResHVACSys:HPSysAuxHtgCap		= {	0  }  
   "Set ResHVACSys:HPModelDualFuel"			ResHVACSys:HPModelDualFuel		= {	0  }     ; SAC 12/08/20

	"Set ResHVACSys:ClSysSEER"           ResHVACSys:ClSysSEER             = {   if (EffMetric > 1) then  UNCHANGED
                                                                           else  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }
	"Set ResHVACSys:ClSysSEER2"          ResHVACSys:ClSysSEER2            = {   if (EffMetric < 2) then  UNCHANGED
                                                                        else  T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"   ResHVACSys:ClSysSEER2perSEER     =              ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER					= {
											if (EffMetric > 1) then  UNCHANGED
                                 else if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif  }
	"Set ResHVACSys:ClSysEER2"				ResHVACSys:ClSysEER2					=              ; SAC 10/09/22 (tic #3431)
										{	if (EffMetric < 2) then  UNCHANGED
                                 else if (LocalStatus( ClSysSEER2 ) < 1) then  UNDEFINED
											else if (			  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												   ClSysSEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	 13                                   * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	(11.3 + (0.57 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else	(10   + (0.84 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											endif endif endif endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"    ResHVACSys:ClSysEER2perEER    =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	"Set ResHVACSys:ClSysCFMperTon"       		ResHVACSys:ClSysCFMperTon        = {	T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_HtPump_RoomHeatPump" 1 0 1 0
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr	= {	UNDEFINED  }
   "Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set ResHVACSys:HtPump:IsMultiSpeed"		ResHtPumpSys:IsMultiSpeed			= {	0  }
;	"Set ResHVACSys:HtPump:IsZonal"				ResHtPumpSys:IsZonal				= {	0  }
; no setting of HSPF, Cap47, ... ??
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACHtPump_SplitHeatPump"       1 0 1 0
   "Set ResHtPumpSys:Type to SplitHeatPump"       	ResHtPumpSys:Type	= {	4  }	; "SplitHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      ResHtPumpSys:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
   "Call subordinate rulelist to default type-specific heat pump system data"	ResHtPumpSys:Action = {	EvalRulelist( "Default_HtPump_SplitHeatPump" , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHtPump_DuctlessMiniSplitHeatPump"       1 0 1 0
   "Set ResHtPumpSys:Type to DuctlessHeatPump"     	ResHtPumpSys:Type	= {	10  }	; "DuctlessHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      ResHtPumpSys:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
  "Call subordinate rulelist to default type-specific heat pump system data"	ResHtPumpSys:Action = {	EvalRulelist( "Default_HtPump_DuctlessMiniSplitHeatPump" , 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACHtPump_RoomHeatPump" 1 0 1 0
   "Set ResHtPumpSys:Type to RoomHeatPump" 	ResHtPumpSys:Type	= {	7  }	; "RoomHeatPump"
	"Call subordinate rulelist to default generic heat pump system data"	      ResHtPumpSys:Action = {	EvalRulelist( "Default_HVACHeatPump", 1 )  }
  "Call subordinate rulelist to default type-specific heat pump system data"	ResHtPumpSys:Action = {	EvalRulelist( "Default_HtPump_RoomHeatPump"  , 1 )  }
END
;*************************************************************************

; SAC 12/5/13 - replaced individual equipment-based HVACCool budget conversion mechanism (above) w/ following that sets data directly to the HVACSys object(s)
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_SplitAirCond" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set ResHVACSys:AutoSizeCool[1]"				ResHVACSys:AutoSizeCool[1]			= {	1  }
	"Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set ResClgSys:IsMultiSpeed"				ResClgSys:IsMultiSpeed		= {	0  }
;	"Set ResClgSys:IsZonal"						ResClgSys:IsZonal				= {	0  }

; SAC 12/26/14 - added logic to set based on existing/verified value - and do this BEFORE resetting ClSysSEER or use of an existing SEER value can screw up the logic
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
; KN 02/24/2015 to support use of codebase for setting verified charge. Concerned about how many different places this same variable is set
; KN 02/24/2015 old version of test replaced by codebase call	;else if (Proj:CliZnNum == 2 .OR. (Proj:CliZnNum >= 8 .AND. Proj:CliZnNum <= 15))
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr	= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																												CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																												MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingFChg ) > 0.0001)
																										then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingFChg )
																										else if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																										else if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																										then	0.96 ; verified, CID
																										else	0.90 ; not verified
																										endif endif endif  }
   ; moved up from below to set iff existing equipment where ClSysCFMperTon & ClSysSEER invalid but SEERValid for StdCoolingType - SAC 09/13/21 (user/CEC support)
   "Set ResHVACSys:ClSysCFMperTon"        ResHVACSys:ClSysCFMperTon  =
      {  if (ResProj:RunScope != 2 .OR. Status != 1 .OR.
             ( IfValidAnd( ClSysSEER > 0 )==0 .AND. IfValidAnd( ClSysCFMperTon > 0 )==0 .AND.
               T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) ))
         then  T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
         else  UNCHANGED  endif  }

                  ;"dbg" ResHVACSys:Action = { PostMessageToLog( "   b4 setting model %s HVACSys '%s' EffMetric - was %g", Proj:RunAbbrev, Name, EffMetric ) }
   "Set ResHVACSys:EffMetric depending on StandardsVersion, RunScope & Status"   ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if ( (ResProj:RunScope == 2 .AND. Status == 1) .OR.    ; existing
              (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5) ) then  UNCHANGED   
         else if (ResProj:StdsVersionYr < 2022) then  1
         else  2
         endif endif  }
                  ;"dbg" ResHVACSys:Action = { PostMessageToLog( "      after: EffMetric = %g", EffMetric ) }

   ; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
   ; added logic to ensure SEER lookup for existing equipment where ClSysSEER invalid but SEERValid for StdCoolingType - SAC 09/13/21 (user/CEC support)
	"Set ResHVACSys:ClSysSEER"						ResHVACSys:ClSysSEER			=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric > 1) then  UNCHANGED
         else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
             CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
             MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
         then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
         else
            if (ResProj:RunScope != 2 .OR. Status != 1 .OR.
                ( IfValidAnd( ClSysSEER > 0 )==0 .AND.
                  T24RCoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) ))
            then  T24RCoolingEquipment:SEER(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
            else  UNCHANGED
            endif endif endif  }
	"Set ResHVACSys:ClSysSEER2"					ResHVACSys:ClSysSEER2		=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric < 2) then  UNCHANGED
         else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
             CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
             MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
         then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
         else
            if (ResProj:RunScope != 2 .OR. Status != 1 .OR.
                ( IfValidAnd( ClSysSEER2 > 0 )==0 .AND.
                  T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) ))
            then  T24RCoolingEquipment:SEER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
            else  UNCHANGED
            endif endif endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER  =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER				= {
											if (EffMetric > 1) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13)then		11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif endif  }
	"Set ResHVACSys:ClSysEER2"						ResHVACSys:ClSysEER2				=        ; SAC 09/19/22 (tic #1331)
										{	if (EffMetric < 2) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
                                 else if (LocalStatus( ClSysSEER2 ) < 1) then  UNCHANGED
                                 else if (T24RCoolingEquipment:EER2Valid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0)
											then  if (			        T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												         ClSysSEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											      then					  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											      else if (ClSysSEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                       then	 13                                   * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											      else if (ClSysSEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                       then	(11.3 + (0.57 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                         - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											      else	(10   + (0.84 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                         - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
                                       endif endif endif
                                 else  UNCHANGED
											endif endif endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"    ResHVACSys:ClSysEER2perEER    =           ; SAC 09/19/22 (tic #1331)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

;	"Set ResHVACSys:ClSysCFMperTon"       		ResHVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
;	mjb	8/21/14	E+A+A - do NOT allow tradeoffs with existing CFMperTon (CEC direction)
;	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
;																										ClSysCFMperTon >= 350 .AND. MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon ) > 100)
;																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon )
;																								else	
;																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
;																									else
;																										350  
;																									endif endif  }
; mjb 1/30/15 - mods to look up std. CFMperTon from T24RClimateZoneCodeBase
;	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED else 350 endif  }
;	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED else T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) endif  }

;	"debug HVAC"			ResHVACSys:Action = { PostWarning( "Setup_HVACSys_Cool_SplitAirCond  ResHVACSys: '%s'  ClSysSEER: %g   ClSysEER: %g",  Name, ClSysSEER, ClSysEER )  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_RoomAirCond" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set ResHVACSys:AutoSizeCool[1]"				ResHVACSys:AutoSizeCool[1]			= {	1  }
	"Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
;	"Set ResClgSys:IsMultiSpeed"				ResClgSys:IsMultiSpeed		= {	0  }
;	"Set ResClgSys:IsZonal"						ResClgSys:IsZonal				= {	0  }

   "Set ResHVACSys:EffMetric depending on StandardsVersion, RunScope & Status"   ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if ( (ResProj:RunScope == 2 .AND. Status == 1) .OR.    ; existing
              (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5) ) then  UNCHANGED   
         else if (ResProj:StdsVersionYr < 2022) then  1
         else  2
         endif endif  }

;	"Set ResHVACSys:ClSysSEER"            		ResHVACSys:ClSysSEER				= {   T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  }

	"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER				=        ; SAC 10/09/22 (tic #3431)
                              {  if (EffMetric > 1) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else UNCHANGED
											endif endif endif endif }
	"Set ResHVACSys:ClSysEER2"						ResHVACSys:ClSysEER2				=        ; SAC 10/09/22 (tic #3431)
                              {  if (EffMetric < 2) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER2 ) < 1) then  UNCHANGED
											else if (T24RCoolingEquipment:EER2Valid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0)
											then  if (		        T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												      ClSysSEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											      then				  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											      else  UNCHANGED  endif
											else UNCHANGED
											endif endif endif endif }
   "Set ResHVACSys:ClSysEER2perEER"    ResHVACSys:ClSysEER2perEER    =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set ResHVACSys:ClSysSEER"						ResHVACSys:ClSysSEER			=     ; SAC 10/09/22 (tic #3431)
                                                                     {  if (EffMetric > 1) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else	1.07 * ClSysEER
																									endif endif endif }
	"Set ResHVACSys:ClSysSEER2"					ResHVACSys:ClSysSEER2		=     ; SAC 10/09/22 (tic #3431) - assume same SEER2/EER2 ratio as SEER/EER...?
      {  if (EffMetric < 2) then  UNCHANGED
         else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
         then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
         else
            if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
				else	1.07 * ClSysEER2
            endif endif endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER  =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	;"Set ResHVACSys:ClSysSEER"						ResHVACSys:ClSysSEER			= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
	;																									ClSysSEER >= T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) .AND.
	;																									MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
	;																							then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
	;																							else	
	;																								if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
	;																								else
	;																									T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  
	;																								endif endif  }

	;"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER				= {
	;										if (LocalStatus( ClSysSEER ) < 1) then  UNCHANGED
	;										else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
	;											  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
	;										then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
	;										else if (ClSysSEER >= 16) then	13
	;										else if (ClSysSEER >= 13)then		11.3 + (0.57 * (ClSysSEER - 13  ))
	;										else										10   + (0.84 * (ClSysSEER - 11.5))
	;										endif endif endif endif  }
    ;
;	"Set ResHVACSys:ClSysCFMperTon"       		ResHVACSys:ClSysCFMperTon        = {  350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_SplitHeatPump" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set ResHVACSys:AutoSizeCool[1]"				ResHVACSys:AutoSizeCool[1]			= {	1  }
	"Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
;	"Set ResClgSys:IsMultiSpeed"				ResClgSys:IsMultiSpeed		= {	0  }
;	"Set ResClgSys:IsZonal"						ResClgSys:IsZonal				= {	0  }

; SAC 12/26/14 - added logic to set based on existing/verified value - and do this BEFORE resetting ClSysSEER or use of an existing SEER value can screw up the logic
; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
; KN 02/24/2015 to support use of codebase for setting verified charge. Concerned about how many different places this same variable is set
; KN 02/24/2015 old version of test replaced by codebase call	;else	if (Proj:CliZnNum == 2 .OR. (Proj:CliZnNum >= 8 .AND. Proj:CliZnNum <= 15))
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr = {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																												CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																												MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingFChg ) > 0.0001)
																										then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingFChg )
																										else	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																												then	0.96 ; verified,CID
																												else	0.90 ; not verified
																												endif endif  }

   "Set ResHVACSys:EffMetric depending on StandardsVersion, RunScope & Status"   ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if ( (ResProj:RunScope == 2 .AND. Status == 1) .OR.    ; existing
              (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5) ) then  UNCHANGED   
         else if (ResProj:StdsVersionYr < 2022) then  1
         else  2
         endif endif  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set ResHVACSys:ClSysSEER"						ResHVACSys:ClSysSEER			=     ; SAC 10/09/22 (tic #3431)
                                                                     {  if (EffMetric > 1) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  
																									endif endif endif  }
	"Set ResHVACSys:ClSysSEER2"					ResHVACSys:ClSysSEER2		=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric < 2) then  UNCHANGED
         else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
             CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
             MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
         then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
         else
            if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
            else  T24RCoolingEquipment:SEER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
            endif endif endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER  =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER					=     ; SAC 10/09/22 (tic #3431)
                              {  if (EffMetric > 1) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif endif  }
	"Set ResHVACSys:ClSysEER2"						ResHVACSys:ClSysEER2					=     ; SAC 09/19/22 (tic #1331) - assumes same SEER2/EER2 ratio as SEER/EER...?
										{	if (EffMetric < 2) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER2 ) < 1) then  UNCHANGED
											else if (			  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												   ClSysSEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	 13                                   * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	(11.3 + (0.57 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else	(10   + (0.84 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											endif endif endif endif endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"    ResHVACSys:ClSysEER2perEER    =           ; SAC 09/19/22 (tic #1331)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

;	"Set ResHVACSys:ClSysCFMperTon"       		ResHVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }
END
;*************************************************************************
RULELIST "Setup_HVACSys_Cool_RoomHeatPump" 1 0 1 0
; mjb	12/9/13 - added logic for E+A+A
;				  - for E+A+A, do NOT Verify EER, just SEER
	"Set ResHVACSys:AutoSizeCool[1]"				ResHVACSys:AutoSizeCool[1]			= {	1  }
	"Set ResHVACSys:ClSysSizingFactor"			ResHVACSys:ClSysSizingFactor		= {	1.2  }      ; SAC 02/25/22
	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
;	"Set ResClgSys:IsMultiSpeed"				ResClgSys:IsMultiSpeed		= {	0  }
;	"Set ResClgSys:IsZonal"						ResClgSys:IsZonal				= {	0  }

   "Set ResHVACSys:EffMetric depending on StandardsVersion, RunScope & Status"   ResHVACSys:EffMetric =     ; SAC 10/09/22 (tic #3431)
      {  if ( (ResProj:RunScope == 2 .AND. Status == 1) .OR.    ; existing
              (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5) ) then  UNCHANGED   
         else if (ResProj:StdsVersionYr < 2022) then  1
         else  2
         endif endif  }

; SAC 12/26/14 - replaced logic triggering use of existing/verified properties to reflect OVERALL cooling equipment beter/equal/worse status (rather than only a comparison of SEER)
	"Set ResHVACSys:ClSysSEER"						ResHVACSys:ClSysSEER			=     ; SAC 10/09/22 (tic #3431)
                                                                     {  if (EffMetric > 1) then  UNCHANGED
                                                                        else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
																										T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  
																									endif endif endif  }
	"Set ResHVACSys:ClSysSEER2"					ResHVACSys:ClSysSEER2		=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric < 2) then  UNCHANGED
         else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
               CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
               MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER ) > 5)
         then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingSEER )
         else
            if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
            else  T24RCoolingEquipment:SEER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
            endif endif endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"     ResHVACSys:ClSysSEER2perSEER  =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

	"Set ResHVACSys:ClSysEER"						ResHVACSys:ClSysEER					=     ; SAC 10/09/22 (tic #3431)
                              {  if (EffMetric > 1) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER ) > 5)
											then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingEER )
											else if (LocalStatus( ClSysSEER ) < 1) then  UNDEFINED
											else if (			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												  ClSysSEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER >= 16) then	13
											else if (ClSysSEER >= 13) then	11.3 + (0.57 * (ClSysSEER - 13  ))
											else										10   + (0.84 * (ClSysSEER - 11.5))
											endif endif endif endif endif endif  }
	"Set ResHVACSys:ClSysEER2"						ResHVACSys:ClSysEER2					=     ; SAC 10/09/22 (tic #3431) - assumes same SEER2/EER2 ratio as SEER/EER...?
										{	if (EffMetric < 2) then  UNCHANGED
                                 else if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
													CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
													MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER ) > 5)
											then	MaxRevRef( Zone:AltHVACSystem, Zone:VerifExistingEER )
											else if (LocalStatus( ClSysSEER2 ) < 1) then  UNCHANGED
											else if (			  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) > 0 .AND.
												   ClSysSEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
											then					  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	 13                                   * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else if (ClSysSEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )))
                                 then	(11.3 + (0.57 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											else	(10   + (0.84 * ((ClSysSEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ))
                                                                   - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )
											endif endif endif endif endif endif  }
   "Set ResHVACSys:ClSysEER2perEER"    ResHVACSys:ClSysEER2perEER    =           ; SAC 10/09/22 (tic #3431)
                                                   {  if (EffMetric < 2 .OR. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) ) < 1) then  0
                                                      else  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", EnumString( StdCoolingType ) )  endif  }

;	"Set ResHVACSys:ClSysCFMperTon"       		ResHVACSys:ClSysCFMperTon        = {	350  }
; mjb	12/9/13	E+A+A - consider what correct min existing airflow per ton should be?  right now its 100
; mjb 1/30/15 - mods to lookup std. CFMperTon from T24RClimateZoneCodeBase
	"Set ResHVACSys:ClSysCFMperTon"				ResHVACSys:ClSysCFMperTon		= {	if (ResProj:RunScope == 2 .AND. Status == 2 .AND. IsVerified .AND.
																										CoolEqpVsStandard >= 0 .AND.		; => equal or better than standard
																										MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon ) > 100)
																								then	MaxRevRef( ResZn:AltHVACSystem, ResZn:VerifExistingCFMperTon )
																								else	
																									if (ResProj:RunScope == 2 .AND. Status == 1) then UNCHANGED
																									else
;																										350  
																										T24RClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
																									endif endif  }

	"Set ResHVACSys:ClSysRefrigChgAdjFctr"		ResHVACSys:ClSysRefrigChgAdjFctr = {	UNDEFINED  }
END
;*************************************************************************

; SAC 8/16/19 - rulelist to force Proposed model VCHP performance to Std design levels (tic #1148)
; replaced 'EnumString( StdHeatingType )' in table look-ups w/ 'HtPumpSysTypeAbbrev' - SAC 04/07/21
; SEER2/EER2/HSPF2 - SAC 10/09/22 (tic #3431)
;************************************************************************* 
RULELIST "Setup_HVACSys_ProposedVCHP" 1 0 1 0
;   "Set ResHVACSys:HPSysHSPF"    ResHVACSys:HPSysHSPF  = {  T24RHeatingEquipment:HSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  }
;   "Set ResHVACSys:ClSysSEER"    ResHVACSys:ClSysSEER  = {  T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  }
;   "Set ResHVACSys:ClSysEER"     ResHVACSys:ClSysEER   = {  T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )  }
   "Set ResHVACSys:HPSysHSPF"    ResHVACSys:HPSysHSPF  = {  if (EffMetric < 2)
                                                      then  T24RHeatingEquipment:HSPF(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:HPSysHSPF2"   ResHVACSys:HPSysHSPF2 = {  if (EffMetric = 2)
                                                      then  T24RHeatingEquipment:HSPF2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:HPSysHSPF2perHSPF"   ResHVACSys:HPSysHSPF2perHSPF =           ; SAC 09/19/22 (tic #1331)
                                                   {  if (EffMetric = 2 .AND. T24RHeatingEquipment:HSPF2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
                                                      then  T24RHeatingEquipment:HSPF2perHSPF( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysSEER"    ResHVACSys:ClSysSEER  = {  if (EffMetric < 2)
                                                      then  T24RCoolingEquipment:SEER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysSEER2"   ResHVACSys:ClSysSEER2 = {  if (EffMetric = 2)
                                                      then  T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysSEER2perSEER"   ResHVACSys:ClSysSEER2perSEER =           ; SAC 09/19/22 (tic #1331)
                                                   {  if (EffMetric = 2 .AND. T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
                                                      then  T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysEER"     ResHVACSys:ClSysEER   = {  if (EffMetric < 2)
                                                      then  T24RCoolingEquipment:EER(   "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysEER2"    ResHVACSys:ClSysEER2  = {  if (EffMetric = 2)
                                                      then  T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
   "Set ResHVACSys:ClSysEER2perEER"   ResHVACSys:ClSysEER2perEER =           ; SAC 09/19/22 (tic #1331)
                                                   {  if (EffMetric = 2 .AND. T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0)
                                                      then  T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev )
                                                      else  UNCHANGED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Setup_HVACCool_SplitAirCond" 1 0 1 0
   "Set ResClgSys:Type to SplitAirCond" 	ResClgSys:Type	= {	2  }	; "SplitAirCond"
	"Call subordinate rulelist to default generic cooling system data"			ResClgSys:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	ResClgSys:Action = {	EvalRulelist( "Default_Cool_SplitAirCond", 1 )  }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
;	"Set ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	if (Proj:CliZnNum == 2 .OR. (Proj:CliZnNum >= 8 .AND. Proj:CliZnNum <= 15))
;																								then	0.96  ; verified
;																								else	0.90  ; not verified
;																								endif  }
; KN 03/24/2015 to use codebase to determine ACCharge
	"Set ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																								then	0.96  ; verified
																								else	0.90  ; not verified
																								endif  }

END
;*************************************************************************
RULELIST "Setup_HVACCool_RoomAirCond" 1 0 1 0
   "Set ResClgSys:Type to RoomAirCond" 		ResClgSys:Type	= {	5  }	; "RoomAirCond"
	"Call subordinate rulelist to default generic cooling system data"			ResClgSys:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	ResClgSys:Action = {	EvalRulelist( "Default_Cool_RoomAirCond", 1 )  }
END
;*************************************************************************
RULELIST "Setup_HVACCool_SplitHeatPump" 1 0 1 0
   "Set ResClgSys:Type to SplitHeatPump" 	ResClgSys:Type	= {	6  }	; "SplitHeatPump"
	"Call subordinate rulelist to default generic cooling system data"			ResClgSys:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	ResClgSys:Action = {	EvalRulelist( "Default_Cool_SplitHeatPump", 1 )  }
  ; SAC 3/4/13 - based on e-mail from BAW 3/1/13
;	"Set ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	if (Proj:CliZnNum == 2 .OR. (Proj:CliZnNum >= 8 .AND. Proj:CliZnNum <= 15))
;																								then	0.96
;																								else	0.90  endif  }
; KN 03/24/2015 to use codebase to determine ACCharge
	"Set ResClgSys:RefrigChgAdjFctr"		ResClgSys:RefrigChgAdjFctr	= {	if (T24RClimateZoneCodeBase:VerifyCharge( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr ) > 0.5 )
																								then	0.96  ; verified
																								else	0.90  ; not verified
																								endif  }

END
;*************************************************************************
RULELIST "Setup_HVACCool_RoomHeatPump" 1 0 1 0
   "Set ResClgSys:Type to RoomHeatPump" 	ResClgSys:Type	= {	10  }	; "RoomHeatPump"
	"Call subordinate rulelist to default generic cooling system data"			ResClgSys:Action = {	EvalRulelist( "Default_HVACCool", 1 )  }
   "Call subordinate rulelist to default type-specific cooling system data"	ResClgSys:Action = {	EvalRulelist( "Default_Cool_RoomHeatPump", 1 )  }
END
;*************************************************************************


;;*************************************************************************
;RULELIST "Setup_HVACSys_CoolVent" 1 0 1 1
;	"Set CoolVent system type"		ResHVACSys:Type	= {	10  }		; "Cooling Ventilation System"
;END
;;*************************************************************************
;RULELIST "Setup_HVACFan_CoolVent" 1 0 1 1
;	"Set CoolVent fan type"			ResFanSys:Type	= {	2  }		; "Whole House Fan"
;END
;;*************************************************************************


;	mjb	8/1/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACCool_EER" 1 0 0 0
;*************************************************************************

   "Set SEER from SEER2 iff EffMetric set to SEER2 & SEER2 is valid"    ResClgSys:SEER	=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric == 2 .AND. Proj:StdDesignBase >= 2019)
         then  if (IfValidAnd( SEER2 > 0 ) .AND.
                   T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
               then  SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
               else  UNCHANGED  endif
         else  UNCHANGED  endif  }

	"Reset EER if UseEERinAnalysis not checked"		
	ResClgSys:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
							SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
		then T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10   + (0.84 * (SEER - 11.5))
		endif endif endif endif  }
	"Reset ResClgSys:EERRpt"		ResClgSys:EERRpt	= {	if (IfValidAnd( EER > 0 )) then  FltToStr( EER, 11 )  else  "N/A"  endif   }
;	"debug HVAC"			ResClgSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "ForceDefault_HVACCool_EER  ResClgSys: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }

   "Set EER2 from EER iff EffMetric set to SEER2/EER2 & EER is valid"     ResClgSys:EER2	=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric == 2 .AND. Proj:StdDesignBase >= 2019)
         then  if (IfValidAnd( EER > 0 ) .AND.
                   T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
               then  EER * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
               else  UNCHANGED  endif
         else  UNCHANGED  endif  }
END

;************************************************************************* SAC 10/09/22 (tic #3431)
RULELIST "ForceDefault_HVACCool_EER2" 1 0 0 0
;*************************************************************************

	"Reset EER2 if UseEERinAnalysis not checked"		
	ResClgSys:EER2	= {	
		if (LocalStatus( SEER2 ) < 1) then UNCHANGED
		else if (	T24RCoolingEquipment:EER2Valid(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
							SEER2 == T24RCoolingEquipment:SEER2( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
		then T24RCoolingEquipment:EER2(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
      then   13                         * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
      then  (11.3 + (0.57 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                              - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else  (10   + (0.84 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                              - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		endif endif endif endif  }
	"Reset ResClgSys:EERRpt"		ResClgSys:EERRpt	= {	if (IfValidAnd( EER2 > 0 )) then  FltToStr( EER2, 11 )  else  "N/A"  endif   }
;	"debug HVAC"			ResClgSys:Action = { if (FloorAreaServed > 0.5) then PostWarning( "ForceDefault_HVACCool_EER  HVACCool: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }

END


; SAC 1/13/14 - added rulelists to FORCE Window Height/Width to be UNDEFINED when Win:SpecMethod = "Overall Window Area" and Area to be defaulted when Win:SpecMethod = "...Dimensions..."

;	em	10/30/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACHtPump_EER" 1 0 0 0
;*************************************************************************

   "Set SEER from SEER2 iff EffMetric set to SEER2 & SEER2 is valid"    ResHtPumpSys:SEER	=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric == 2 .AND. IfValidAnd( SEER2 > 0 ) .AND.
             T24RCoolingEquipment:SEER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
         then  if (T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
               then  SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
               else  UNCHANGED  endif
         else  UNCHANGED  endif  }

	"Reset EER if UseEERinAnalysis not checked"
	ResHtPumpSys:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
					SEER == T24RCoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
		then			T24RCoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10 + (0.84 * (SEER - 11.5))
 		endif endif endif endif  }
	;"Reset ResHtPumpSys:EERRpt"		ResHtPumpSys:EERRpt	= {	EER   }

   "Set EER2 from EER iff EffMetric set to SEER2/EER2 & EER is valid"     ResHtPumpSys:EER2	=     ; SAC 10/09/22 (tic #3431)
      {  if (EffMetric == 2 .AND. IfValidAnd( EER > 0 ) .AND.
             T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
         then  if (T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0)
               then  EER * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
               else  UNCHANGED  endif
         else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "ForceDefault_HVACHtPump_EER2" 1 0 0 0
;*************************************************************************

	"Reset EER2 if UseEERinAnalysis not checked"       ; SAC 10/09/22 (tic #3431)
	ResHtPumpSys:EER2	= {	
		if (LocalStatus( SEER2 ) < 1) then UNCHANGED
		else if (	      T24RCoolingEquipment:EER2Valid( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ) > 0 .AND.
					SEER2 == T24RCoolingEquipment:SEER2(     "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
		then			      T24RCoolingEquipment:EER2(      "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER2 >= (16 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
      then   13                         * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else if (SEER2 >= (13 * T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )))
      then  (11.3 + (0.57 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                              - 13  ))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
		else  (10   + (0.84 * ((SEER2 / T24RCoolingEquipment:SEER2perSEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr ))
                              - 11.5))) * T24RCoolingEquipment:EER2perEER( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", TypeAbbrevStr )
 		endif endif endif endif  }
	;"Reset HVACHtPump:EERRpt"		ResHtPumpSys:EERRpt	= {	EER   }

END


;*************************************************************************
RULELIST "ForceDefault_ResProj_ACH50" 1 0 0 0
;*************************************************************************
	"Redefault ResProj:ACH50"		ResProj:ACH50	= {	UNDEFINED  }
END


;*************************************************************************
RULELIST "ForceDefault_Zone_HVAC" 1 0 0 0
;*************************************************************************
;	mjb	10/14/14	assign HVACSystem from ActiveHVACSystem for IsAddAlone
	"Set HVACSystem to ActiveHVACSystem"	ResZn:HVACSystem			=	{	ActiveHVACSystem	}
   "Force HVACSys Status to Existing"		ResZn:HVACSystem:Status	=  {  1 }
   ; SAC 4/10/15 - modified rule to allow selection of New or Existing+New for New Cons Addition Alone
   "Force HVACDist Status to Existing (in some cases)"
   		ResZn:HVACSystem:DistribSystem:Status	= {	if (ResProj:RunScope == 2) then  UNCHANGED	; need to keep Status as is for EAA
   																	else if (ResProj:IsAddAlone > 0.5 .AND. IfValidAnd( HVACSystem:DistribSystem:Status = 2)) then  1
   																	else if (ResProj:IsAddAlone < 0.5) then  1
   																	else  UNCHANGED  endif endif endif  }
END
;*************************************************************************


;*************************************************************************  ; added to ensure *:CFMperTon is defaulted for equipment where it is not editable - SAC 08/20/20 (tic #1003)
RULELIST "Blast_HVACHtPump_CFMperTon" 1 0 0 0
   "Blast ResHtPumpSys:CFMperTon"  ResHtPumpSys:CFMperTon = {  UNDEFINED  }
END
;*************************************************************************
RULELIST "Blast_HVACCool_CFMperTon" 1 0 0 0
   "Blast ResClgSys:CFMperTon"    ResClgSys:CFMperTon   = {  UNDEFINED  }
END
;*************************************************************************


; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumHeatSystemTypes (same for Cool & HtPump)
;*************************************************************************
RULELIST "ForceReset_HeatSystem_1" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[1]"				ResHVACSys:HeatSystem[1]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[1]"		ResHVACSys:HeatSystemCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_2" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[2]"				ResHVACSys:HeatSystem[2]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[2]"		ResHVACSys:HeatSystemCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_3" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[3]"				ResHVACSys:HeatSystem[3]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[3]"		ResHVACSys:HeatSystemCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_4" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[4]"				ResHVACSys:HeatSystem[4]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[4]"		ResHVACSys:HeatSystemCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_5" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[5]"				ResHVACSys:HeatSystem[5]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[5]"		ResHVACSys:HeatSystemCount[5]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_6" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[6]"				ResHVACSys:HeatSystem[6]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[6]"		ResHVACSys:HeatSystemCount[6]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_7" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[7]"				ResHVACSys:HeatSystem[7]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[7]"		ResHVACSys:HeatSystemCount[7]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_8" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[8]"				ResHVACSys:HeatSystem[8]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[8]"		ResHVACSys:HeatSystemCount[8]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_9" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[9]"				ResHVACSys:HeatSystem[9]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[9]"		ResHVACSys:HeatSystemCount[9]		= {	UNDEFINED  }
END
RULELIST "ForceReset_HeatSystem_10" 1 0 0 0
	"Force reset of ResHVACSys:HeatSystem[10]"			ResHVACSys:HeatSystem[10]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HeatSystemCount[10]"		ResHVACSys:HeatSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_CoolSystem_1" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[1]"				ResHVACSys:CoolSystem[1]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[1]"		ResHVACSys:CoolSystemCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_2" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[2]"				ResHVACSys:CoolSystem[2]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[2]"		ResHVACSys:CoolSystemCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_3" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[3]"				ResHVACSys:CoolSystem[3]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[3]"		ResHVACSys:CoolSystemCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_4" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[4]"				ResHVACSys:CoolSystem[4]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[4]"		ResHVACSys:CoolSystemCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_5" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[5]"				ResHVACSys:CoolSystem[5]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[5]"		ResHVACSys:CoolSystemCount[5]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_6" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[6]"				ResHVACSys:CoolSystem[6]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[6]"		ResHVACSys:CoolSystemCount[6]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_7" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[7]"				ResHVACSys:CoolSystem[7]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[7]"		ResHVACSys:CoolSystemCount[7]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_8" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[8]"				ResHVACSys:CoolSystem[8]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[8]"		ResHVACSys:CoolSystemCount[8]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_9" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[9]"				ResHVACSys:CoolSystem[9]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[9]"		ResHVACSys:CoolSystemCount[9]		= {	UNDEFINED  }
END
RULELIST "ForceReset_CoolSystem_10" 1 0 0 0
	"Force reset of ResHVACSys:CoolSystem[10]"			ResHVACSys:CoolSystem[10]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:CoolSystemCount[10]"		ResHVACSys:CoolSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_HtPumpSystem_1" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[1]"				ResHVACSys:HtPumpSystem[1]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[1]"		ResHVACSys:HtPumpSystemCount[1]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_2" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[2]"				ResHVACSys:HtPumpSystem[2]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[2]"		ResHVACSys:HtPumpSystemCount[2]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_3" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[3]"				ResHVACSys:HtPumpSystem[3]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[3]"		ResHVACSys:HtPumpSystemCount[3]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_4" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[4]"				ResHVACSys:HtPumpSystem[4]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[4]"		ResHVACSys:HtPumpSystemCount[4]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_5" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[5]"				ResHVACSys:HtPumpSystem[5]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[5]"		ResHVACSys:HtPumpSystemCount[5]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_6" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[6]"				ResHVACSys:HtPumpSystem[6]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[6]"		ResHVACSys:HtPumpSystemCount[6]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_7" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[7]"				ResHVACSys:HtPumpSystem[7]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[7]"		ResHVACSys:HtPumpSystemCount[7]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_8" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[8]"				ResHVACSys:HtPumpSystem[8]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[8]"		ResHVACSys:HtPumpSystemCount[8]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_9" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[9]"				ResHVACSys:HtPumpSystem[9]			= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[9]"		ResHVACSys:HtPumpSystemCount[9]	= {	UNDEFINED  }
END
RULELIST "ForceReset_HtPumpSystem_10" 1 0 0 0
	"Force reset of ResHVACSys:HtPumpSystem[10]"				ResHVACSys:HtPumpSystem[10]		= {	UNDEFINED  }
	"Force reset of ResHVACSys:HtPumpSystemCount[10]"		ResHVACSys:HtPumpSystemCount[10]	= {	UNDEFINED  }
END
;*************************************************************************

;************************************************************************* SAC 09/03/22
RULELIST "ForceReset_DwellUnitType_NumHeatCoolEquipTypes" 1 0 0 0
	"Force reset of DwellUnitType:NumHeatEquipTypes"		DwellUnitType:NumHeatEquipTypes		= {	UNDEFINED  }
	"Force reset of DwellUnitType:NumCoolEquipTypes"		DwellUnitType:NumCoolEquipTypes		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_NumHtPumpEquipTypes" 1 0 0 0
	"Force reset of DwellUnitType:NumHtPumpEquipTypes"		DwellUnitType:NumHtPumpEquipTypes	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on DwellUnitType:NumHeatEquipTypes (same for Cool & HtPump)
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_HeatEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[1]"			DwellUnitType:HVACHeatRef[1]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[1]"		DwellUnitType:HeatEquipCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[2]"			DwellUnitType:HVACHeatRef[2]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[2]"		DwellUnitType:HeatEquipCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[3]"			DwellUnitType:HVACHeatRef[3]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[3]"		DwellUnitType:HeatEquipCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[4]"			DwellUnitType:HVACHeatRef[4]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[4]"		DwellUnitType:HeatEquipCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HeatEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACHeatRef[5]"			DwellUnitType:HVACHeatRef[5]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:HeatEquipCount[5]"		DwellUnitType:HeatEquipCount[5]		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_CoolEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[1]"			DwellUnitType:HVACCoolRef[1]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[1]"		DwellUnitType:CoolEquipCount[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[2]"			DwellUnitType:HVACCoolRef[2]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[2]"		DwellUnitType:CoolEquipCount[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[3]"			DwellUnitType:HVACCoolRef[3]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[3]"		DwellUnitType:CoolEquipCount[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[4]"			DwellUnitType:HVACCoolRef[4]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[4]"		DwellUnitType:CoolEquipCount[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_CoolEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACCoolRef[5]"			DwellUnitType:HVACCoolRef[5]			= {	UNDEFINED  }
	"Force reset of DwellUnitType:CoolEquipCount[5]"		DwellUnitType:CoolEquipCount[5]		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_1" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[1]"			DwellUnitType:HVACHtPumpRef[1]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[1]"		DwellUnitType:HtPumpEquipCount[1]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_2" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[2]"			DwellUnitType:HVACHtPumpRef[2]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[2]"		DwellUnitType:HtPumpEquipCount[2]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_3" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[3]"			DwellUnitType:HVACHtPumpRef[3]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[3]"		DwellUnitType:HtPumpEquipCount[3]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_4" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[4]"			DwellUnitType:HVACHtPumpRef[4]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[4]"		DwellUnitType:HtPumpEquipCount[4]	= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_HtPumpEquip_5" 1 0 0 0
	"Force reset of DwellUnitType:HVACHtPumpRef[5]"			DwellUnitType:HVACHtPumpRef[5]		= {	UNDEFINED  }
	"Force reset of DwellUnitType:HtPumpEquipCount[5]"		DwellUnitType:HtPumpEquipCount[5]	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 10/21/19
RULELIST "ForceReset_IAQFan_SensRecovEff" 1 0 0 0
	"Force reset of ResIAQFan:SensRecovEff"			ResIAQFan:SensRecovEff		= {	UNDEFINED  }
	"Force reset of ResIAQFan:AdjSensRecovEff"		ResIAQFan:AdjSensRecovEff	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 2/5/20 (tic #1174)
RULELIST "ForceOn_IAQFan_IncludesRecov" 1 0 1 1
   "Force ResIAQFan:IncludesRecov ON"           ResIAQFan:IncludesRecov  = {  1  }
   "post warning re: new SRE/ASRE inputs"    ResIAQFan:Action  = {
      if (NumAssignments < 1) then  UNCHANGED
      else  PostWarning( "IAQ fan '%s' was modeled with heat recovery using out of date inputs. New inputs for SRE & ASRE must be specified before analysis can be performed.", Name )  endif  }
END
;*************************************************************************
RULELIST "ForceReset_IAQFan_IAQRecovEffect" 1 0 0 0
   "Force reset of ResIAQFan:IAQRecovEffect"    ResIAQFan:IAQRecovEffect  = {  UNDEFINED  }
END
;*************************************************************************

;*************************************************************************    ; SAC 2/7/20 (tic #1174)
RULELIST "Interpolate_IAQFan_SRE_ASRE" 1 0 0 0
   "Set ResIAQFan:HVIListedInterpFrac"       ResIAQFan:HVIListedInterpFrac  =
      {  (IAQCFM - HVIListedInterpCFM[1]) / (HVIListedInterpCFM[2] - HVIListedInterpCFM[1])  }
   "Interpolate ResIAQFan:SensRecovEff"      ResIAQFan:SensRecovEff  =
      {  int( HVIListedInterpSRE[1]  + ( (HVIListedInterpSRE[2]  - HVIListedInterpSRE[1] ) * HVIListedInterpFrac ) + 0.5 )  }
   "Interpolate ResIAQFan:AdjSensRecovEff"   ResIAQFan:AdjSensRecovEff  =
      {  int( HVIListedInterpASRE[1] + ( (HVIListedInterpASRE[2] - HVIListedInterpASRE[1]) * HVIListedInterpFrac ) + 0.5 )  }
END
;*************************************************************************


  ; LDH - Rulelist to Blast DwellUnit Objects for Single Family Projects
;*************************************************************************
RULELIST "BlastDwellingUnit" 1 0 0 0
  "Post Warning Message for Dwelling Unit Purge"  DwellUnit:Action = {
    PostWarning( "Specification of Dwelling Units in not valid for single family projects.  Dwelling Unit 
                  '%s' will be purged.", 
                  Name ) }

  "Blast Dwelling Unit"  DwellUnit:Action = { DeleteComp() }  
END

  ; LDH - Rulelist to Reset Zone Status Properties for 'Newly Constructed' Projects
;*************************************************************************
RULELIST "ResetZoneStatus_New" 1 0 0 1

; ---------- Reset Zone Status ------------------------------------------------------------------------------
  "Post Warning Regarding ResZn:Status Reset"    ResZn:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects, all zones must have Status 'New'.  Zone '%s' Status
                        will be reset to 'New'.", Name )
    else UNCHANGED
    endif }

  "Reset ResZn:Status based on ResProj:RunScope"  ResZn:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Attic Status -----------------------------------------------------------------------------
  "Post Warning Regarding Attic:Status Reset"    ResAttic:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects, all Attics must have Status 'New'.  Attic '%s' Status
                        will be reset to 'New'.", Name )
    else UNCHANGED
    endif }

  "Reset Attic:Status based on ResProj:RunScope"  ResAttic:Status = {
    if( Status != 3 )   
    then "New"
    else UNCHANGED
    endif }
END


  ; LDH - Rulelist to Reset Envelope Status Properties for Zones with Status = New
;*************************************************************************
RULELIST "ResetEnvelopeObjectStatus_New" 1 0 0 1

   ; SAC 7/19/17 - revised all rules to first confirm that surface is child of Zone (as opposed to Garage) before reporting or changing Status (tic #768)
; ---------- Reset ExtWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding ExtWall:Status Reset"    ExtWall:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset ExtWall:Status to New"    ExtWall:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset ExteriorFloor Status ---------------------------------------------------------------------
  "Post Warning Regarding ExteriorFloor:Status Reset"    ExteriorFloor:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset ExteriorFloor:Status to New"    ExteriorFloor:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset CathedralCeiling Status ------------------------------------------------------------------
  "Post Warning Regarding CathedralCeiling:Status Reset"    CathedralCeiling:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset CathedralCeiling:Status to New"    CathedralCeiling:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset CeilingBelowAttic Status -----------------------------------------------------------------
  "Post Warning Regarding CeilingBelowAttic:Status Reset"    CeilingBelowAttic:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset CeilingBelowAttic:Status to New"    CeilingBelowAttic:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset FloorOverCrawl Status --------------------------------------------------------------------
  "Post Warning Regarding FloorOverCrawl:Status Reset"    FloorOverCrawl:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset FloorOverCrawl:Status to New"    FloorOverCrawl:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset IntWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding IntWall:Status Reset"    IntWall:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset IntWall:Status to New"    IntWall:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset UndWall Status ---------------------------------------------------------------------------
  "Post Warning Regarding UndWall:Status Reset"    UndWall:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset UndWall:Status to New"    UndWall:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset UndFloor Status --------------------------------------------------------------------------
  "Post Warning Regarding UndFloor:Status Reset"    UndFloor:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset UndFloor:Status to New"    UndFloor:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset SlabFloor Status -------------------------------------------------------------------------
  "Post Warning Regarding SlabFloor:Status Reset"    SlabFloor:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset SlabFloor:Status to New"    SlabFloor:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset InteriorFloor ----------------------------------------------------------------------------
  "Post Warning Regarding InteriorFloor:Status Reset"    InteriorFloor:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset InteriorFloor:Status to New"    InteriorFloor:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

; ---------- Reset InteriorCeiling Status -------------------------------------------------------------------
  "Post Warning Regarding InteriorCeiling:Status Reset"    InteriorCeiling:Action = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif endif }
  
"Reset InteriorCeiling:Status to New"    InteriorCeiling:Status = {
    if (ParentComponentType() != "ResZn") then  UNCHANGED
    else if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif endif }

   ; SAC 7/19/17 - switch granparent Status checks to parent since Parent2( Status ) for Garage is invalid (tic #768)
; ---------- Reset Window Status ----------------------------------------------------------------------------
  "Post Warning Regarding Window:Status Reset"    Window:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Window:Status to New"    Window:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Door Status ------------------------------------------------------------------------------
  "Post Warning Regarding Door:Status Reset"    Door:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Door:Status to New"    Door:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset Skylt Status -----------------------------------------------------------------------------
  "Post Warning Regarding Skylt:Status Reset"    Skylt:Action = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then PostWarning ( "'%s' Status will be reset to 'New' due to it's assignment to a zone with status
                             = 'New'", Name )
    else UNCHANGED
    endif }
  
"Reset Skylt:Status to New"    Skylt:Status = {
    if( Parent( Status ) = 3 .AND. Status != 3 )
    then "New"
    else UNCHANGED
    endif }
END


  ; LDH - Rulelist to Reset Envelope Status Properties for Zones with Status = New
;*************************************************************************
RULELIST "ResetMechStatus_New" 1 0 0 1

; ---------- Reset ResZn:HVACSysStatus -----------------------------------------------------------------------
  "Post Warning Regarding ResZn:HVACSysStatus Reset"    ResZn:Action = {
    if( HVACSysStatus != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  HVACSysStatus for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset ResZn:HVACSysStatus to New"    ResZn:HVACSysStatus = {
    if( HVACSysStatus != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset HVACSys Status ---------------------------------------------------------------------------
  "Post Warning Regarding ResHVACSys:Status Reset"    ResHVACSys:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset ResHVACSys:Status to New"    ResHVACSys:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset HVACDist Status ---------------------------------------------------------------------------
  "Post Warning Regarding ResHVACSys:Status Reset"    ResDistSys:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset ResHVACSys:Status to New"    ResDistSys:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset ResZn:DHWSys1Status -----------------------------------------------------------------------
  "Post Warning Regarding ResZn:DHWSys1Status Reset"    ResZn:Action = {
    if( DHWSys1Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  DHWSys1Status for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset ResZn:DHWSys1Status to New"    ResZn:DHWSys1Status = {
    if( DHWSys1Status != 3 )
    then "New"
    else UNCHANGED
    endif }

; ---------- Reset ResZn:DHWSys2Status -----------------------------------------------------------------------
  "Post Warning Regarding ResZn:DHWSys2Status Reset"    ResZn:Action = {
    if( DHWSys2Status != 3 .AND. Proj:IsSFamResRuleset)
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  DHWSys2Status for '%s' will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset ResZn:DHWSys2Status to New"    ResZn:DHWSys2Status = {
    if( DHWSys2Status != 3 )
    then "New"
    else UNCHANGED
    endif }
; ---------- Reset DHWSys Status ---------------------------------------------------------------------------
  "Post Warning Regarding DHWSys:Status Reset"    ResDHWSys:Action = {
    if( Status != 3 )
    then PostWarning ( "For 'Newly Constructed' projects which ARE NOT Additions/Alterations, all objects
                        must have Status 'New'.  '%s' Status will be reset to 'New'.", Name )
    else UNCHANGED
    endif }
  
"Reset DHWSys:Status to New"    ResDHWSys:Status = {
    if( Status != 3 )
    then "New"
    else UNCHANGED
    endif }

END
;*************************************************************************


;************************************************************************* SAC 04/08/21
RULELIST "SetupDwellUnitType_AreaServed" 1 0 0 1
   "Set DwellUnitType:DUFloorAreaServed"     DwellUnitType:DUFloorAreaServed =
      {  SumRevRef( DwellUnit:DwellUnitTypeRef, DwellUnit:TotalCondFlrAreaWithMult )  }
   "Set DwellUnitType:DUClFlrAreaServed iff this DUT has valid HVACCool assignments"            DwellUnitType:DUClFlrAreaServed =
      {  if (HVACSysType == 1 .AND. IfValidAnd( NumCoolEquipTypes > 0 ) .AND.
             IfValidAnd( HVACCoolRef[1]:Type > 1 ) .AND. IfValidAnd( CoolEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUHtFlrAreaServed iff this DUT has valid HVACHeat assignments"            DwellUnitType:DUHtFlrAreaServed =
      {  if (HVACSysType ==1 .AND. IfValidAnd( NumHeatEquipTypes > 0 ) .AND.
             IfValidAnd( HVACHeatRef[1]:Type > 0 ) .AND. IfValidAnd( HeatEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUHtPmpFlrAreaServed iff this DUT has valid HVACHtPump assignments"       DwellUnitType:DUHtPmpFlrAreaServed =
      {  if (HVACSysType == 2 .AND. IfValidAnd( NumHtPumpEquipTypes > 0 ) .AND.
             IfValidAnd( HVACHtPumpRef[1]:Type > 0 ) .AND. IfValidAnd( HtPumpEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUGasFurnAreaServed iff served by a gas furnace air handler"              DwellUnitType:DUGasFurnAreaServed =
      {  if (DUHtFlrAreaServed > 0 .AND. (HeatEqpType == 1 .OR. HeatEqpType == 18))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUSDHVFlrAreaServed iff served by a SDHV (small duct high velocity) sys"  DwellUnitType:DUSDHVFlrAreaServed =
      {  if (DUClFlrAreaServed > 0 .AND. CoolEqpType == 18)
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUCntrlHtClFlrAreaServed iff this DUT has valid ResCentralHtgClgSys assignments"   DwellUnitType:DUCntrlHtClFlrAreaServed =  ; SAC 03/15/22
      {  if (HVACSysType == 4 .AND. IfValidAnd( NumCentralEquipTypes > 0 ) .AND.
             IfValidAnd( HVACCentralRef[1]:Type > 0 ) .AND. IfValidAnd( CentralEquipCount[1] > 0 ))
         then  DUFloorAreaServed  else  0  endif  }
   "Set DwellUnitType:DUNewOrAltHVACFlrAreaServed"    DwellUnitType:DUNewOrAltHVACFlrAreaServed =     ; SAC 06/29/23 (tic #3479)
      {  SumRevRef( DwellUnit:DwellUnitTypeRef, DwellUnit:NewOrAltHVACFlrAreaWithMult )  }
END
;*************************************************************************


;************************************************************************* rulelist to UN-assign HVACSys objects from Zones in MFam models - SAC 04/09/21
RULELIST "Blast_Zone_HVACSys_Assignments" 1 0 0 1
   "Blast ResZn:HVACSystem"        ResZn:HVACSystem        = {  UNDEFINED  } 
   "Blast ResZn:AltHVACSystem"     ResZn:AltHVACSystem     = {  UNDEFINED  }
   "Blast ResZn:exHVACSystem"      ResZn:exHVACSystem      = {  UNDEFINED  }
   "Blast ResZn:ActiveHVACSystem"  ResZn:ActiveHVACSystem  = {  UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
