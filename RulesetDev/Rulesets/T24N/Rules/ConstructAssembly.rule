// ConstructAssembly
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2017, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
//
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------
//

// No direct correlation of ACM topics - just miscellaneous rules pertaining to
// ConstructAssembly objects
//
// The main objects in the SDD are:
//     ConsAssm / ConstructAssembly
//     Mat / Material
//


// -----------------------------------------------------------------------------
; revised logic to include Res surface types when setting ConsAssm:AssignedSurfType - SAC 02/03/22
RULE ConsAssm:AssignedSurfType
;   DATATYPE
;		Integer
;	LONGFORM
;		AssignedSurfaceType
   DESCRIPTION
     "The type of surface object that this construction assembly IS assigned to."
  INPUTCLASS
    NotInput
  DEFAULT
         if( (SumRevRef(   ExtWall:ConsAssmRef,     ExtWall:Area ) +
              SumRevRef( ResExtWall:Construction,   ResExtWall:Area ) +
              SumRevRef( ResExtWall:exConstruction, ResExtWall:Area )) > 1 ) then  1
	 else if( (SumRevRef(      Roof:ConsAssmRef,              Roof:Area ) +
              SumRevRef( ResCathedralCeiling:Construction,   ResCathedralCeiling:Area ) +
              SumRevRef( ResCathedralCeiling:exConstruction, ResCathedralCeiling:Area )) > 1 ) then  2
	 else if( (SumRevRef(    ExtFlr:ConsAssmRef,    ExtFlr:Area ) +
              SumRevRef( ResExtFlr:Construction,   ResExtFlr:Area ) +
              SumRevRef( ResExtFlr:exConstruction, ResExtFlr:Area )) > 1 ) then  3
	 else if( SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:Area) > 1 ) then  4
	 else if( SumRevRef(  UndgrFlr:ConsAssmRef,  UndgrFlr:Area) > 1 ) then  5
	 else if( SumRevRef(   IntWall:ConsAssmRef,   IntWall:Area) > 1 ) then  6
	 else if( SumRevRef(   Ceiling:ConsAssmRef,   Ceiling:Area) > 1 ) then  7
	 else if( SumRevRef(    IntFlr:ConsAssmRef,    IntFlr:Area) > 1 ) then  8
	 else  0  
	 endif endif endif endif endif endif endif endif
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:CompatibleSurfType
   DESCRIPTION
     "The type of surface object that this construction assembly can be assigned to."
  INPUTCLASS
    Required
; Moved option list to Enums file to facilitate conditional lists
;  OPTION
;    ExteriorWall
;    Roof
;    ExteriorFloor
;    UndergroundWall
;    UndergroundFloor
;    InteriorWall
;    Ceiling
;    InteriorFloor
  DEFAULT
    switch (AssignedSurfType)
      case  1 :  "ExteriorWall"
      case  2 :  "Roof"
      case  3 :  "ExteriorFloor"
      case  4 :  "UndergroundWall"
      case  5 :  "UndergroundFloor"
      case  6 :  "InteriorWall"
      case  7 :  "Ceiling"
      case  8 :  "InteriorFloor"
      default :  UNDEFINED
    endswitch
  SIZING
    CompatibleSurfType
  ANNUAL_PROPOSED
    if( LocalStatus(CompatibleSurfType) > 1 )
      then  UNCHANGED
    else u:CompatibleSurfType
//	  else  switch (AssignedSurfType)
//            case  1 :  "ExteriorWall"
//            case  2 :  "Roof"
//            case  3 :  "ExteriorFloor"
//            case  4 :  "UndergroundWall"
//            case  5 :  "UndergroundFloor"
//            case  6 :  "InteriorWall"
//            case  7 :  "Ceiling"
//            case  8 :  "InteriorFloor"
//            default :  UNCHANGED
//          endswitch  
    endif
  ANNUAL_BASELINE
    z:CompatibleSurfType
ENDRULE

// -----------------------------------------------------------------------------
RULE ConsAssm:CompatibleSurfTypeRpt
  RULESETS
    T24N
   DESCRIPTION
     "Translates CompatibleSurfType to CampatibleSurfTypeRpt."
  INPUTCLASS
    NotInput
  OPTION
    Exterior Wall
    Roof
    Exterior Floor
    Underground Wall
    Underground Floor
    Interior Wall
    Ceiling
    Interior Floor
  ANNUAL_PROPOSED
    switch ( CompatibleSurfType )
      case "ExteriorWall"     : "Exterior Wall"
      case "Roof"             : "Roof"
      case "ExteriorFloor"    : "Exterior Floor"
      case "UndergroundWall"  : "Underground Wall"
      case "UndergroundFloor" : "Underground Floor"
      case "InteriorWall"     : "Interior Wall"
      case "Ceiling"          : "Ceiling"
      case "InteriorFloor"    : "Interior Floor"
      default: UNDEFINED
    endswitch
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ConsAssm:SpecMthd
  DESCRIPTION
     "The method in which the construction assembly performance characteristics are specified."
  INPUTCLASS
    Prescribed
  OPTION
    Layers
    UFactor
    CFactor
    FFactor
  DEFAULT
    switch (CompatibleSurfType)
      case "UndergroundWall"  : "CFactor"
      case "UndergroundFloor" : if( IfValidAnd( IsRadSlab > 0 ))
                                then "Layers"
                                else "FFactor"
                                endif
      default: "Layers"
    endswitch
//  CHECKCODE
//    switch (CompatibleSurfType)
//      case "UndergroundWall"  : if (LocalStatus( SpecMthd ) < 1)
//                                then  PostError( "ConsAssm '%s' SpecMthd is currently undefined but must be set to 'CFactor' whenever CompatibleSurfType = 'UndergroundWall'", Name )
//                                else if (SpecMthd = "CFactor") then  UNCHANGED
//                                else  PostError( "ConsAssm '%s' SpecMthd is currently '%s' but must be set to 'CFactor' whenever CompatibleSurfType = 'UndergroundWall'", Name, SpecMthd )
//                                endif endif
//      case "UndergroundFloor" : if (LocalStatus( SpecMthd ) < 1)
//                                then  PostError( "ConsAssm '%s' SpecMthd is currently undefined but must be set to 'FFactor' whenever CompatibleSurfType = 'UndergroundFloor'", Name )
//                                else if (SpecMthd = "FFactor") then  UNCHANGED
//                                else  PostError( "ConsAssm '%s' SpecMthd is currently '%s' but must be set to 'FFactor' whenever CompatibleSurfType = 'UndergroundFloor'", Name, SpecMthd )
//                                endif endif
//      default:  if (LocalStatus( SpecMthd ) < 1)
//                then  PostError( "ConsAssm '%s' SpecMthd is currently undefined but must be set to 'Layers' whenever CompatibleSurfType is not set to an underground surface type", Name )
//                else if (SpecMthd = "Layers") then  UNCHANGED
//                else  PostError( "ConsAssm '%s' SpecMthd is currently '%s' but must be set to 'Layers' whenever CompatibleSurfType is not set to an underground surface type", Name, SpecMthd )
//                endif endif
//    endswitch
  SIZING
    switch (CompatibleSurfType)  // For some reason the DEFAULT value can not be changed from the original value set by OpenStudio when exported to SDD.xml
      case "UndergroundWall"  : "CFactor"
      case "UndergroundFloor" : if( IfValidAnd( IsRadSlab > 0 ))
                                then "Layers"
                                else "FFactor"
                                endif
      default: "Layers"
    endswitch
  ANNUAL
    z:SpecMthd
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ConsAssm:NumMats
   DATATYPE
		Integer
	LONGFORM
		NumberMaterials
	DESCRIPTION
     "Number of Material layers assigned to assembly."
   INPUTCLASS
     NotInput
   DEFAULT
         if( LocalCompAssigned(MatRef[10]) ) then  10
		else if( LocalCompAssigned(MatRef[9] ) ) then   9
		else if( LocalCompAssigned(MatRef[8] ) ) then   8
		else if( LocalCompAssigned(MatRef[7] ) ) then   7
		else if( LocalCompAssigned(MatRef[6] ) ) then   6
		else if( LocalCompAssigned(MatRef[5] ) ) then   5
		else if( LocalCompAssigned(MatRef[4] ) ) then   4
		else if( LocalCompAssigned(MatRef[3] ) ) then   3
		else if( LocalCompAssigned(MatRef[2] ) ) then   2
		else if( LocalCompAssigned(MatRef[1] ) ) then   1
		else  0  
		endif endif endif endif endif endif endif endif endif endif
   CHECKSIM
     switch (CompatibleSurfType)
       case "UndergroundWall"  : UNCHANGED
       case "UndergroundFloor" : UNCHANGED
       default:
         if( NumMats < 1 ) then
           PostError("Construction Assembly '%s' has no materials assigned.  
                      Material assignments are required.",Name)
         else UNCHANGED
         endif
     endswitch
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:SumMatHeatCap
  RULESETS
    T24N
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  UNITS
    Btu/sqft-F
  DEFAULT
    switch (NumMats)
      case  1 :  MatRef[1]:HeatCap
      case  2 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap
      case  3 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap
      case  4 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap
      case  5 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap
      case  6 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap + MatRef[6]:HeatCap
      case  7 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap
      case  8 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap
      case  9 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap +
                 MatRef[9]:HeatCap
      case 10 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                 MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap +
                 MatRef[9]:HeatCap + MatRef[10]:HeatCap
      default :  0
	  endswitch
  SIZING
    if( IfValidAnd(NumMats > 0) ) then
      switch (NumMats)
        case  1 :  MatRef[1]:HeatCap
        case  2 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap
        case  3 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap
        case  4 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap
        case  5 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap
        case  6 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap + MatRef[6]:HeatCap
        case  7 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap
        case  8 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap
        case  9 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap +
                   MatRef[9]:HeatCap
        case 10 :  MatRef[1]:HeatCap + MatRef[2]:HeatCap + MatRef[3]:HeatCap + MatRef[4]:HeatCap +
                   MatRef[5]:HeatCap + MatRef[6]:HeatCap + MatRef[7]:HeatCap + MatRef[8]:HeatCap +
                   MatRef[9]:HeatCap + MatRef[10]:HeatCap
        default :  0
  	  endswitch
  	else UNDEFINED
  	endif
  ANNUAL
    z:SumMatHeatCap
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:WtPerArea
  RULESETS
    T24N
  DESCRIPTION
    ""
  UNITS
    lb/sqft
  REPORTPRECISION
    3    
  DEFAULT
    if( CompatibleSurfType = "Roof" ) then
      switch (NumMats)
        case  1 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12
        case  2 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12
        case  3 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12
        case  4 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12
        case  5 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12
        case  6 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12 + 
                   MatRef[6]:Dens  * MatRef[6]:Thkns  / 12
        case  7 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12 + 
                   MatRef[6]:Dens  * MatRef[6]:Thkns  / 12 + 
                   MatRef[7]:Dens  * MatRef[7]:Thkns  / 12
        case  8 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12 + 
                   MatRef[6]:Dens  * MatRef[6]:Thkns  / 12 + 
                   MatRef[7]:Dens  * MatRef[7]:Thkns  / 12 + 
                   MatRef[8]:Dens  * MatRef[8]:Thkns  / 12
        case  9 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12 + 
                   MatRef[6]:Dens  * MatRef[6]:Thkns  / 12 + 
                   MatRef[7]:Dens  * MatRef[7]:Thkns  / 12 + 
                   MatRef[8]:Dens  * MatRef[8]:Thkns  / 12 +
                   MatRef[9]:Dens  * MatRef[9]:Thkns  / 12
        case 10 :  MatRef[1]:Dens  * MatRef[1]:Thkns  / 12 + 
                   MatRef[2]:Dens  * MatRef[2]:Thkns  / 12 + 
                   MatRef[3]:Dens  * MatRef[3]:Thkns  / 12 + 
                   MatRef[4]:Dens  * MatRef[4]:Thkns  / 12 +
                   MatRef[5]:Dens  * MatRef[5]:Thkns  / 12 + 
                   MatRef[6]:Dens  * MatRef[6]:Thkns  / 12 + 
                   MatRef[7]:Dens  * MatRef[7]:Thkns  / 12 + 
                   MatRef[8]:Dens  * MatRef[8]:Thkns  / 12 +
                   MatRef[9]:Dens  * MatRef[9]:Thkns  / 12 + 
                   MatRef[10]:Dens * MatRef[10]:Thkns / 12
        default :  0
	    endswitch
	  else UNDEFINED
	  endif
  SIZING
    if( CompatibleSurfType = "Roof" ) then
      u:WtPerArea
  	else UNDEFINED
  	endif
  ANNUAL
    if( CompatibleSurfType = "Roof" ) then
      z:WtPerArea
  	else UNDEFINED
  	endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ConsAssm:IsSpandrel
  RULESETS
    T24N
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MatRef[1]:IsSpandrel > 0 ) then  "true"  
    else  "false"  
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:ContainsMetalWallMaterial
  RULESETS
    T24N
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  2 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  3 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall +
                     MatRef[3]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  4 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  5 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  6 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall +
                     MatRef[6]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  7 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall + MatRef[6]:IsMetalWall +
                     MatRef[7]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  8 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall + MatRef[6]:IsMetalWall +
                     MatRef[7]:IsMetalWall + MatRef[8]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case  9 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall + MatRef[6]:IsMetalWall +
                     MatRef[7]:IsMetalWall + MatRef[8]:IsMetalWall +
                     MatRef[9]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      case 10 :  if( MatRef[1]:IsMetalWall + MatRef[2]:IsMetalWall + MatRef[3]:IsMetalWall +
                     MatRef[4]:IsMetalWall + MatRef[5]:IsMetalWall + MatRef[6]:IsMetalWall +
                     MatRef[7]:IsMetalWall + MatRef[8]:IsMetalWall + MatRef[9]:IsMetalWall +
                     MatRef[10]:IsMetalWall > 0 ) then  "true"  else  "false"  endif
      default :  "false"
    endswitch
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:ContainsMetalFrameMaterial
  RULESETS
    T24N
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  2 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  3 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame +
                     MatRef[3]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  4 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  5 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  6 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame +
                     MatRef[6]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  7 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame + MatRef[6]:IsMetalFrame +
                     MatRef[7]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  8 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame + MatRef[6]:IsMetalFrame +
                     MatRef[7]:IsMetalFrame + MatRef[8]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case  9 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame + MatRef[6]:IsMetalFrame +
                     MatRef[7]:IsMetalFrame + MatRef[8]:IsMetalFrame +
                     MatRef[9]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      case 10 :  if( MatRef[1]:IsMetalFrame + MatRef[2]:IsMetalFrame + MatRef[3]:IsMetalFrame +
                     MatRef[4]:IsMetalFrame + MatRef[5]:IsMetalFrame + MatRef[6]:IsMetalFrame +
                     MatRef[7]:IsMetalFrame + MatRef[8]:IsMetalFrame + MatRef[9]:IsMetalFrame +
                     MatRef[10]:IsMetalFrame > 0 ) then  "true"  else  "false"  endif
      default :  "false"
    endswitch
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:ContainsWoodFrameMaterial
  RULESETS
    T24N
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  2 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  3 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame +
                     MatRef[3]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  4 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  5 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  6 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame +
                     MatRef[6]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  7 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame + MatRef[6]:IsWoodFrame +
                     MatRef[7]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  8 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame + MatRef[6]:IsWoodFrame +
                     MatRef[7]:IsWoodFrame + MatRef[8]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case  9 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame + MatRef[6]:IsWoodFrame +
                     MatRef[7]:IsWoodFrame + MatRef[8]:IsWoodFrame +
                     MatRef[9]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      case 10 :  if( MatRef[1]:IsWoodFrame + MatRef[2]:IsWoodFrame + MatRef[3]:IsWoodFrame +
                     MatRef[4]:IsWoodFrame + MatRef[5]:IsWoodFrame + MatRef[6]:IsWoodFrame +
                     MatRef[7]:IsWoodFrame + MatRef[8]:IsWoodFrame + MatRef[9]:IsWoodFrame +
                     MatRef[10]:IsWoodFrame > 0 ) then  "true"  else  "false"  endif
      default :  "false"
    endswitch
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:ContainsMetalRoofMaterial
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  2 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  3 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof +
                     MatRef[3]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  4 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  5 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  6 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof +
                     MatRef[6]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  7 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof + MatRef[6]:IsMetalRoof +
                     MatRef[7]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  8 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof + MatRef[6]:IsMetalRoof +
                     MatRef[7]:IsMetalRoof + MatRef[8]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case  9 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof + MatRef[6]:IsMetalRoof +
                     MatRef[7]:IsMetalRoof + MatRef[8]:IsMetalRoof +
                     MatRef[9]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      case 10 :  if( MatRef[1]:IsMetalRoof + MatRef[2]:IsMetalRoof + MatRef[3]:IsMetalRoof +
                     MatRef[4]:IsMetalRoof + MatRef[5]:IsMetalRoof + MatRef[6]:IsMetalRoof +
                     MatRef[7]:IsMetalRoof + MatRef[8]:IsMetalRoof + MatRef[9]:IsMetalRoof +
                     MatRef[10]:IsMetalRoof > 0 ) then  "true"  else  "false"  endif
      default :  "false"
    endswitch
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ConsAssm:ContainsHollowCoreMasonryMaterial
  RULESETS
    T24N
  DATATYPE
    Enumeration
  OPTION
    true
    false
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  2 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  3 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry +
                     MatRef[3]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  4 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  5 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  6 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry +
                     MatRef[6]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  7 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry + 
                     MatRef[6]:IsHollowCoreMasonry +
                     MatRef[7]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  8 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry + 
                     MatRef[6]:IsHollowCoreMasonry +
                     MatRef[7]:IsHollowCoreMasonry + 
                     MatRef[8]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case  9 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry + 
                     MatRef[6]:IsHollowCoreMasonry +
                     MatRef[7]:IsHollowCoreMasonry + 
                     MatRef[8]:IsHollowCoreMasonry +
                     MatRef[9]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      case 10 :  if( MatRef[1]:IsHollowCoreMasonry + 
                     MatRef[2]:IsHollowCoreMasonry + 
                     MatRef[3]:IsHollowCoreMasonry +
                     MatRef[4]:IsHollowCoreMasonry + 
                     MatRef[5]:IsHollowCoreMasonry + 
                     MatRef[6]:IsHollowCoreMasonry +
                     MatRef[7]:IsHollowCoreMasonry + 
                     MatRef[8]:IsHollowCoreMasonry + 
                     MatRef[9]:IsHollowCoreMasonry +
                     MatRef[10]:IsHollowCoreMasonry > 0 ) then  "true"  else  "false"  endif
      default :  "false"
    endswitch
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:FrmMat
  OPTION
    NA
    Wood
    Metal
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    switch (NumMats)
      case  1 :  if( MatRef[1]:IsMetalFrameLayer > 0 ) then  "Metal" 
            else if( MatRef[1]:IsWoodFrameLayer > 0 ) then  "Wood" 
                else "NA"  endif endif
      case  2 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  3 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer +
                     MatRef[3]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer +
                     MatRef[3]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  4 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  5 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  6 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer +
                     MatRef[6]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer +
                     MatRef[6]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  7 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                     MatRef[7]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                     MatRef[7]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  8 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                     MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                     MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case  9 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                     MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer +
                     MatRef[9]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                     MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer +
                     MatRef[9]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      case 10 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                     MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                     MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer +
                     MatRef[10]:IsMetalFrameLayer > 0 ) then  "Metal"  
            else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                     MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                     MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer + MatRef[9]:IsWoodFrameLayer +
                     MatRef[10]:IsWoodFrameLayer > 0 ) then  "Wood"  
                else "NA"  endif endif
      default :  "NA"
    endswitch
ENDRULE


// ----------------------------------------------------------------------------- SAC 02/10/22 (MFam)
RULE NEW ConsAssm:FramingFactor
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "Only valid for Wood framed walls"
  INPUTCLASS
    NotInput
  DEFAULT
  if (FrmMat = "Metal") then 0 else
    switch (NumMats)
      case  1 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else 0  endif
      case  2 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else 0  endif endif
      case  3 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else 0  endif endif endif
      case  4 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else 0  endif endif endif endif
      case  5 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else 0  endif endif endif endif endif
      case  6 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else if (IfValidAnd( MatRef[6]:FrmFacMembers > 0 )) then  MatRef[6]:FrmFacMembers
               else 0  endif endif endif endif endif endif
      case  7 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else if (IfValidAnd( MatRef[6]:FrmFacMembers > 0 )) then  MatRef[6]:FrmFacMembers
               else if (IfValidAnd( MatRef[7]:FrmFacMembers > 0 )) then  MatRef[7]:FrmFacMembers
               else 0  endif endif endif endif endif endif endif
      case  8 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else if (IfValidAnd( MatRef[6]:FrmFacMembers > 0 )) then  MatRef[6]:FrmFacMembers
               else if (IfValidAnd( MatRef[7]:FrmFacMembers > 0 )) then  MatRef[7]:FrmFacMembers
               else if (IfValidAnd( MatRef[8]:FrmFacMembers > 0 )) then  MatRef[8]:FrmFacMembers
               else 0  endif endif endif endif endif endif endif endif
      case  9 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else if (IfValidAnd( MatRef[6]:FrmFacMembers > 0 )) then  MatRef[6]:FrmFacMembers
               else if (IfValidAnd( MatRef[7]:FrmFacMembers > 0 )) then  MatRef[7]:FrmFacMembers
               else if (IfValidAnd( MatRef[8]:FrmFacMembers > 0 )) then  MatRef[8]:FrmFacMembers
               else if (IfValidAnd( MatRef[9]:FrmFacMembers > 0 )) then  MatRef[9]:FrmFacMembers
               else 0  endif endif endif endif endif endif endif endif endif
      case 10 :     if (IfValidAnd( MatRef[1]:FrmFacMembers > 0 )) then  MatRef[1]:FrmFacMembers
               else if (IfValidAnd( MatRef[2]:FrmFacMembers > 0 )) then  MatRef[2]:FrmFacMembers
               else if (IfValidAnd( MatRef[3]:FrmFacMembers > 0 )) then  MatRef[3]:FrmFacMembers
               else if (IfValidAnd( MatRef[4]:FrmFacMembers > 0 )) then  MatRef[4]:FrmFacMembers
               else if (IfValidAnd( MatRef[5]:FrmFacMembers > 0 )) then  MatRef[5]:FrmFacMembers
               else if (IfValidAnd( MatRef[6]:FrmFacMembers > 0 )) then  MatRef[6]:FrmFacMembers
               else if (IfValidAnd( MatRef[7]:FrmFacMembers > 0 )) then  MatRef[7]:FrmFacMembers
               else if (IfValidAnd( MatRef[8]:FrmFacMembers > 0 )) then  MatRef[8]:FrmFacMembers
               else if (IfValidAnd( MatRef[9]:FrmFacMembers > 0 )) then  MatRef[9]:FrmFacMembers
               else if (IfValidAnd( MatRef[10]:FrmFacMembers > 0 )) then  MatRef[10]:FrmFacMembers
               else 0  endif endif endif endif endif endif endif endif endif endif
      default :  0
    endswitch endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeNonWallCheckVal
  DATATYPE
		Integer
	DESCRIPTION
     "Set a flag value to use to write an error if an illegal combination 
      of composite layers is included in a construction assembly."
  INPUTCLASS
    NotInput
  CHECKSIM
    if( CompatibleSurfType != "ExteriorWall" ) then
      switch (NumMats)
        case  1 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[1]:IsWoodFrameLayer > 1 ) then 1 
                   else 0 endif
        case  2 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  3 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer +
                       MatRef[3]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer +
                       MatRef[3]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  4 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  5 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  6 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer +
                       MatRef[6]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer +
                       MatRef[6]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  7 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  8 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case  9 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer +
                       MatRef[9]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer +
                       MatRef[9]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        case 10 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer +
                       MatRef[10]:IsMetalFrameLayer + 
                       MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer + MatRef[9]:IsWoodFrameLayer +
                       MatRef[10]:IsWoodFrameLayer > 1 ) then 1  
                   else 0 endif
        default :  0
      endswitch
    else 0
    endif
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeWallCheckVal1
  DATATYPE
		Integer
	DESCRIPTION
     "Set a flag value to use to write an error if an illegal combination 
      of composite layers is included in a construction assembly."
  INPUTCLASS
    NotInput
  CHECKSIM
    if( CompatibleSurfType = "ExteriorWall" .AND. NumMats < 7 ) then
      switch (NumMats)
        case  1 :  if( MatRef[1]:IsMetalFrameLayer > 0 ) then 5
              else if( MatRef[1]:IsWoodFrameLayer > 0 ) then 2 
                   else 0 endif endif
        case  2 :  if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer > 1 ) then 2  
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer >= 1 ) ) then 3  
                   else 0 endif endif endif
        case  3 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer +
                       MatRef[3]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer +
                         MatRef[3]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer +
                         MatRef[3]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer +
                       MatRef[3]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        case  4 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        case  5 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        case  6 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer +
                       MatRef[6]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer +
                         MatRef[6]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer +
                         MatRef[6]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer +
                       MatRef[6]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        default :  0
      endswitch
    else 0
    endif
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeWallCheckVal2
  DATATYPE
		Integer
	DESCRIPTION
     "Set a flag value to use to write an error if an illegal combination 
      of composite layers is included in a construction assembly."
  INPUTCLASS
    NotInput
  CHECKSIM
    if( CompatibleSurfType = "ExteriorWall" .AND. 
        NumMats >= 7 .AND. NumMats < 10 ) then
      switch (NumMats)
        case  7 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[6]:IsMetalFrameLayer + MatRef[7]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                         MatRef[7]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                         MatRef[7]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        case  8 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[6]:IsMetalFrameLayer + MatRef[7]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                         MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                         MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        case  9 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[6]:IsMetalFrameLayer + MatRef[7]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer +
                       MatRef[9]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                         MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer +
                         MatRef[9]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                         MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer +
                         MatRef[9]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer +
                       MatRef[9]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        default :  0
      endswitch
    else 0
    endif
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeWallCheckVal3
  DATATYPE
		Integer
	DESCRIPTION
     "Set a flag value to use to write an error if an illegal combination 
      of composite layers is included in a construction assembly."
  INPUTCLASS
    NotInput
  CHECKSIM
    if( CompatibleSurfType = "ExteriorWall" .AND. NumMats >= 10 ) then
      switch (NumMats)
        case 10 :  if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer > 1 ) .OR.
                       ( MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[3]:IsMetalFrameLayer + MatRef[4]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[6]:IsMetalFrameLayer + MatRef[7]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer > 1 ) .OR.  
                       ( MatRef[9]:IsMetalFrameLayer + MatRef[10]:IsMetalFrameLayer > 1 ) ) then 5  
              else if( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                       MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                       MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer + MatRef[9]:IsWoodFrameLayer +
                       MatRef[10]:IsWoodFrameLayer > 1 ) then 2
              else if( ( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                         MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                         MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer +
                         MatRef[10]:IsMetalFrameLayer >= 1 ) .AND.
                       ( MatRef[1]:IsWoodFrameLayer + MatRef[2]:IsWoodFrameLayer + MatRef[3]:IsWoodFrameLayer +
                         MatRef[4]:IsWoodFrameLayer + MatRef[5]:IsWoodFrameLayer + MatRef[6]:IsWoodFrameLayer +
                         MatRef[7]:IsWoodFrameLayer + MatRef[8]:IsWoodFrameLayer + MatRef[9]:IsWoodFrameLayer +
                         MatRef[10]:IsWoodFrameLayer >= 1 ) ) then 3  
              else if( MatRef[1]:IsMetalFrameLayer + MatRef[2]:IsMetalFrameLayer + MatRef[3]:IsMetalFrameLayer +
                       MatRef[4]:IsMetalFrameLayer + MatRef[5]:IsMetalFrameLayer + MatRef[6]:IsMetalFrameLayer +
                       MatRef[7]:IsMetalFrameLayer + MatRef[8]:IsMetalFrameLayer + MatRef[9]:IsMetalFrameLayer + 
                       MatRef[10]:IsMetalFrameLayer > 2 ) then 4
                   else 0 endif endif endif endif
        default :  0
      endswitch
    else 0
    endif
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeConsCheckVal
  DATATYPE
		Integer
	DESCRIPTION
     "Set a flag value to use to write an error if an illegal combination 
      of composite layers is included in a construction assembly."
  INPUTCLASS
    NotInput
  CHECKSIM
    CompositeNonWallCheckVal + CompositeWallCheckVal1 + 
    CompositeWallCheckVal2 + CompositeWallCheckVal3
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:CompositeWallCheckMessage
	DESCRIPTION
     "Check to prevent constructions with more than one composite layer,
      except exterior walls which are allowed to have two metal framed 
      composite layers but only with a non-composite layer between them."
  INPUTCLASS
    NotInput
  CHECKSIM
    switch (CompositeConsCheckVal)
      case  1 :	
        PostError("Construction Assembly '%s' has more than 1 composite material 
    	             layers.  This is not allowed for constructions that have 
    	             compatible surface type other than exterior wall.",Name)
      case  2 :	
    	  PostError("Construction Assembly '%s' has more than 1 wood-framed 
    	             composite material layers.  This is not allowed.",Name)
      case  3 :	
      	PostError("Construction Assembly '%s' has more than 1 composite material 
      	           layers including a combination of wood-framed and 
      	           metal-framed layers.  This is not allowed.",Name)
      case  4 :	
      	PostError("Construction Assembly '%s' has more than 2 metal-framed 
      	           composite material layers.  This is not allowed.",Name)
      case  5 :	
      	PostError("Construction Assembly '%s' has 2 metal-framed composite 
    	             material layers which are placed adjacent to each other.   
    	             This is not allowed - at least one material which has a code 
    	             category other than composite must be placed between the two 
    	             composite layers.",Name)
      default :
        UNCHANGED
    endswitch
ENDRULE



// -----------------------------------------------------------------------------
RULE ConsAssm:CavityInsVal
  HELP
    "Total nominal R-value of the cavity insulation in a construction"
  DESCRIPTION
    "Total nominal R-value of the cavity insulation in a construction"
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (NumMats)
      case  1 :  MatRef[1]:CavityInsVal
      case  2 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal
      case  3 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal
      case  4 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal
      case  5 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal
      case  6 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal + MatRef[6]:CavityInsVal
      case  7 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal + MatRef[6]:CavityInsVal +
                 MatRef[7]:CavityInsVal
      case  8 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal + MatRef[6]:CavityInsVal +
                 MatRef[7]:CavityInsVal + MatRef[8]:CavityInsVal
      case  9 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal + MatRef[6]:CavityInsVal +
                 MatRef[7]:CavityInsVal + MatRef[8]:CavityInsVal + MatRef[9]:CavityInsVal
      case 10 :  MatRef[1]:CavityInsVal + MatRef[2]:CavityInsVal + MatRef[3]:CavityInsVal +
                 MatRef[4]:CavityInsVal + MatRef[5]:CavityInsVal + MatRef[6]:CavityInsVal +
                 MatRef[7]:CavityInsVal + MatRef[8]:CavityInsVal + MatRef[9]:CavityInsVal +
                 MatRef[10]:CavityInsVal  
      default :  0
    endswitch
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:OutsdAirFilmR
  LONGFORM
    OutsideAirFilmRValue
  DATATYPE
    Float
  HELP
    "Outside air film R-value"
  DESCRIPTION
    "Outside air film R-value"
  INPUTCLASS
    NotInput
  DEFAULT : S901G ECBC
         if( CompatibleSurfType = "ExteriorWall"    ) then  0.17
    else if( CompatibleSurfType = "Roof"            ) then  0.17
    else if( CompatibleSurfType = "ExteriorFloor"   ) then  0.46
    else if( CompatibleSurfType = "UndergroundWall" ) then  0.00
    else if( CompatibleSurfType = "UndergroundFloor") then  0.00
    else if( CompatibleSurfType = "InteriorWall"    ) then  0.68
    else if( CompatibleSurfType = "Ceiling"         ) then  0.92
    else if( CompatibleSurfType = "InteriorFloor"   ) then  0.61
	  else  0  
	  endif endif endif endif endif endif endif endif
  DEFAULT
         if( CompatibleSurfType = "ExteriorWall"    ) then  0.17
    else if( CompatibleSurfType = "Roof"            ) then  0.17
    else if( CompatibleSurfType = "ExteriorFloor"   ) then  0.17
    else if( CompatibleSurfType = "UndergroundWall" ) then  0.00
    else if( CompatibleSurfType = "UndergroundFloor") then  0.00
    else if( CompatibleSurfType = "InteriorWall"    ) then  0.68
    else if( CompatibleSurfType = "Ceiling"         ) then  0.92
    else if( CompatibleSurfType = "InteriorFloor"   ) then  0.61
	  else  0  
	  endif endif endif endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ConsAssm:InsdAirFilmR
  LONGFORM
    InsideAirFilmRValue
  DATATYPE
    Float
  HELP
    "Inside air film R-value"
  DESCRIPTION
    "Inside air film R-value"
  INPUTCLASS
    NotInput
  DEFAULT
         if( CompatibleSurfType = "ExteriorWall"    ) then  0.68
    else if( CompatibleSurfType = "Roof"            ) then  0.61
    else if( CompatibleSurfType = "ExteriorFloor"   ) then  0.92
    else if( CompatibleSurfType = "UndergroundWall" ) then  0.00  // C-Factor in ASHRAE is always stated with no air films -> the original value was 0.68
    else if( CompatibleSurfType = "UndergroundFloor") then  0.92
    else if( CompatibleSurfType = "InteriorWall"    ) then  0.68
    else if( CompatibleSurfType = "Ceiling"         ) then  0.61
    else if( CompatibleSurfType = "InteriorFloor"   ) then  0.92
	 else  0  endif endif endif endif endif endif endif endif
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:UFactor
  HELP
    "Construction assembly overall U-factor"
  DESCRIPTION
    "Construction assembly overall U-factor"
  INPUTCLASS
    NotInput
  REPORTPRECISION
    3
  DEFAULT : S901G ECBC
    if( CompatibleSurfType = "UndergroundFloor" .OR. LocalStatus( MatRef[1]:RVal ) = 0 )
    then UNDEFINED
    else (Int( ( ConsAssmUFactor( 1 ) * 1000 ) ) / 1000 )
    endif
  DEFAULT
    if( CompatibleSurfType = "UndergroundFloor" .OR. LocalStatus( MatRef[1]:RVal ) = 0 )
    then UNDEFINED
    else ConsAssmUFactor( 1 )
    endif
  SIZING : S901G ECBC
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else if( ConsAssmUFactor( 1 ) <= 0 )
    then UNDEFINED
    else ConsAssmUFactor( 1 )
    endif endif
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else if( ConsAssmUFactor( 1 ) = 0 )
    then UNDEFINED
    else ConsAssmUFactor( 1 )
    endif endif
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else ConsAssmUFactor( 1 )
    endif
  ANNUAL_BASELINE
    z:UFactor
ENDRULE

//// -----------------------------------------------------------------------------
//RULE ConsAssm:UFactorReport
//  HELP
//    "Construction assembly overall U-factor"
//  DESCRIPTION
//    "Construction assembly overall U-factor"
//  INPUTCLASS
//    NotInput
//  DEFAULT : S901G ECBC
//    if( CompatibleSurfType = "UndergroundFloor" .OR. LocalStatus( MatRef[1]:RVal ) = 0 )
//    then UNDEFINED
//    else (Int( ( ConsAssmUFactor( 1 ) * 1000 ) ) / 1000 )
//    endif
//  DEFAULT
//    if( CompatibleSurfType = "UndergroundFloor" .OR. LocalStatus( MatRef[1]:RVal ) = 0 )
//    then UNDEFINED
//    else ConsAssmUFactor( 1 )
//    endif
//  SIZING : S901G ECBC
//    if( ConsAssmUFactor( 1 ) <= 0 .OR. CompatibleSurfType = "UndergroundFloor" )
//    then UNDEFINED
//    else ConsAssmUFactor( 1 )
//    endif
//  SIZING
//    if( ConsAssmUFactor( 1 ) = 0 .OR. CompatibleSurfType = "UndergroundFloor" )
//    then UNDEFINED
//    else ConsAssmUFactor( 1 )
//    endif
//  ANNUAL_PROPOSED
//    if( CompatibleSurfType = "UndergroundFloor" )
//    then UNDEFINED
//    else ConsAssmUFactor( 1 )
//    endif
//  ANNUAL_BASELINE
//    z:UFactor
//ENDRULE

// ----------------------------------------------------------------------------- SAC 12/07/21
RULE NEW ConsAssm:MatchingResConsAssmRef
  LONGFORM
    MatchingResidentialConstructAssemblyReference
  DATATYPE
    ResConsAssm
  HELP
    "ResConsAssm that matches the characteristics of this ConsAssm"
  DESCRIPTION
    "ResConsAssm that matches the characteristics of this ConsAssm"
  INPUTCLASS
    NotInput
ENDRULE


// -------------- Door Certification Method ---------------------------------------
RULE DrCons:CertificationMthd
  DESCRIPTION
    "Selection of the door certification method."  
  HELP
    ""
  REFERENCE 
    ACM-5.5.6
  INPUTCLASS
    Required
ENDRULE



// -------------- Door Opening ---------------------------------------
RULE DrCons:Open
  DESCRIPTION
    "Defines the exterior door operation. "  
  HELP
    ""
  REFERENCE 
    ACM-5.5.6
  INPUTCLASS
    Optional
ENDRULE



// -------------- Door Type ---------------------------------------
RULE DrCons:Type
  DESCRIPTION
    "Specifies the type of door for CEC Default Performance."  
  HELP
    ""
  REFERENCE 
    ACM-5.5.6
  INPUTCLASS
    Required
ENDRULE



// -------------- Door U Factor ---------------------------------------
RULE DrCons:UFactor
  DESCRIPTION
    "Door Construction assembly overall U-factor"
  HELP
    ""
  INPUTCLASS
    Optional
  REPORTPRECISION
    3
  DEFAULT : S901G ECBC
    if (u:CertificationMthd = "NFRCRated")
    then u:UFactor
    else
      if( u:CertificationMthd = "90.1DefaultPerformance"
         .AND. u:Type != "- specify -" )
      then S901GDefaultOpqDoorUFactor:UFactor("DrType",u:Type)
      else UNDEFINED
      endif
    endif
  DEFAULT
    if (u:CertificationMthd = "NFRCRated")
    then u:UFactor
    else
      if( u:CertificationMthd = "DefaultPerformance"
         .AND. u:Type != "- specify -" )
      then CECDefaultOpqDoorUFactor:UFactor("DrType",u:Type)
      else UNDEFINED
      endif
    endif
  CHECKSIM
    if( UFactor >1.5 )
    then
    	PostError("The assigned UFactor of '%s' exceed maximum allowed value,
    	        	 1.500 [Btu/h-ft2-F]",Name)
    else UNCHANGED
    endif
ENDRULE

// This rule has been moved to OpaqueEnvelope-Door-InsideConvCoef.rule - CG 20161220
;RULE DrCons:UFactorSim
;  DESCRIPTION
;    "Door Construction assembly overall U-factor"
;  HELP
;    ""
;  INPUTCLASS
;    NotInput
;  REPORTPRECISION
;    3
;  DEFAULT
;    if( IfValidAnd( UFactor > 0 ) )
;    then UFactor
;    else UNCHANGED
;    endif
;  CHECKCODE
;    if( IfValidAnd( UFactorSim > 0 ) )
;    then UNCHANGED
;    else PostError( "For Door Construction: '%s', the simulated U-factor is not
;                     defined.", Name )
;    endif
;  SIZING
;    if( IfValidAnd( UFactor > 0 ) )
;    then UFactor
;    else UNCHANGED
;    endif
;  ANNUAL
;    if( IfValidAnd( UFactor > 0 ) )
;    then UFactor
;    else UNCHANGED
;    endif
;ENDRULE

// S901GDefaultOpqDoorUFactor:UFactor("DrType",u:Type)
TABLE S901GDefaultOpqDoorUFactor
    DrType                                    UFactor
    MetalInsulatedSwingingDoor                0.500
    MetalUninsulatedDoubleLayerDoor           0.700
    MetalUninsulatedSingleLayerDoor           1.450
    WoodLessThan1.75inThickDoor               0.600
    WoodGreaterThanOrEqualTo1.75inThickDoor   0.500
ENDTABLE

// CECDefaultOpqDoorUFactor:UFactor("DrType",u:Type)
//TABLE CECDefaultOpqDoorUFactor
//    DrType                                    UFactor
//    MetalInsulatedSingleLayerSectionalDoor    1.450
//    MetalInsulatedSwingingDoor                0.700
//    MetalUninsulatedDoubleLayerDoor           0.500
//    MetalUninsulatedSingleLayerDoor           0.500
//    MetalUninsulatedSingleLayerRollupDoor     0.600
//    WoodLessThan1.75inThickDoor               1.450
//    WoodGreaterThanOrEqualTo1.75inThickDoor   0.179
//ENDTABLE

// CECDefaultOpqDoorUFactor:UFactor("DrType",u:Type)
TABLE CECDefaultOpqDoorUFactor
    DrType                                    UFactor
    MetalInsulatedSingleLayerSectionalDoor    0.179
    MetalInsulatedSwingingDoor                0.500
    MetalUninsulatedDoubleLayerDoor           0.700
    MetalUninsulatedSingleLayerDoor           1.450
    MetalUninsulatedSingleLayerRollupDoor     1.450
    WoodLessThan1.75inThickDoor               0.600
    WoodGreaterThanOrEqualTo1.75inThickDoor   0.500
ENDTABLE

// -------------- Underground Floor Type -----------------------------
RULE ConsAssm:SlabType
  DESCRIPTION
     "This is the underground floor slab type."  
  REFERENCE 
    ACM-5.5.9 Slab Floors in Contact with Ground
  INPUTCLASS
    Optional
  DEFAULT
    if( LocalStatus(Name) < 1 )
    then UNDEFINED
    else
      if( CompatibleSurfType = "UndergroundFloor" .OR. AssignedSurfType = 5 )
      then "UnheatedSlabOnGrade"
      else UNDEFINED
      endif
    endif
ENDRULE


// -------------- Underground Floor Heated or Unheated -----------------------------
RULE NEW ConsAssm:HtdOrUnhtd
  DATATYPE
    Enumeration
  DESCRIPTION
     "This determined if the floor slab is heated or unheated."  
  REFERENCE 
    ACM-5.5.9 Slab Floors in Contact with Ground
  INPUTCLASS
    NotInput
  OPTION
    HeatedSlab
    UnheatedSlab
  DEFAULT
    if( LocalStatus(Name) < 1 )
    then UNDEFINED
    else
      if( CompatibleSurfType = "UndergroundFloor" .OR. AssignedSurfType = 5 )
      then 
        if(     SlabType = "HeatedSlabOnGrade"
           .OR. SlabType = "HeatedSlabBelowGrade" )
        then "HeatedSlab"
        else 
          if(     SlabType = "UnheatedSlabOnGrade"
             .OR. SlabType = "UnheatedSlabBelowGrade" )
          then "UnheatedSlab"
          else UNDEFINED
          endif
        endif
      else UNDEFINED
      endif
    endif
ENDRULE


// -------------- Underground Floor Insulation Orientation --------------------
RULE ConsAssm:SlabInsOrientation
  DESCRIPTION
     "This determines the underground floor insulation orientation."  
  REFERENCE 
    ACM-5.5.9 Slab Floors in Contact with Ground
  INPUTCLASS
    Optional
  DEFAULT
    if(  CompatibleSurfType = "UndergroundFloor"
      .OR. AssignedSurfType = 5 )
    then u:SlabInsOrientation
    else UNDEFINED
    endif
ENDRULE


// -------------- Underground Floor Insulation RValue --------------------
RULE ConsAssm:SlabInsThrmlR
  DESCRIPTION
     "This determines the amount of insulation for the floor."  
  REFERENCE 
    ACM-5.5.9 Slab Floors in Contact with Ground
  INPUTCLASS
    Optional
  DEFAULT
    if(  CompatibleSurfType = "UndergroundFloor"
      .OR. AssignedSurfType = 5 )
    then "R0"
    else UNDEFINED
    endif
ENDRULE


// -------------- Underground Floor FFactor Lookup --------------------
RULE ConsAssm:FFactor
  DESCRIPTION
     "This determines the floor f-factor based on the slab details."
  REFERENCE 
    ACM-5.5.9 Slab Floors in Contact with Ground
  INPUTCLASS
    NotInput
  DEFAULT
    if( LocalStatus(Name) < 1 .OR. IfValidAnd( IsRadSlab > 0 ) )
    then UNDEFINED
    else
      if(  CompatibleSurfType = "UndergroundFloor"
        .OR. AssignedSurfType = 5 )
      then
        if(       SlabType = "HeatedSlabBelowGrade"
           .OR. u:SlabType = "HeatedSlabOnGrade" )
        then  HeatedSlabFFactor:FFactor("SlabInsOrientation",SlabInsOrientation, "HtdOrUnhtd",HtdOrUnhtd, "SlabInsThrmlR",SlabInsThrmlR)  // see Table in OpaqueEnvelope-UndergroundFloors.rule
        else
	  if(       SlabType = "UnheatedSlabBelowGrade"
             .OR. u:SlabType = "UnheatedSlabOnGrade" )
          then UnheatedSlabFFactor:FFactor("SlabInsOrientation",SlabInsOrientation, "HtdOrUnhtd",HtdOrUnhtd, "SlabInsThrmlR",SlabInsThrmlR)  // see Table in OpaqueEnvelope-UndergroundFloors.rule
          else UNDEFINED 
          endif
	endif
      else UNDEFINED
      endif
    endif
  SIZING_PROPOSED
    u:FFactor
  ANNUAL
    z:FFactor
ENDRULE


// -----------------------------------------------------------------------------
// TO DO: currently there is no method to assemble construction layers
// for CompatibleSurfType = "UndergroundWall" in CBECC
// A default value for this is in OpaqueEnvelope-UndergroundSurfaces.rule
//
RULE ConsAssm:CFactor
  DESCRIPTION
    "Construction assembly overall C-factor"
  INPUTCLASS
    NotInput
  DEFAULT
    if( CompatibleSurfType = "UndergroundWall" .AND. LocalStatus( MatRef[1]:RVal ) != 0 )
    then ConsAssmUFactor( 1 )
    else UNDEFINED
    endif
  SIZING_PROPOSED
    if( u:CompatibleSurfType = "UndergroundWall" )
    then Round ( ConsAssmUFactor( 1 ), 3 )
    else UNDEFINED
    endif
//  SIZING_BASELINE
//    if( CompatibleSurfType = "UndergroundFloor" )
//    then UNDEFINED
//    else if( ConsAssmUFactor( 1 ) = 0 )
//    then UNDEFINED
//    else if( CompatibleSurfType = "UndergroundWall" )
//    then 1.14
//    else UNDEFINED
//    endif endif endif
  ANNUAL
    z:CFactor
ENDRULE


// ----------------- Roof CRRC Product ID --------------------------------------
RULE ConsAssm:CRRCProdID
  RULESETS
    T24N
  DESCRIPTION
    "The Product ID shown on the report of the roofing solar properties from 
     Cool Roof Rating Council testing of the roofing."
  HELP
    ""
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  SIZING
    UNDEFINED
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      u:CRRCProdID
    else UNDEFINED
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// ----------------- Roof Solar Reflectance ASTM Certified --------------------------------------
RULE ConsAssm:SolReflASTMCertification
  RULESETS
    S901G ECBC
  DESCRIPTION
    "The user will provide evidence that the new Solar Reflectance is ASTM
     certified"
  HELP
    "The user will provide evidence that the new Solar Reflectance is ASTM
     certified"
//  REFERENCE
//    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  DEFAULT
    0
  SIZING
    u:SolReflASTMCertification
  ANNUAL
    z:SolReflASTMCertification
ENDRULE

// ----------------- Roof Thermal Emittance ASTM Certified --------------------------------------
RULE ConsAssm:ThrmlEmitASTMCertification
  RULESETS
    S901G ECBC
  DESCRIPTION
    "The user will provide evidence that the new Thermal Emittance is ASTM
     certified"
  HELP
    "The user will provide evidence that the new Thermal Emittance is ASTM
     certified"
//  REFERENCE
//    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  DEFAULT
    0
  SIZING
    u:ThrmlEmitASTMCertification
  ANNUAL
    z:ThrmlEmitASTMCertification
ENDRULE

// ----------------- Roof CRRC Product ID --------------------------------------
RULE ConsAssm:HasCRRCProdID
  RULESETS
    T24N
  DESCRIPTION
    "A flag to indicate whether a CRRC product ID number has been input.  This
    is used to allow CRRC properties to be entered."
  INPUTCLASS
    NotInput
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  DEFAULT
    if( CompatibleSurfType = "Roof" ) then
      if( LocalStatus(CRRCProdID) < 1 ) then 0
      else if( strlen(CRRCProdID) > 0 ) then 1
      else 0
      endif endif
    else UNDEFINED
    endif
ENDRULE

// ----------------- Roof CRRC Initial Emittance -------------------------------
RULE ConsAssm:CRRCInitialEmit
  RULESETS
    T24N
  DESCRIPTION
    "The Initial Emittance value from Cool Roof Rating Council testing of the
    roofing."
  HELP
    "The Initial Emittance value from Cool Roof Rating Council testing of the
    roofing."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    if( BuiltUpRoof = 1 ) then 0.85
    else if( BallastedRoof = 1 ) then 0.85
    else 0.75
    endif endif
  CHECKCODE
    if( HasCRRCProdID = 0 ) then
      if( LocalStatus(CRRCInitialEmit) > 4 ) then
        PostWarning("User input values for CRRC Emittance for construction 
                     assembly '%s' are not used if the CRRC Product ID is not 
                     specified.",Name)
      else UNCHANGED
      endif
    else UNCHANGED
    endif
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        u:CRRCInitialEmit
      else 0.75
      endif
    else UNDEFINED
    endif
ENDRULE

// ----------------- Roof CRRC Initial Reflectance -----------------------------
RULE ConsAssm:CRRCInitialRefl
  RULESETS
    T24N
  DESCRIPTION
    "The Initial Reflectance value from Cool Roof Rating Council testing of the
    roofing."
  HELP
    "The Initial Reflectance value from Cool Roof Rating Council testing of the
    roofing."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    if( BuiltUpRoof = 1 ) then 0.50
    else if( BallastedRoof = 1 ) then 0.45
    else 0.08
    endif endif
  CHECKCODE
    if( HasCRRCProdID = 0 ) then
      if( LocalStatus(CRRCInitialRefl) > 4 ) then
        PostWarning("User input values for CRRC Reflectance for construction 
                     assembly '%s' are not used if the CRRC Product ID is not 
                     specified.",Name)
      else UNCHANGED
      endif
    else UNCHANGED
    endif
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        u:CRRCInitialRefl
      else 0.08
      endif
    else UNDEFINED
    endif
ENDRULE

// ----------------- Roof Aged Emittance ----------------------------------
RULE ConsAssm:RoofAgedThrmlEmit
  RULESETS
    S901G ECBC
  DESCRIPTION
    "The Aged Emittance value."
  HELP
    "The Aged Emittance value."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    0.90
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" )
    then
      if( ThrmlEmitASTMCertification = 1  .AND.
          LocalStatus(RoofAgedThrmlEmit) > 0 )
      then u:RoofAgedThrmlEmit
      else 0.90
      endif
    else UNDEFINED
    endif
  ANNUAL_PROPOSED
    z:RoofAgedThrmlEmit
ENDRULE


// ----------------- Roof CRRC Aged Emittance ----------------------------------
RULE ConsAssm:CRRCAgedEmit
  RULESETS
    T24N
  DESCRIPTION
    "The Aged Emittance value from Cool Roof Rating Council testing of the
    roofing."
  HELP
    "The Aged Emittance value from Cool Roof Rating Council testing of the
    roofing."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    if( BuiltUpRoof = 1 ) then 0.85
    else if( BallastedRoof = 1 ) then 0.85
    else 0.75
    endif endif
  CHECKCODE
    if( HasCRRCProdID = 0 ) then
      if( LocalStatus(CRRCAgedEmit) > 4 ) then
        PostWarning("User input values for CRRC Emittance for construction 
                     assembly '%s' are not used if the CRRC Product ID is not 
                     specified.",Name)
      else UNCHANGED
      endif
    else UNCHANGED
    endif
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        u:CRRCAgedEmit
      else if( BuiltUpRoof = 1 ) then 0.85
      else if( BallastedRoof = 1 ) then 0.85
      else 0.75
      endif endif endif
    else UNDEFINED
    endif
  ANNUAL_PROPOSED
    z:CRRCAgedEmit
ENDRULE

// ----------------- Roof Aged Solar Reflectance --------------------------------
RULE ConsAssm:RoofAgedSolRefl
  RULESETS
    S901G ECBC
  DESCRIPTION
    "The Aged Solar Reflectance value from ASTM."
  HELP
    "The Aged Solar Reflectance value from ASTM."
//  REFERENCE
//    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    0.30
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" )
    then
      if( SolReflASTMCertification = 1 .AND.
          LocalStatus(RoofAgedSolRefl) > 0 )
      then u:RoofAgedSolRefl
      else 0.30
      endif
    else UNDEFINED
    endif
  ANNUAL_PROPOSED
    z:RoofAgedSolRefl
ENDRULE

// ----------------- Roof CRRC Aged Reflectance --------------------------------
RULE ConsAssm:CRRCAgedRefl
  RULESETS
    T24N
  DESCRIPTION
    "The Aged Reflectance value from Cool Roof Rating Council testing of the
    roofing."
  HELP
    "The Aged Reflectance value from Cool Roof Rating Council testing of the
    roofing."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    Optional
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    if( BuiltUpRoof = 1 ) then 0.48
    else if( BallastedRoof = 1 ) then 0.40
    else 0.08
    endif endif
  CHECKCODE
    if( HasCRRCProdID = 0 ) then
      if( LocalStatus(CRRCAgedRefl) > 4 ) then
        PostWarning("User input values for CRRC Reflectance for construction 
                     assembly '%s' are not used if the CRRC Product ID is not 
                     specified.",Name)
      else UNCHANGED
      endif
    else UNCHANGED
    endif
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        u:CRRCAgedRefl
      else if( BuiltUpRoof = 1 ) then 0.48
      else if( BallastedRoof = 1 ) then 0.40
      else 0.08
      endif endif endif
    else UNDEFINED
    endif
  ANNUAL_PROPOSED
    z:CRRCAgedRefl
ENDRULE

// ----------------- Roof Field Applied Coating? -------------------------------
RULE ConsAssm:FieldAppliedCoating
  RULESETS
    T24N
  DESCRIPTION
    "A flag to indicate if the roofing surface is from a coating applied on
    site or not."
  HELP
    "A flag to indicate if the roofing surface is from a coating applied on
    site or not."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    CondRequired
  DEFAULT
    0
  SIZING
    0
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      UNCHANGED
    else 0
    endif
  ANNUAL_BASELINE
    0
ENDRULE

// ----------------- Roof Solar Absorptance ------------------------------------
RULE ConsAssm:ExtSolAbs
  DESCRIPTION
    "The fraction of incident solar radiation on the roof which is absorbed."
  HELP
    "The fraction of incident solar radiation on the roof which is absorbed.
    Solar radiation includes the visible spectrum as well as infrared and
    ultraviolet wavelengths."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT : S901G ECBC
    0.7       // 1 - 0.3
  DEFAULT
    if( CompatibleSurfType = "Roof" ) then
      1 - CRRCAgedRefl
    else 0.7       // 1 - 0.3
    endif
  CHECKCODE : T24N
    if( CompatibleSurfType = "Roof" .AND. HasCRRCProdID = 1 ) then
      if( LocalStatus(CRRCAgedRefl) = 0 .AND.
          LocalStatus(CRRCInitialRefl) = 0 ) then
        PostError("Reflectance data, aged or initial, is required for CRRC
                   rated roofing products on construction assembly %s.",Name)
      else if( CRRCAgedRefl <= 0 .AND.
               CRRCInitialRefl <= 0 ) then
        PostError("Nonzero reflectance data, aged or initial, is required for
                 CRRC rated roofing products on construction assembly %s.",Name)
      else UNCHANGED
      endif endif
    else UNCHANGED
    endif
  SIZING_PROPOSED : S901G ECBC
    if( CompatibleSurfType = "Roof" )
    then ( 1 - z:RoofAgedSolRefl )
    else u:ExtSolAbs
    endif
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        if( u:CRRCAgedRefl <= 0 ) then
          if( u:FieldAppliedCoating ) then
            1 - (0.2 + (0.65 * (u:CRRCInitialRefl - 0.2)))
          else
            1 - (0.2 + (0.70 * (u:CRRCInitialRefl - 0.2)))
          endif
        else
          1 - CRRCAgedRefl
        endif
      else
        1 - CRRCAgedRefl
      endif
    else 0.70                        // 1 - 0.3 
    endif
  SIZING_BASELINE : S901G ECBC
    if( CompatibleSurfType = "Roof" )
    then
      if( Proj:CliZnNum < 41 )
      then (1 - 0.55 )
      else (1 - 0.30 )
      endif
    else u:ExtSolAbs
    endif
  ANNUAL_PROPOSED : S901G ECBC
    zp:ExtSolAbs
  ANNUAL_PROPOSED
    z:ExtSolAbs
  ANNUAL_BASELINE : S901G ECBC
    zb:ExtSolAbs
ENDRULE

// ----------------- Roof Thermal Absorptance ----------------------------------
RULE ConsAssm:ExtThrmlAbs
  DESCRIPTION
    "The fraction of incident long wavelength radiation on the roof which is
    absorbed."
  HELP
    "The fraction of incident long wavelength radiation on the roof which is
    absorbed."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  CHECKCODE : T24N
    if( CompatibleSurfType = "Roof" .AND. HasCRRCProdID = 1 ) then
      if( LocalStatus(CRRCAgedEmit) = 0 .AND.
          LocalStatus(CRRCInitialEmit) = 0 ) then
        PostError("Emittance data, aged or initial, is required for CRRC
                   rated roofing products on construction assembly %s.",Name)
      else if( CRRCAgedEmit <= 0 .AND.
               CRRCInitialEmit <= 0 ) then
        PostError("Nonzero emittance data, aged or initial, is required for CRRC
                   rated roofing products on construction assembly %s.",Name)
      else UNCHANGED
      endif endif
    else UNCHANGED
    endif
  DEFAULT : S901G ECBC
    0.9
  DEFAULT
    if( CompatibleSurfType = "Roof" ) then
      0.85
//      if( BuiltUpRoof = 1 ) then
//        0.85
//      else if( BallastedRoof = 1 ) then
//        0.85
//      else 0.75
//      endif endif
    else 0.9
    endif
  SIZING_PROPOSED : S901G ECBC
    if( CompatibleSurfType = "Roof" )
    then z:RoofAgedThrmlEmit
    else u:ExtThrmlAbs
    endif
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID = 1 ) then
        if( u:CRRCAgedEmit <= 0 ) then
          u:CRRCInitialEmit
        else u:CRRCAgedEmit
        endif
      else 0.85
      endif
    else 0.9
    endif
  SIZING_BASELINE : S901G ECBC
    if( CompatibleSurfType = "Roof" )
    then
      if( Proj:CliZnNum < 41 )
      then 0.75
      else 0.90
      endif
    else u:ExtThrmlAbs
    endif
  ANNUAL_PROPOSED : S901G ECBC
    zp:ExtThrmlAbs
  ANNUAL_PROPOSED
    z:ExtThrmlAbs
  ANNUAL_BASELINE : S901G ECBC
    zb:ExtThrmlAbs
ENDRULE

// ----------------- Roof Visible Absorptance ----------------------------------
RULE ConsAssm:ExtVisAbs
  DESCRIPTION
    "The fraction of incident visible wavelength radiation on the roof which is
    absorbed."
  HELP
    "The fraction of incident visible wavelength radiation on the roof which is
    absorbed."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  SIZING_PROPOSED
    if( CompatibleSurfType = "Roof" )
    then ExtThrmlAbs
    else 0.8
    endif
  ANNUAL_PROPOSED
    z:ExtVisAbs
ENDRULE


// ----------------- Surface Roughness -----------------------------------------
RULE ConsAssm:ExtRoughness
  DESCRIPTION
    "The relative roughness of the exterior surface.  The roughness affects
    convective heat transfer of the surface."
  HELP
    "The relative roughness of the exterior surface.  The roughness affects
    convective heat transfer of the surface."
  REFERENCE
    ACM-5.11.10 (possibly being moved to 5.5.3, 5.5.4 or 5.5.5)
  INPUTCLASS
    Prescribed
  OPTION
    VeryRough
    Rough
    MediumRough
    MediumSmooth
    Smooth
    VerySmooth
  DEFAULT
    MediumRough
  SIZING
    MediumRough
  ANNUAL
    z:ExtRoughness
ENDRULE



// ----------------- Interior Solar Absorptance --------------------------------
RULE ConsAssm:IntSolAbs
  DESCRIPTION
    "The fraction of incident solar radiation which is absorbed."
  HELP
    "The fraction of incident solar radiation on the interior surface which is
    absorbed.  Solar radiation includes the visible spectrum as well as
    infrared and ultraviolet wavelengths."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    0.7         // 1 - 0.3
  SIZING
    0.7
  ANNUAL
    z:IntSolAbs
ENDRULE

// ----------------- Interior Thermal Absorptance ------------------------------
RULE ConsAssm:IntThrmlAbs
  DESCRIPTION
    "The fraction of incident long wavelength radiation which is absorbed."
  HELP
    "The fraction of incident long wavelength radiation on the interior surface
    which is absorbed."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    0.9
  SIZING
    0.9
  ANNUAL
    z:IntThrmlAbs
ENDRULE

// ----------------- Interior Visible Absorptance ------------------------------
RULE ConsAssm:IntVisAbs
  DESCRIPTION
    "The fraction of incident visible wavelength radiation which is absorbed."
  HELP
    "The fraction of incident visible wavelength radiation on the interior
    surface which is absorbed."
  REFERENCE
    ACM-5.5.1 (possibly being moved to 5.5.3)
  INPUTCLASS
    NotInput
  MINIMUM
    0
  MAXIMUM
    1
  REPORTPRECISION
    2
  DEFAULT
    0.8
  SIZING
    0.8
  ANNUAL
    z:IntVisAbs
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:PerfFacRpt
  HELP
    "A text string containing U- C- or F-Factor and the corresponding value
     for each construction assembly for use in the compliance report."
  DESCRIPTION
    "A text string containing U- C- or F-Factor and the corresponding value
     for each construction assembly for use in the compliance report."
  INPUTCLASS
    NotInput
  DEFAULT
    if( CompatibleSurfType = "ExteriorWall" .OR.
        CompatibleSurfType = "Roof" .OR.
        CompatibleSurfType = "ExteriorFloor" .OR.
        CompatibleSurfType = "InteriorWall" .OR.
        CompatibleSurfType = "Ceiling" .OR.
        CompatibleSurfType = "InteriorFloor" ) then
      if( LocalStatus(UFactor) > 0 ) then
        Format( "U-Factor: %s", FltToStr(UFactor,3,0,5) )
      else "NA" 
      endif
    else if( CompatibleSurfType = "UndergroundWall" ) then
      if( LocalStatus(CFactor) > 0 ) then
        Format( "C-Factor: %s", FltToStr(CFactor,3,0,5) )
      else "NA" 
      endif
    else if( CompatibleSurfType = "UndergroundFloor" ) then
      if( LocalStatus(FFactor) > 0 ) then
        Format( "F-Factor: %s", FltToStr(FFactor,3,0,5) )
      else "NA" 
      endif
    else "NA"
    endif endif endif
  SIZING_PROPOSED
    u:PerfFacRpt
  ANNUAL_PROPOSED
    z:PerfFacRpt
ENDRULE


// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
      // revised Area* rules to include Res surface assignments - SAC 03/10/23
RULE ConsAssm:AreaNew
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaNew ) +
        SumRevRef( ResExtWall:Construction, ResExtWall:AreaNew )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaNew ) +
        SumRevRef( ResCathedralCeiling:Construction, ResCathedralCeiling:AreaNew )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaNew ) +
        SumRevRef( ResExtFlr:Construction, ResExtFlr:AreaNew )
      case 4:  // UndgrWall
        SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:AreaNew )
      case 5:  // UndgrFlrA
        SumRevRef( UndgrFlr:ConsAssmRef, UndgrFlr:AreaNew )
      case 6:  // IntWall
        SumRevRef( IntWall:ConsAssmRef, IntWall:AreaNew )
      case 7:  // Ceiling
        SumRevRef( Ceiling:ConsAssmRef, Ceiling:AreaNew )
      case 8:  // IntFlr
        SumRevRef( IntFlr:ConsAssmRef, IntFlr:AreaNew )
      default:
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
RULE ConsAssm:AreaAltered
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaAltered ) +
        SumRevRef( ResExtWall:Construction, ResExtWall:AreaAltered )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaAltered ) +
        SumRevRef( ResCathedralCeiling:Construction, ResCathedralCeiling:AreaAltered )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaAltered ) +
        SumRevRef( ResExtFlr:Construction, ResExtFlr:AreaAltered )
      case 4:  // UndgrWall
        SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:AreaAltered )
      case 5:  // UndgrFlr
        SumRevRef( UndgrFlr:ConsAssmRef, UndgrFlr:AreaAltered )
      case 6:  // IntWall
        SumRevRef( IntWall:ConsAssmRef, IntWall:AreaAltered )
      case 7:  // Ceiling
        SumRevRef( Ceiling:ConsAssmRef, Ceiling:AreaAltered )
      case 8:  // IntFlr
        SumRevRef( IntFlr:ConsAssmRef, IntFlr:AreaAltered )
      default:
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
RULE ConsAssm:AreaExisting
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaExisting ) +
        SumRevRef( ResExtWall:Construction, ResExtWall:AreaExisting )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaExisting ) +
        SumRevRef( ResCathedralCeiling:Construction, ResCathedralCeiling:AreaExisting )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaExisting ) +
        SumRevRef( ResExtFlr:Construction, ResExtFlr:AreaExisting )
      case 4:  // UndgrWall
        SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:AreaExisting )
      case 5:  // UndgrFlr
        SumRevRef( UndgrFlr:ConsAssmRef, UndgrFlr:AreaExisting )
      case 6:  // IntWall
        SumRevRef( IntWall:ConsAssmRef, IntWall:AreaExisting )
      case 7:  // Ceiling
        SumRevRef( Ceiling:ConsAssmRef, Ceiling:AreaExisting )
      case 8:  // IntFlr
        SumRevRef( IntFlr:ConsAssmRef, IntFlr:AreaExisting )
      default:
        UNCHANGED
    endswitch
ENDRULE    


// ----------------------------------------------------------------------------- SAC 01/27/22
// ------- Surface areas assigned via Res* surfaces
RULE NEW ConsAssm:AreaResZnSurf
  DATATYPE 
    Float
  LONGFORM
    AreaResidentialZoneSurface
  DESCRIPTION
    "The total area of the construction assembly assigned by residential (MFam) surfaces."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ResExtWall:Construction,   ResExtWall:Area ) +
        SumRevRef( ResExtWall:exConstruction, ResExtWall:Area )
      case 2:  // Roof
        SumRevRef( ResCathedralCeiling:Construction,   ResCathedralCeiling:Area ) +
        SumRevRef( ResCathedralCeiling:exConstruction, ResCathedralCeiling:Area )
      case 3:  // ExtFlr
        SumRevRef( ResExtFlr:Construction,   ResExtFlr:Area ) +
        SumRevRef( ResExtFlr:exConstruction, ResExtFlr:Area )
      case 4:  // UndgrWall
; if/when more types added below - correspomnding changes also needed to RULE ConsAssm:AssignedSurfType - SAC 02/03/22
        UNDEFINED
      case 5:  // UndgrFlrA
        UNDEFINED
      case 6:  // IntWall
        UNDEFINED
      case 7:  // Ceiling
        UNDEFINED
      case 8:  // IntFlr
        UNDEFINED
      default:
        UNDEFINED
    endswitch
ENDRULE    


// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaNewNonResCond
  DESCRIPTION
    "The total NonResidential area of the construction assembly by surface 
     status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaNewNonResCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaNewNonResCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaNewNonResCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaNewResCond
  DESCRIPTION
    "The total Residential area of the construction assembly by surface 
     status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaNewResCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaNewResCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaNewResCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaNewRelocCond
  DESCRIPTION
    "The total Relocatable Classroom area of the construction assembly by 
     surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaNewRelocCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaNewRelocCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaNewRelocCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    


// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaAltNonResCond
  DESCRIPTION
    "The total NonResidential area of the construction assembly by surface 
     status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaAltNonResCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaAltNonResCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaAltNonResCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaAltResCond
  DESCRIPTION
    "The total Residential area of the construction assembly by surface 
     status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaAltResCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaAltResCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaAltResCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm, Status and BldgType
RULE ConsAssm:AreaAltRelocCond
  DESCRIPTION
    "The total Relocatable Classroom area of the construction assembly by 
     surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (AssignedSurfType)
      case 1:  // ExtWall
        SumRevRef( ExtWall:ConsAssmRef, ExtWall:AreaAltRelocCond )
      case 2:  // Roof
        SumRevRef( Roof:ConsAssmRef, Roof:AreaAltRelocCond )
      case 3:  // ExtFlr
        SumRevRef( ExtFlr:ConsAssmRef, ExtFlr:AreaAltRelocCond )
      default:         // Only interested in ExtWall, ExtFlr and Roof
        UNCHANGED
    endswitch
ENDRULE    


// -----------------------------------------------------------------------------
RULE ConsAssm:SteepSlopeFlag
  DESCRIPTION
    "A flag to indicat that the construction assembly is assigned to a least 
     one steep sloped roofs."
  ANNUAL_PROPOSED
    if( AssignedSurfType = 2 )   // Roof
    then
      if( SumRevRef( Roof:ConsAssmRef, Roof:SteepSlopeFlag ) > 0 )
      then 1
      else 0
      endif
    else UNDEFINED
    endif
ENDRULE    


// -----------------------------------------------------------------------------
RULE ConsAssm:LowSlopeFlag
  DESCRIPTION
    "A flag to indicat that the construction assembly is assigned to a least 
     one low sloped roofs."
  ANNUAL_PROPOSED
    if( AssignedSurfType = 2 )   // Roof
    then
      if( SumRevRef( Roof:ConsAssmRef, Roof:LowSlopeFlag ) > 0 )
      then 1
      else 0
      endif
    else UNDEFINED
    endif
ENDRULE    


// -----------------------------------------------------------------------------
RULE ConsAssm:RoofSlopeRpt
  DESCRIPTION
    "Text string to be used to report whether the construction is assigned to
     steep sloped roofs, low sloped roofs, or both."
  ANNUAL_PROPOSED
    if( AssignedSurfType = 2 )   // Roof
    then
      if( SteepSlopeFlag = 1 .AND. LowSlopeFlag = 1 )
      then
        "Low and Steep-Slope"
      else if( SteepSlopeFlag = 1 )
      then
        "Steep-Slope"
      else if( LowSlopeFlag = 1 )
      then
        "Low-Slope"
      else
        "Not Assigned"
      endif endif endif
    else UNDEFINED
    endif
ENDRULE    


// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
RULE DrCons:AreaNew
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    SumRevRef( Dr:DrConsRef, Dr:AreaNew )
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
RULE DrCons:AreaAltered
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    SumRevRef( Dr:DrConsRef, Dr:AreaAltered )
ENDRULE    

// -----------------------------------------------------------------------------
// ------- Calculate surface areas by ConsAssm and Status
RULE DrCons:AreaExisting
  DESCRIPTION
    "The total area of the construction assembly by surface status."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    SumRevRef( Dr:DrConsRef, Dr:AreaExisting )
ENDRULE    


//------------------------------------------------------------------------------
// ---- Identify the window status to which the door construction applies ----
RULE NEW DrCons:NewDrCnt
  DATATYPE 
    Integer
  LONGFORM
    NewDoorCount
  DESCRIPTION
    "Identifies the number of 'New' door objects which are
     assigned to a door construction"  
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( Dr:DrConsRef, Dr:IsNew )
ENDRULE

//------------------------------------------------------------------------------
RULE NEW DrCons:AlteredDrCnt
  DATATYPE 
    Integer
  LONGFORM
    AlteredDoorCount
  DESCRIPTION
    "Identifies the number of 'Altered' door objects which are
     assigned to a door construction"  
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( Dr:DrConsRef, Dr:IsAltered )
ENDRULE

//------------------------------------------------------------------------------
RULE NEW DrCons:ExistingDrCnt
  DATATYPE 
    Integer
  LONGFORM
    ExistingDoorCount
  DESCRIPTION
    "Identifies the number of 'Existing' of door objects which are
     assigned to a door construction"   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( Dr:DrConsRef, Dr:IsExisting )
ENDRULE

// -----------------------------------------------------------------------------
// ********** Fenestration - Status *******************************************
RULE DrCons:Status  
  DESCRIPTION
    "This property identifies whether the door construction is referenced
     by new or existing doors."
  HELP
  ""
  REFERENCE 
       ACM-5.5.7
  INPUTCLASS
    NotInput
  OPTION
    New
    Altered
    Existing
  DEFAULT
// if DrCons is referenced by doors with more than one Status, assignment
// will not be valid.  Will check for this condition in CheckCode rule below
    if( NewDrCnt > 0 ) then "New" else
    if( AlteredDrCnt > 0 ) then "Altered" else
    if( ExistingDrCnt > 0 ) then "Existing" else
     "New"
    endif endif endif
  CHECKCODE
// check to ensure door construction is referenced by doors of 
// only one compliance status
    if( ( u:NewDrCnt > 0 .AND. u:ExistingDrCnt > 0 ) .OR.
        ( u:NewDrCnt > 0 .AND. u:AlteredDrCnt > 0 ) .OR.
        ( u:AlteredDrCnt > 0 .AND. u:ExistingDrCnt > 0 ) )
    then
      PostError("Door Construction '%s' may not be
                 assigned to doors with more than one Status, 
                 i.e. New, Altered or Existing", 
                 u:Name)
    else
      UNCHANGED
    endif
  SIZING
    u:Status
  ANNUAL
    z:Status
ENDRULE

// -----------------------------------------------------------------------------
// ** debugging rule evaluation duration **
RULE NEW Proj:RuleEvalDuration
  INPUTCLASS
    NotInput
  DEFAULT
    LogDuration( "            time to evaluate Schedule & Construction DEFAULT rules:  %.3f seconds" )
  SIZING_PROPOSED
    LogDuration( "            time to evaluate Schedule & Construction SIZING_PROPOSED rules:  %.3f seconds" )
  SIZING_BASELINE
    LogDuration( "            time to evaluate Schedule & Construction SIZING_BASELINE rules:  %.3f seconds" )
  ANNUAL_PROPOSED
    LogDuration( "            time to evaluate Schedule & Construction ANNUAL_PROPOSED rules:  %.3f seconds" )
  ANNUAL_BASELINE
    LogDuration( "            time to evaluate Schedule & Construction ANNUAL_BASELINE rules:  %.3f seconds" )
ENDRULE

// -----------------------------------------------------------------------------
// --------- Delete Material References for Below Grade Floors and Walls -------
RULE ConsAssm:MatRef[1]
  DESCRIPTION
    ""
  HELP
    ""
  INPUTCLASS
    CondRequired
  DEFAULT
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
  SIZING_PROPOSED
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[2]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[3]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[4]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then if( IfValidAnd( IsRadSlab > 0 ))
      then UNCHANGED
      else UNDEFINED
      endif
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[5]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[6]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[7]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[8]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[9]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:MatRef[10]
  SIZING
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
  ANNUAL
    if( CompatibleSurfType = "UndergroundFloor" )
    then UNDEFINED
    else UNCHANGED
    endif
ENDRULE

// ----------------- Continuous Insulation Sum --------------------------------------
RULE ConsAssm:InsCheckSum
  RULESETS
    T24N
  DESCRIPTION
    "The sum of the continous insulation RValues for each construction assembly. "
  HELP
    ""
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    switch (NumMats)
      case  1 :  MatRef[1]:InsCheck
      case  2 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck
      case  3 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck
      case  4 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck
      case  5 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck
      case  6 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck + MatRef[6]:InsCheck
      case  7 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck + MatRef[6]:InsCheck + MatRef[7]:InsCheck
      case  8 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck + MatRef[6]:InsCheck + MatRef[7]:InsCheck + MatRef[8]:InsCheck
      case  9 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck + MatRef[6]:InsCheck + MatRef[7]:InsCheck + MatRef[8]:InsCheck +
                 MatRef[9]:InsCheck
      case 10 :  MatRef[1]:InsCheck + MatRef[2]:InsCheck + MatRef[3]:InsCheck + MatRef[4]:InsCheck +
                 MatRef[5]:InsCheck + MatRef[6]:InsCheck + MatRef[7]:InsCheck + MatRef[8]:InsCheck +
                 MatRef[9]:InsCheck + MatRef[10]:InsCheck
      default :  0
    endswitch
ENDRULE

// ----------------- CRRC Product Density --------------------------------------
RULE ConsAssm:RoofDens
  RULESETS
    T24N
  DESCRIPTION
    "Check box for CRRC products >= 25 lb/ft2. "
  HELP
    ""
  PREVIOUSNAMES
    RfDens
  INPUTCLASS
    Default
  DEFAULT
    if( IfValidAnd(WtPerArea >= 25.0) ) then 1
    else 0
    endif
ENDRULE


// ----------------- CRRC Product Density --------------------------------------
RULE ConsAssm:BuiltUpRoof
  RULESETS
    T24N
  DESCRIPTION
    "Check box for built-up roofing with size 6-8 complying with ASTM D448 and 
     D1863."
  HELP
    ""
  PREVIOUSNAMES
    BuiltUpRf
  INPUTCLASS
    Default
  DEFAULT
    0
  SIZING_PROPOSED
    u:BuiltUpRoof
  ANNUAL_PROPOSED
    zp:BuiltUpRoof
ENDRULE


// ----------------- CRRC Product Density --------------------------------------
RULE ConsAssm:BallastedRoof
  RULESETS
    T24N
  DESCRIPTION
    "Check box for aggregate roofing with size 2-4 complying with ASTM D448."
  HELP
    ""
  PREVIOUSNAMES
    BallastedRf
  INPUTCLASS
    Default
  DEFAULT
    0
  CHECKCODE
    if( BuiltUpRoof > 0 .AND. BallastedRoof > 0 ) then
      PostError( "ConsAssm '%s' is set to be both certified built-up roof 
                  and certified ballasted roof.  This is not allowed.  Revise 
                  the input.", Name )
    else UNCHANGED
    endif
  SIZING_PROPOSED
    u:BallastedRoof
  ANNUAL_PROPOSED
    zp:BallastedRoof
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:CRRCSRIRpt
  RULESETS
    T24N
  DESCRIPTION
    "Text string containing SRI value or NA, for reporting."
  HELP
    ""
  INPUTCLASS
    NotInput
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID > 0 ) then
        if( LocalStatus( CRRCSRI ) > 0 ) then
          if( CRRCSRI > 0 ) then
            FltToStr( CRRCSRI, 0 )
          else
            "Not Provided"
          endif
        else
          "Not Provided"
        endif
      else "NA"
      endif
    else UNDEFINED
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE ConsAssm:CRRCProdIDRpt
  RULESETS
    T24N
  DESCRIPTION
    "Text string containing the CRRC Product ID or NA, for reporting."
  HELP
    ""
  INPUTCLASS
    NotInput
  ANNUAL_PROPOSED
    if( CompatibleSurfType = "Roof" ) then
      if( HasCRRCProdID > 0 ) then
        "CRRC Prod. ID: " + CRRCProdID
      else if( BuiltUpRoof = 1 ) then
        "Built-Up Roofing, Size 6-8, ASTM D448 and D1896"
      else if( BallastedRoof = 1 ) then
        "Ballasted Roofing, Size 2-4, ASTM D448"
      else
        "NA"
      endif endif endif
    else UNDEFINED
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


//------------------------------------------------------------------------------
// ---- Identify the status to which the construction applies ------------------
RULE NEW ConsAssm:NewConsCnt
  DATATYPE 
    Integer
  LONGFORM
    NewConstructionCount
  DESCRIPTION
    "Identifies the number of 'New' construction assembly objects which are
     assigned to a construction assembly."   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( ExtWall:ConsAssmRef,   ExtWall:IsNew ) +
    SumRevRef( IntWall:ConsAssmRef,   IntWall:IsNew ) +
    SumRevRef( Roof:ConsAssmRef,      Roof:IsNew ) +
    SumRevRef( Ceiling:ConsAssmRef,   Ceiling:IsNew ) +
    SumRevRef( ExtFlr:ConsAssmRef,    ExtFlr:IsNew ) +
    SumRevRef( IntFlr:ConsAssmRef,    IntFlr:IsNew ) +
    SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:IsNew ) +
    SumRevRef( UndgrFlr:ConsAssmRef,  UndgrFlr:IsNew )
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

//------------------------------------------------------------------------------
RULE NEW ConsAssm:AlteredConsCnt
  DATATYPE 
    Integer
  LONGFORM
    AlteredConstructionCount
  DESCRIPTION
    "Identifies the number of 'Altered' construction assembly objects which are
     assigned to a construction assembly."   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( ExtWall:ConsAssmRef,   ExtWall:IsAltered ) +
    SumRevRef( IntWall:ConsAssmRef,   IntWall:IsAltered ) +
    SumRevRef( Roof:ConsAssmRef,      Roof:IsAltered ) +
    SumRevRef( Ceiling:ConsAssmRef,   Ceiling:IsAltered ) +
    SumRevRef( ExtFlr:ConsAssmRef,    ExtFlr:IsAltered ) +
    SumRevRef( IntFlr:ConsAssmRef,    IntFlr:IsAltered ) +
    SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:IsAltered ) +
    SumRevRef( UndgrFlr:ConsAssmRef,  UndgrFlr:IsAltered )
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

//------------------------------------------------------------------------------
RULE NEW ConsAssm:ExistingConsCnt
  DATATYPE 
    Integer
  LONGFORM
    ExistingConstructionCount
  DESCRIPTION
    "Identifies the number 'Existing' of construction assembly objects which are
     assigned to a construction assembly."   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( ExtWall:ConsAssmRef,   ExtWall:IsExisting ) +
    SumRevRef( IntWall:ConsAssmRef,   IntWall:IsExisting ) +
    SumRevRef( Roof:ConsAssmRef,      Roof:IsExisting ) +
    SumRevRef( Ceiling:ConsAssmRef,   Ceiling:IsExisting ) +
    SumRevRef( ExtFlr:ConsAssmRef,    ExtFlr:IsExisting ) +
    SumRevRef( IntFlr:ConsAssmRef,    IntFlr:IsExisting ) +
    SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:IsExisting ) +
    SumRevRef( UndgrFlr:ConsAssmRef,  UndgrFlr:IsExisting )
  SIZING
    UNDEFINED
  ANNUAL
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ConsAssm:Status  
  DESCRIPTION
    "This property identifies whether the construction is referenced
     by new, altered or existing windows"
  HELP
  ""
  INPUTCLASS
    NotInput
  OPTION
    New
    Altered
    Existing
    Invalid
    Unknown
  DEFAULT
// if ConsAssm is referenced by surfaces with more than one Status, assignment
// will not be valid.  Will check for this condition in CheckCode rule below
    if( ( u:NewConsCnt > 0 .AND. u:ExistingConsCnt > 0 ) .OR.
        ( u:NewConsCnt > 0 .AND. u:AlteredConsCnt > 0 ) .OR.
        ( u:AlteredConsCnt > 0 .AND. u:ExistingConsCnt > 0 ) ) then "Invalid" else
    if( NewConsCnt > 0 ) then "New" else
    if( AlteredConsCnt > 0 ) then "Altered" else
    if( ExistingConsCnt > 0 ) then "Existing" else
     "Unknown"
    endif endif endif endif
  CHECKCODE
// check to ensure construction is referenced by surfaces with
// only one compliance status
    if( Proj:IsNewEnv .OR. Proj:IsExistingEnv ) 
      then UNCHANGED
    else if( ( u:NewConsCnt > 0 .AND. u:ExistingConsCnt > 0 ) .OR.
             ( u:NewConsCnt > 0 .AND. u:AlteredConsCnt > 0 ) .OR.
             ( u:AlteredConsCnt > 0 .AND. u:ExistingConsCnt > 0 ) )
      then
        PostError("Construction assembly '%s' may not be
                   assigned to surfaces with more than one Status, 
                   i.e. New, Altered or Existing", u:Name)
    else UNCHANGED
    endif endif
  SIZING
    if( Proj:IsNewEnv ) then "New"
    else if( Proj:IsExistingEnv ) then "Existing"
    else u:Status
    endif endif
  ANNUAL
    z:Status
ENDRULE

//------------------------------------------------------------------------------ SAC 12/16/21
RULE NEW ConsAssm:ModeledSurfArea
  DATATYPE 
    Float
  LONGFORM
    ModeledSurfaceArea
  DESCRIPTION
    "Sum of all surface areas (ignoring space/floor multipliers) that reference this ConsAssm."   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( ExtWall:ConsAssmRef,   ExtWall:Area ) +
    SumRevRef( IntWall:ConsAssmRef,   IntWall:Area ) +
    SumRevRef( Roof:ConsAssmRef,      Roof:Area ) +
    SumRevRef( Ceiling:ConsAssmRef,   Ceiling:Area ) +
    SumRevRef( ExtFlr:ConsAssmRef,    ExtFlr:Area ) +
    SumRevRef( IntFlr:ConsAssmRef,    IntFlr:Area ) +
    SumRevRef( UndgrWall:ConsAssmRef, UndgrWall:Area ) +
    SumRevRef( UndgrFlr:ConsAssmRef,  UndgrFlr:Area )
ENDRULE

RULE NEW Mat:ModeledSurfArea
  DATATYPE 
    Float
  LONGFORM
    ModeledSurfaceArea
  DESCRIPTION
    "Sum of all surface areas (ignoring space/floor multipliers) that are
     described by ConsAssm objects that include this Mat layer."   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumRevRef( ConsAssm:MatRef[1],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[2],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[3],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[4],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[5],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[6],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[7],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[8],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[9],  ConsAssm:ModeledSurfArea ) +
    SumRevRef( ConsAssm:MatRef[10],  ConsAssm:ModeledSurfArea )
ENDRULE

; added logic to flag Mat as user-specified only when CodeCat = "Specify Properties" - SAC 06/08/22
RULE NEW Mat:UserSpecModeledFlag
  DATATYPE 
    Integer
  DESCRIPTION
    "Flag denoting Mats that are defined by user-specified properties
     and used to describe simulated surfaces in the building"   
  INPUTCLASS
    NotInput
  DEFAULT 
    if (IfValidAnd( ModeledSurfArea > 1 ) .AND. 
        IfValidAnd( CodeCat = "Specify Properties" ))
    then  1  else  UNDEFINED  endif
ENDRULE

RULE NEW Proj:NumUserSpecMats
  DATATYPE 
    Integer
  LONGFORM
    NumberUserSpecifiedMaterials
  DESCRIPTION
    "Number of Mats that are defined by user-specified properties
     and used to describe simulated surfaces in the building"   
  INPUTCLASS
    NotInput
  DEFAULT 
    SumAll( Mat:UserSpecModeledFlag )
ENDRULE

// ----------------------------------------------------------------------------- SAC 01/27/22
// ------- Surface areas assigned via Res* surfaces
RULE NEW Mat:AreaResZnSurf
  DATATYPE 
    Float
  LONGFORM
    AreaResidentialZoneSurface
  DESCRIPTION
    "The total area of the construction material assigned by residential (MFam) surfaces."
  UNITS
    ft2
  INPUTCLASS
    NotInput
  REPORTPRECISION
    0
  DEFAULT
    SumRevRef( ConsAssm:MatRef[1],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[2],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[3],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[4],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[5],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[6],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[7],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[8],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[9],  ConsAssm:AreaResZnSurf ) +
    SumRevRef( ConsAssm:MatRef[10],  ConsAssm:AreaResZnSurf )
ENDRULE    

// ----------------------------------------------------------------------------- SAC 02/02/22
// ------- Properties to model Res* surfaces in CSE
RULE NEW Mat:ResThrmlCndctCT
  DATATYPE 
    Float
  LONGFORM
    ResidentialThermalConductivityCoefficientTemperature
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then  if (FrmMat = "Wood")
          then if (MaterialData:CSE_CondCT("MatList","Softwood - 1/2 in.") >= 0)
               then  MaterialData:CSE_CondCT("MatList","Softwood - 1/2 in.")
               else  UNDEFINED
               endif
          else UNDEFINED
          endif
    else if (CodeCat = "Specify Properties")
    then  UNDEFINED
    ; then  UserThrmlCndct
    else if( LocalStatus(CodeItem) < 2 ) then
      UNDEFINED
    else if( CodeItem = "- specify -" ) then
      UNDEFINED
    else if (MaterialData:CSE_CondCT("MatList",CodeItem) >= 0)
    then  MaterialData:CSE_CondCT("MatList",CodeItem)
    else  UNDEFINED
    endif endif endif endif endif
ENDRULE

RULE NEW Mat:ResMetalRVal
  DATATYPE 
    Float
  LONGFORM
    ResidentialMetalRValue
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite" .AND. FrmMat = "Metal")
    then if( LocalStatus(FrmConfig) > 0 .AND. LocalStatus(CavityInsVal) > 0 ) 
         then if( FrmConfig = "WallMetalSingleLayerBatt" .OR.
                  FrmConfig = "WallMetalDoubleLayerBatt" .OR.
                  FrmConfig = "RoofMetalScrewDown" .OR.
                  FrmConfig = "RoofMetalStandingSeam" .OR.
                  FrmConfig = "RoofMetalStandingSeamFilledCavity" ) 
              then MetalInsFrameLayers:Rvalue("FrmConfig",FrmConfig,"CavityIns",CavityInsVal)
              else if( LocalStatus(FrmDepth) > 0 ) 
                   then MetalInsFrameLayers:Rvalue("FrmConfig",FrmConfig,"FrmDepth",FrmDepth,"CavityIns",CavityInsVal )
                   else UNDEFINED
                   endif 
              endif
         else UNDEFINED
         endif
    else UNDEFINED 
    endif
ENDRULE

RULE NEW Mat:ResThrmlCndct
  DATATYPE 
    Float
  LONGFORM
    ResidentialThermalConductivity
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then  if (FrmMat = "Wood")
          then if (MaterialData:CSE_Cond("MatList","Softwood - 1/2 in.") >= 0)
               then  MaterialData:CSE_Cond("MatList","Softwood - 1/2 in.")
               else  ThrmlCndct
               endif
          else if (FrmMat = "Metal" .AND. LocalStatus( ResMetalRVal ) > 0)
          then  1 / max( ResMetalRVal, 0.0001 )
          else UNDEFINED
          endif endif
    else if (CodeCat = "Specify Properties")
    then  UserThrmlCndct
    else if( LocalStatus(CodeItem) < 2 ) then
      UNDEFINED
    else if( CodeItem = "- specify -" ) then
      UNDEFINED
    else if (MaterialData:CSE_Cond("MatList",CodeItem) > 0)
    then  MaterialData:CSE_Cond("MatList",CodeItem)
    else  ThrmlCndct
    endif endif endif endif endif
ENDRULE

RULE NEW Mat:ResSpecHt
  DATATYPE 
    Float
  LONGFORM
    ResidentialSpecificHeat
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then  if (FrmMat = "Wood")
          then if (MaterialData:CSE_SpecHt("MatList","Softwood - 1/2 in.") >= 0)
               then  MaterialData:CSE_SpecHt("MatList","Softwood - 1/2 in.")
               else  SpecHt
               endif
          else UNDEFINED
          endif
    else if (CodeCat = "Specify Properties")
    then  UserSpecHt
    else if( LocalStatus(CodeItem) < 2 ) then
      UNDEFINED
    else if( CodeItem = "- specify -" ) then
      UNDEFINED
    else if (MaterialData:CSE_SpecHt("MatList",CodeItem) > 0)
    then  MaterialData:CSE_SpecHt("MatList",CodeItem)
    else  SpecHt
    endif endif endif endif endif
ENDRULE

RULE NEW Mat:ResDens
  DATATYPE 
    Float
  LONGFORM
    ResidentialDensity
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then  if (FrmMat = "Wood")
          then if (MaterialData:CSE_Dens("MatList","Softwood - 1/2 in.") >= 0)
               then  MaterialData:CSE_Dens("MatList","Softwood - 1/2 in.")
               else  Dens
               endif
          else UNDEFINED
          endif
    else if (CodeCat = "Specify Properties")
    then  UserDens
    else if( LocalStatus(CodeItem) < 2 ) then
      UNDEFINED
    else if( CodeItem = "- specify -" ) then
      UNDEFINED
    else if (MaterialData:CSE_Dens("MatList",CodeItem) > 0)
    then  MaterialData:CSE_Dens("MatList",CodeItem)
    else  Dens
    endif endif endif endif endif
ENDRULE



;if CavityIns == 0 then ResMat  "VertWallCavity"      Thickness = 3.5    Conductivity = 0.314     ConductivityCT = 0.00397    SpecHeat = 0.24   Density = 0.075   RValPerInch = 1.1333    ..   ; from BAW 1/27/13 to facilitate garage walls w/ no insulation   

RULE NEW Mat:ResCavDens
  DATATYPE 
    Float
  LONGFORM
    ResidentialCavityDensity
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then if (FrmMat = "Metal")
         then 0
         else if (CavityIns == 0) then ResProj:LibMat_VertWallCavity:Density else ResProj:LibMat_OtherIns:Density endif
         endif
    else UNDEFINED
    endif
ENDRULE

RULE NEW Mat:ResCavSpecHt
  DATATYPE 
    Float
  LONGFORM
    ResidentialCavitySpecificHeat
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then if (FrmMat = "Metal")
         then 0
         else if (CavityIns == 0) then ResProj:LibMat_VertWallCavity:SpecHeat else ResProj:LibMat_OtherIns:SpecHeat endif
         endif
    else UNDEFINED
    endif
ENDRULE

RULE NEW Mat:ResCavOtherThrmlCndctCT
  DATATYPE 
    Float
  LONGFORM
    ResidentialCavityOtherThermalConductivityCoefficientTemperature
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then if (FrmMat = "Metal")
         then UNDEFINED
         else if (CavityIns == 0) then ResProj:LibMat_VertWallCavity:ConductivityCT else ResProj:LibMat_OtherIns:ConductivityCT endif
         endif
    else UNDEFINED
    endif
ENDRULE

RULE NEW Mat:ResCavCeilingThrmlCndctCT
  DATATYPE 
    Float
  LONGFORM
    ResidentialCavityCeilingThermalConductivityCoefficientTemperature
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then if (FrmMat = "Metal")
         then UNDEFINED
         else ResProj:LibMat_CeilingIns:ConductivityCT
         endif
    else UNDEFINED
    endif
ENDRULE

RULE NEW Mat:ResFrmThkns
  DATATYPE 
    Float
  LONGFORM
    ResidentialFrameThickness
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then  if (FrmMat = "Metal")
          then  0.1
          else  FrmDepthVal / 12.0
          endif
;    then switch (FrmDepth) 
;                 case "0_5In": (0.5 / 12.0)
;                 case "0_75In": (0.75 / 12.0)
;                 case "1In": (1.0 / 12.0)
;                 case "1_5In": (1.5 / 12.0)
;                 case "2In": (2.0 / 12.0)
;                 case "2_5In": (2.5 / 12.0)
;                 case "3In": (3.0 / 12.0)
;                 case "3_5In": (3.5 / 12.0)
;                 case "4In": (4.0 / 12.0)
;                 case "4_5In": (4.5 / 12.0)
;                 case "5In": (5.0 / 12.0)
;                 case "5_5In": (5.5 / 12.0)
;                 case "7_25In": (7.25 / 12.0)
;                 case "9_25In": (9.25 / 12.0)
;                 case "11_25In": (11.25 / 12.0)
;                 default: UNDEFINED
;         endswitch
    else UNDEFINED
    endif
ENDRULE

RULE NEW Mat:ResCavThrmlCndct
  DATATYPE 
    Float
  LONGFORM
    ResidentialCavityThermalConductivity
  DESCRIPTION
     ""
  INPUTCLASS
    NotInput
  DEFAULT
    if (CodeCat = "Composite")
    then if (FrmMat = "Metal")
         then ResThrmlCndct
         else if (CavityIns == 0) 
              then ResProj:LibMat_VertWallCavity:Conductivity
              else if ( IfValidAnd( ResFrmThkns > 0 ) )
                   then ResFrmThkns / CavityIns
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE



// -----------------------------------------------------------------------------
// ---- support for Quality Insulation Installation (QII) - MFam Res -----------  SAC 02/15/22

RULE NEW ConsAssm:ResSurfacesOfNewZone
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesOfNewZone
  DESCRIPTION
     "flag indicating this ConsAssm is assigned to Res surfaces of New zones"
  INPUTCLASS
    NotInput
  DEFAULT
    switch (CompatibleSurfType)
      case  "ExteriorWall"      :  SumRevRef( ResExtWall:Construction, ResExtWall:ParentIsNewZone )
      case  "Roof"              :  SumRevRef( ResAttic:Construction,   ResAttic:IsNew ) +
                                   SumRevRef( ResCathedralCeiling:Construction,  ResCathedralCeiling:ParentIsNewZone )
      case  "ExteriorFloor"     :  SumRevRef( ResExtFlr:Construction,  ResExtFlr:ParentIsNewZone )
      case  "UndergroundWall"   :  SumRevRef( ResUndgrWall:Construction, ResUndgrWall:ParentIsNewZone )
    ;  case  "UndergroundFloor"  :  SumRevRef( ResUndgrFlr:?????,         ResUndgrFlr:ParentIsNewZone )
    ;  case  "InteriorWall"      :  SumRevRef( ResIntWall:Construction, ResIntWall:ParentIsNewZone )
    ;  case  "Ceiling"           :  SumRevRef( InteriorCeiling:Construction,   InteriorCeiling:ParentIsNewZone )
    ;  case  "InteriorFloor"     :  SumRevRef( ResIntFlr:Construction,     ResIntFlr:ParentIsNewZone )
    ;                               SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ParentIsNewZone )
    ;                               SumRevRef( FloorOverCrawl:Construction,    FloorOverCrawl:ParentIsNewZone )
      default  :  0
    endswitch
ENDRULE

RULE NEW ConsAssm:ResSurfacesOfNotNewZone
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesOfNotNewZone
  DESCRIPTION
     "flag indicating this ConsAssm is assigned to Res surfaces of zones that are Not New"
  INPUTCLASS
    NotInput
  DEFAULT
    switch (CompatibleSurfType)
      case  "ExteriorWall"      :  SumRevRef( ResExtWall:Construction, ResExtWall:ParentNotNewZone )
      case  "Roof"              :  SumRevRef( ResAttic:Construction,   ResAttic:IsAltered ) +
                                   SumRevRef( ResAttic:Construction,   ResAttic:IsExisting ) +
                                   SumRevRef( ResCathedralCeiling:Construction,  ResCathedralCeiling:ParentNotNewZone )
      case  "ExteriorFloor"     :  SumRevRef( ResExtFlr:Construction,  ResExtFlr:ParentNotNewZone )
      case  "UndergroundWall"   :  SumRevRef( ResUndgrWall:Construction, ResUndgrWall:ParentNotNewZone )
    ;  case  "UndergroundFloor"  :  SumRevRef( ResUndgrFlr:?????,         ResUndgrFlr:ParentNotNewZone )
    ;  case  "InteriorWall"      :  SumRevRef( ResIntWall:Construction, ResIntWall:ParentNotNewZone )
    ;  case  "Ceiling"           :  SumRevRef( InteriorCeiling:Construction,   InteriorCeiling:ParentNotNewZone )
    ;  case  "InteriorFloor"     :  SumRevRef( ResIntFlr:Construction,     ResIntFlr:ParentNotNewZone )
    ;                               SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ParentNotNewZone )
    ;                               SumRevRef( FloorOverCrawl:Construction,    FloorOverCrawl:ParentNotNewZone )
      default  :  0
    endswitch
ENDRULE

RULE NEW ConsAssm:ResSurfacesQIIDegraded
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesQIIDegraded
  DESCRIPTION
     "flag indicating this ConsAssm is assigned to QII-degraded Res surfaces"
  INPUTCLASS
    NotInput
  DEFAULT
    if (Proj:IsComRuleset .AND. IfValidAnd( Proj:IsHighRiseMFam > 0 )) then  0
    else if (CompatibleSurfType = "ExteriorWall")     ; ResExtWall
    then  SumRevRef( ResExtWall:Construction, ResExtWall:QIIDegraded )
    else  ResSurfacesOfNotNewZone   ; other surface types still use (Not)NewZone logic
    endif endif
ENDRULE

RULE NEW ConsAssm:ResSurfacesQIINotDegraded
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesQIINotDegraded
  DESCRIPTION
     "flag indicating this ConsAssm is assigned to NON-QII-degraded Res surfaces"
  INPUTCLASS
    NotInput
  DEFAULT
    if (CompatibleSurfType = "ExteriorWall")     ; ResExtWall
    then  SumRevRef( ResExtWall:Construction, ResExtWall:QIINotDegraded )
    else  ResSurfacesOfNewZone      ; other surface types still use (Not)NewZone logic
    endif
ENDRULE

RULE NEW Mat:ResSurfacesQIIDegraded
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesQIIDegraded
  DESCRIPTION
    "flag indicating this Mat is referenced by ConsAssm(s) assigned to QII-degraded Res surfaces"
  INPUTCLASS
    NotInput
  DEFAULT
    SumRevRef( ConsAssm:MatRef[1],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[2],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[3],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[4],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[5],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[6],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[7],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[8],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[9],  ConsAssm:ResSurfacesQIIDegraded ) +
    SumRevRef( ConsAssm:MatRef[10],  ConsAssm:ResSurfacesQIIDegraded )
ENDRULE    

RULE NEW Mat:ResSurfacesQIINotDegraded
  DATATYPE 
    Integer
  LONGFORM
    ResidentialSurfacesQIINotDegraded
  DESCRIPTION
    "flag indicating this Mat is referenced by ConsAssm(s) assigned to NON-QII-degraded Res surfaces"
  INPUTCLASS
    NotInput
  DEFAULT
    SumRevRef( ConsAssm:MatRef[1],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[2],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[3],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[4],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[5],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[6],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[7],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[8],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[9],  ConsAssm:ResSurfacesQIINotDegraded ) +
    SumRevRef( ConsAssm:MatRef[10],  ConsAssm:ResSurfacesQIINotDegraded )
ENDRULE    



// -----------------------------------------------------------------------------
// ------- Wall Construction Heat Capacity -------------------------------------
// Input restriction summary:
//      Not a user input. It is derived based on construction.
RULE NEW ConsAssm:HtCapCat
  RULESETS
    T24N
  DATATYPE
    Enumeration
  DESCRIPTION
    "The category for the heat capacity of the wall construction: Light, Heavy, 
     or not mass. Based on thresholds of 7 and 15 Btu/ft-F."
  HELP
    ""
  INPUTCLASS
    NotInput
  OPTION
    Light
    Heavy
    NotMass
    Mass
    Other
  DEFAULT
    // HC>15   is Heavy mass
    // 15>HC>7 is Light mass,
    // 7>HC and metal layer then metal building
    // 7>HC and FrmMat=Metal then metal frame
    // otherwise wood
    if( CompatibleSurfType = "ExteriorWall" ) then 
      if( SumMatHeatCap > 15 ) then
        "Heavy"
      else if( SumMatHeatCap < 7 ) then
        "NotMass"
      else
        "Light"
      endif endif
    else if( CompatibleSurfType = "ExteriorFloor" ) then 
      if( SumMatHeatCap >= 5 ) then
        "Mass"
      else
        "Other"
      endif
    else UNCHANGED
    endif endif
ENDRULE


// -----------------------------------------------------------------------------
// ------- Construction Assembly ConsType --------------------------------------
RULE NEW ConsAssm:ConsType
  RULESETS
    T24N
  DATATYPE
    Enumeration
  DESCRIPTION
    "The Exterior Wall, Roof or Exterior Floor construction type  Metal 
     Building Wall, Metal Frame Wall, Mass-Light Wall, Mass-Heavy Wall, 
     Wood Framed Wall, Wood Framing And Other Roof, Metal Building Roof, 
     Mass Floor, and Other Floor."
  HELP
    ""
  INPUTCLASS
    NotInput
  LONGFORM
    ConstructionType
  OPTION
    MetalBuildingWall
    MetalFrameWall
    ConstructType
    MassLightWall
    MassHeavyWall
    WoodFramingAndOtherWall
    SpandrelWall
    WoodFramingAndOtherRoof
    MetalBuildingRoof
    MassFloor
    OtherFloor
  DEFAULT
    if( CompatibleSurfType = "ExteriorWall" ) then
      if( HtCapCat = "Light" ) then
        "MassLightWall"
      else if( HtCapCat = "Heavy" ) then
        "MassHeavyWall"
      else if( IsSpandrel = "true" ) then
        "SpandrelWall"
      else if( ContainsMetalWallMaterial = "true" ) then
        "MetalBuildingWall"
      else if( ContainsMetalFrameMaterial = "true" ) then
        "MetalFrameWall"
      else if( ContainsWoodFrameMaterial = "true" ) then
        "WoodFramingAndOtherWall"
      else "WoodFramingAndOtherWall"
      endif endif endif endif endif endif
    else if( CompatibleSurfType = "Roof" ) then
      if( ContainsMetalRoofMaterial = "true" ) then
        "MetalBuildingRoof"
      else if( ContainsMetalFrameMaterial = "true" ) then
        "MetalBuildingRoof"
      else if( ContainsWoodFrameMaterial = "true" ) then
        "WoodFramingAndOtherRoof"
      else
        "WoodFramingAndOtherRoof"  // even if it does not contain a wood frame it would be an "other" wall
      endif endif endif
    else if( CompatibleSurfType = "ExteriorFloor" ) then
      if( HtCapCat = "Mass" ) then
        "MassFloor"
      else
        "OtherFloor"
      endif
    else
      UNCHANGED
    endif endif endif
  CHECKCODE
    if( LocalStatus( ConsType ) > 1 ) then
      if( ( ValidOr( AreaNewNonResCond,0 ) + 
            ValidOr( AreaNewResCond,0 ) + 
            ValidOr( AreaNewRelocCond,0 ) ) > 0.1 ) then
        if( ConsType = "MassLightWall" .AND. 
            Status = "New" .AND. 
            UFactor > MassLightWallMaxUFac[1] + 0.001 .AND. 
            ContainsHollowCoreMasonryMaterial = "true" ) then 
          if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
          PostError("The u-factor of light mass wall construction '%s' is '%.3f', 
                     which exceeds the maximum allowable value, '%.3f', violating 
                     Section 120.7.",Name,UFactor,MassLightWallMaxUFac[1] )
          endif
        else if( ConsType = "MassHeavyWall" .AND. 
                 Status = "New" .AND. 
                 UFactor > MassHeavyWallMaxUFac[1] + 0.001 .AND.
                 ContainsHollowCoreMasonryMaterial = "true" ) then 
          if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else          
          PostError("The u-factor of heavy mass wall construction '%s' is '%.3f', 
                     which exceeds the maximum allowable value, '%.3f', violating 
                     Section 120.7.",Name,UFactor,MassHeavyWallMaxUFac[1] )
          endif
        else UNCHANGED
        endif endif
      else UNCHANGED
      endif
    else UNCHANGED
    endif
ENDRULE

RULE ConsAssm:FireRtdFlag
  DESCRIPTION
    "Flag indicating whether or not the construction fire rating is greater than 1hr"
  HELP
    "Only used to determine multifamily wall standard design performance."
  DEFAULT
    0
ENDRULE

// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueNewNonRes
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to NonResidential spaces in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaNewNonResCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaNewNonResCond * UFactor
    else UNCHANGED
    endif
ENDRULE


// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueNewRes
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to Residential spaces in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaNewResCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaNewResCond * UFactor
    else UNCHANGED
    endif
ENDRULE


// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueNewReloc
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to Relocatable Classrooms in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaNewRelocCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaNewRelocCond * UFactor
    else UNCHANGED
    endif
ENDRULE

// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueAltNonRes
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to NonResidential spaces in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaAltNonResCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaAltNonResCond * UFactor
    else UNCHANGED
    endif
ENDRULE


// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueAltRes
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to Residential spaces in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaAltResCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaAltResCond * UFactor
    else UNCHANGED
    endif
ENDRULE


// -----------------------------------------------------------------------------
// ------- Construction Assembly UA --------------------------------------
RULE NEW ConsAssm:UAValueAltReloc
  RULESETS
    T24N
  DATATYPE
    Float
  DESCRIPTION
    "The UA value of each Exterior Wall, Roof or Exterior Floor construction 
     assigned to Relocatable Classrooms in the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( AreaAltRelocCond > 0 ) .AND. IfValidAnd( UFactor > 0 ) ) then
      AreaAltRelocCond * UFactor
    else UNCHANGED
    endif
ENDRULE



// Below are a series of variables with array indices.  The indices are:
//  - [1] New NonResidential 
//  - [2] New Residential 
//  - [3] New Relocatable Classroom 
//  - [4] Altered NonResidential 
//  - [5] Altered Residential 
//  - [6] Altered Relocatable Classroom 
//
//  The exception to this is that the MaxUFactor variables are indexed as:
//   - [1] New
//   - [2] Altered

// ============================================================================================================================================================================
// Section 120.7 Mandatory U-Factors for New Construction 141.0(b)1 Mandatory Insulation (alterations)
// 141.0(b)1 Mandatory Insulation (Wall and Floor Alterations)
TABLE OpaqueEnvelopeMaxUFactor_T24N_2016
    TypeOfCons                UFactor UFactor UFactor  
    Status=                   New     Altered Existing
    MetalBuildingRoof         0.098   -       9.999   
    WoodFramingAndOtherRoof   0.075   -       9.999   
    MetalBuildingWall         0.113   0.113   9.999   
    MetalFrameWall            0.151   0.217   9.999   
    MassLightWall             0.440   9.999   9.999   
    MassHeavyWall             0.690   9.999   9.999   
    WoodFramingAndOtherWall   0.110   0.110   9.999   
    SpandrelWall              0.280   0.280   9.999   
    MassFloor                 0.269   -       9.999   
    OtherFloor                0.071   0.071   9.999   
ENDTABLE
// ============================================================================================================================================================================


// ============================================================================================================================================================================
// 141.0(b)1 Mandatory Insulation (Mass Floor Alterations)
TABLE AlteredMassFloorMaxUFactor_T24N_2016
    BldgType                  UFactor
    Residential               0.111
    NonResidential            9.999
    RelocClass                9.999
ENDTABLE
// ============================================================================================================================================================================


// ============================================================================================================================================================================
// 141.0(b)2Biii Mandatory Insulation (Roof Alterations)
TABLE AlteredRoofMaxUFactor_T24N_2016
    BldgType                  UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor
    ClimateZone=              1       2       3       4       5       6       7       8       9       10      11      12      13      14      15      16
    NonResidential            0.082   0.055   0.082   0.082   0.082   0.082   0.082   0.082   0.082   0.055   0.055   0.055   0.055   0.055   0.055   0.055
    Residential               0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055
    RelocClass                0.082   0.055   0.082   0.082   0.082   0.082   0.082   0.082   0.082   0.055   0.055   0.055   0.055   0.055   0.055   0.055
ENDTABLE
// ============================================================================================================================================================================


// ============================================================================================================================================================================
// Section 120.7 Mandatory U-Factors for New Construction 141.0(b)1 Mandatory Insulation (alterations)
// 141.0(b)1 Mandatory Insulation (Wall and Floor Alterations)
TABLE OpaqueEnvelopeMaxUFactor_T24N_2019
    TypeOfCons                UFactor UFactor UFactor  
    Status=                   New     Altered Existing
    MetalBuildingRoof         0.098   -       9.999   
    WoodFramingAndOtherRoof   0.075   -       9.999   
    MetalBuildingWall         0.113   0.113   9.999   
    MetalFrameWall            0.151   0.217   9.999   
    MassLightWall             0.440   9.999   9.999   
    MassHeavyWall             0.690   9.999   9.999   
    WoodFramingAndOtherWall   0.110   0.110   9.999   
    SpandrelWall              0.280   0.280   9.999   
    MassFloor                 0.269   -       9.999   
    OtherFloor                0.071   0.071   9.999   
ENDTABLE
// ============================================================================================================================================================================


// ============================================================================================================================================================================
// 141.0(b)1 Mandatory Insulation (Mass Floor Alterations)
TABLE AlteredMassFloorMaxUFactor_T24N_2019
    BldgType                  UFactor
    Residential               0.111
    NonResidential            9.999
    RelocClass                9.999
ENDTABLE
// ============================================================================================================================================================================


// ============================================================================================================================================================================
// 141.0(b)2Biii Mandatory Insulation (Roof Alterations)
TABLE AlteredRoofMaxUFactor_T24N_2019
    BldgType                  UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor UFactor
    ClimateZone=              1       2       3       4       5       6       7       8       9       10      11      12      13      14      15      16
    NonResidential            0.082   0.055   0.082   0.082   0.082   0.082   0.082   0.082   0.082   0.055   0.055   0.055   0.055   0.055   0.055   0.055
    Residential               0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055   0.055
    RelocClass                0.082   0.055   0.082   0.082   0.082   0.082   0.082   0.082   0.082   0.055   0.055   0.055   0.055   0.055   0.055   0.055
ENDTABLE
// ============================================================================================================================================================================




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------------- Mandatory Maximum U-Factor - New ------------------------------
RULE Proj:MtlBldgWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Metal Building Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MetalBuildingWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MetalBuildingWall",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Metal Frame Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MetalFrameWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MetalFrameWall",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Mass Light Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MassLightWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MassLightWall",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Mass Heavy Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MassHeavyWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MassHeavyWall",
                                               "Status","New")                                               
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Wood Framing And Other Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","WoodFramingAndOtherWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","WoodFramingAndOtherWall",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Spandrel Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","SpandrelWall",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","SpandrelWall",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Wood Framing And Other Roofs."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","WoodFramingAndOtherRoof",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","WoodFramingAndOtherRoof",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Metal Building Roofs."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MetalBuildingRoof",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MetalBuildingRoof",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Mass Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MassFloor",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MassFloor",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of new Other Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","OtherFloor",
                                               "Status","New")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","OtherFloor",
                                               "Status","New")
ENDRULE


// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------------- Mandatory Maximum U-Factor - Altered --------------------------
RULE Proj:MtlBldgWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of Metal Building Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MetalBuildingWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MetalBuildingWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Metal Frame Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MetalFrameWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MetalFrameWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Mass Light Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MassLightWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MassLightWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Mass Heavy Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","MassHeavyWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","MassHeavyWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Wood Framing And Other Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","WoodFramingAndOtherWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","WoodFramingAndOtherWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Spandrel Walls."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","SpandrelWall",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","SpandrelWall",
                                               "Status","Altered")
ENDRULE


// -----------------------------------------------------------------------------
//
//  Array positions: Residential [1], NonRes [2], Relocatable Classroom [3]
//
RULE Proj:AltRoofMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Metal Building Roofs."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredRoofMaxUFactor_T24N_2016:UFactor("BldgType","Residential",
                                            "ClimateZone",u:Project:CliZnNum)
  DEFAULT : T24N
    if (IfValidAnd( Project:CliZnNum > 0 ))
    then  AlteredRoofMaxUFactor_T24N_2019:UFactor("BldgType","Residential",
                                            "ClimateZone",Project:CliZnNum)
    else  UNCHANGED endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:AltRoofMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Metal Building Roofs."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredRoofMaxUFactor_T24N_2016:UFactor("BldgType","NonResidential",
                                            "ClimateZone",u:Project:CliZnNum)
  DEFAULT : T24N
    if (IfValidAnd( Project:CliZnNum > 0 ))
    then  AlteredRoofMaxUFactor_T24N_2019:UFactor("BldgType","NonResidential",
                                            "ClimateZone",Project:CliZnNum)   
    else  UNCHANGED  endif                                         
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:AltRoofMaxUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Metal Building Roofs."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredRoofMaxUFactor_T24N_2016:UFactor("BldgType","RelocClass",
                                            "ClimateZone",u:Project:CliZnNum)
  DEFAULT : T24N
    if (IfValidAnd( Project:CliZnNum > 0 ))
    then  AlteredRoofMaxUFactor_T24N_2019:UFactor("BldgType","RelocClass",
                                            "ClimateZone",Project:CliZnNum)
    else  UNCHANGED  endif
ENDRULE


// -----------------------------------------------------------------------------
//
//  Array positions: Residential [1], NonRes [2], Relocatable Classroom [3]
//
RULE Proj:AltMassFlrMaxUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Mass Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredMassFloorMaxUFactor_T24N_2016:UFactor("BldgType","Residential")
  DEFAULT : T24N
    AlteredMassFloorMaxUFactor_T24N_2019:UFactor("BldgType","Residential")
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:AltMassFlrMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Mass Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredMassFloorMaxUFactor_T24N_2016:UFactor("BldgType","NonResidential")
  DEFAULT : T24N
    AlteredMassFloorMaxUFactor_T24N_2019:UFactor("BldgType","NonResidential")
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:AltMassFlrMaxUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Mass Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    AlteredMassFloorMaxUFactor_T24N_2016:UFactor("BldgType","RelocClass")
  DEFAULT : T24N
    AlteredMassFloorMaxUFactor_T24N_2019:UFactor("BldgType","RelocClass")    
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrMaxUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The mandatory maximum u-factor of altered Other Floors."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    OpaqueEnvelopeMaxUFactor_T24N_2016:UFactor("TypeOfCons","OtherFloor",
                                               "Status","Altered")
  DEFAULT : T24N
    OpaqueEnvelopeMaxUFactor_T24N_2019:UFactor("TypeOfCons","OtherFloor",
                                               "Status","Altered")
ENDRULE


// Below are a series of variables with array indices.  The indices are:
//  - [1] New NonResidential 
//  - [2] New Residential 
//  - [3] New Relocatable Classroom 
//  - [4] Altered NonResidential 
//  - [5] Altered Residential 
//  - [6] Altered Relocatable Classroom 
//
// *****************************************************************************
// *****************************************************************************
// *****************       New NonResidential         ************************** 
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewNonRes, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Frame Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Light Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Heavy Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Spandrel Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[1]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Other Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewNonResCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[1] > 0 ) then
      MtlBldgWallUA[1] / MtlBldgWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[1] > 0 ) then
      MtlFrmWallUA[1] / MtlFrmWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[1] > 0 ) then
      MassLightWallUA[1] / MassLightWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[1] > 0 ) then
      MassHeavyWallUA[1] / MassHeavyWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[1] > 0 ) then
      WoodFrmAndOtherWallUA[1] / WoodFrmAndOtherWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[1] > 0 ) then
      SpandrelWallUA[1] / SpandrelWallArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[1] > 0 ) then
      WoodFrmAndOtherRoofUA[1] / WoodFrmAndOtherRoofArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[1] > 0 ) then
      MtlBldgRoofUA[1] / MtlBldgRoofArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[1] > 0 ) then
      MassFlrUA[1] / MassFlrArea[1]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[1]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[1] > 0 ) then
      OtherFlrUA[1] / OtherFlrArea[1]
    else UNDEFINED
    endif
ENDRULE


// *****************************************************************************
// *****************************************************************************
// *****************         New Residential          ************************** 
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewRes, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Frame Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Light Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Heavy Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Spandrel Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[2]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Other Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewResCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[2] > 0 ) then
      MtlBldgWallUA[2] / MtlBldgWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[2] > 0 ) then
      MtlFrmWallUA[2] / MtlFrmWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[2] > 0 ) then
      MassLightWallUA[2] / MassLightWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[2] > 0 ) then
      MassHeavyWallUA[2] / MassHeavyWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[2] > 0 ) then
      WoodFrmAndOtherWallUA[2] / WoodFrmAndOtherWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[2] > 0 ) then
      SpandrelWallUA[2] / SpandrelWallArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[2] > 0 ) then
      WoodFrmAndOtherRoofUA[2] / WoodFrmAndOtherRoofArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[2] > 0 ) then
      MtlBldgRoofUA[2] / MtlBldgRoofArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[2] > 0 ) then
      MassFlrUA[2] / MassFlrArea[2]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[2]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[2] > 0 ) then
      OtherFlrUA[2] / OtherFlrArea[2]
    else UNDEFINED
    endif
ENDRULE


// *****************************************************************************
// *****************************************************************************
// *****************    New Relocatable Classroom      *************************
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueNewReloc, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Frame Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Light Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Heavy Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Spandrel Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Wood Framing And Other Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Metal Building Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Mass Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[3]
  RULESETS
    T24N
  DESCRIPTION
    "The total new area of Other Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaNewRelocCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[3] > 0 ) then
      MtlBldgWallUA[3] / MtlBldgWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[3] > 0 ) then
      MtlFrmWallUA[3] / MtlFrmWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[3] > 0 ) then
      MassLightWallUA[3] / MassLightWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[3] > 0 ) then
      MassHeavyWallUA[3] / MassHeavyWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[3] > 0 ) then
      WoodFrmAndOtherWallUA[3] / WoodFrmAndOtherWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[3] > 0 ) then
      SpandrelWallUA[3] / SpandrelWallArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[3] > 0 ) then
      WoodFrmAndOtherRoofUA[3] / WoodFrmAndOtherRoofArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[3] > 0 ) then
      MtlBldgRoofUA[3] / MtlBldgRoofArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[3] > 0 ) then
      MassFlrUA[3] / MassFlrArea[3]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[3]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[3] > 0 ) then
      OtherFlrUA[3] / OtherFlrArea[3]
    else UNDEFINED
    endif
ENDRULE


//
// *****************************************************************************
// *****************************************************************************
// ***************       Altered NonResidential         ************************
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltNonRes, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Frame Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Light Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Heavy Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Spandrel Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[4]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Other Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltNonResCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[4] > 0 ) then
      MtlBldgWallUA[4] / MtlBldgWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[4] > 0 ) then
      MtlFrmWallUA[4] / MtlFrmWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[4] > 0 ) then
      MassLightWallUA[4] / MassLightWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[4] > 0 ) then
      MassHeavyWallUA[4] / MassHeavyWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[4] > 0 ) then
      WoodFrmAndOtherWallUA[4] / WoodFrmAndOtherWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[4] > 0 ) then
      SpandrelWallUA[4] / SpandrelWallArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[4] > 0 ) then
      WoodFrmAndOtherRoofUA[4] / WoodFrmAndOtherRoofArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[4] > 0 ) then
      MtlBldgRoofUA[4] / MtlBldgRoofArea[4]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[4] > 0 ) then
      MassFlrUA[4] / MassFlrArea[4]
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else  
    if( MassFlrArea[4] > 0 ) then
      if( MassFlrUFac[4] > AltMassFlrMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Mass Floors 
                   assigned to nonresidential spaces
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",MassFlrUFac[4],
                   AltMassFlrMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[4]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     altered non-residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[4] > 0 ) then
      OtherFlrUA[4] / OtherFlrArea[4]
    else UNDEFINED
    endif
ENDRULE


// *****************************************************************************
// *****************************************************************************
// *****************       Altered Residential         *************************
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltRes, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Frame Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Light Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Heavy Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Spandrel Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[5]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Other Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltResCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[5] > 0 ) then
      MtlBldgWallUA[5] / MtlBldgWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[5] > 0 ) then
      MtlFrmWallUA[5] / MtlFrmWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[5] > 0 ) then
      MassLightWallUA[5] / MassLightWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[5] > 0 ) then
      MassHeavyWallUA[5] / MassHeavyWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[5] > 0 ) then
      WoodFrmAndOtherWallUA[5] / WoodFrmAndOtherWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[5] > 0 ) then
      SpandrelWallUA[5] / SpandrelWallArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[5] > 0 ) then
      WoodFrmAndOtherRoofUA[5] / WoodFrmAndOtherRoofArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[5] > 0 ) then
      MtlBldgRoofUA[5] / MtlBldgRoofArea[5]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[5] > 0 ) then
      MassFlrUA[5] / MassFlrArea[5]
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MassFlrArea[5] > 0 ) then
      if( MassFlrUFac[5] > AltMassFlrMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Mass Floors 
                   assigned to residential spaces
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",MassFlrUFac[5],
                   AltMassFlrMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[5]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     altered residential portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[5] > 0 ) then
      OtherFlrUA[5] / OtherFlrArea[5]
    else UNDEFINED
    endif
ENDRULE


// *****************************************************************************
// *****************************************************************************
// *****************    Altered Relocatable Classroom     **********************
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type UA --------------------------------------
RULE Proj:MtlBldgWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Frame Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Light Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Heavy Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Spandrel Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Wood Framing And Other Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Metal Building Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Mass Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUA[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total UA value of Other Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:UAValueAltReloc, ConsAssm:ConsType = "OtherFloor" )
ENDRULE




// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Total Area --------------------------------------
RULE Proj:MtlBldgWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MetalBuildingWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Frame Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MetalFrameWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Light Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MassLightWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Heavy Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MassHeavyWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "WoodFramingAndOtherWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Spandrel Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "SpandrelWall" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Wood Framing And Other Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "WoodFramingAndOtherRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Metal Building Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MetalBuildingRoof" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Mass Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "MassFloor" )
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrArea[6]
  RULESETS
    T24N
  DESCRIPTION
    "The total altered area of Other Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( ConsAssm:AreaAltRelocCond, ConsAssm:ConsType = "OtherFloor" )
ENDRULE



// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
RULE Proj:MtlBldgWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[6] > 0 ) then
      MtlBldgWallUA[6] / MtlBldgWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[6] > 0 ) then
      MtlFrmWallUA[6] / MtlFrmWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[6] > 0 ) then
      MassLightWallUA[6] / MassLightWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[6] > 0 ) then
      MassHeavyWallUA[6] / MassHeavyWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[6] > 0 ) then
      WoodFrmAndOtherWallUA[6] / WoodFrmAndOtherWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[6] > 0 ) then
      SpandrelWallUA[6] / SpandrelWallArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[6] > 0 ) then
      WoodFrmAndOtherRoofUA[6] / WoodFrmAndOtherRoofArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[6] > 0 ) then
      MtlBldgRoofUA[6] / MtlBldgRoofArea[6]
    else UNDEFINED
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[6] > 0 ) then
      MassFlrUA[6] / MassFlrArea[6]
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MassFlrArea[6] > 0 ) then
      if( MassFlrUFac[6] > AltMassFlrMaxUFac[3] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Mass Floors 
                   assigned to relocatable classrooms
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",MassFlrUFac[6],
                   AltMassFlrMaxUFac[3])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[6]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     altered relocatable classroom portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[6] > 0 ) then
      OtherFlrUA[6] / OtherFlrArea[6]
    else UNDEFINED
    endif
ENDRULE



// Below are a series of variables with array indices.  The indices are:
//  - [1] New NonResidential 
//  - [2] New Residential 
//  - [3] New Relocatable Classroom 
//  - [4] Altered NonResidential 
//  - [5] Altered Residential 
//  - [6] Altered Relocatable Classroom 
//
// For the area weighted u-factor checks, we need to combine into new and 
// altered by construction type.  So we add two additional indices:
//  - [7] New
//  - [8] Altered
//
// *****************************************************************************
// *****************************************************************************
// *****************              New                 ************************** 
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
//
RULE Proj:MtlBldgWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[1] + MtlBldgWallArea[2] + MtlBldgWallArea[3]  > 0 ) then
      ( MtlBldgWallUA[1] + MtlBldgWallUA[2] + MtlBldgWallUA[3] ) /
      ( MtlBldgWallArea[1] + MtlBldgWallArea[2] + MtlBldgWallArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MtlBldgWallArea[1] + MtlBldgWallArea[2] + MtlBldgWallArea[3] > 0 ) then
      if( MtlBldgWallUFac[7] > MtlBldgWallMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Metal Building Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",MtlBldgWallUFac[7],
                   MtlBldgWallMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[1] + MtlFrmWallArea[2] + MtlFrmWallArea[3]  > 0 ) then
      ( MtlFrmWallUA[1] + MtlFrmWallUA[2] + MtlFrmWallUA[3] ) /
      ( MtlFrmWallArea[1] + MtlFrmWallArea[2] + MtlFrmWallArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MtlFrmWallArea[1] + MtlFrmWallArea[2] + MtlFrmWallArea[3] > 0 ) then
      if( MtlFrmWallUFac[7] > MtlFrmWallMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Metal Frame Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",MtlFrmWallUFac[7],
                   MtlFrmWallMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[1] + MassLightWallArea[2] + MassLightWallArea[3]  > 0 ) then
      ( MassLightWallUA[1] + MassLightWallUA[2] + MassLightWallUA[3] ) /
      ( MassLightWallArea[1] + MassLightWallArea[2] + MassLightWallArea[3] ) 
    else UNDEFINED
    endif
  // No checkcode for new mass walls, 
  // mandatory u-factor must be met by each wall construction
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[1] + MassHeavyWallArea[2] + MassHeavyWallArea[3]  > 0 ) then
      ( MassHeavyWallUA[1] + MassHeavyWallUA[2] + MassHeavyWallUA[3] ) /
      ( MassHeavyWallArea[1] + MassHeavyWallArea[2] + MassHeavyWallArea[3] ) 
    else UNDEFINED
    endif
  // No checkcode for new mass walls, 
  // mandatory u-factor must be met by each wall construction
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[1] + WoodFrmAndOtherWallArea[2] + WoodFrmAndOtherWallArea[3]  > 0 ) then
      ( WoodFrmAndOtherWallUA[1] + WoodFrmAndOtherWallUA[2] + WoodFrmAndOtherWallUA[3] ) /
      ( WoodFrmAndOtherWallArea[1] + WoodFrmAndOtherWallArea[2] + WoodFrmAndOtherWallArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( WoodFrmAndOtherWallArea[1] + WoodFrmAndOtherWallArea[2] + WoodFrmAndOtherWallArea[3] > 0 ) then
      if( WoodFrmAndOtherWallUFac[7] > WoodFrmAndOtherWallMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Wood Framing And Other Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",WoodFrmAndOtherWallUFac[7],
                   WoodFrmAndOtherWallMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[1] + SpandrelWallArea[2] + SpandrelWallArea[3]  > 0 ) then
      ( SpandrelWallUA[1] + SpandrelWallUA[2] + SpandrelWallUA[3] ) /
      ( SpandrelWallArea[1] + SpandrelWallArea[2] + SpandrelWallArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( SpandrelWallArea[1] + SpandrelWallArea[2] + SpandrelWallArea[3] > 0 ) then
      if( SpandrelWallUFac[7] > SpandrelWallMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Spandrel Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",SpandrelWallUFac[7],
                   SpandrelWallMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[1] + WoodFrmAndOtherRoofArea[2] + WoodFrmAndOtherRoofArea[3]  > 0 ) then
      ( WoodFrmAndOtherRoofUA[1] + WoodFrmAndOtherRoofUA[2] + WoodFrmAndOtherRoofUA[3] ) /
      ( WoodFrmAndOtherRoofArea[1] + WoodFrmAndOtherRoofArea[2] + WoodFrmAndOtherRoofArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( WoodFrmAndOtherRoofArea[1] + WoodFrmAndOtherRoofArea[2] + WoodFrmAndOtherRoofArea[3] > 0 ) then
      if( WoodFrmAndOtherRoofUFac[7] > WoodFrmAndOtherRoofMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Wood Framing And Other Roofs 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",WoodFrmAndOtherRoofUFac[7],
                   WoodFrmAndOtherRoofMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[1] + MtlBldgRoofArea[2] + MtlBldgRoofArea[3]  > 0 ) then
      ( MtlBldgRoofUA[1] + MtlBldgRoofUA[2] + MtlBldgRoofUA[3] ) /
      ( MtlBldgRoofArea[1] + MtlBldgRoofArea[2] + MtlBldgRoofArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MtlBldgRoofArea[1] + MtlBldgRoofArea[2] + MtlBldgRoofArea[3] > 0 ) then
      if( MtlBldgRoofUFac[7] > MtlBldgRoofMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Metal Building Roofs 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",MtlBldgRoofUFac[7],
                   MtlBldgRoofMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[1] + MassFlrArea[2] + MassFlrArea[3]  > 0 ) then
      ( MassFlrUA[1] + MassFlrUA[2] + MassFlrUA[3] ) /
      ( MassFlrArea[1] + MassFlrArea[2] + MassFlrArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MassFlrArea[1] + MassFlrArea[2] + MassFlrArea[3] > 0 ) then
      if( MassFlrUFac[7] > MassFlrMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Mass Floors 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",MassFlrUFac[7],
                   MassFlrMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[7]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     new portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[1] + OtherFlrArea[2] + OtherFlrArea[3]  > 0 ) then
      ( OtherFlrUA[1] + OtherFlrUA[2] + OtherFlrUA[3] ) /
      ( OtherFlrArea[1] + OtherFlrArea[2] + OtherFlrArea[3] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( OtherFlrArea[1] + OtherFlrArea[2] + OtherFlrArea[3] > 0 ) then
      if( OtherFlrUFac[7] > OtherFlrMaxUFac[1] + 0.001 ) then
        PostError("The area weighted average u-factor of new Other Floors 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 120.7.",OtherFlrUFac[7],
                   OtherFlrMaxUFac[1])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE

//
// *****************************************************************************
// *****************************************************************************
// *****************            Altered               ************************** 
// *****************************************************************************
// *****************************************************************************
// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
// ------- Construction Type Area Weighted UValue ------------------------------
//
RULE Proj:MtlBldgWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgWallArea[4] + MtlBldgWallArea[5] + MtlBldgWallArea[6]  > 0 ) then
      ( MtlBldgWallUA[4] + MtlBldgWallUA[5] + MtlBldgWallUA[6] ) /
      ( MtlBldgWallArea[4] + MtlBldgWallArea[5] + MtlBldgWallArea[6] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MtlBldgWallArea[4] + MtlBldgWallArea[5] + MtlBldgWallArea[6] > 0 ) then
      if( MtlBldgWallUFac[8] > MtlBldgWallMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Metal Building Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",MtlBldgWallUFac[8],
                   MtlBldgWallMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlFrmWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Frame Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlFrmWallArea[4] + MtlFrmWallArea[5] + MtlFrmWallArea[6]  > 0 ) then
      ( MtlFrmWallUA[4] + MtlFrmWallUA[5] + MtlFrmWallUA[6] ) /
      ( MtlFrmWallArea[4] + MtlFrmWallArea[5] + MtlFrmWallArea[6] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( MtlFrmWallArea[4] + MtlFrmWallArea[5] + MtlFrmWallArea[6] > 0 ) then
      if( MtlFrmWallUFac[8] > MtlFrmWallMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Metal Frame Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",MtlFrmWallUFac[8],
                   MtlFrmWallMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassLightWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Light Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassLightWallArea[4] + MassLightWallArea[5] + MassLightWallArea[6]  > 0 ) then
      ( MassLightWallUA[4] + MassLightWallUA[5] + MassLightWallUA[6] ) /
      ( MassLightWallArea[4] + MassLightWallArea[5] + MassLightWallArea[6] ) 
    else UNDEFINED
    endif
  // No checkcode for altered mass walls, no mandatory requirement
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassHeavyWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Heavy Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassHeavyWallArea[4] + MassHeavyWallArea[5] + MassHeavyWallArea[6]  > 0 ) then
      ( MassHeavyWallUA[4] + MassHeavyWallUA[5] + MassHeavyWallUA[6] ) /
      ( MassHeavyWallArea[4] + MassHeavyWallArea[5] + MassHeavyWallArea[6] ) 
    else UNDEFINED
    endif
  // No checkcode for altered mass walls, no mandatory requirement
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherWallArea[4] + WoodFrmAndOtherWallArea[5] + WoodFrmAndOtherWallArea[6]  > 0 ) then
      ( WoodFrmAndOtherWallUA[4] + WoodFrmAndOtherWallUA[5] + WoodFrmAndOtherWallUA[6] ) /
      ( WoodFrmAndOtherWallArea[4] + WoodFrmAndOtherWallArea[5] + WoodFrmAndOtherWallArea[6] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( WoodFrmAndOtherWallArea[4] + WoodFrmAndOtherWallArea[5] + WoodFrmAndOtherWallArea[6] > 0 ) then
      if( WoodFrmAndOtherWallUFac[8] > WoodFrmAndOtherWallMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Wood Framing And Other Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",WoodFrmAndOtherWallUFac[8],
                   WoodFrmAndOtherWallMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:SpandrelWallUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Spandrel Walls used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( SpandrelWallArea[4] + SpandrelWallArea[5] + SpandrelWallArea[6]  > 0 ) then
      ( SpandrelWallUA[4] + SpandrelWallUA[5] + SpandrelWallUA[6] ) /
      ( SpandrelWallArea[4] + SpandrelWallArea[5] + SpandrelWallArea[6] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( SpandrelWallArea[4] + SpandrelWallArea[5] + SpandrelWallArea[6] > 0 ) then
      if( SpandrelWallUFac[8] > SpandrelWallMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Spandrel Walls 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",SpandrelWallUFac[8],
                   SpandrelWallMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:WoodFrmAndOtherRoofUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Wood Framing And Other Roofs used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( WoodFrmAndOtherRoofArea[4] + WoodFrmAndOtherRoofArea[5] + WoodFrmAndOtherRoofArea[6]  > 0 ) then
      ( WoodFrmAndOtherRoofUA[4] + WoodFrmAndOtherRoofUA[5] + WoodFrmAndOtherRoofUA[6] ) /
      ( WoodFrmAndOtherRoofArea[4] + WoodFrmAndOtherRoofArea[5] + WoodFrmAndOtherRoofArea[6] ) 
    else UNDEFINED
    endif
  // No checkcode for altered roofs here, 
  // mandatory requirement applied separately by building type
  // See WoodFrmAndOtherRoofUFac [4], [5], and [6]
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MtlBldgRoofUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Metal Building Roofs used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MtlBldgRoofArea[4] + MtlBldgRoofArea[5] + MtlBldgRoofArea[6]  > 0 ) then
      ( MtlBldgRoofUA[4] + MtlBldgRoofUA[5] + MtlBldgRoofUA[6] ) /
      ( MtlBldgRoofArea[4] + MtlBldgRoofArea[5] + MtlBldgRoofArea[6] ) 
    else UNDEFINED
    endif
  // No checkcode for altered roofs here, 
  // mandatory requirement applied separately by building type
  // See MtlBldgRoofUFac [4], [5], and [6]
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:MassFlrUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Mass Floors used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( MassFlrArea[4] + MassFlrArea[5] + MassFlrArea[6]  > 0 ) then
      ( MassFlrUA[4] + MassFlrUA[5] + MassFlrUA[6] ) /
      ( MassFlrArea[4] + MassFlrArea[5] + MassFlrArea[6] ) 
    else UNDEFINED
    endif
  // No checkcode for altered mass floors here, 
  // mandatory requirement applied separately by building type
  // See MassFlrUFac [4], [5], and [6]
ENDRULE


// -----------------------------------------------------------------------------
//
RULE Proj:OtherFlrUFac[8]
  RULESETS
    T24N
  DESCRIPTION
    "The area weighted u-factor of Other Floors used in the 
     altered portions of the project."
  HELP
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( OtherFlrArea[4] + OtherFlrArea[5] + OtherFlrArea[6]  > 0 ) then
      ( OtherFlrUA[4] + OtherFlrUA[5] + OtherFlrUA[6] ) /
      ( OtherFlrArea[4] + OtherFlrArea[5] + OtherFlrArea[6] ) 
    else UNDEFINED
    endif
  CHECKCODE
    if( IfValidAnd( Proj:DisableMandUFacChecks = 1 )) then UNCHANGED else
    if( OtherFlrArea[4] + OtherFlrArea[5] + OtherFlrArea[6] > 0 ) then
      if( OtherFlrUFac[8] > OtherFlrMaxUFac[2] + 0.001 ) then
        PostError("The area weighted average u-factor of altered Other Floors 
                   in the project, '%.3f', exceeds the maximum allowable value, 
                   '%.3f', violating Section 141.0(b).",OtherFlrUFac[8],
                   OtherFlrMaxUFac[2])
      else UNCHANGED
      endif
    else UNCHANGED
    endif
    endif
ENDRULE
