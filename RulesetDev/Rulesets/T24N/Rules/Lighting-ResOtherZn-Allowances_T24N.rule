// Area Category and Tailored Lighting Power Allowances
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2017, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------

//  This rule file addresses the following building descriptors:
//  Section 5.4.4 - Interior Lighting
//      General Lighting Exceptional Power
//      General Lighting Exceptional Task Area
//      Custom Lighting Power
//      ..
// ********** Additional Lighting Power Allowances - ResOtherZn ********************

// ---------- Area Category Allowances ----------------------------------------
RULE NEW ResOtherZn:ACMDetTaskArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     DetailedTaskWork"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="DetailedTaskWork" )
ENDRULE
RULE NEW ResOtherZn:ACMSpecTaskArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     SpecializedLabTaskWork"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT 
    SumChildrenIf( IntLtgSys:AllowArea,
                    IntLtgSys:AllowType=="SpecializedTaskWork" )
ENDRULE
RULE NEW ResOtherZn:ACMOrnamentalArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     Ornamental (renamed as Decorative/Display in T24N_2022)"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf(IntLtgSys:AllowArea,
                  IntLtgSys:AllowType=="Decorative/Display" )
ENDRULE
RULE NEW ResOtherZn:ACMPrecArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     PrecisionWork"
  INPUTCLASS 
    NotInput     
  UNITS
    ft2    
  DEFAULT
    SumChildrenIf(IntLtgSys:AllowArea,
                  IntLtgSys:AllowType=="PrecisionWork" )
ENDRULE
RULE NEW ResOtherZn:ACMWhtOrChkLenght
  DATATYPE
    Float
  DESCRIPTION
    "The Total Length of a Space claiming a lighting allowance for 
     WhiteOrChalkBoard"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowLen,
                   IntLtgSys:AllowType=="WhiteOrChalkBoard" )
ENDRULE
RULE NEW ResOtherZn:ACMAccentDispArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     AccentDisplayFeature"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="AccentDisplayFeature" )
ENDRULE
RULE NEW ResOtherZn:ACMAccentDispMuseumArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     AccentDisplayFeatureMuseum"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="AccentDisplayFeatureMuseum" )
ENDRULE
RULE NEW ResOtherZn:ACMDecorArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     Decorative"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="Decorative" )
ENDRULE
RULE NEW ResOtherZn:ACMVideoArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     VideoconferencingStudioLighting"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="VideoconferencingStudioLighting" )
ENDRULE
RULE NEW ResOtherZn:ACMPrkgATMQty
  DATATYPE
    Float
  DESCRIPTION
    "The Total Number of ATMs/Ticket Machines for which an Parking Garage lighting 
     allowance is being claimed."
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowQty,
                   IntLtgSys:AllowType=="ParkingGarageATM/TicketMachine" )
ENDRULE
RULE NEW ResOtherZn:ACMPortOffLtgArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for
     Portable ( & Decorative/Display ) Office Lighting"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="Decorative/Display&PortableLightingForOffice" )
ENDRULE
RULE NEW ResOtherZn:ACMExtIllumMirrorQty
  DATATYPE
    Float
  DESCRIPTION
    "The Total Number of Mirrors for which an External Illuminated Mirror lighting 
     allowance is being claimed."
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowQty,
                   IntLtgSys:AllowType=="ExternalIlluminatedMirror" )
ENDRULE
RULE NEW ResOtherZn:ACMIntIllumMirrorQty
  DATATYPE
    Float
  DESCRIPTION
    "The Total Number of Mirrors for which an Internal Illuminated Mirror lighting 
     allowance is being claimed."
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowQty,
                   IntLtgSys:AllowType=="InternalIlluminatedMirror" )
ENDRULE
RULE NEW ResOtherZn:ACMTransLtgOffAtNightArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     Transition Lighting Off At Night"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="TransitionLightingOffAtNight" )
ENDRULE
RULE NEW ResOtherZn:ACMTunWhtOrDimToWarmArea
  DATATYPE
    Float
  DESCRIPTION
    "The Total Area of a Space claiming a lighting allowance for 
     Tunable White or Dim to Warm"
  INPUTCLASS 
    NotInput         
  UNITS
    ft2
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea,
                   IntLtgSys:AllowType=="TunableWhiteOrDimToWarm" )
ENDRULE
RULE NEW ResOtherZn:ACMDetTaskAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional DetailedTaskWork Allowance Calculated using the 
     Area Category Method"
  INPUTCLASS 
    NotInput
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "DetailedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMDetTaskAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMDetTaskArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "DetailedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMDetTaskAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMDetTaskArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "DetailedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMDetTaskAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMDetTaskArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMSpecTaskAllow
  DESCRIPTION
    "Additional SpecializedTaskWork Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput    
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "SpecializedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMSpecTaskAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMSpecTaskArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "SpecializedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMSpecTaskAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMSpecTaskArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "SpecializedTaskWork" )
    then MIN( SumChildren( IntLtgSys:ACMSpecTaskAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMSpecTaskArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMOrnamentalAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Ornamental Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput          
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "Decorative/Display" )
    then MIN( SumChildren( IntLtgSys:ACMOrnamentalAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMOrnamentalArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "Decorative/Display" )
    then MIN( SumChildren( IntLtgSys:ACMOrnamentalAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMOrnamentalArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "Decorative/Display" )
    then MIN( SumChildren( IntLtgSys:ACMOrnamentalAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMOrnamentalArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:AMCPrecAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Precision Work Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput        
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "PrecisionWork" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMPrecArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "PrecisionWork" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMPrecArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "PrecisionWork" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMPrecArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:WhtOrChkAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional WhiteOrChalkBoard Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput          
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "WhiteOrChalkBoard (W/ft)" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMPrecArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "WhiteOrChalkBoard (W/ft)" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMPrecArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "WhiteOrChalkBoard (W/ft)" )
    then MIN( SumChildren( IntLtgSys:AMCPrecAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMPrecArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMVideoAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional VideoconferencingStudioLighting Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput         
  UNITS
    Watts 
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "VideoconferencingStudioLighting" )
    then MIN( SumChildren( IntLtgSys:ACMVideoAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMVideoArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "VideoconferencingStudioLighting" )
    then MIN( SumChildren( IntLtgSys:ACMVideoAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMVideoArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "VideoconferencingStudioLighting" )
    then MIN( SumChildren( IntLtgSys:ACMVideoAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMVideoArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMPrkgATMAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional ATM/Ticket Machine Allowance Calculated using the Area Categroy Method."
  INPUTCLASS 
    NotInput         
  UNITS
    Watts 
  DEFAULT
    if( IfValidAnd( ACMPrkgATMQty > 0 ) )
    then MIN( SumChildren( IntLtgSys:ACMPrkgATMAllow ),
              100+50*(ACMPrkgATMQty-1) )
    else 0
    endif
ENDRULE
RULE NEW ResOtherZn:ACMPortOffLtgAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Portable Office Lighting Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput         
  UNITS
    Watts 
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "Decorative/Display&PortableLightingForOffice" )
    then MIN( SumChildren( IntLtgSys:ACMPortOffLtgAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMPortOffLtgArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "Decorative/Display&PortableLightingForOffice" )
    then MIN( SumChildren( IntLtgSys:ACMPortOffLtgAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMPortOffLtgArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "Decorative/Display&PortableLightingForOffice" )
    then MIN( SumChildren( IntLtgSys:ACMPortOffLtgAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMPortOffLtgArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMExtIllumMirrorAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional External Illuminated Mirror Lighting Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput         
  UNITS
    Watts 
  DEFAULT
    MIN( SumChildren( IntLtgSys:ACMExtIllumMirrorAllow ) , 
                      40 * ACMExtIllumMirrorQty )
ENDRULE
RULE NEW ResOtherZn:ACMIntIllumMirrorAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Internal Illuminated Mirror Lighting Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput         
  UNITS
    Watts 
  DEFAULT
    MIN( SumChildren( IntLtgSys:ACMIntIllumMirrorAllow ) , 
                      120 * ACMIntIllumMirrorQty )
ENDRULE
RULE NEW ResOtherZn:ACMTransLtgOffAtNightAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Transition Lighting Off at Night Allowance Calculated using the 
     Area Category Method"
  INPUTCLASS 
    NotInput
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "TransitionLightingOffAtNight" )
    then MIN( SumChildren( IntLtgSys:ACMTransLtgOffAtNightAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMTransLtgOffAtNightArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "TransitionLightingOffAtNight" )
    then MIN( SumChildren( IntLtgSys:ACMTransLtgOffAtNightAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMTransLtgOffAtNightArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "TransitionLightingOffAtNight" )
    then MIN( SumChildren( IntLtgSys:ACMTransLtgOffAtNightAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMTransLtgOffAtNightArea )
    else 0
    endif endif endif
ENDRULE
RULE NEW ResOtherZn:ACMTunWhtOrDimToWarmAllow
  DATATYPE
    Float
  DESCRIPTION
    "Additional Tunable White or Dim to Warm Allowance Calculated using the 
     Area Category Method"
  INPUTCLASS 
    NotInput
  UNITS 
    Watts
  DEFAULT
    if( SpaceFunctionData:AllowType1( "FuncType", SpcFunc ) = "TunableWhiteOrDimToWarm" )
    then MIN( SumChildren( IntLtgSys:ACMTunWhtOrDimToWarmAllow ),SpaceFunctionData:AllowArea1( "FuncType", SpcFunc )*ACMTunWhtOrDimToWarmArea )
    else if( SpaceFunctionData:AllowType2( "FuncType", SpcFunc ) = "TunableWhiteOrDimToWarm" )
    then MIN( SumChildren( IntLtgSys:ACMTunWhtOrDimToWarmAllow ),SpaceFunctionData:AllowArea2( "FuncType", SpcFunc )*ACMTunWhtOrDimToWarmArea )
    else if( SpaceFunctionData:AllowType3( "FuncType", SpcFunc ) = "TunableWhiteOrDimToWarm" )
    then MIN( SumChildren( IntLtgSys:ACMTunWhtOrDimToWarmAllow ),SpaceFunctionData:AllowArea3( "FuncType", SpcFunc )*ACMTunWhtOrDimToWarmArea )
    else 0
    endif endif endif
ENDRULE

RULE NEW ResOtherZn:ACMTotAllowPwr
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput 
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if ( IntLtgSpecMthd = "AreaCategoryMethod" ) 
    then 
    ( ACMDetTaskAllow + 
      ACMSpecTaskAllow +
      ACMOrnamentalAllow + 
      AMCPrecAllow + 
      WhtOrChkAllow +
      ACMVideoAllow +
      ACMPrkgATMAllow+
      ACMPortOffLtgAllow + 
      ACMExtIllumMirrorAllow +
      ACMIntIllumMirrorAllow +
      ACMTransLtgOffAtNightAllow +
      ACMTunWhtOrDimToWarmAllow )
    else 0
    endif
ENDRULE
RULE NEW ResOtherZn:ACMTotAllowPwrWithMult
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance Calculated using the Area Category Allowance
    inlcuding space multiplier."
  INPUTCLASS 
    NotInput 
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if ( IntLtgSpecMthd = "AreaCategoryMethod" ) 
    then 
      ValidOr(ACMTotAllowPwr,0) * 1 ; ResOtherZn doesn't have multiplier
    else 0
    endif
ENDRULE
RULE NEW ResOtherZn:CondACMTotAllowPwr
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance for conditioned spaces, Calculated using the 
     Area Category Method"
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if( Type = "Conditioned" ) 
    then ACMTotAllowPwr
    else 0
    endif
  SIZING
    switch ( ApplyStdLtg )
    case  1: UNDEFINED   ; Installed lighting is Undefined for standard design
    default:             ; proposed design
      if( Type = "Conditioned" ) 
      then ACMTotAllowPwr
      else 0
      endif
    endswitch
ENDRULE
RULE NEW ResOtherZn:CondACMTotAllowPwrWithMult
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance for conditioned spaces, Calculated using the 
     Area Category Method including floor multipliers."
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if( Type = "Conditioned" ) 
    then ValidOr(ACMTotAllowPwr,0) * 1 ; ResOtherZn doesn't have multiplier
    else 0
    endif
  SIZING
    switch ( ApplyStdLtg )
    case  1: UNDEFINED   ; Installed lighting is Undefined for standard design
    default:             ; proposed design
      if( Type = "Conditioned" ) 
      then ValidOr(ACMTotAllowPwr,0) * 1 ; ResOtherZn doesn't have multiplier
      else 0
      endif
    endswitch
ENDRULE
RULE NEW ResOtherZn:UncondACMTotAllowPwr
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance for unconditioned spaces, Calculated using the
     Area Category Method"
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if( Type = "Conditioned" ) 
    then 0
    else ACMTotAllowPwr
    endif
  SIZING
    switch ( ApplyStdLtg )
    case  1: UNDEFINED   ; Installed lighting is Undefined for standard design
    default:             ; proposed design
      if( Type = "Conditioned" ) 
      then 0
      else ACMTotAllowPwr
      endif
    endswitch
ENDRULE
RULE NEW ResOtherZn:UncondACMTotAllowPwrWithMult
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance for unconditioned spaces, Calculated using the
     Area Category Method including floor multiplier"
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if( Type = "Conditioned" ) 
    then 0
    else ValidOr(ACMTotAllowPwr,0) * 1 ; ResOtherZn doesn't have multiplier
    endif
  SIZING
    switch ( ApplyStdLtg )
    case  1: UNDEFINED   ; Installed lighting is Undefined for standard design
    default:             ; proposed design
      if( Type = "Conditioned" ) 
      then 0
      else ValidOr(ACMTotAllowPwr,0) * 1 ; ResOtherZn doesn't have multiplier
      endif
    endswitch
ENDRULE
RULE NEW ResOtherZn:ACMTotAllowLPD
  DATATYPE
    Float
  LONGFORM
    AreaCategoryMethodTotalAllowanceLightingPowerDensity
  DESCRIPTION
    "Total Additional Allowance Calculated using the Area Category Allowance"
  INPUTCLASS 
    NotInput         
  MINIMUM 
    0
  MAXIMUM 
    10    
  UNITS 
    Watts/ft2
  DEFAULT
    if( IfValidAnd( Area > 0 ) )
    then ACMTotAllowPwr/Area
    else 0
    endif
ENDRULE

// ---------- Tailored Allowances ---------------------------------------------
RULE NEW ResOtherZn:TMWallDispAllowLen
  DATATYPE
    FLoat
  DESCRIPTION
    "Total Length claimed for the tailored wall display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    ft
  REPORTPRECISION
    0
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowLen, 
                   IntLtgSys:AllowType = "TailoredWallDisplayAllowance" )
ENDRULE
RULE NEW ResOtherZn:TMWallDispDsgn
  DATATYPE
    FLoat
  DESCRIPTION
   "Design power of interior lighting systems claiming the tailored wall 
    display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    SumChildren( IntLtgSys:TMWallDispAllow )
ENDRULE
RULE NEW ResOtherZn:TMWallDispMax
  DATATYPE
    FLoat
  DESCRIPTION
   "Maximum allowance available for interior lighting systems claiming the
    tailored wall display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    SumChildren( IntLtgSys:TMWallDispMax )
ENDRULE
RULE NEW ResOtherZn:TMWallDispAllow
  DATATYPE
    FLoat
  DESCRIPTION
    "The total tailored wall display allowance for all interior lighting systems in the
     building.  This value is the smaller of the design wall display power and
     the maximum wall display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    MIN( TMWallDispDsgn, TMWallDispMax)
ENDRULE

RULE NEW ResOtherZn:TMFlrDispAllowArea
  DATATYPE
    Float
  LONGFORM
    TailoredMethodFloorDisplayAllowanceArea
  DESCRIPTION
    "Total Area claimed for the tailored floor display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea, 
                   IntLtgSys:AllowType = "TailoredFloorDisplayAllowance" )
ENDRULE
RULE NEW ResOtherZn:TMTaskAllowArea
  DATATYPE
    Float
  LONGFORM
    TailoredMethodTaskAllowanceArea
  DESCRIPTION
    "Total Area claimed for the tailored task allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea, 
                   IntLtgSys:AllowType = "TailoredTaskAllowance" )
ENDRULE
RULE NEW ResOtherZn:TMCmbdFlrDispTaskAllowArea
  DATATYPE
    Float
  DESCRIPTION
    "Total Area claimed for the tailored floor display or task allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    ft2
  REPORTPRECISION
    0
  DEFAULT
    TMFlrDispAllowArea + TMTaskAllowArea
ENDRULE
RULE NEW ResOtherZn:TMFlrDispDsgn
  DATATYPE
    Float
  LONGFORM
    TailoredMethodFloorDisplayDesign
  DESCRIPTION
    "Design power of interior lighting systems claiming the tailored floor 
     display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildren( IntLtgSys:TMFlrDispAllow )
ENDRULE
RULE NEW ResOtherZn:TMTaskDsgn
  DATATYPE
    Float
  LONGFORM
    TailoredMethodTaskDesign
  DESCRIPTION
    "Design power of interior lighting systems claiming the tailored task
     allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildren( IntLtgSys:TMTaskAllow )
ENDRULE
RULE NEW ResOtherZn:TMCmbdFlrDispTaskDsgn
  DATATYPE
    Float
  DESCRIPTION
    "Design power of interior lighting systems claiming the tailored floor 
     display or task allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    TMFlrDispDsgn + TMTaskDsgn
ENDRULE
RULE NEW ResOtherZn:TMFlrDispMax
  DATATYPE
    Float
  LONGFORM
    TailoredMethodFloorDisplayMaximum
  DESCRIPTION
   "Maximum allowaance available for interior lighting systems claiming the
    tailored floor display allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildren( IntLtgSys:TMFlrDispMax )
ENDRULE
RULE NEW ResOtherZn:TMTaskMax
  DATATYPE
    Float
  LONGFORM
    TailoredMethodTaskMaximum
  DESCRIPTION
   "Maximum allowaance available for interior lighting systems claiming the
    tailored task allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  DEFAULT
    SumChildren( IntLtgSys:TMTaskMax )
ENDRULE
RULE NEW ResOtherZn:TMCmbdFlrDispTaskMax
  DATATYPE
    Float
  DESCRIPTION
   "Maximum allowaance available for interior lighting systems claiming the
    tailored floor display or task allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    TMFlrDispMax + TMTaskMax
ENDRULE
RULE NEW ResOtherZn:TMCmbdFlrDispTaskAllow
  DATATYPE
    Float
  DESCRIPTION
    "The total combined floor display and task allowance for all interior 
     lighting systems in the space.  This value is the smaller of the design 
     floor display and task power and the maximum floor display and task
     allowance."
  INPUTCLASS 
    NotInput           
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    MIN( TMCmbdFlrDispTaskDsgn, TMCmbdFlrDispTaskMax)
ENDRULE

RULE NEW ResOtherZn:TMOrnAndSpclEftAllowArea
  DATATYPE
    Float
  DESCRIPTION
    "Total Area claimed for the tailored ornamemental/special effect
     allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    ft2
  REPORTPRECISION
    0
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea, 
                   IntLtgSys:AllowType = "TailoredDecorativeAndSpecialEffectAllowance" )
ENDRULE
RULE NEW ResOtherZn:TMOrnAndSpclEftDsgn
  DATATYPE
    Float
  DESCRIPTION
    "Design power of interior lighting systems claiming the tailored 
     ornamemental/special effect allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    SumChildren( IntLtgSys:TMOrnAndSpclEftAllow )
ENDRULE
RULE NEW ResOtherZn:TMOrnAndSpclEftMax
  DATATYPE
    Float
  DESCRIPTION
   "Maximum allowance available for interior lighting systems claiming the
    tailored ornamemental/special effect allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    SumChildren( IntLtgSys:TMOrnAndSpclEftMax )
ENDRULE
RULE NEW ResOtherZn:TMOrnAndSpclEftAllow 
  DATATYPE
    Float
  DESCRIPTION
    "The total ornamemental/special effect allowance for all interior lighting
     systems in the space.  This value is the smaller of the design floor 
     display power and the maximum floor display allowance."
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    MIN( TMOrnAndSpclEftDsgn, TMOrnAndSpclEftMax)
ENDRULE

RULE NEW ResOtherZn:TMVeryValDispAllowArea
  DATATYPE
    Float
  DESCRIPTION
    "Total Area claimed for the tailored very valuable display case
     allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    ft2
  REPORTPRECISION
    0
  DEFAULT
    SumChildrenIf( IntLtgSys:AllowArea, 
                   IntLtgSys:AllowType = "TailoredVeryValuableDisplayCaseAllowance" )
ENDRULE
RULE NEW ResOtherZn:TMVeryValDispDsgn
  DATATYPE
    Float
  DESCRIPTION
    "Design power of interior lighting systems claiming the tailored 
     very valuable display case allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    SumChildren( IntLtgSys:TMVeryValDispAllow )
ENDRULE
RULE NEW ResOtherZn:TMVeryValDispMax
  DATATYPE
    Float
  DESCRIPTION
   "Maximum allowance available for interior lighting systems claiming the
    tailored very valuable display case allowance."
  INPUTCLASS 
    NotInput     
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    MIN( SumChildren( IntLtgSys:TMVeryValDispMax ), 
         0.50*Area )
ENDRULE
RULE NEW ResOtherZn:TMVeryValDispAllow
  DATATYPE
    Float
  DESCRIPTION
    "The total very valuable display case allowance for all interior lighting
     systems in the space.  This value is the smaller of the design floor 
     display power and the maximum floor display allowance."
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    MIN( TMVeryValDispDsgn, TMVeryValDispMax ) 
ENDRULE

RULE NEW ResOtherZn:TMTotAllowPwr
  DATATYPE
    Float
  DESCRIPTION
    "Total Additional Allowance Calculated using the Tailored Method"
  INPUTCLASS 
    NotInput         
  UNITS 
    Watts
  REPORTPRECISION
    0
  DEFAULT
    if ( IntLtgSpecMthd = "TailoredMethod" ) 
    then 
      TMWallDispAllow + 
      TMCmbdFlrDispTaskAllow +
      TMOrnAndSpclEftAllow + 
      TMVeryValDispAllow 
    else 0
    endif
ENDRULE

RULE NEW ResOtherZn:TMTotAllowLPD
  DATATYPE
    Float
  LONGFORM
    TailoredMethodTotalAllowanceLightingPowerDensity 
  DESCRIPTION
    "Total Additional Allowance Calculated using the Tailored Method"
  INPUTCLASS 
    NotInput         
  MINIMUM 
    0
  MAXIMUM 
    10    
  UNITS 
    Watts/ft2
  REPORTPRECISION
    1
  DEFAULT
    if( IfValidAnd( Area > 0 ) )
    then TMTotAllowPwr/Area
    else 0
    endif
ENDRULE

// ---------- Total Allowances - ResOtherZn ----------------------------------------
RULE NEW ResOtherZn:RegAddlAllowPwr
  DATATYPE
    Float
  LONGFORM
    RegulatedAdditionalAllowancePower
  DESCRIPTION
    "A container for the Regulated Additional Allowance Lighting Power"
  INPUTCLASS
    NotInput
  DEFAULT  
    if ( IntLtgSpecMthd = "CompleteBuildingMethod" ) 
      then 0
    else if ( IntLtgSpecMthd = "AreaCategoryMethod" ) 
      then ACMTotAllowPwr
    else if ( IntLtgSpecMthd = "TailoredMethod" ) 
      then TMTotAllowPwr
    else 0
    endif endif endif 
ENDRULE
RULE NEW ResOtherZn:RegAddlAllowFlag
  DATATYPE
    Integer
  LONGFORM
    RegulatedAdditionalAllowanceFlag
  DESCRIPTION
    "A flag that identifies the presence of Regulated Additional Allowance Power"
  INPUTCLASS
    NotInput
  DEFAULT  
    if ( RegAddlAllowPwr > 0 )
    then 1
    else 0
    endif
  SIZING
    UNDEFINED
ENDRULE

// TO DO ---------- Reporting -------------------------------------------------------