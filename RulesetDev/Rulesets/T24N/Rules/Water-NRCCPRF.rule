// Water - NRCCPRF XML (section I*)
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2021, California Energy Commission
//  All rights reserved.
//  Redistribution and Water03_TankCategoryuse in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------


; NRCC Res DHW 2019 => 2022
; noXMLoutput_ResWtrHtrRef:ElementType => noXMLoutput_ResWtrHtrRef:HeaterElementType
; noXMLoutput_ResWtrHtrRef:TankCat => noXMLoutput_ResWtrHtrRef:TankType
; noXMLoutput_ResWtrHtrRef:TankVol => noXMLoutput_ResWtrHtrRef:TankVolume
; noXMLoutput_ResWtrHtrRef:InpRatingElec => noXMLoutput_ResWtrHtrRef:InputRating
; noXMLoutput_ResWtrHtrRef:InpRating => noXMLoutput_ResWtrHtrRef:InputRating
; noXMLoutput_ResWtrHtrRef:EffRpt => noXMLoutput_ResWtrHtrRef:EfficiencyUnits
; noXMLoutput_ResWtrHtrRef:ThrmlEff AND EF AND UEF => noXMLoutput_ResWtrHtrRef:EnergyFactor
; noXMLoutput_ResWtrHtrRef:TankIntInsR => noXMLoutput_ResWtrHtrRef:IntInsulRVal
; noXMLoutput_ResWtrHtrRef:TankExtInsR => noXMLoutput_ResWtrHtrRef:ExtInsulRVal
; noXMLoutput_ResWtrHtrRef:StdbyLossFrac => noXMLoutput_ResWtrHtrRef:StandbyLossFrac
; noXMLoutput_ResWtrHtrRef:FirstHrRating => noXMLoutput_ResWtrHtrRef:FirstHourRating
; noXMLoutput_ResWtrHtrRef:FlowRate => noXMLoutput_ResWtrHtrRef:RatedFlow
; noXMLoutput_ResWtrHtrRef:IsUEFRtdSim => noXMLoutput_ResWtrHtrRef:IsUEF
; noXMLoutput_ResWtrHtrRef:TankZn => noXMLoutput_ResWtrHtrRef:???

; See BEMEnums_Res DHWSys.txt
; noXMLoutput_ResDHWSysRef:CentralSys => noXMLoutput_ResDHWSysRef:CentralDHW
; noXMLoutput_ResDHWSysRef:DistType => noXMLoutput_ResDHWSysRef:MFamDistType
; noXMLoutput_ResDHWSysRef:Type => noXMLoutput_ResDHWSysRef:SystemType
; noXMLoutput_ResDHWSysRef:CentralSysType => noXMLoutput_ResDHWSysRef:CentralDHWType
; noXMLoutput_ResDHWSysRef:CompactDist => noXMLoutput_ResDHWSysRef:CompactDistrib
; noXMLoutput_ResDHWSysRef:CentralHPWHSysDesc => noXMLoutput_ResDHWSysRef:CHPWHSysDescrip
; noXMLoutput_ResDHWSysRef:CentralHPWHIntegratedPackagedType => noXMLoutput_ResDHWSysRef:CHPWHIntegPkgType
; noXMLoutput_ResDHWSysRef:CentralHPWHModel => noXMLoutput_ResDHWSysRef:CHPWHNEEAModel


; nrccSection_Water nrccTableWater 
RULE NEW ResWtrHtr:nrcctblRowWaterRef
  DATATYPE
    nrcctblRowWater
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowWater:noXMLoutput_ResWtrHtrRef
  DATATYPE
    ResWtrHtr
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW WtrHtr:nrcctblRowWaterRef
  DATATYPE
    nrcctblRowWater
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowWater:noXMLoutput_WtrHtrRef
  DATATYPE
    WtrHtr
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowWater:Parent
  ANNUAL_PROPOSED
    nrccTableWater:Name
ENDRULE

RULE nrcctblRowWater:Water01_WaterHeaterName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then noXMLoutput_ResWtrHtrRef:Name
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then noXMLoutput_WtrHtrRef:Name
    else UNDEFINED
    endif endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWater:Water02_WaterHeaterFuelSource
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) 
    then
        switch (noXMLoutput_ResWtrHtrRef:HeaterElementType)
            case "Electric Resistance" : "Electricity"
            case "Gas"                 : if (IfValidAnd(Proj:GasType == "NaturalGas"))
                                         then "NaturalGas"
                                         else "PropaneGas"
                                         endif
            case "Heat Pump"           : "WaterHeatingHP"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) 
    then 
        switch (noXMLoutput_WtrHtrRef:FuelSrc)
            case "Electricity" : "Electricity"
            case "FuelOil#1"   : "Oil"
            case "Gas"         : if (IfValidAnd(Proj:GasType == "NaturalGas"))
                                 then "NaturalGas"
                                 else "PropaneGas"
                                 endif
            case "PropaneGas"  : "PropaneGas"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water03_TankCategory
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) 
    then
        switch (noXMLoutput_ResWtrHtrRef:TankType)
            case "Boiler"                     : "Boiler"
            case "Commercial Packaged Boiler" : "BoilerCommercial"
            case "Indirect"                   : "Indirect"
            case "Instantaneous"              : "Instantaneous"
            case "Storage"                    : "Storage"
            case "Commercial Instantaneous (TE)" : "InstantaneousCommercial"
            case "Commercial Storage (TE & SBL)" : "StorageCommercial"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) 
    then noXMLoutput_WtrHtrRef:SubType
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water03_TankCategory ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWater:Water04_WaterHeaterCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then noXMLoutput_WtrHtrRef:Cnt
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water05_StorageCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:TankVolume ) )
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:StorCap ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water05_StorageCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; NRCC Res DHW
; RJH 4/10/23 do not report ResWtrHtr "Residential (NEEA rated) Product" values
; RJH 5/03/23 Issue #47 add HeaterElementType == "Heat Pump" condition
RULE nrcctblRowWater:Water06_WaterHeaterElectricFiredRatedInput
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump")
                                                          then UNDEFINED
                                                          else if (noXMLoutput_ResWtrHtrRef:HeaterElementType == "Gas") then UNDEFINED else atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:InputRating / 1000 ) ) endif
                                                          endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then if (noXMLoutput_WtrHtrRef:FuelSrc == "Gas") then UNDEFINED else atof( Format( "%.2f", noXMLoutput_WtrHtrRef:InputPower ) ) endif
    else UNDEFINED
    endif endif
ENDRULE
; fixed undefined numerator bug in following rule - SAC 10/11/22   ; revised to leave undefined if InputRating hidden in UI - SAC 03/21/23
RULE nrcctblRowWater:Water06_WaterHeaterGasRatedInput
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump")
         then UNDEFINED
         else if (noXMLoutput_ResWtrHtrRef:HeaterElementType == "Gas" .AND. LocalStatus( noXMLoutput_ResWtrHtrRef:InputRating ) > 0 .AND.
                  IfValidAnd( noXMLoutput_ResWtrHtrRef:ShowInputRating > 0 ))
              then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:InputRating / 1000 ) )
              else UNDEFINED endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) 
    then   if (noXMLoutput_WtrHtrRef:FuelSrc == "Gas" .AND. LocalStatus( noXMLoutput_WtrHtrRef:CapRtd ) > 0)
           then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:CapRtd / 1000 ) )
           else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water06_WaterHeaterElectricFiredRatedInput ) > 0 .OR. LocalStatus( Water06_WaterHeaterGasRatedInput ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; RJH 4/10/23 do not report ResWtrHtr "Heat Pump" "Residential (NEEA rated) Product" values
; RJH 5/03/23 Issue #47 add HeaterElementType == "Heat Pump" condition
RULE nrcctblRowWater:Water07_WaterHeaterRatedInputUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump")
         then UNDEFINED
         else if (LocalStatus( Water06_WaterHeaterElectricFiredRatedInput ) > 0) 
              then "kW"
              else if (LocalStatus( Water06_WaterHeaterGasRatedInput ) > 0) 
                   then "kBtuHr" 
                   else UNDEFINED
                   endif 
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef))
         then if (LocalStatus( Water06_WaterHeaterElectricFiredRatedInput ) > 0) 
              then "kW"
              else if (LocalStatus( Water06_WaterHeaterGasRatedInput ) > 0) 
                   then "kBtuHr" 
                   else UNDEFINED
                   endif 
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowWater:Water07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water07_WaterHeaterRatedInputUnits ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; RJH 4/10/23 do not report ResWtrHtr "Heat Pump" "Residential (NEEA rated) Product" values
; RJH 5/03/23 Issue #47 add HeaterElementType == "Heat Pump" condition
RULE nrcctblRowWater:Water08_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then UNDEFINED
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. LocalStatus( noXMLoutput_WtrHtrRef:EffRpt ) > 0) 
         then if (substr( noXMLoutput_WtrHtrRef:EffRpt, 0, 3 ) == "COP") then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:COP ) ) else UNDEFINED endif
    else UNDEFINED endif endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWater:Water08_ThermalEfficiency
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) 
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump")
         then UNDEFINED
         else if (LocalStatus( noXMLoutput_ResWtrHtrRef:EfficiencyUnits ) > 0)
              then if (noXMLoutput_ResWtrHtrRef:EfficiencyUnits == "TE") 
                   then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:EnergyFactor ) ) 
                   else UNDEFINED 
                   endif
              else UNDEFINED
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. LocalStatus( noXMLoutput_WtrHtrRef:EffRpt ) > 0) 
         then if (substr( noXMLoutput_WtrHtrRef:EffRpt, 0, 5 ) == "Thrml") 
              then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:ThrmlEff ) ) 
              else UNDEFINED 
              endif
         else UNDEFINED 
         endif 
    endif
ENDRULE
RULE nrcctblRowWater:Water08_EnergyFactor
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef) .AND. LocalStatus( noXMLoutput_ResWtrHtrRef:EfficiencyUnits ) > 0)
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump") 
         then UNDEFINED
         else if (noXMLoutput_ResWtrHtrRef:EfficiencyUnits == "EF") 
              then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:EnergyFactor ) ) 
              else UNDEFINED 
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. LocalStatus( noXMLoutput_WtrHtrRef:EffRpt ) > 0) 
         then if (substr( noXMLoutput_WtrHtrRef:EffRpt, 0, 2 ) == "EF") then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:EF ) ) else UNDEFINED endif
    else UNDEFINED endif endif
ENDRULE
RULE nrcctblRowWater:Water08_UniformEnergyFactor
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef) .AND. LocalStatus( noXMLoutput_ResWtrHtrRef:EfficiencyUnits ) > 0) 
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump") 
         then UNDEFINED
         else if (noXMLoutput_ResWtrHtrRef:EfficiencyUnits == "UEF") 
              then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:EnergyFactor ) ) 
              else UNDEFINED 
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. LocalStatus( noXMLoutput_WtrHtrRef:EffRpt ) > 0) 
         then if (substr( noXMLoutput_WtrHtrRef:EffRpt, 0, 3 ) == "UEF") then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:UEF ) ) else UNDEFINED endif
    else UNDEFINED endif endif
ENDRULE
RULE nrcctblRowWater:Water08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water08_EfficiencyCOP ) > 0 .OR. LocalStatus( Water08_ThermalEfficiency ) > 0 .OR. LocalStatus( Water08_EnergyFactor ) > 0 .OR. LocalStatus( Water08_UniformEnergyFactor ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; RJH 4/10/23 do not report ResWtrHtr "Residential (NEEA rated) Product" values
; RJH 5/03/23 Issue #47 add HeaterElementType == "Heat Pump" condition
RULE nrcctblRowWater:Water09_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then if (noXMLoutput_ResWtrHtrRef:HPWHCategory == "Residential (NEEA rated) Product" .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump")
         then UNDEFINED
         else if (LocalStatus( Water08_EfficiencyCOP ) > 0) 
              then "COP"
              else if (LocalStatus( Water08_ThermalEfficiency ) > 0) 
                   then "ThermalEfficiency"
                   else if (LocalStatus( Water08_EnergyFactor ) > 0) 
                        then "EnergyFactor"
                        else if (LocalStatus( Water08_UniformEnergyFactor ) > 0) 
                             then "UniformEnergyFactor"
                             else  UNDEFINED  
                             endif 
                        endif 
                   endif 
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef))
         then if (LocalStatus( Water08_EfficiencyCOP ) > 0) 
              then "COP"
              else if (LocalStatus( Water08_ThermalEfficiency ) > 0) 
                   then "ThermalEfficiency"
                   else if (LocalStatus( Water08_EnergyFactor ) > 0) 
                        then "EnergyFactor"
                        else if (LocalStatus( Water08_UniformEnergyFactor ) > 0) 
                             then "UniformEnergyFactor"
                             else  UNDEFINED  
                             endif 
                        endif 
                   endif 
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowWater:Water09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water09_EfficiencyType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; NRCC Res DHW          ; added logic to set int/ext insulation only when displayed in UI - SAC 03/21/23
RULE nrcctblRowWater:Water10_TankInteriorInsulationRValue
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then  if (LocalStatus( noXMLoutput_ResWtrHtrRef:IntInsulRVal ) > 0 .AND.
              (IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 7 ) .OR. IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 1  ) .OR.
               IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 0 ) .OR. IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 16 )))
          then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:IntInsulRVal ) ) else UNDEFINED endif
          else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then UNDEFINED
          else UNDEFINED
          endif endif
ENDRULE
RULE nrcctblRowWater:Water10_TankExteriorInsulationRValue
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then  if (LocalStatus( noXMLoutput_ResWtrHtrRef:ExtInsulRVal ) > 0 .AND.
              (IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 7 ) .OR. IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 1  ) .OR.
               IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 0 ) .OR. IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 16 )))
          then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:ExtInsulRVal ) ) else UNDEFINED endif
          else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then UNDEFINED
          else UNDEFINED
          endif endif
ENDRULE
RULE nrcctblRowWater:Water10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water10_TankInteriorInsulationRValue ) > 0 .OR. LocalStatus( Water10_TankExteriorInsulationRValue ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; NRCC Res DHW
   ; added logic to apply same Display logic from ResScreens determining when to provide access to StandbyLossFrac before reporting it - SAC 05/11/23 (gh LMCC issue #11)
RULE nrcctblRowWater:Water11_WaterHeaterStandbyLossFraction
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef))
    then  if ( ( IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType =  3 ) .OR.
                 IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterType = 13 ) ) .AND.
                LocalStatus( noXMLoutput_ResWtrHtrRef:StandbyLossFrac ) > 0 )
          then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:StandbyLossFrac ) ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then if (LocalStatus( noXMLoutput_WtrHtrRef:StdbyLossFrac ) > 0) then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:StdbyLossFrac ) ) else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water11_WaterHeaterStandbyLossFraction ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWater:Water12_WaterHeaterFirstHourRating
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then if (LocalStatus( noXMLoutput_ResWtrHtrRef:FirstHourRating ) > 0 .AND. noXMLoutput_ResWtrHtrRef:IsUEF = 1 .AND. noXMLoutput_ResWtrHtrRef:TankType = "Storage") then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:FirstHourRating ) ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then if (LocalStatus( noXMLoutput_WtrHtrRef:FirstHrRating ) > 0 .AND. noXMLoutput_WtrHtrRef:IsUEFRtd = 1 .AND. noXMLoutput_WtrHtrRef:SubType = "Storage") then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:FirstHrRating ) ) else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water12_WaterHeaterFlowRate
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then if (LocalStatus( noXMLoutput_ResWtrHtrRef:RatedFlow ) > 0 .AND. noXMLoutput_ResWtrHtrRef:IsUEF = 1 .AND. noXMLoutput_ResWtrHtrRef:TankType = "Instantaneous") then atof( Format( "%.2f", noXMLoutput_ResWtrHtrRef:RatedFlow ) ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then if (LocalStatus( noXMLoutput_WtrHtrRef:FlowRate ) > 0 .AND. noXMLoutput_WtrHtrRef:IsUEFRtd = 1 .AND. noXMLoutput_WtrHtrRef:SubType = "Instantaneous") then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:FlowRate ) ) else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water12_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water12_WaterHeaterFirstHourRating ) > 0 .OR. LocalStatus( Water12_WaterHeaterFlowRate ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
RULE nrcctblRowWater:Water13_WaterHeaterTypeNR
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then UNDEFINED
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then 
      if ( LocalStatus( noXMLoutput_WtrHtrRef:Type ) > 0 .AND. noXMLoutput_WtrHtrRef:Type <> "Conventional" ) 
      then noXMLoutput_WtrHtrRef:Type 
      else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water13_ResHPWHCategory
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then UNDEFINED
    else if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) then 
      if ( LocalStatus( noXMLoutput_ResWtrHtrRef:HPWHCategory ) > 0 .AND. noXMLoutput_ResWtrHtrRef:HeaterElementType = "Heat Pump" ) 
      then switch (noXMLoutput_ResWtrHtrRef:HPWHCategory)
            case	"Residential (NEEA rated) Product" :	"NEEAResHPWH"
            case	"Commercial Product"		       :	"CommercialResHPWH"
            case	"UEF Rated"		                   :	"UEFResHPWH"
            case	"Non-UEF Rated"		               :	"NonUEFResHPWH"
            default :  UNDEFINED
         endswitch
      else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water13_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water13_WaterHeaterTypeNR ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE

; NRCC Res DHW    ; revised to leave undefined if tank location hidden in UI - SAC 03/21/23
RULE nrcctblRowWater:Water14_TankLocation
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) 
    then if (noXMLoutput_ResWtrHtrRef:TankOutside .AND.
             IfValidAnd( noXMLoutput_ResWtrHtrRef:ShowTankLocation > 0 ))
         then "Outside"
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWater:Water14_TankLocationString
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef)) 
    then if (noXMLoutput_ResWtrHtrRef:TankOutside .OR.
             IfValidAnd( noXMLoutput_ResWtrHtrRef:ShowTankLocation > 0 )==0)
         then UNDEFINED
         else noXMLoutput_ResWtrHtrRef:TankZone
         endif
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) 
         then if (LocalStatus( noXMLoutput_WtrHtrRef:TankZnRpt ) > 0) 
              then if (noXMLoutput_WtrHtrRef:TankZnRpt != "Tank Zn: NA") then noXMLoutput_WtrHtrRef:TankZnRpt else UNDEFINED endif 
              else UNDEFINED 
              endif
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowWater:Water14_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water14_TankLocation ) > 0 .OR. LocalStatus( Water14_TankLocationString ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE

; added NEEA HPWH reporting entries - SAC 10/18/22
RULE nrcctblRowWater:Water15_HeatPumpWaterHeaterBrandNEEA
  ANNUAL_PROPOSED
    if ( IfValidAnd( Proj:IsLowRiseMFam > 0 ) .AND.
         IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterElementType = "Heat Pump" ) .AND.
         IfValidAnd( noXMLoutput_ResWtrHtrRef:HPWHCategory = "Residential (NEEA rated) Product" ) ) 
    then if ( EnumValue( noXMLoutput_ResWtrHtrRef:HPWHBrand ) > 2)
         then  switch( noXMLoutput_ResWtrHtrRef:HPWHBrand )
                        case "A. O. Smith"     :  "AOSmith"
                        case "American"        :  "American"
                        case "Bradford White"  :  "BradfordWhite"
                        case "Direct Energy"   :  "DirectEnergy"
                        case "EcoSense"        :  "EcoSense"
                        case "GE"              :  "GE"
                        case "Kenmore"         :  "Kenmore"
                        case "Lochinvar"       :  "Lochinvar"
                        case "Reliance"        :  "Reliance"
                        case "Rheem"           :  "Rheem"
                        case "Rheem Canada"    :  "RheemCanada"
                        case "Richmond"        :  "Richmond"
                        case "Ruud"            :  "Ruud"
                        case "Sanden"          :  "Sanden"
                        case "State"           :  "State"
                        case "Stiebel Eltron"  :  "Stiebel"
                        case "US Craftmaster"  :  "USCraftmaster"
                        case "Whirlpool"       :  "Whirlpool"
                        case "(generic)"       :  "Generic"     ; SAC 5/28/19    ; updated to 'Generic' - SAC 10/02/21
                        default  :  UNDEFINED
                    endswitch
         else UNDEFINED
         endif
    else  UNDEFINED 
    endif
ENDRULE
RULE nrcctblRowWater:Water15_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water15_HeatPumpWaterHeaterBrandNEEA ) > 0) 
    then UNDEFINED
    else if (IfValidAnd( Proj:IsLowRiseMFam > 0)) then "NotApplicable" else UNDEFINED endif
    endif
ENDRULE

; added 40 new Rheem (and related) NEEA HPWH entries - SAC 12/29/22
; added 18 new AOSmith (and related) NEEA HPWH entries - SAC 01/19/23
; replced long switch w/ table look-up - SAC 01/19/23
RULE nrcctblRowWater:Water16_HeatPumpWaterHeaterModelNEEA
  ANNUAL_PROPOSED
    if ( IfValidAnd( Proj:IsLowRiseMFam > 0 ) .AND.
         LocalStatus( Water15_HeatPumpWaterHeaterBrandNEEA ) > 0 )
    then if ( EnumValue( noXMLoutput_ResWtrHtrRef:HPWHModel ) > 1)
         then  HPWHData_NEEA:RptHPWHModel( "ModelNum", EnumValue( noXMLoutput_ResWtrHtrRef:HPWHModel ) ) 
         else UNDEFINED
         endif
    else  UNDEFINED 
    endif
ENDRULE
RULE nrcctblRowWater:Water16_HeatPumpWaterHeaterModelNEEA
  ANNUAL_PROPOSED
    if (LocalStatus( Water16_HeatPumpWaterHeaterModelNEEA ) > 0) then  UNCHANGED
    else if ( IfValidAnd( Proj:IsLowRiseMFam > 0 ) .AND.
              IfValidAnd( noXMLoutput_ResWtrHtrRef:HeaterElementType = "Heat Pump" ) .AND.
              IfValidAnd( noXMLoutput_ResWtrHtrRef:HPWHCategory = "Commercial Product" ) ) 
    then if ( IfValidAnd( noXMLoutput_ResWtrHtrRef:HPWH_ComProduct > 0.5 )==0 .OR.
              EnumValue(  noXMLoutput_ResWtrHtrRef:HPWHComModel ) < 3 .OR.
				  EnumValue(  noXMLoutput_ResWtrHtrRef:ASHPType ) < 1 ) then  UNCHANGED
         else  switch( EnumValue(  noXMLoutput_ResWtrHtrRef:HPWHComModel ) )
                        case  110172  :  "AOSmithCAHP120"
                        default       :  UNCHANGED
                    endswitch
         endif
    else  UNCHANGED 
    endif endif
ENDRULE
RULE nrcctblRowWater:Water16_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water16_HeatPumpWaterHeaterModelNEEA ) > 0) 
    then UNDEFINED
    else if (IfValidAnd( Proj:IsLowRiseMFam > 0)) then "NotApplicable" else UNDEFINED endif
    endif
ENDRULE

RULE nrcctblRowWater:Water17_HeatPumpWaterHeaterSimulationGroup
  ANNUAL_PROPOSED
    if (LocalStatus( Water16_HeatPumpWaterHeaterModelNEEA ) > 0)
    then if ( EnumValue( noXMLoutput_ResWtrHtrRef:ASHPType ) > 0)
         then  switch( noXMLoutput_ResWtrHtrRef:ASHPType )
                                    case "AO Smith PHPT 60" :  "AOSmithPHPT60"
                                    case "AO Smith PHPT 80" :  "AOSmithPHPT80"
                                    case "AO Smith HPTU 50" :  "AOSmithHPTU50"
                                    case "AO Smith HPTU 66" :  "AOSmithHPTU66"
                                    case "AO Smith HPTU 80" :  "AOSmithHPTU80"
                                    case "AO Smith SHPT 50" :  "AOSmithSHPT50"
                                    case "AO Smith SHPT 66" :  "AOSmithSHPT66"
                                    case "AO Smith SHPT 80" :  "AOSmithSHPT80"
                                    case "GE2014 50"        :  "GE201450"
                                    case "GE2014 80"        :  "GE201480"
                                    case "GE2014 80 Eff DR" :  "GE201480EffDR"
                                    case "Sanden 40"        :  "Sanden40"
                                    case "Sanden 80"        :  "Sanden80"
                                    case "Stiebel 220E"     :  "Stiebel220E"
                                 ;   case "GE2012 50"        :  "GE201250"
                                    case "GE2012 50"        :  "AOSmithSHPT50"     ; SAC 5/28/19
                                    case "AWHSTier3Generic40" :  "AWHSTier3Generic40"  ; SAC 06/17/21
                                    case "AWHSTier3Generic50" :  "AWHSTier3Generic50"
                                    case "AWHSTier3Generic65" :  "AWHSTier3Generic65"
                                    case "AWHSTier3Generic80" :  "AWHSTier3Generic80"
                                    case "Rheem HB 50"      :  "RheemHB50"          ; added missing mapping to 'RheemHB50' - SAC 06/04/21
                                    case "Rheem HBDR-45-50" :  "RheemHBDR4550"
                                    case "Rheem HBDR-45-65" :  "RheemHBDR4565"
                                    case "Rheem HBDR-45-80" :  "RheemHBDR4580"
                                    case "Rheem HBDR-22-50" :  "RheemHBDR2250"
                                    case "Rheem HBDR-22-65" :  "RheemHBDR2265"      ; fixed errant mapping - SAC 06/04/21
                                    case "Rheem HBDR-22-80" :  "RheemHBDR2280"      ; fixed errant mapping - SAC 06/04/21
                                    case "Colmac CxV-5"     :  "ColmacCxV5_SP"         ; SAC 6/16/20 - large central HPWH additions
                                    case "Colmac CxA-10"    :  "ColmacCxA10_SP"  
                                    case "Colmac CxA-15"    :  "ColmacCxA15_SP"  
                                    case "Colmac CxA-20"    :  "ColmacCxA20_SP"  
                                    case "Colmac CxA-25"    :  "ColmacCxA25_SP"  
                                    case "Colmac CxA-30"    :  "ColmacCxA30_SP"  
                                    case "Nyle C25A"        :  "NyleC25A_SP"   
                                    case "Nyle C60A"        :  "NyleC60A_SP"   
                                    case "Nyle C90A"        :  "NyleC90A_SP"   
                                    case "Nyle C125A"       :  "NyleC125A_SP"  
                                    case "Nyle C185A"       :  "NyleC185A_SP"  
                                    case "Nyle C250A"       :  "NyleC250A_SP"  
                                    case "Nyle C60A-CWP"    :  "NyleC60A_CWP_SP"       ; SAC 6/23/20 - added cold wthr package presets
                                    case "Nyle C90A-CWP"    :  "NyleC90A_CWP_SP" 
                                    case "Nyle C125A-CWP"   :  "NyleC125A_CWP_SP"
                                    case "Nyle C185A-CWP"   :  "NyleC185A_CWP_SP"
                                    case "Nyle C250A-CWP"   :  "NyleC250A_CWP_SP"
                                    case "Sanden GS3-45HPA-US"     :  "SandenGS3"
                                    case "Bradford White 2020 65"  :  "BWC202065"         ; SAC 6/16/20 - NEEA additions
                                    case "Rheem 2020 Premium 40"   :  "Rheem2020Prem40" 
                                    case "Rheem 2020 Premium 50"   :  "Rheem2020Prem50" 
                                    case "Rheem 2020 Premium 65"   :  "Rheem2020Prem65" 
                                    case "Rheem 2020 Premium 80"   :  "Rheem2020Prem80" 
                                    case "Rheem 2020 Builder 40"   :  "Rheem2020Build40"
                                    case "Rheem 2020 Builder 50"   :  "Rheem2020Build50"
                                    case "Rheem 2020 Builder 65"   :  "Rheem2020Build65"
                                    case "Rheem 2020 Builder 80"   :  "Rheem2020Build80"
                                    case "AO Smith CAHP-120"       :  "AOSmithCAHP120"    ; SAC 02/20/21 (tic #1260)
                                    case "RheemPlugInShared40"     :  "RheemPlugInShared40"        ; SAC 12/29/22
                                    case "RheemPlugInShared50"     :  "RheemPlugInShared50"   
                                    case "RheemPlugInShared65"     :  "RheemPlugInShared65"   
                                    case "RheemPlugInShared80"     :  "RheemPlugInShared80"   
                                    case "RheemPlugInDedicated40"  :  "RheemPlugInDedicated40"
                                    case "RheemPlugInDedicated50"  :  "RheemPlugInDedicated50"
                                    case "AOSmithHPTS50"  :  "AOSmithHPTS50"     ; SAC 01/19/23
                                    case "AOSmithHPTS66"  :  "AOSmithHPTS66"
                                    case "AOSmithHPTS80"  :  "AOSmithHPTS80"
                        default  :  UNDEFINED
                    endswitch
         else UNDEFINED
         endif
    else  UNDEFINED 
    endif
ENDRULE
RULE nrcctblRowWater:Water17_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water17_HeatPumpWaterHeaterSimulationGroup ) > 0) 
    then UNDEFINED
    else if (IfValidAnd( Proj:IsLowRiseMFam > 0)) then "NotApplicable" else UNDEFINED endif
    endif
ENDRULE

RULE nrcctblRowWater:Water18_TankLocation
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0) .AND. IfValidAnd( noXMLoutput_ResWtrHtrRef:TankOutside > 0 ))
    then  "Outside"
    else  UNDEFINED  endif
ENDRULE
RULE nrcctblRowWater:Water18_TankLocationString
  ANNUAL_PROPOSED
    if (LocalStatus( Water18_TankLocation ) > 0) then  UNDEFINED
    else if (IfValidAnd(Proj:IsLowRiseMFam > 0) .AND. LocalCompAssigned( noXMLoutput_ResWtrHtrRef:TankZone ) > 0)
    then  noXMLoutput_ResWtrHtrRef:TankZone:Name
    else  UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowWater:Water18_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water18_TankLocation       ) > 0 .OR.
        LocalStatus( Water18_TankLocationString ) > 0) 
    then UNDEFINED
    else if (IfValidAnd(Proj:IsLowRiseMFam > 0)) then "NotApplicable" else UNDEFINED endif
    endif
ENDRULE
RULE nrcctblRowWater:Water19_ResidentialWaterHeaterType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResWtrHtrRef) .AND. IfValidAnd( Proj:IsLowRiseMFam > 0 ))
    then if (noXMLoutput_ResWtrHtrRef:HeaterElementType == "Heat Pump") 
         then "HeatPumpWaterHeater"
         else switch( noXMLoutput_ResWtrHtrRef:TankType )
                    case "Boiler"                                    :  "BoilerWaterHeater"
                    case "Indirect"                                  :  "IndirectWaterHeating"
                    case "Commercial Instantaneous (TE)"             :  "InstantaneousCommercial"
                    case "Consumer Instantaneous (UEF)"              :  "InstantaneousConsumer"
                    case "Residential-Duty Commercial Storage (UEF)" :  "InstantaneousResDutyCommercial"
                    case "Commercial Storage (TE & SBL)"             :  "StorageCommercial"
                    case "Consumer Storage (UEF)"                    :  "StorageConsumer"
                    case "Residential-Duty Commercial Storage (UEF)" :  "StorageResDutyCommercial"
                    case "Commercial Packaged Boiler"                :  "CommercialPackagedBoiler"
                    default  :  UNDEFINED
              endswitch
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWater:Water19_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Water19_ResidentialWaterHeaterType ) > 0) 
    then UNDEFINED
    else if (IfValidAnd(Proj:IsLowRiseMFam > 0)) then "NotApplicable" else UNDEFINED endif
    endif
ENDRULE




; nrccSection_WaterMF nrccTableWaterMF 
RULE NEW ResDHWSys:nrcctblRowWaterMFRef
  DATATYPE
    nrcctblRowWaterMF
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowWaterMF:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowWaterMF:Parent
  ANNUAL_PROPOSED
    nrccTableWaterMF:Name
ENDRULE

RULE nrcctblRowWaterMF:WaterMF01_WaterHeatingSystemName
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:Name
ENDRULE
RULE nrcctblRowWaterMF:WaterMF02_ResidentialWaterHeatingSystemType
  ANNUAL_PROPOSED
    "DHW"
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWaterMF:WaterMF03_CentralSystem
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CentralDHW) then "true" else "false" endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF04_WaterHeaterTotalSystemCount
  ANNUAL_PROPOSED
    int(noXMLoutput_ResDHWSysRef:TotNumDHWHeaters)
ENDRULE

; RJH 10/28/22 I am not sure about this mapping between the CBECC and schema enums
RULE nrcctblRowWaterMF:WaterMF05_ResidentialDHWCentralDistributionType
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CentralDHW) 
    then  
        switch (noXMLoutput_ResDHWSysRef:MFamDistType)
            case "Multi-family: No loops or recirc pump"                                   : "NoRecirculationMF"
            case "Multi-family: Recirculation demand control"                              : "RecirculatingDemandControlMF"
            case "Multi-family: Recirculating with temperature modulation and monitoring " : "RecirculationMF"
            case "Multi-family: Recirculating with temperature modulation"                 : "RecirculationMF"
            case "Multi-family: Recirculating with temperature modulation and monitoring"  : "RecirculationMF"
            case "Multi-family: Recirculating with no control (continuous pumping)"        : "RecirculationMF"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE

;0, ResDHWSys:MFamDistType,  0
;2,	 6848,	"Multi-family: Recirculating with temperature modulation and monitoring "     ; SAC 8/28/16 - remove trailing space
;1,    Proj:Ruleset,   -1008,  0   ; Backward compatibility - removed recirc items no longer intended to be included in analysis - SAC 02/13/21 (tic #1220)
;2,	 6336,	"Multi-family: Recirculation demand control"
;2,	 6592,	"Multi-family: Recirculating with temperature modulation"	
;2,	 6848,	"Multi-family: Recirculating with temperature modulation and monitoring"
;1,    Proj:Ruleset,    -999,  0   ; Current selections
;2,	    0,	"Multi-family: No loops or recirc pump"							; SDS 07/26/2016: modified (tic #707)
;2,	 5056,	"Multi-family: Recirculating with no control (continuous pumping)"

RULE nrcctblRowWaterMF:WaterMF05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( WaterMF05_ResidentialDHWCentralDistributionType ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE

; NRCC Res DHW
RULE nrcctblRowWaterMF:WaterMF06_ResidentialDHWDwellingUnitDistributionType
  ANNUAL_PROPOSED
    if( LocalStatus( noXMLoutput_ResDHWSysRef:SystemType ) > 0 )
    then switch (noXMLoutput_ResDHWSysRef:SystemType)
            case	"Standard"	                                                  :	"StandardDistribution"
            case	"Parallel Piping"		                                      :	"StandardDistributionCentralParallelPiping"
            case	"Point of use"		                                          :	"PointOfUse"
            case	"Recirculation, Non-Demand Control"		                      :	"RecirculationNonDemand"
            case	"Recirculation, Demand Control Push Button"		              :	"DemandRecirculationManualControl"
            case	"Recirculation, Demand Control Occupancy/Motion"		      :	"DemandRecirculationSensorControls"
            case	"(HERS req'd) Pipe Insulation, All Lines"		              :	"StandardDistributionInsulatedPipesHERS"
            case	"(HERS req'd) Parallel Piping"		                          :	"StandardDistributionCentralParallelPipingHERS"
            case	"(HERS req'd) Recirculation, Demand Control Push Button"	  :	"DemandRecirculationManualControlHERS"
            case	"(HERS req'd) Recirculation, Demand Control Occupancy/Motion" :	"DemandRecirculationSensorControlsHERS"
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( WaterMF06_ResidentialDHWDwellingUnitDistributionType ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE

; NRCC Res DHW
RULE nrcctblRowWaterMF:WaterMF07_WaterHeatingSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then noXMLoutput_ResDHWSysRef:Name + " - heater"
          else noXMLoutput_ResDHWSysRef:DHWHeater:Name
          endif
    else  UNDEFINED  
    endif
ENDRULE

RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[1]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[2]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[3]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[4]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[5]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[5]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[6]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[6]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[7]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[7]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[8]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[8]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[9]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[9]
          endif
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF07_WaterHeaterName[10]
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then  if (noXMLoutput_ResDHWSysRef:CentralDHW == 1 .AND. noXMLoutput_ResDHWSysRef:CentralDHWType == "HPWH")
          then UNDEFINED
          else noXMLoutput_ResDHWSysRef:ResWtrHtrName[10]
          endif
    else  UNDEFINED  
    endif
ENDRULE

; replaced LocalStatus( ...:DHWSolSysRef ) w/ LocalCompAssigned() because reference can be user defined (- none -) w/ no valid component referenced - SAC 08/23/21
RULE nrcctblRowWaterMF:WaterMF08_DHWSolarSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef:DHWSolarSysRef ) > 0 .AND. noXMLoutput_ResDHWSysRef:CSESolarSysSimValid) then noXMLoutput_ResDHWSysRef:DHWSolarSysRef:Name else UNDEFINED endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( WaterMF08_DHWSolarSystemName ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF09_IsCompactDistribution
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CentralDHW) 
    then UNDEFINED 
    else if (noXMLoutput_ResDHWSysRef:IsCompactDistrib > 0)
         then "true"
         else "false"
         endif
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( WaterMF09_IsCompactDistribution ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE


; RJH 11/02/22 LMCC only
RULE nrcctblRowWaterMF:WaterMF10_PipeInsulationVerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then if (noXMLoutput_ResDHWSysRef:PipeInsVerifReq > 0)
         then "true"  
         else "false"  
         endif 
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
    then if (LocalStatus( WaterMF10_PipeInsulationVerificationRequired ) > 0) 
         then UNDEFINED
         else "NotApplicable"
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF11_ParallelPipingVerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then if (noXMLoutput_ResDHWSysRef:ParPipingVerReq > 0)
         then "true"  
         else "false"  
         endif 
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
    then if (LocalStatus( WaterMF11_ParallelPipingVerificationRequired ) > 0) 
         then UNDEFINED
         else "NotApplicable"
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF12_RecirculationControlVerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then if (noXMLoutput_ResDHWSysRef:RecirCtrlVerReq > 0)
         then "true"  
         else "false"  
         endif 
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF12_NotApplicableMessage
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
    then if (LocalStatus( WaterMF12_RecirculationControlVerificationRequired ) > 0) 
         then UNDEFINED
         else "NotApplicable"
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF13_DWHR_HERS_VerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned( noXMLoutput_ResDHWSysRef ))
    then if (noXMLoutput_ResDHWSysRef:HERSCheck:ShwrDrnWtrHtRecov > 0)
         then "true"  
         else "false"  
         endif 
    else  UNDEFINED  
    endif
ENDRULE
RULE nrcctblRowWaterMF:WaterMF13_NotApplicableMessage
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
    then if (LocalStatus( WaterMF13_DWHR_HERS_VerificationRequired ) > 0) 
         then UNDEFINED
         else "NotApplicable"
         endif
    else UNDEFINED
    endif
ENDRULE


; nrccSection_WaterCHPWH nrccTableCHPWH 
RULE NEW ResDHWSys:nrcctblRowCHPWHRef
  DATATYPE
    nrcctblRowCHPWH
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowCHPWH:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowCHPWH:Parent
  ANNUAL_PROPOSED
    nrccTableCHPWH:Name
ENDRULE

; nrccWaterCHPWH02
RULE NEW ResDHWSys:nrccWaterCHPWH02Ref
  DATATYPE
    nrccWaterCHPWH02
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccWaterCHPWH02:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccWaterCHPWH02:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned( noXMLoutput_ResDHWSysRef:nrcctblRowCHPWHRef ) > 0) then noXMLoutput_ResDHWSysRef:nrcctblRowCHPWHRef:Name else UNDEFINED endif
ENDRULE

RULE nrcctblRowCHPWH:WaterCHPWH01_WaterHeatingSystemName
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:Name
ENDRULE


; NRCC Res DHW 2019 => 2022
; noXMLoutput_ResWtrHtrRef:ElementType => noXMLoutput_ResWtrHtrRef:HeaterElementType
; noXMLoutput_ResWtrHtrRef:TankCat => noXMLoutput_ResWtrHtrRef:TankType
; noXMLoutput_ResWtrHtrRef:TankVol => noXMLoutput_ResWtrHtrRef:TankVolume
; noXMLoutput_ResWtrHtrRef:InpRatingElec => noXMLoutput_ResWtrHtrRef:InputRating
; noXMLoutput_ResWtrHtrRef:InpRating => noXMLoutput_ResWtrHtrRef:InputRating
; noXMLoutput_ResWtrHtrRef:EffRpt => noXMLoutput_ResWtrHtrRef:EfficiencyUnits
; noXMLoutput_ResWtrHtrRef:ThrmlEff AND EF AND UEF => noXMLoutput_ResWtrHtrRef:EnergyFactor
; noXMLoutput_ResWtrHtrRef:TankIntInsR => noXMLoutput_ResWtrHtrRef:IntInsulRVal
; noXMLoutput_ResWtrHtrRef:TankExtInsR => noXMLoutput_ResWtrHtrRef:ExtInsulRVal
; noXMLoutput_ResWtrHtrRef:StdbyLossFrac => noXMLoutput_ResWtrHtrRef:StandbyLossFrac
; noXMLoutput_ResWtrHtrRef:FirstHrRating => noXMLoutput_ResWtrHtrRef:FirstHourRating
; noXMLoutput_ResWtrHtrRef:FlowRate => noXMLoutput_ResWtrHtrRef:RatedFlow
; noXMLoutput_ResWtrHtrRef:IsUEFRtdSim => noXMLoutput_ResWtrHtrRef:IsUEF
; noXMLoutput_ResWtrHtrRef:TankZn => noXMLoutput_ResWtrHtrRef:???

; See BEMEnums_Res DHWSys.txt
; noXMLoutput_ResDHWSysRef:CentralSys => noXMLoutput_ResDHWSysRef:CentralDHW
; noXMLoutput_ResDHWSysRef:DistType => noXMLoutput_ResDHWSysRef:MFamDistType
; noXMLoutput_ResDHWSysRef:Type => noXMLoutput_ResDHWSysRef:SystemType
; noXMLoutput_ResDHWSysRef:CentralSysType => noXMLoutput_ResDHWSysRef:CentralDHWType
; noXMLoutput_ResDHWSysRef:CompactDist => noXMLoutput_ResDHWSysRef:CompactDistrib
; noXMLoutput_ResDHWSysRef:CentralHPWHSysDesc => noXMLoutput_ResDHWSysRef:CHPWHSysDescrip
; noXMLoutput_ResDHWSysRef:CentralHPWHIntegratedPackagedType => noXMLoutput_ResDHWSysRef:CHPWHIntegPkgType
; noXMLoutput_ResDHWSysRef:CentralHPWHModel => noXMLoutput_ResDHWSysRef:CHPWHNEEAModel
; noXMLoutput_ResDHWSysRef:CentralHPWHBrand => noXMLoutput_ResDHWSysRef:CHPWHNEEABrand
; noXMLoutput_ResDHWSysRef:CentralHPWHCprsrType => noXMLoutput_ResDHWSysRef:CHPWHCompType
; noXMLoutput_ResDHWSysRef:CentralHPWHCprsrCnt => noXMLoutput_ResDHWSysRef:CHPWHNumComp
; noXMLoutput_ResDHWSysRef:CentralHPWHPriTankVol => noXMLoutput_ResDHWSysRef:CHPWHTotTankVol
; noXMLoutput_ResDHWSysRef:CentralHPWHTankCnt => noXMLoutput_ResDHWSysRef:CHPWHTankCount
; noXMLoutput_ResDHWSysRef:CentralHPWHTankRVal => noXMLoutput_ResDHWSysRef:CHPWHTankRVal
; noXMLoutput_ResDHWSysRef:CentralHPWHTankLctn => noXMLoutput_ResDHWSysRef:CHPWHTankLoc
; noXMLoutput_ResDHWSysRef:CentralHPWHAirSrc => noXMLoutput_ResDHWSysRef:CHPWHTankLoc

;; RJH - 9/29/22 If Single Pass Primary OR Multi Pass Primary then ONLY populate WaterCHPWH02_CentralHPWHCompressorType (See SVN Documentation/T24/T24R_CentralHPWHCompressors.xlsx)

RULE nrccWaterCHPWH02:WaterCHPWH02_CentralHPWHCompressorType
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Single Pass Primary") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Multi Pass Primary") )
    then if( LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHCompType ) > 0 )
        then switch (noXMLoutput_ResDHWSysRef:CHPWHCompType)
                case	"Colmac CxV-5  (14kW cap @ 40F)"	:	"ColmacCxV5"
                case	"Colmac CxA-10  (21kW cap @ 40F)"	:	"ColmacCxA10"
                case	"Colmac CxA-15  (29kW cap @ 40F)"	:	"ColmacCxA15"
                case	"Colmac CxA-20  (41kW cap @ 40F)"	:	"ColmacCxA20"
                case	"Colmac CxA-25  (49kW cap @ 40F)"	:	"ColmacCxA25"
                case	"Colmac CxA-30  (57kW cap @ 40F)"	:	"ColmacCxA30"
                case	"Nyle C25A  (5kW cap @ 40F)"	:	"NyleC25A"
                case	"Nyle C60A  (11kW cap @ 40F)"	:	"NyleC60A"
                case	"Nyle C90A  (20kW cap @ 40F)"	:	"NyleC90A"
                case	"Nyle C125A  (26kW cap @ 40F)"	:	"NyleC125A"
                case	"Nyle C185A  (40kW cap @ 40F)"	:	"NyleC185A"
                case	"Nyle C250A  (45kW cap @ 40F)"	:	"NyleC250A"
                case	"Nyle C60A-C  (11kW cap @ 40F)"	:	"NyleC60A_C"
                case	"Nyle C90A-C  (20kW cap @ 40F)"	:	"NyleC90A_C"
                case	"Nyle C125A-C  (26kW cap @ 40F)"	:	"NyleC125A_C"
                case	"Nyle C185A-C  (40kW cap @ 40F)"	:	"NyleC185A_C"
                case	"Nyle C250A-C  (45kW cap @ 40F)"	:	"NyleC250A_C"
                case	"Sanden GS3-45HPA-US  (4kW cap @ 40F)"	:	"SandenGS345HPAUS"
                case	"Lochinvar AHP025-*-***N****  (5kW cap @ 40F)"	:	"LochinvarAHP025"
                case	"Lochinvar AHP060-*-***N****  (11kW cap @ 40F)"	:	"LochinvarAHP060"
                case	"Lochinvar AHP090-*-***N****  (20kW cap @ 40F)"	:	"LochinvarAHP090"
                case	"Lochinvar AHP125-*-***N****  (26kW cap @ 40F)"	:	"LochinvarAHP125"
                case	"Lochinvar AHP185-*-***N****  (40kW cap @ 40F)"	:	"LochinvarAHP185"
                case	"Lochinvar AHP250-*-***N****  (45kW cap @ 40F)"	:	"LochinvarAHP250"
                case	"A. O. Smith AHPA-25-*-***N****  (5kW cap @ 40F)"	:	"AOSmithAHPA25"
                case	"A. O. Smith AHPA-60-*-***N****  (11kW cap @ 40F)"	:	"AOSmithAHPA60"
                case	"A. O. Smith AHPA-90-*-***N****  (20kW cap @ 40F)"	:	"AOSmithAHPA90"
                case	"A. O. Smith AHPA-125-*-***N****  (26kW cap @ 40F)"	:	"AOSmithAHPA125"
                case	"A. O. Smith AHPA-185-*-***N****  (40kW cap @ 40F)"	:	"AOSmithAHPA185"
                case	"A. O. Smith AHPA-250-*-***N****  (45kW cap @ 40F)"	:	"AOSmithAHPA250"
                case	"State SHPA-25-*-***N****  (5kW cap @ 40F)"	:	"StateSHPA25"
                case	"State SHPA-60-*-***N****  (11kW cap @ 40F)"	:	"StateSHPA60"
                case	"State SHPA-90-*-***N****  (20kW cap @ 40F)"	:	"StateSHPA90"
                case	"State SHPA-125-*-***N****  (26kW cap @ 40F)"	:	"StateSHPA125"
                case	"State SHPA-185-*-***N****  (40kW cap @ 40F)"	:	"StateSHPA185"
                case	"State SHPA-250-*-***N****  (45kW cap @ 40F)"	:	"StateSHPA250"
                case	"Lochinvar AHP060-*-***C****  (11kW cap @ 40F)"	:	"LochinvarAHP060C"
                case	"Lochinvar AHP090-*-***C****  (20kW cap @ 40F)"	:	"LochinvarAHP090C"
                case	"Lochinvar AHP125-*-***C****  (26kW cap @ 40F)"	:	"LochinvarAHP125C"
                case	"Lochinvar AHP185-*-***C****  (40kW cap @ 40F)"	:	"LochinvarAHP185C"
                case	"Lochinvar AHP250-*-***C****  (45kW cap @ 40F)"	:	"LochinvarAHP250C"
                case	"A. O. Smith AHPA-60-*-***C****  (11kW cap @ 40F)"	:	"AOSmithAHPA60C"
                case	"A. O. Smith AHPA-90-*-***C****  (20kW cap @ 40F)"	:	"AOSmithAHPA90C"
                case	"A. O. Smith AHPA-125-*-***C****  (26kW cap @ 40F)"	:	"AOSmithAHPA125C"
                case	"A. O. Smith AHPA-185-*-***C****  (40kW cap @ 40F)"	:	"AOSmithAHPA185C"
                case	"A. O. Smith AHPA-250-*-***C****  (45kW cap @ 40F)"	:	"AOSmithAHPA250C"
                case	"State SHPA-60-*-***C****  (11kW cap @ 40F)"	:	"StateSHPA60C"
                case	"State SHPA-90-*-***C****  (20kW cap @ 40F)"	:	"StateSHPA90C"
                case	"State SHPA-125-*-***C****  (26kW cap @ 40F)"	:	"StateSHPA125C"
                case	"State SHPA-185-*-***C****  (40kW cap @ 40F)"	:	"StateSHPA185C"
                case	"State SHPA-250-*-***C****  (45kW cap @ 40F)"	:	"StateSHPA250C"
                case	"generic  (5kW cap @ 40F)"	:	"Generic5kW"
                case	"generic  (11kW cap @ 40F)"	:	"Generic11kW"
                case	"generic  (20kW cap @ 40F)"	:	"Generic20kW"
                case	"generic  (26kW cap @ 40F)"	:	"Generic26kW"
                case	"generic  (40kW cap @ 40F)"	:	"Generic40kW"
                case	"generic  (45kW cap @ 40F)"	:	"Generic45kW"
                case	"Colmac CxV-5  (MP, 14kW cap @ 40F)"	:	"ColmacCxV5MP"      ; RJH 10/2/22 new multi pass options
                case	"Colmac CxA-10  (MP, 21kW cap @ 40F)"	:	"ColmacCxA10MP"
                case	"Colmac CxA-15  (MP, 29kW cap @ 40F)"	:	"ColmacCxA15MP"
                case	"Colmac CxA-20  (MP, 41kW cap @ 40F)"	:	"ColmacCxA20MP"
                case	"Colmac CxA-25  (MP, 49kW cap @ 40F)"	:	"ColmacCxA25MP"
                case	"Colmac CxA-30  (MP, 57kW cap @ 40F)"	:	"ColmacCxA30MP"
                case	"Rheem HPHD-60HNU (horiz MP, 12kW cap @ 45F)"	  :	"RheemHPHD60HNUMP"
                case	"Rheem HPHD-60VNU (vertical MP, 12kW cap @ 45F)"  :	"RheemHPHD60VNUMP"
                case	"Rheem HPHD-135HNU (horiz MP, 30kW cap @ 45F)"	  :	"RheemHPHD135HNUMP"
                case	"Rheem HPHD-135VNU (vertical MP, 30kW cap @ 45F)" :	"RheemHPHD135VNUMP"
                case	"Nyle C60A  (MP, 11kW cap @ 40F)"	:	"NyleC60AMP"
                case	"Nyle C90A  (MP, 20kW cap @ 40F)"	:	"NyleC90AMP"
                case	"Nyle C125A  (MP, 26kW cap @ 40F)"	:	"NyleC125AMP"
                case	"Nyle C185A  (MP, 41kW cap @ 40F)"	:	"NyleC185AMP"
                case	"Nyle C250A  (MP, 46kW cap @ 40F)"	:	"NyleC250AMP"
                case	"Nyle C60A-C  (MP, 11kW cap @ 40F)"	:	"NyleC60A_CMP"
                case	"Nyle C90A-C  (MP, 20kW cap @ 40F)"	:	"NyleC90A_CMP"
                case	"Nyle C125A-C  (MP, 26kW cap @ 40F)"	:	"NyleC125A_CMP"
                case	"Nyle C185A-C  (MP, 41kW cap @ 40F)"	:	"NyleC185A_CMP"
                case	"Nyle C250A-C  (MP, 46kW cap @ 40F)"	:	"NyleC250A_CMP"
                case	"Lochinvar AHP060-*-***N****  (MP, 11cap @ 40F)"	:	"LochinvarAHP060MP"
                case	"Lochinvar AHP090-*-***N****  (MP, 20kw cap @ 40F)"	:	"LochinvarAHP090MP"
                case	"Lochinvar AHP125-*-***N****  (MP, 26kw cap @ 40F)"	:	"LochinvarAHP125MP"
                case	"Lochinvar AHP185-*-***N****  (MP, 41kw cap @ 40F)"	:	"LochinvarAHP185MP"
                case	"Lochinvar AHP250-*-***N****  (MP, 46kw cap @ 40F)"	:	"LochinvarAHP250MP"
                case	"A. O. Smith AHPA-60-*-***N****  (MP, 11kw cap @ 40F)"	:	"AOSmithAHPA60MP"
                case	"A. O. Smith AHPA-90-*-***N****  (MP, 20kw cap @ 40F)"	:	"AOSmithAHPA90MP"
                case	"A. O. Smith AHPA-125-*-***N****  (MP, 26kw cap @ 40F)"	:	"AOSmithAHPA125MP"
                case	"A. O. Smith AHPA-185-*-***N****  (MP, 41kw cap @ 40F)"	:	"AOSmithAHPA185MP"
                case	"A. O. Smith AHPA-250-*-***N****  (MP, 46kw cap @ 40F)"	:	"AOSmithAHPA250MP"
                case	"State SHPA-60-*-***N****  (MP, 11kw cap @ 40F)"	:	"StateSHPA60MP"
                case	"State SHPA-90-*-***N****  (MP, 20kw cap @ 40F)"	:	"StateSHPA90MP"
                case	"State SHPA-125-*-***N****  (MP, 26kw cap @ 40F)"	:	"StateSHPA125MP"
                case	"State SHPA-185-*-***N****  (MP, 41kw cap @ 40F)"	:	"StateSHPA185MP"
                case	"State SHPA-250-*-***N****  (MP, 46kw cap @ 40F)"	:	"StateSHPA250MP"
                case	"Lochinvar AHP060-*-***C****  (MP, 11kw cap @ 40F)"	:	"LochinvarAHP060CMP"
                case	"Lochinvar AHP090-*-***C****  (MP, 20kw cap @ 40F)"	:	"LochinvarAHP090CMP"
                case	"Lochinvar AHP125-*-***C****  (MP, 26kw cap @ 40F)"	:	"LochinvarAHP125CMP"
                case	"Lochinvar AHP185-*-***C****  (MP, 41kw cap @ 40F)"	:	"LochinvarAHP185CMP"
                case	"Lochinvar AHP250-*-***C****  (MP, 46kw cap @ 40F)"	:	"LochinvarAHP250CMP"
                case	"A. O. Smith AHPA-60-*-***C****  (MP, 11kw cap @ 40F)"	:	"AOSmithAHPA60CMP"
                case	"A. O. Smith AHPA-90-*-***C****  (MP, 20kw cap @ 40F)"	:	"AOSmithAHPA90CMP"
                case	"A. O. Smith AHPA-125-*-***C****  (MP, 26kw @ 40F)"	:	"AOSmithAHPA125CMP"
                case	"A. O. Smith AHPA-185-*-***C****  (MP, 41kw @ 40F)"	:	"AOSmithAHPA185CMP"
                case	"A. O. Smith AHPA-250-*-***C****  (MP, 46kw @ 40F)"	:	"AOSmithAHPA250CMP"
                case	"State SHPA-60-*-***C****  (MP, 11kw cap @ 40F)"	:	"StateSHPA60CMP"
                case	"State SHPA-90-*-***C****  (MP, 20kw cap @ 40F)"	:	"StateSHPA90CMP"
                case	"State SHPA-125-*-***C****  (MP, 26kw cap @ 40F)"	:	"StateSHPA125CMP"
                case	"State SHPA-185-*-***C****  (MP, 41kw cap @ 40F)"	:	"StateSHPA185CMP"
                case	"State SHPA-250-*-***C****  (MP, 46kw cap @ 40F)"	:	"StateSHPA250CMP"
                default :  UNDEFINED
             endswitch
        else UNDEFINED
        endif
    else UNDEFINED
    endif
ENDRULE

;; RJH - 9/30/22 If Integrated, Packaged System then populate WaterCHPWH02_HeatPumpWaterHeaterBrand for NEEA
RULE nrccWaterCHPWH02:WaterCHPWH02_HeatPumpWaterHeaterBrand
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated, Packaged System") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated/Packaged System"))
    then    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHIntegPkgType == "Residential (NEEA rated) Product") .AND. LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHNEEABrand ) > 0 )
            then switch (noXMLoutput_ResDHWSysRef:CHPWHNEEABrand)
                    case	"A. O. Smith"	 :	"AOSmith"
                    case	"American"		 :	"American"
                    case	"Bradford White" :	"BradfordWhite"
                    case	"Direct Energy"	 :	"DirectEnergy"
                    case	"EcoSense"		 :	"EcoSense"
                    case	"GE"		     :	"GE"
                    case	"Kenmore"		 :	"Kenmore"
                    case	"Lochinvar"		 :	"Lochinvar"
                    case	"Reliance"		 :	"Reliance"
                    case	"Rheem"		     :	"Rheem"
                    case	"Rheem Canada"	 :	"RheemCanada"
                    case	"Richmond"		 :	"Richmond"
                    case	"Ruud"		     :	"Ruud"
                    case	"Sanden"		 :	"Sanden"
                    case	"State"		     :	"State"
                    case	"Stiebel Eltron" :	"Stiebel"
                    case	"US Craftmaster" :	"USCraftmaster"
                    case	"Whirlpool"		 :	"Whirlpool"
                    case	"(generic)"		 :	"Generic"
                    default :  UNDEFINED
                 endswitch
            else UNDEFINED
            endif
    else UNDEFINED
    endif
ENDRULE

;; RJH - 9/30/22 If Integrated, Packaged System then populate WaterCHPWH02_HeatPumpWaterHeaterModel for NEEA OR Commercial
RULE nrccWaterCHPWH02:WaterCHPWH02_HeatPumpWaterHeaterModel
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated, Packaged System") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated/Packaged System") )
    then if( ResProj:EnergyCodeYearNum >= 2022 .AND. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHIntegPkgType == "Residential (NEEA rated) Product") .AND. LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHNEEAModel ) > 0 )
         then HPWHData_NEEA:RptHPWHModel( "Model", noXMLoutput_ResDHWSysRef:CHPWHNEEAModel )
         else if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHIntegPkgType == "Commercial Product") )
              then "AOSmithCAHP120"
              else UNDEFINED
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
; SAC 12/26/22 - was:   then HPWHData_NEEA:HeatPumpWaterHeaterModel( "Model", EnumValue( noXMLoutput_ResDHWSysRef:CHPWHNEEAModel ) )

; mods to switch values accounting for increment of 100 for CHPWH compressor types - SAC 12/28/22
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH02a_HeatPumpWaterHeaterSimulationGroup
  ANNUAL_PROPOSED
    if (EnumValue(noXMLoutput_ResDHWSysRef:CHPWHSysDescrip) < 1 .OR. EnumValue(noXMLoutput_ResDHWSysRef:CHPWHASHPType) < 1)
    then  UNDEFINED
    else  switch ( EnumValue(noXMLoutput_ResDHWSysRef:CHPWHASHPType) ) 
            case 11 :  "AOSmithPHPT60"    ; "AO Smith PHPT 60"
            case 12 :  "AOSmithPHPT80"    ; "AO Smith PHPT 80"
            case 13 :  "AOSmithHPTU50"    ; "AO Smith HPTU 50"
            case 14 :  "AOSmithHPTU66"    ; "AO Smith HPTU 66"
            case 15 :  "AOSmithHPTU80"    ; "AO Smith HPTU 80"
            case 32 :  "AOSmithSHPT50"    ; "AO Smith SHPT 50"      ; AOSmithSHPT50
            case 33 :  "AOSmithSHPT66"    ; "AO Smith SHPT 66"      ; AOSmithSHPT66
            case 34 :  "AOSmithSHPT80"    ; "AO Smith SHPT 80"      ; AOSmithSHPT80
            case 72 :  "AOSmithCAHP120"   ; "AO Smith CAHP-120"     ; SAC 01/30/21 (tic #1260)
            case 19 :  "GE201450"         ; "GE2014 50"
            case 23 :  "GE201480"         ; "GE2014 80"
            case 36 :  "GE201480"         ; "GE2014 80 Eff DR"      ; GE2014_80DR          -- DR ???
            case 21 :  "RheemHB50"        ; "Rheem HB 50"
            case 16 :  "Sanden40"         ; "Sanden 40"
            case 17 :  "Sanden80"         ; "Sanden 80"
            case 22 :  "Stiebel220E"      ; "Stiebel 220E"
            case 38 :  "GE201250"         ; "GE2012 50"
            case 73 :  "Tier3Generic40"   ; "AWHSTier3Generic40"    ; NEEA generic tier 3 options - SAC 06/17/21
            case 74 :  "Tier3Generic50"   ; "AWHSTier3Generic50"
            case 75 :  "Tier3Generic65"   ; "AWHSTier3Generic65"
            case 76 :  "Tier3Generic80"   ; "AWHSTier3Generic80"
            case 39 :  "RheemHBDR4550"    ; "Rheem HBDR-45-50"
            case 40 :  "RheemHBDR4565"    ; "Rheem HBDR-45-65"
            case 41 :  "RheemHBDR4580"    ; "Rheem HBDR-45-80"
            case 42 :  "RheemHBDR2250"    ; "Rheem HBDR-22-50"
            case 43 :  "RheemHBDR2265"    ; "Rheem HBDR-22-65"
            case 44 :  "RheemHBDR2280"    ; "Rheem HBDR-22-80"
            case 148 :  "ColmacCxV5_SP"    ; "Colmac CxV-5"
            case 149 :  "ColmacCxA10_SP"   ; "Colmac CxA-10"
            case 150 :  "ColmacCxA15_SP"   ; "Colmac CxA-15"
            case 145 :  "ColmacCxA20_SP"   ; "Colmac CxA-20"
            case 151 :  "ColmacCxA25_SP"   ; "Colmac CxA-25"
            case 152 :  "ColmacCxA30_SP"   ; "Colmac CxA-30"
            case 153 :  "NyleC25A_SP"      ; "Nyle C25A"
            case 154 :  "NyleC60A_SP"      ; "Nyle C60A"
            case 155 :  "NyleC90A_SP"      ; "Nyle C90A"
            case 156 :  "NyleC125A_SP"     ; "Nyle C125A"
            case 146 :  "NyleC185A_SP"     ; "Nyle C185A"
            case 147 :  "NyleC250A_SP"     ; "Nyle C250A"
            case 167 :  "NyleC60A_CWP_SP"  ; "Nyle C60A-CWP"        ; SAC 6/23/20 - added cold wthr package presets
            case 168 :  "NyleC90A_CWP_SP"  ; "Nyle C90A-CWP"
            case 169 :  "NyleC125A_CWP_SP" ; "Nyle C125A-CWP"
            case 170 :  "NyleC185A_CWP_SP" ; "Nyle C185A-CWP"
            case 171 :  "NyleC250A_CWP_SP" ; "Nyle C250A-CWP"
            case 157 :  "SandenGS3"        ; "Sanden GS3-45HPA-US"   ; used to map to 17 - Sanden 80
            case 58 :  "BWC202065"        ; "Bradford White 2020 65"     ; SAC 6/16/20 - NEEA additions
            case 59 :  "Rheem2020Prem40"  ; "Rheem 2020 Premium 40"
            case 60 :  "Rheem2020Prem50"  ; "Rheem 2020 Premium 50"
            case 61 :  "Rheem2020Prem65"  ; "Rheem 2020 Premium 65"
            case 62 :  "Rheem2020Prem80"  ; "Rheem 2020 Premium 80"
            case 63 :  "Rheem2020Build40" ; "Rheem 2020 Builder 40"
            case 64 :  "Rheem2020Build50" ; "Rheem 2020 Builder 50"
            case 65 :  "Rheem2020Build65" ; "Rheem 2020 Builder 65"
            case 66 :  "Rheem2020Build80" ; "Rheem 2020 Builder 80"
            case 191 :  "Generic5kW"       ; "generic 5kW"                ; SAC 06/22/21
            case 192 :  "Generic11kW"      ; "generic 11kW"
            case 193 :  "Generic20kW"      ; "generic 20kW"
            case 194 :  "Generic26kW"      ; "generic 26kW"
            case 195 :  "Generic40kW"      ; "generic 40kW"
            case 196 :  "Generic45kW"      ; "generic 45kW"
            case 177 :  "ColmacCxV5MP"    ; "Colmac CxV-5 (MP)"      ; multi pass additions - SAC 01/17/22
            case 178 :  "ColmacCxA10MP"   ; "Colmac CxA-10 (MP)"
            case 179 :  "ColmacCxA15MP"   ; "Colmac CxA-15 (MP)"
            case 180 :  "ColmacCxA20MP"   ; "Colmac CxA-20 (MP)"
            case 181 :  "ColmacCxA25MP"   ; "Colmac CxA-25 (MP)"
            case 182 :  "ColmacCxA30MP"   ; "Colmac CxA-30 (MP)"
            case 183 :  "RheemHPHD60HNUMP"      ; "Rheem HPHD-60HNU (horiz MP)"
            case 184 :  "RheemHPHD60HNUMP"      ; "Rheem HPHD-60HNU (horiz MP)"
            case 185 :  "RheemHPHD135HNUMP"      ; "Rheem HPHD-135HNU (horiz MP)"
            case 186 :  "RheemHPHD135VNUMP"      ; "Rheem HPHD-135VNU (vertical MP)"
            case 105 :  "NyleC60AMP"      ; "Nyle C60A (MP)"
            case 106 :  "NyleC90AMP"      ; "Nyle C90A (MP)"
            case 107 :  "NyleC125AMP"     ; "Nyle C125A (MP)"
            case 108 :  "NyleC185AMP"     ; "Nyle C185A (MP)"
            case 109 :  "NyleC250AM"      ; "Nyle C250A (MP)"
            case 125 :  "NyleC60A_CWPMP"  ; "Nyle C60A-CWP (MP)"  
            case 126 :  "NyleC90A_CWPMP"  ; "Nyle C90A-CWP (MP)"
            case 127 :  "NyleC125A_CWPMP" ; "Nyle C125A-CWP (MP)"
            case 128 :  "NyleC185A_CWPMP" ; "Nyle C185A-CWP (MP)"
            case 129 :  "NyleC250A_CWPMP" ; "Nyle C250A-CWP (MP)"
            default :  UNDEFINED
          endswitch
    endif
ENDRULE

; RJH 3/24/23 Added as NOT REPORTED IN PDF
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH02b_WaterHeaterFuelSource
  ANNUAL_PROPOSED
    "WaterHeatingHP"
ENDRULE

; NRCC Res DHW
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH03_CompressorCountCHPWH
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:CHPWHNumComp
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH04_PrimaryTankCapacity
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:CHPWHTotTankVol ) )
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH05_TankCountCHPWH
  ANNUAL_PROPOSED
    if (LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHSysDescrip ) > 0 .AND. noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated, Packaged System")
    then UNDEFINED
    else if (LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHTankCount ) > 0)
         then noXMLoutput_ResDHWSysRef:CHPWHTankCount 
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_WaterCHPWH05_TankCountCHPWH ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH06_PrimaryTankTotalInsulation
  ANNUAL_PROPOSED
    if (LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHSysDescrip ) > 0 .AND. noXMLoutput_ResDHWSysRef:CHPWHSysDescrip == "Integrated, Packaged System")
    then UNDEFINED
    else if (LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHTankRVal ) > 0)
         then atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:CHPWHTankRVal ) ) 
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_WaterCHPWH06_PrimaryTankTotalInsulation ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH07_TankLocation
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHTankLoc == "Outside")
    then "Outside"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH07_ZoneSystemName
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHTankLoc == "Zone")
    then noXMLoutput_ResDHWSysRef:CHPWHTankZone:Name
    else UNDEFINED
    endif
ENDRULE


RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH08_AirSource
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHSrcAirLoc == "Outside")
    then "Outside"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowCHPWH:afterchildren_WaterCHPWH08_ZoneSystemName
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHSrcAirLoc == "Zone")
    then noXMLoutput_ResDHWSysRef:CHPWHSrcAirZone:Name
    else UNDEFINED
    endif
ENDRULE



; nrccSection_LpTank nrccTableLpTank 
RULE NEW ResDHWSys:nrcctblRowLpTankRef
  DATATYPE
    nrcctblRowLpTank
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowLpTank:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowLpTank:Parent
  ANNUAL_PROPOSED
    nrccTableLpTank:Name
ENDRULE

; nrccLpTank02
RULE NEW ResDHWSys:nrccLpTank02Ref
  DATATYPE
    nrccLpTank02
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccLpTank02:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccLpTank02:Parent
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:nrcctblRowLpTankRef:Name
ENDRULE



; NRCC Res DHW 2019 => 2022
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankType => noXMLoutput_ResDHWSysRef:CHPWHLoopTankType
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankCprsrCnt => noXMLoutput_ResDHWSysRef:CHPWHLoopTankCompCnt
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankVol => noXMLoutput_ResDHWSysRef:CHPWHLoopTankVol
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankCnt => noXMLoutput_ResDHWSysRef:CHPWHLoopTankTankCnt
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankRVal => noXMLoutput_ResDHWSysRef:CHPWHLoopTankRVal
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankBrand => noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEABrand
; noXMLoutput_ResDHWSysRef:CentralHPWHLpTankCprsrType => noXMLoutput_ResDHWSysRef:CHPWHLoopTankCompType


; NRCC Res DHW
RULE nrcctblRowLpTank:LpTank01_LoopTankType
  ANNUAL_PROPOSED
    switch (noXMLoutput_ResDHWSysRef:CHPWHLoopTankType)
        case "Electric Resistance"        : "ElectricResistance"
        case "Integrated/Packaged System" : "IntegratedPackagedSystem"
        case "Single Pass Primary"        : "SinglePass"
        case "Multi Pass Primary"         : "MultiPass"
        default :  UNDEFINED
    endswitch
ENDRULE

RULE nrcctblRowLpTank:LpTank01a_LoopTankConfig
  ANNUAL_PROPOSED
    switch (noXMLoutput_ResDHWSysRef:CHPWHLoopTankConfig)
        case "None (return to Primary)" : "None"
        case "Series (Swing)"           : "Series"
        case "Parallel"                 : "Parallel"
        default :  UNDEFINED
    endswitch
ENDRULE

; RJH 2/3/23 Add CHPWH Name reference for HERS providers
RULE nrcctblRowLpTank:LpTank01b_WaterHeatingSystemName
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:Name
ENDRULE

;; RJH - 10/4/22 If Single Pass Primary OR Multi Pass Primary then ONLY populate LpTank02_CentralHPWHCompressorType (See SVN Documentation/T24/T24R_CentralHPWHCompressors.xlsx)
RULE nrccLpTank02:LpTank02_CentralHPWHCompressorType
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Single Pass Primary") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Multi Pass Primary") )
    then if( LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHLoopTankCompType ) > 0 )
        then switch (noXMLoutput_ResDHWSysRef:CHPWHLoopTankCompType)
                case	"Colmac CxV-5  (14kW cap @ 40F)"	:	"ColmacCxV5"
                case	"Colmac CxA-10  (21kW cap @ 40F)"	:	"ColmacCxA10"
                case	"Colmac CxA-15  (29kW cap @ 40F)"	:	"ColmacCxA15"
                case	"Colmac CxA-20  (41kW cap @ 40F)"	:	"ColmacCxA20"
                case	"Colmac CxA-25  (49kW cap @ 40F)"	:	"ColmacCxA25"
                case	"Colmac CxA-30  (57kW cap @ 40F)"	:	"ColmacCxA30"
                case	"Nyle C25A  (5kW cap @ 40F)"	:	"NyleC25A"
                case	"Nyle C60A  (11kW cap @ 40F)"	:	"NyleC60A"
                case	"Nyle C90A  (20kW cap @ 40F)"	:	"NyleC90A"
                case	"Nyle C125A  (26kW cap @ 40F)"	:	"NyleC125A"
                case	"Nyle C185A  (40kW cap @ 40F)"	:	"NyleC185A"
                case	"Nyle C250A  (45kW cap @ 40F)"	:	"NyleC250A"
                case	"Nyle C60A-C  (11kW cap @ 40F)"	:	"NyleC60A_C"
                case	"Nyle C90A-C  (20kW cap @ 40F)"	:	"NyleC90A_C"
                case	"Nyle C125A-C  (26kW cap @ 40F)"	:	"NyleC125A_C"
                case	"Nyle C185A-C  (40kW cap @ 40F)"	:	"NyleC185A_C"
                case	"Nyle C250A-C  (45kW cap @ 40F)"	:	"NyleC250A_C"
                case	"Sanden GS3-45HPA-US  (4kW cap @ 40F)"	:	"SandenGS345HPAUS"
                case	"Lochinvar AHP025-*-***N****  (5kW cap @ 40F)"	:	"LochinvarAHP025"
                case	"Lochinvar AHP060-*-***N****  (11kW cap @ 40F)"	:	"LochinvarAHP060"
                case	"Lochinvar AHP090-*-***N****  (20kW cap @ 40F)"	:	"LochinvarAHP090"
                case	"Lochinvar AHP125-*-***N****  (26kW cap @ 40F)"	:	"LochinvarAHP125"
                case	"Lochinvar AHP185-*-***N****  (40kW cap @ 40F)"	:	"LochinvarAHP185"
                case	"Lochinvar AHP250-*-***N****  (45kW cap @ 40F)"	:	"LochinvarAHP250"
                case	"A. O. Smith AHPA-25-*-***N****  (5kW cap @ 40F)"	:	"AOSmithAHPA25"
                case	"A. O. Smith AHPA-60-*-***N****  (11kW cap @ 40F)"	:	"AOSmithAHPA60"
                case	"A. O. Smith AHPA-90-*-***N****  (20kW cap @ 40F)"	:	"AOSmithAHPA90"
                case	"A. O. Smith AHPA-125-*-***N****  (26kW cap @ 40F)"	:	"AOSmithAHPA125"
                case	"A. O. Smith AHPA-185-*-***N****  (40kW cap @ 40F)"	:	"AOSmithAHPA185"
                case	"A. O. Smith AHPA-250-*-***N****  (45kW cap @ 40F)"	:	"AOSmithAHPA250"
                case	"State SHPA-25-*-***N****  (5kW cap @ 40F)"	:	"StateSHPA25"
                case	"State SHPA-60-*-***N****  (11kW cap @ 40F)"	:	"StateSHPA60"
                case	"State SHPA-90-*-***N****  (20kW cap @ 40F)"	:	"StateSHPA90"
                case	"State SHPA-125-*-***N****  (26kW cap @ 40F)"	:	"StateSHPA125"
                case	"State SHPA-185-*-***N****  (40kW cap @ 40F)"	:	"StateSHPA185"
                case	"State SHPA-250-*-***N****  (45kW cap @ 40F)"	:	"StateSHPA250"
                case	"Lochinvar AHP060-*-***C****  (11kW cap @ 40F)"	:	"LochinvarAHP060C"
                case	"Lochinvar AHP090-*-***C****  (20kW cap @ 40F)"	:	"LochinvarAHP090C"
                case	"Lochinvar AHP125-*-***C****  (26kW cap @ 40F)"	:	"LochinvarAHP125C"
                case	"Lochinvar AHP185-*-***C****  (40kW cap @ 40F)"	:	"LochinvarAHP185C"
                case	"Lochinvar AHP250-*-***C****  (45kW cap @ 40F)"	:	"LochinvarAHP250C"
                case	"A. O. Smith AHPA-60-*-***C****  (11kW cap @ 40F)"	:	"AOSmithAHPA60C"
                case	"A. O. Smith AHPA-90-*-***C****  (20kW cap @ 40F)"	:	"AOSmithAHPA90C"
                case	"A. O. Smith AHPA-125-*-***C****  (26kW cap @ 40F)"	:	"AOSmithAHPA125C"
                case	"A. O. Smith AHPA-185-*-***C****  (40kW cap @ 40F)"	:	"AOSmithAHPA185C"
                case	"A. O. Smith AHPA-250-*-***C****  (45kW cap @ 40F)"	:	"AOSmithAHPA250C"
                case	"State SHPA-60-*-***C****  (11kW cap @ 40F)"	:	"StateSHPA60C"
                case	"State SHPA-90-*-***C****  (20kW cap @ 40F)"	:	"StateSHPA90C"
                case	"State SHPA-125-*-***C****  (26kW cap @ 40F)"	:	"StateSHPA125C"
                case	"State SHPA-185-*-***C****  (40kW cap @ 40F)"	:	"StateSHPA185C"
                case	"State SHPA-250-*-***C****  (45kW cap @ 40F)"	:	"StateSHPA250C"
                case	"generic  (5kW cap @ 40F)"	:	"Generic5kW"
                case	"generic  (11kW cap @ 40F)"	:	"Generic11kW"
                case	"generic  (20kW cap @ 40F)"	:	"Generic20kW"
                case	"generic  (26kW cap @ 40F)"	:	"Generic26kW"
                case	"generic  (40kW cap @ 40F)"	:	"Generic40kW"
                case	"generic  (45kW cap @ 40F)"	:	"Generic45kW"
                case	"Colmac CxV-5  (MP, 14kW cap @ 40F)"	:	"ColmacCxV5MP"      ; RJH 10/2/22 new multi pass options
                case	"Colmac CxA-10  (MP, 21kW cap @ 40F)"	:	"ColmacCxA10MP"
                case	"Colmac CxA-15  (MP, 29kW cap @ 40F)"	:	"ColmacCxA15MP"
                case	"Colmac CxA-20  (MP, 41kW cap @ 40F)"	:	"ColmacCxA20MP"
                case	"Colmac CxA-25  (MP, 49kW cap @ 40F)"	:	"ColmacCxA25MP"
                case	"Colmac CxA-30  (MP, 57kW cap @ 40F)"	:	"ColmacCxA30MP"
                case	"Rheem HPHD-60HNU (horiz MP, 12kW cap @ 45F)"	  :	"RheemHPHD60HNUMP"
                case	"Rheem HPHD-60VNU (vertical MP, 12kW cap @ 45F)"  :	"RheemHPHD60VNUMP"
                case	"Rheem HPHD-135HNU (horiz MP, 30kW cap @ 45F)"	  :	"RheemHPHD135HNUMP"
                case	"Rheem HPHD-135VNU (vertical MP, 30kW cap @ 45F)" :	"RheemHPHD135VNUMP"
                case	"Nyle C60A  (MP, 11kW cap @ 40F)"	:	"NyleC60AMP"
                case	"Nyle C90A  (MP, 20kW cap @ 40F)"	:	"NyleC90AMP"
                case	"Nyle C125A  (MP, 26kW cap @ 40F)"	:	"NyleC125AMP"
                case	"Nyle C185A  (MP, 41kW cap @ 40F)"	:	"NyleC185AMP"
                case	"Nyle C250A  (MP, 46kW cap @ 40F)"	:	"NyleC250AMP"
                case	"Nyle C60A-C  (MP, 11kW cap @ 40F)"	:	"NyleC60A_CMP"
                case	"Nyle C90A-C  (MP, 20kW cap @ 40F)"	:	"NyleC90A_CMP"
                case	"Nyle C125A-C  (MP, 26kW cap @ 40F)"	:	"NyleC125A_CMP"
                case	"Nyle C185A-C  (MP, 41kW cap @ 40F)"	:	"NyleC185A_CMP"
                case	"Nyle C250A-C  (MP, 46kW cap @ 40F)"	:	"NyleC250A_CMP"
                case	"Lochinvar AHP060-*-***N****  (MP, 11cap @ 40F)"	:	"LochinvarAHP060MP"
                case	"Lochinvar AHP090-*-***N****  (MP, 20kw cap @ 40F)"	:	"LochinvarAHP090MP"
                case	"Lochinvar AHP125-*-***N****  (MP, 26kw cap @ 40F)"	:	"LochinvarAHP125MP"
                case	"Lochinvar AHP185-*-***N****  (MP, 41kw cap @ 40F)"	:	"LochinvarAHP185MP"
                case	"Lochinvar AHP250-*-***N****  (MP, 46kw cap @ 40F)"	:	"LochinvarAHP250MP"
                case	"A. O. Smith AHPA-60-*-***N****  (MP, 11kw cap @ 40F)"	:	"AOSmithAHPA60MP"
                case	"A. O. Smith AHPA-90-*-***N****  (MP, 20kw cap @ 40F)"	:	"AOSmithAHPA90MP"
                case	"A. O. Smith AHPA-125-*-***N****  (MP, 26kw cap @ 40F)"	:	"AOSmithAHPA125MP"
                case	"A. O. Smith AHPA-185-*-***N****  (MP, 41kw cap @ 40F)"	:	"AOSmithAHPA185MP"
                case	"A. O. Smith AHPA-250-*-***N****  (MP, 46kw cap @ 40F)"	:	"AOSmithAHPA250MP"
                case	"State SHPA-60-*-***N****  (MP, 11kw cap @ 40F)"	:	"StateSHPA60MP"
                case	"State SHPA-90-*-***N****  (MP, 20kw cap @ 40F)"	:	"StateSHPA90MP"
                case	"State SHPA-125-*-***N****  (MP, 26kw cap @ 40F)"	:	"StateSHPA125MP"
                case	"State SHPA-185-*-***N****  (MP, 41kw cap @ 40F)"	:	"StateSHPA185MP"
                case	"State SHPA-250-*-***N****  (MP, 46kw cap @ 40F)"	:	"StateSHPA250MP"
                case	"Lochinvar AHP060-*-***C****  (MP, 11kw cap @ 40F)"	:	"LochinvarAHP060CMP"
                case	"Lochinvar AHP090-*-***C****  (MP, 20kw cap @ 40F)"	:	"LochinvarAHP090CMP"
                case	"Lochinvar AHP125-*-***C****  (MP, 26kw cap @ 40F)"	:	"LochinvarAHP125CMP"
                case	"Lochinvar AHP185-*-***C****  (MP, 41kw cap @ 40F)"	:	"LochinvarAHP185CMP"
                case	"Lochinvar AHP250-*-***C****  (MP, 46kw cap @ 40F)"	:	"LochinvarAHP250CMP"
                case	"A. O. Smith AHPA-60-*-***C****  (MP, 11kw cap @ 40F)"	:	"AOSmithAHPA60CMP"
                case	"A. O. Smith AHPA-90-*-***C****  (MP, 20kw cap @ 40F)"	:	"AOSmithAHPA90CMP"
                case	"A. O. Smith AHPA-125-*-***C****  (MP, 26kw @ 40F)"	:	"AOSmithAHPA125CMP"
                case	"A. O. Smith AHPA-185-*-***C****  (MP, 41kw @ 40F)"	:	"AOSmithAHPA185CMP"
                case	"A. O. Smith AHPA-250-*-***C****  (MP, 46kw @ 40F)"	:	"AOSmithAHPA250CMP"
                case	"State SHPA-60-*-***C****  (MP, 11kw cap @ 40F)"	:	"StateSHPA60CMP"
                case	"State SHPA-90-*-***C****  (MP, 20kw cap @ 40F)"	:	"StateSHPA90CMP"
                case	"State SHPA-125-*-***C****  (MP, 26kw cap @ 40F)"	:	"StateSHPA125CMP"
                case	"State SHPA-185-*-***C****  (MP, 41kw cap @ 40F)"	:	"StateSHPA185CMP"
                case	"State SHPA-250-*-***C****  (MP, 46kw cap @ 40F)"	:	"StateSHPA250CMP"
                default :  UNDEFINED
             endswitch
        else UNDEFINED
        endif
    else UNDEFINED
    endif
ENDRULE


;; RJH - 10/4/22 If Integrated, Packaged System then populate LpTank02_HeatPumpWaterHeaterBrand for NEEA
RULE nrccLpTank02:LpTank02_HeatPumpWaterHeaterBrand
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Integrated, Packaged System") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Integrated/Packaged System"))
    then    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankIntegPkgType == "Residential (NEEA rated) Product") .AND. LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEABrand ) > 0 )
            then switch (noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEABrand)
                    case	"A. O. Smith"	 :	"AOSmith"
                    case	"American"		 :	"American"
                    case	"Bradford White" :	"BradfordWhite"
                    case	"Direct Energy"	 :	"DirectEnergy"
                    case	"EcoSense"		 :	"EcoSense"
                    case	"GE"		     :	"GE"
                    case	"Kenmore"		 :	"Kenmore"
                    case	"Lochinvar"		 :	"Lochinvar"
                    case	"Reliance"		 :	"Reliance"
                    case	"Rheem"		     :	"Rheem"
                    case	"Rheem Canada"	 :	"RheemCanada"
                    case	"Richmond"		 :	"Richmond"
                    case	"Ruud"		     :	"Ruud"
                    case	"Sanden"		 :	"Sanden"
                    case	"State"		     :	"State"
                    case	"Stiebel Eltron" :	"Stiebel"
                    case	"US Craftmaster" :	"USCraftmaster"
                    case	"Whirlpool"		 :	"Whirlpool"
                    case	"(generic)"		 :	"Generic"
                    default :  UNDEFINED
                 endswitch
            else UNDEFINED
            endif
    else UNDEFINED
    endif
ENDRULE

;; RJH - 10/4/22 If Integrated, Packaged System then populate LpTank02_HeatPumpWaterHeaterModel for NEEA OR Commercial
RULE nrccLpTank02:LpTank02_HeatPumpWaterHeaterModel
  ANNUAL_PROPOSED
    if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Integrated, Packaged System") .OR. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Integrated/Packaged System") )
    then if( ResProj:EnergyCodeYearNum >= 2022 .AND. IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankIntegPkgType == "Residential (NEEA rated) Product") .AND. LocalStatus( noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEAModel ) > 0 )
         then HPWHData_NEEA:RptHPWHModel( "Model", noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEAModel )
         else if( IfValidAnd(noXMLoutput_ResDHWSysRef:CHPWHLoopTankIntegPkgType == "Commercial Product") )
              then "AOSmithCAHP120"
              else UNDEFINED
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
; SAC 12/26/22 - was:   then HPWHData_NEEA:HeatPumpWaterHeaterModel( "Model", EnumValue( noXMLoutput_ResDHWSysRef:CHPWHLoopTankNEEAModel ) )

RULE nrccLpTank02:LpTank02_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( LpTank02_CentralHPWHCompressorType ) > 0 .OR. LocalStatus( LpTank02_HeatPumpWaterHeaterBrand ) > 0 .OR. LocalStatus( LpTank02_HeatPumpWaterHeaterModel ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE


; NRCC Res DHW
RULE nrcctblRowLpTank:afterchildren_LpTank03_CompressorCountCHPWH
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:CHPWHLoopTankCompCnt
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank04_LoopTankCapacity
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:CHPWHLoopTankVol ) )
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank05_TankCountCHPWH
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "NEEA HPWH" .OR. noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Commercial HPWH")
    then UNDEFINED
    else noXMLoutput_ResDHWSysRef:CHPWHLoopTankTankCnt
    endif
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_LpTank05_TankCountCHPWH ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowLpTank:afterchildren_LpTank06_LoopTankTotalInsulation
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "NEEA HPWH" .OR. noXMLoutput_ResDHWSysRef:CHPWHLoopTankType == "Commercial HPWH")
    then UNDEFINED
    else atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:CHPWHLoopTankRVal ) )
    endif
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_LpTank06_LoopTankTotalInsulation ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
; NRCC Res DHW
RULE nrcctblRowLpTank:afterchildren_LpTank07_LoopTankLocation
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankLoc == "Outside")
    then "Outside"
    else if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankLoc == "Zone")
         then noXMLoutput_ResDHWSysRef:CHPWHLoopTankZone:Name
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank08_AirSource
  ANNUAL_PROPOSED
    if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankSrcAirLoc == "Outside")
    then "Outside"
    else if (noXMLoutput_ResDHWSysRef:CHPWHLoopTankSrcAirLoc == "Zone")
         then noXMLoutput_ResDHWSysRef:CHPWHLoopTankSrcAirZone:Name
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowLpTank:afterchildren_LpTank08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_LpTank08_AirSource ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE


; NRCC Res DHW 2019 => 2022
; noXMLoutput_ResDHWSysRef:LpCnt => noXMLoutput_ResDHWSysRef:NRecircLoops
; noXMLoutput_ResDHWSysRef:IsRecircSys => noXMLoutput_ResDHWSysRef:IsRecircSystem
; noXMLoutput_ResDHWSysRef:LpPipeInsThkns[1] => noXMLoutput_ResDHWSysRef:LoopPipeInsulThk[1]
; noXMLoutput_ResDHWSysRef:PipeLctn => noXMLoutput_ResDHWSysRef:RecircPipeLoc

; nrccSection_RecircLp nrccTableRecircLp 
RULE NEW ResDHWSys:nrcctblRowRecircLpRef
  DATATYPE
    nrcctblRowRecircLp
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowRecircLp:noXMLoutput_ResDHWSysRef
  DATATYPE
    ResDHWSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowRecircLp:Parent
  ANNUAL_PROPOSED
    nrccTableRecircLp:Name
ENDRULE

RULE nrcctblRowRecircLp:RecircLp01_WaterHeatingSystemName
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:Name
ENDRULE
; NRCC Res DHW
RULE nrcctblRowRecircLp:RecircLp02_RecirculationLoopCount
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:NRecircLoops
ENDRULE
RULE nrcctblRowRecircLp:RecircLp03_PipeInsulationThickness
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:LoopPipeInsulThk[1] ) )
ENDRULE
RULE nrcctblRowRecircLp:RecircLp04_PipeLocation
  ANNUAL_PROPOSED
    switch (noXMLoutput_ResDHWSysRef:RecircPipeLoc)
        case "Conditioned"      : "ConditionedSpace"
        case "Semi-Conditioned" : "SemiConditionedSpace"
        case "Unconditioned"    : "UnconditionedSpace"
        case "Underground"      : "Underground"
        default :  UNDEFINED
    endswitch
ENDRULE
RULE nrcctblRowRecircLp:RecircLp05_RecirculationPumpPower
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ResDHWSysRef:RecircPumpPwr ) )
ENDRULE
RULE nrcctblRowRecircLp:RecircLp06_PumpPowerUnits
  ANNUAL_PROPOSED
    noXMLoutput_ResDHWSysRef:RecircPumpPwrUnits
ENDRULE


; nrccSection_WaterSolar nrccTableWaterSolar 
RULE NEW DHWSolSys:nrcctblRowWaterSolarRef
  DATATYPE
    nrcctblRowWaterSolar
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowWaterSolar:noXMLoutput_DHWSolSysRef
  DATATYPE
    DHWSolSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowWaterSolar:Parent
  ANNUAL_PROPOSED
    nrccTableWaterSolar:Name
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar01_DHWSolarSystemName
  ANNUAL_PROPOSED
    noXMLoutput_DHWSolSysRef:Name
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar02_Manufacturer
  ANNUAL_PROPOSED
    switch (noXMLoutput_DHWSolSysRef:Manufacturer)
        case	"1st Sunflower Renewable Energy Co., Ltd"	:	"SunflowerRenewable" ; renamed - SAC 05/11/21		
        case	"Baymak Group"	:	"BaymakGroup"                                                  ; renamed - SAC 05/11/21		
        case	"Chromagen"	:	"Chromagen"                                                        ; renamed - SAC 05/11/21		
        case	"Bach Khoa Investment And Development Of Solar Energy Corporation"	:	"IREX"     ; remapped to IREX Energy - SAC 05/11/21		
        case	"Power Panel Inc."	:	"PowerPanel"	                                           ; renamed - SAC 05/11/21	
        case	"SEA Group Ltd."	:	"SEA_Group"                                              ; renamed - SAC 05/11/21		
        case	"SunTrac Solar Inc."	:	"SunTracSolar"                                      ; renamed - SAC 05/11/21		
        case	"RG Resource Technologies"	:	"RGResourceTechnologies"                           ; renamed - SAC 05/11/21		
        case	"SEA Groups Ltd."	:	"SEA_Group"                                             ; renamed - SAC 05/11/21		
        case	"SOLID Solar Energy Systems GmbH"	:	"SOLIDSolarEnergySystemsGmbH"              ; added - SAC 05/11/21		
        case	"Soltek Puerto Rico LLC"	:	"SoltekPuertoRicoLLC"                              ; added - SAC 05/11/21		
        case	"Sunbank Solar"	:	"SunbankSolar"                                                 ; added - SAC 05/11/21		
        case	"SunTrac USA"	:	"SunTracUSA"                                                   ; renamed - SAC 05/12/21		
        case	"Acevedo Solar Systems LLC"	:	"AcevedoSolarSystemsLLC"	                       ; added - SAC 05/10/21	
        case	"Aqua Solanor Inc"	:	"AquaSolanorInc"	                                       ; added - SAC 05/10/21		
        case	"Haining Xianke New Material Technology Co., Ltd."	:	"HainingXiankeSolar"       ; renamed - SAC 05/11/21		
        case	"Naked Energy Ltd"	:	"NakedEnergyLtd"		                                   ; added - SAC 05/10/21	
        case	"ACR Solar International"	:	"ACR_Solar"		
        case	"Advanced Thermal Solar, LLC"	:	"AdvancedThermalSolar"		
        case	"Agua Del Sol"	:	"AguaDelSol"		
        case	"Alternate Energy Technologies"	:	"AlternateEnergyTechnologies"		
        case	"Apricus Inc."	:	"ApricusInc"		
        case	"Artic Solar Inc."	:	"ArticSolar"		
        case	"Bach Khoa Investment and Development of Solar Energy Corporation"	:	"BachKhoaInvestDevelopSolar"		
        case	"Baymak Goup"	:	"BaymakGoup"		
        case	"Beijing Sunda Solar Energy Technology Co Ltd"	:	"BeijingSundaSolar"		
        case	"Beijing Tianpu Solar Energy Industry Co"	:	"BeijingTianpuSolar"		
        case	"Bosch Thermotechnology Corp."	:	"BoschThermotechnology"		
        case	"Bronx Recycing Center Inc."	:	"BronxRecycing"		
        case	"Butler Sun Solutions, Inc."	:	"ButlerSun"		
        case	"Caleffi Solar"	:	"CaleffiSolar"		
        case	"Changzhou HE Jia Solar Energy Co., Ltd."	:	"ChangzhouSolar"		
        case	"China Hitek Solar Co., Ltd."	:	"ChinaHitekSolar"		
        case	"Chromagen"	:	"Chromagen"		
        case	"Commercial Energy Savings Plus"	:	"CommercialEnergySavings"		
        case	"Dehlsen Associates LLC."	:	"DehlsenAssociates"		
        case	"Dimas SA"	:	"DimasSA"		
        case	"Dimplex North America Ltd."	:	"DimplexNorthAmerica"		
        case	"Duda Energy"	:	"DudaEnergy"		
        case	"EarthNet Energy"	:	"EarthNetEnergy"		
        case	"EchoFirst Inc."	:	"EchoFirst"		
        case	"Energetyka Solarna Ensol Sp. z O.O."	:	"EnergetykaSolarna"		
        case	"Energy Conservation Products and Services"	:	"EnergyConservation"		
        case	"EnerWorks, Inc."	:	"EnerWorks"		
        case	"Environmental Solar Systems"	:	"EnvironmentalSolar"		
        case	"ergSol, Inc."	:	"ErgSol"		
        case	"Ezinc Metal Sanayi ve Ticaret A.S."	:	"EzincMetalSanayi"		
        case	"First Solar Products, Inc."	:	"FirstSolarProducts"		
        case	"Gear Solar"	:	"GearSolar"		
        case	"GreenBase Inc"	:	"GreenBase"		
        case	"GREENoneTec SolarIndustrie GmbH"	:	"GREENoneTec"		
        case	"Guangdong Fivestar Solar Energy Co., Ltd"	:	"GuangdongFivestarSolar"		
        case	"Gull Industries"	:	"GullIndustries"		
        case	"Haining Meilu Solar Energy Water Heater Co., Ltd."	:	"HainingMeiluSolar"		
        case	"Haining Oupairineng Solar Energy Water Heater Co., Ltd"	:	"HainingOupairinengSolar"		
        case	"Helioakmi S.A."	:	"Helioakmi"		
        case	"Heliodyne, Inc."	:	"Heliodyne"		
        case	"HEWALEX Sp. z o.o. Sp.k."	:	"HEWALEXsp"		
        case	"HTP, Inc."	:	"HTP"		
        case	"HUCU Solar Espana SL"	:	"HUCU"		
        case	"Innosolar Energy Co., Ltd."	:	"InnosolarEnergy"		
        case	"Integrated Solar LLC"	:	"IntegratedSolar"		
        case	"IREX Energy Stock Joint Company"	:	"IREX"		
        case	"Jiangsu Micoe Solar Energy Co., Ltd."	:	"JiangsuMicoeSolar"		
        case	"Jiangsu Sunpower Solar Technology Co., Ltd"	:	"JiangsuSunpowerSolar"		
        case	"Jiangsu Sunrain Solar Energy Co., Ltd."	:	"JiangsuSunrainSolar"		
        case	"Jiaxing Tjsun New Energy Co., Ltd."	:	"JiaxingTjsunNewEnergy"		
        case	"K-Cor, Inc."	:	"K_Cor"		
        case	"Kangnam Co., Ltd."	:	"Kangnam"		
        case	"KBB Kollektorbau"	:	"KBB_Kollektorbau"		
        case	"Kingspan Environmental Ltd."	:	"KingspanEnvironmental"		
        case	"Kingspan Solar Inc."	:	"KingspanSolar"		
        case	"KIOTO Clear Energy S.A. de C.V."	:	"KIOTO_ClearEnergySA"		
        case	"Kloben Sud S.r.l."	:	"KlobenSud"		
        case	"Lochinvar, LLC"	:	"Lochinvar"		
        case	"Magen Eco-Energy"	:	"MagenEcoEnergy"		
        case	"Modern Market Inc."	:	"ModernMarket"		
        case	"Modulo Solar SA de CV"	:	"ModuloSolar"		
        case	"Next Generation Energy, LLC"	:	"NextGenerationEnergy"		
        case	"Nimrod Industries Ltd."	:	"NimrodIndustries"		
        case	"NY Thermal Inc. (NTI)"	:	"NY_Thermal"		
        case	"Oventrop Corporation"	:	"Oventrop"		
        case	"Pacific West Solar"	:	"PacificWestSolar"		
        case	"Papaemmanouel S.A."	:	"Papaemmanouel"		
        case	"Photonomi Global Group"	:	"PhotonomiGlobal"		
        case	"PIEP Solar Technology Co., Ltd."	:	"PIEP_Solar"		
        case	"Power Panel Inc."	:	"PowerPanel"		
        case	"Rheem Water Heaters"	:	"RheemWaterHeaters"		
        case	"Ritter Energie - und Umwelttechnik GmbH &amp; Co. KG"	:	"RitterEnergieUmwelttechnik"		
        case	"Roth Industries, Inc."	:	"RothIndustries"		
        case	"R&R Solar Supply"	:	"RR_Solar"		
        case	"Rural Renewable Energy Alliance"	:	"RuralRenewableEnergy"		
        case	"SAMMLER B MICHALOPOULOS AEBE"	:	"SammlerMichalopoulos"		
        case	"SEA Group Ltd."	:	"SEA_Group"		
        case	"Shandong Linuo New Material Co., Ltd."	:	"ShandongLinuoNewMaterial"		
        case	"Sichuan PiEP Solar Technology Co., Ltd."	:	"SichuanPiEP_Solar"		
        case	"Silk Road Solar"	:	"SilkRoadSolar"		
        case	"SINSANE Co., Ltd."	:	"Sinsane"		
        case	"Solahart Industries"	:	"SolahartIndustries"		
        case	"SolAqua, Inc."	:	"SolAqua"		
        case	"Solar American Solutions"	:	"SolarAmericanSolutions"		
        case	"Solar Coil, LLC"	:	"SolarCoil"		
        case	"Solargenix Energy, LLC"	:	"SolargenixEnergy"		
        case	"Solarhot"	:	"Solarhot"		
        case	"Solar Panels Plus"	:	"SilkRoadSolar"		
        case	"Solar Power Formulators"	:	"SolarPowerFormulators"		
        case	"Solcan / 174945 Ontario Inc."	:	"Solcan174945Ontario"		
        case	"Solene"	:	"Solene"		
        case	"Sole S.A."	:	"SoleSA"		
        case	"Solight Solar Inc"	:	"SolightSolar"		
        case	"Solimpeks Solar Energy Corp"	:	"SolimpeksSolar"		
        case	"Stiebel Eltron"	:	"StiebelEltron"		
        case	"SunEarth, Inc."	:	"SunEarth"		
        case	"1st Sunflower Renewable Energy Co., Ltd"	:	"SunflowerRenewable"		
        case	"Sun Freedom America, LLC"	:	"SunFreedomAmerica"		
        case	"Sun Light &amp; Power"	:	"SunLightPower"		
        case	"SunMaxx Solar LLC"	:	"SunMaxxSolar"		
        case	"SunQuest, Inc."	:	"SunQuest"		
        case	"Sunsiaray Solar Manufacturing, Inc."	:	"SunsiaraySolar"		
        case	"SunTrac Solar Inc."	:	"SunTracSolar"		
        case	"SunUP Solar Systems, Inc"	:	"SunUpSolar"		
        case	"Sunvapor, Inc."	:	"SunvaporInc"		
        case	"Sunvelope Solar"	:	"SunvelopeSolar"		
        case	"Surface Power"	:	"SurfacePower"		
        case	"Tec-Solar Energy Industry Co., Ltd."	:	"TecSolarEnergy"		
        case	"Thermo Dynamics, Ltd."	:	"ThermoDynamics"		
        case	"TIGI Ltd."	:	"TIGI"		
        case	"Trigo Energies Inc."	:	"TrigoEnergies"		
        case	"Tsinghua Solar Systems, Ltd."	:	"TsinghuaSolar"		
        case	"TSW Holding Corp."	:	"TSW_Holding"		
        case	"TVP Solar"	:	"TVP_Solar"		
        case	"UMA Solar"	:	"UMA_Solar"		
        case	"Universal Solar Products, Inc."	:	"UniversalSolar"		
        case	"Viessmann Manufacturing Company (US) Inc."	:	"ViessmannManufacturing"		
        case	"Wagner Solar Inc."	:	"WagnerSolar"		
        case	"Westech Solar Technology Wuxi Co., Ltd."	:	"WestechSolar"		
        case	"Your Home Tech., Ltd."	:	"YourHomeTech"		
        case	"Your Solar Home, Inc."	:	"YourSolarHome"		
        case	"Zhejiang Jiadele Solar Energy Co., Ltd."	:	"ZhejiangJiadeleSolar"		
        case	"Zhejiang Shende New Energy Co., Ltd."	:	"ZhejiangShendeNewEnergy"		
        case	"Zhejiang Shentai Solar Energy Co., Ltd."	:	"ZhejiangShentaiSolar"		
        case	"Zhejiang Sidite New Energy Co., Ltd."	:	"ZhejiangSiditeNewEnergy"		
        case	"Zhejiang Yuanneng New Energy Co., Ltd."	:	"ZhejiangYuannengNewEnergy"		
        default :  UNDEFINED
    endswitch
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar03_Brand
  ANNUAL_PROPOSED
    switch (noXMLoutput_DHWSolSysRef:Brand)
        case	"International Solar System" :	"InternationalSolarSystem" ; RJH added 9/25/22
        case	"Hydro Solar"		         :	"HydroSolar"               ; RJH added 9/25/22
        case	"ensol"		                 :	"Ensol"                    ; RJH added 9/25/22
        case	"Soltek"		             :	"Soltek"                   ; RJH added 9/25/22
        case	"Sunbank Solar"		         :	"SunbankSolar"             ; RJH added 9/25/22
        case	"AE Commercial"		:	"AE_Commercial"
        case	"Alternate Energy"		:	"AlternateEnergy"
        case	"Apricus"		:	"Apricus"
        case	"Architectural Series"		:	"ArchitecturalSeries"
        case	"ATS"		:	"ATS"
        case	"AURORA"		:	"AURORA"
        case	"Baymak"		:	"Baymak"
        case	"Bosch"		:	"Bosch"
        case	"Buderus"		:	"Buderus"
        case	"Butler"		:	"Butler"
        case	"Chromagen"		:	"Chromagen"
        case	"Cleanline-Thermal"		:	"CleanlineThermal"
        case	"Climasol"		:	"Climasol"
        case	"Commercial Collector"		:	"CommercialCollector"
        case	"Dimas SA"		:	"DimasSA"
        case	"Dimplex"		:	"Dimplex"
        case	"DLL"		:	"DLL"
        case	"Duda Solar"		:	"DudaSolar"
        case	"EarthNet Energy"		:	"EarthNetEnergy"
        case	"Echo Building Integrated"		:	"EchoBuildingIntegrated"
        case	"Echo Stanchioned"		:	"EchoStanchioned"
        case	"eco - FLARE"		:	"EcoFLARE"
        case	"eco - Flare PRO"		:	"EcoFlarePRO"
        case	"Eco Spark"		:	"EcoSpark"
        case	"Emperor"		:	"Emperor"
        case	"Empire"		:	"Empire"
        case	"EnerWorks"		:	"EnerWorks_brand"
        case	"Ensol Flat Plate Solar Collector"		:	"EnsolFlatPlateSolarCollector"
        case	"ergSol"		:	"ErgSol"
        case	"Euro"		:	"Euro"
        case	"EURO L20 AR"		:	"EuroL20AR"
        case	"EURO L20 MQ AR"		:	"EuroL20MQAR"
        case	"EZINC"		:	"EZINC"
        case	"Fivestar"		:	"Fivestar"
        case	"FK8209 TSA"		:	"FK8209TSA"
        case	"Flate Plate"		:	"FlatePlate"
        case	"Freeze Safe"		:	"FreezeSafe"
        case	"Fresource"		:	"Fresource"
        case	"GEAR Solar"		:	"GEAR_Solar"
        case	"GOBI"		:	"GOBI"
        case	"GOBI HT"		:	"GOBI_HT"
        case	"GoodFriendSolarWaterHeater"		:	"GoodFriendSolarWaterHeater"
        case	"GreenBase"		:	"GreenBase"
        case	"GREENoneTEC"		:	"GREENoneTEC"
        case	"Gull"		:	"Gull"
        case	"HEJIASUN"		:	"HEJIASUN"
        case	"Hewalex"		:	"Hewalex"
        case	"HITEK"		:	"HITEK"
        case	"Hitek Solar"		:	"HitekSolar"
        case	"HONE"		:	"HONE"
        case	"Honeycomb Collector"		:	"HoneycombCollector"
        case	"HSMSC"		:	"HSMSC"
        case	"HTP Evacuated Tube"		:	"HTP_EvacuatedTube"
        case	"HUCUSOL"		:	"HUCUSOL"
        case	"Imperial"		:	"Imperial"
        case	"Innosolar"		:	"Innosolar"
        case	"I-solar"		:	"Isolar"
        case	"JIADELE"		:	"JIADELE"
        case	"K-Cor Rocket Dome"		:	"K_CorRocketDome"
        case	"Kangnam"		:	"Kangnam"
        case	"KBB"		:	"KBB"
        case	"KBB Kollektorbau"		:	"KBB_Kollektorbau"
        case	"Kingspan Solar"		:	"KingspanSolar"
        case	"Kingspan Solar Flate Plate"		:	"KingspanSolarFlatePlate"
        case	"Kioto Clear Energy"		:	"KiotoClearEnergy"
        case	"KIOTO Clear Energy"		:	"KIOTO_ClearEnergy"
        case	"LINOU SOLAR"		:	"LINOU_SOLAR"
        case	"Lochinvar/TiSun"		:	"LochinvarTiSun"
        case	"Marvel"		:	"Marvel"
        case	"MAXOL FULL PLATE 2.0"		:	"MAXOL_FULL_PLATE2"
        case	"Megasun"		:	"Megasun"
        case	"Micoe"		:	"Micoe"
        case	"Micro-Flo"		:	"MicroFlo"
        case	"Modulo Solar"		:	"ModuloSolar"
        case	"MorningStar"		:	"MorningStar"
        case	"MT-Power"		:	"MT_Power"
        case	"Next Generation Energy, LLC"		:	"NextGenerationEnergy"
        case	"Nimrod Industries Ltd."		:	"NimrodIndustries"
        case	"Northern Comfort"		:	"NorthernComfort"
        case	"North Star"		:	"NorthStar"
        case	"NT-FLEX"		:	"NT_FLEX"
        case	"NTI"		:	"NTI"
        case	"OKP"		:	"OKP"
        case	"ONOSI"		:	"ONOSI"
        case	"Oventrop Corporation"		:	"Oventrop"
        case	"Oventrop Solar"		:	"OventropSolar"
        case	"OVF-21"		:	"OVF21"
        case	"OVF-32"		:	"OVF32"
        case	"OVF-40"		:	"OVF40"
        case	"PG2.0-F/S"		:	"PG2FS"
        case	"PIEP"		:	"PIEP"
        case	"Power Panel"		:	"PowerPanel"
        case	"PYROPEG"		:	"PYROPEG"
        case	"Radco"		:	"Radco"
        case	"Residential Collector"		:	"ResidentialCollector"
        case	"Rheem"		:	"Rheem"
        case	"Ritter Solar"		:	"RitterSolar"
        case	"Roth"		:	"Roth"
        case	"RothHeliostar"		:	"RothHeliostar"
        case	"ROTH R1"		:	"ROTH_R1"
        case	"RREAL Solar Powered Furnace (SPF)"		:	"RREAL_SPF"
        case	"SEA"		:	"SEA"
        case	"Shandong Linuo New Material Co., Ltd."		:	"ShandongLinuoNewMaterial"
        case	"SHT"		:	"SHT"
        case	"Sidite"		:	"Sidite"
        case	"Silk Road Solar"		:	"SilkRoadSolar"
        case	"Skyline"		:	"Skyline"
        case	"Soflower"		:	"Soflower"
        case	"SolVario"		:	"SolVario"
        case	"Solahart"		:	"Solahart"
        case	"Solamax"		:	"Solamax"
        case	"SOLAR FLAME"		:	"SOLAR_FLAME"
        case	"Solar American Solutions"		:	"SolarAmericanSolutions"
        case	"SolarBK"		:	"SolarBK"
        case	"Solar Coil (ICS)"		:	"SolarCoilICS"
        case	"Solar Collectors Sky Pro 1500"		:	"SolarCollectorsSkyPro1500"
        case	"Solar Collectors Sky Pro 1800"		:	"SolarCollectorsSkyPro1800"
        case	"Solar Flame"		:	"SolarFlame"
        case	"SolarFlat"		:	"SolarFlat"
        case	"Solargenix NT-24"		:	"SolargenixNT24"
        case	"Solargenix NT-48"		:	"SolargenixNT48"
        case	"SOLARHOT"		:	"SOLARHOT"
        case	"SOLARHOT Solstice"		:	"SOLARHOT_Solstice"
        case	"Solar Panels Plus"		:	"SolarPanelsPlus"
        case	"Solar Panels Plus - Monarch 32"		:	"SolarPanelsPlusMonarch32"
        case	"Solar Panels Plus - Monarch 40"		:	"SolarPanelsPlusMonarch40"
        case	"Solar Panels Plus - Spartan 32"		:	"SolarPanelsPlusSpartan32"
        case	"Solar Panels Plus - Spartan 40"		:	"SolarPanelsPlusSpartan40"
        case	"SolarSheat"		:	"SolarSheat"
        case	"Solar Skies"		:	"SolarSkies"
        case	"Solar Spectrum"		:	"SolarSpectrum"
        case	"Solarway"		:	"Solarway"
        case	"Solcan"		:	"Solcan"
        case	"Solene"		:	"Solene"
        case	"Solene-Corona"		:	"SoleneCorona"
        case	"Solene EcoFLARE"		:	"SoleneEcoFLARE"
        case	"Solight"		:	"Solight"
        case	"SPF"		:	"SPF"
        case	"SS Series"		:	"SS_Series"
        case	"StarMax IV"		:	"StarMaxIV"
        case	"StarMax V"		:	"StarMaxV"
        case	"STC"		:	"STC"
        case	"Stiebel Eltron"		:	"StiebelEltron"
        case	"Stiebel Eltron, Inc."		:	"StiebelEltronInc"
        case	"SunBelt"		:	"SunBelt"
        case	"SUNCHASER"		:	"SUNCHASER"
        case	"SUNDA"		:	"SUNDA"
        case	"Sun Freedom America-SFA-4"		:	"SunFreedomAmericaSFA4"
        case	"Sun Mate"		:	"SunMate"
        case	"SunMaxx"		:	"SunMaxx"
        case	"Sunpower"		:	"Sunpower"
        case	"SunPro"		:	"SunPro"
        case	"Sunrain"		:	"Sunrain"
        case	"SunStar"		:	"SunStar"
        case	"Suntask"		:	"Suntask"
        case	"SunTrac"		:	"SunTrac"
        case	"SunUp"		:	"SunUp"
        case	"SUNVAPOR"		:	"SUNVAPOR"
        case	"SUNVELOPE SOLAR"		:	"SUNVELOPE_SOLAR"
        case	"Sunvelope Solar"		:	"SunvelopeSolar"
        case	"Surface Power"		:	"SurfacePower"
        case	"TecSolar"		:	"TecSolar"
        case	"Thermo Dynamics G Series"		:	"ThermoDynamicsGSeries"
        case	"Thermomax"		:	"Thermomax"
        case	"ThermoPower"		:	"ThermoPower"
        case	"ThermoRay"		:	"ThermoRay"
        case	"Tianpu"		:	"Tianpu"
        case	"TiSUN"		:	"TiSUN"
        case	"TitanPower"		:	"TitanPower"
        case	"TitanPowerPlus"		:	"TitanPowerPlus"
        case	"Tjsun"		:	"Tjsun"
        case	"Trigo"		:	"Trigo"
        case	"Tsinghua Solar"		:	"TsinghuaSolar"
        case	"Universal Solar Products, Inc."		:	"UniversalSolar"
        case	"Varisol"		:	"Varisol"
        case	"VELUX"		:	"VELUX"
        case	"Vitosol"		:	"Vitosol"
        case	"Westech"		:	"Westech"
        case	"Winston Series CPC"		:	"WinstonSeriesCPC"
        case	"Wunder ALS"		:	"WunderALS"
        case	"Wunder CLSF"		:	"WunderCLSF"
        case	"Xianke"		:	"Xianke"
        case	"Younn"		:	"Younn"
        case	"YUHO"		:	"YUHO"
        case	"ZLUZ"		:	"ZLUZ"
        default :  UNDEFINED
    endswitch
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar04_Model
  ANNUAL_PROPOSED
    switch (noXMLoutput_DHWSolSysRef:Model)
        case	"AE-40T"	:	"AE_40T" ; RJH added 9/25/22
        case	"ergSol 303 Dhp"	:	"ErgSol303Dhp" ; RJH added 9/25/22
        case	"2512"	:	"2512" ; RJH added 9/25/22
        case	"ThermoPower UDF10"	:	"ThermoPowerUDF10" ; RJH added 9/25/22
        case	"ThermoPower UDF20"	:	"ThermoPowerUDF20" ; RJH added 9/25/22
        case	"ThermoPower UDF30"	:	"ThermoPowerUDF30" ; RJH added 9/25/22
        case	"SunTrac27"	:	"SunTrac27" ; RJH added 9/25/22
        case	"042012"	:	"042012" ; RJH added 9/25/22
        case	"VT5815"	:	"VT5815" ; RJH added 9/25/22
        case	"VT5820"	:	"VT5820" ; RJH added 9/25/22
        case	"VT5825"	:	"VT5825" ; RJH added 9/25/22
        case	"VT5830"	:	"VT5830" ; RJH added 9/25/22
        case	"ENERGY+ARGO 27"	:	"EnergyARGO27" ; RJH added 9/25/22
        case	"Virtu HOT"	:	"VirtuHOT" ; RJH added 9/25/22
        case	"Virtu HOT HD"	:	"VirtuHOTHD" ; RJH added 9/25/22
        case	"SunPro32"	:	"SunPro32" ; RJH added 9/25/22
        case	"DIS 150"	:	"DIS150" ; RJH added 9/25/22
        case	"2512, 2512-H"	:	"2512H" ; RJH added 9/25/22
        case	"3476-7HE"	:	"34767HE" ; RJH added 9/25/22
        case	"SB-1200D"	:	"SB1200D" ; RJH added 9/25/22
        case	"ThermoPower VDF10"	:	"ThermoPowerVDF10" ; RJH added 9/25/22
        case	"ThermoPower VDF20"	:	"ThermoPowerVDF20" ; RJH added 9/25/22
        case	"ThermoPower VDF30"	:	"ThermoPowerVDF30" ; RJH added 9/25/22
        case	"STS-TC32R, STS-TC24R"	:	"STSTC32RSTSTC24R" ; RJH added 9/25/22
        case	"1"	:	"1_0"
        case	"44470"	:	"10_01"
        case	"1000 DF"	:	"1000DF"
        case	"1000G"	:	"1000G"
        case	"1000GS"	:	"1000GS"
        case	"100-F, SV1/SH1"	:	"100F_SV1SH1"
        case	"100-FM SH1F"	:	"100FM_SH1F"
        case	"100-FM SV1F"	:	"100FM_SV1F"
        case	"100-FM SVKF"	:	"100FM_SVKF"
        case	"10844 VP"	:	"10844VP"
        case	"1500G"	:	"1500G"
        case	"1500GS"	:	"1500GS"
        case	"1808"	:	"1808"
        case	"1809"	:	"1809"
        case	"20-01"	:	"20_01"
        case	"2000A"	:	"2000A"
        case	"2000B"	:	"2000B"
        case	"2000 DF"	:	"2000DF"
        case	"2000H"	:	"2000H"
        case	"200-F Sv2C/SH2C"	:	"200F_Sv2C_SH2C"
        case	"200-FM SH2F"	:	"200FM_SH2F"
        case	"200-FM SV2F"	:	"200FM_SV2F"
        case	"200-T SP2A - 1.26"	:	"200T_SP2A1_26"
        case	"200-T SP2A - 1.51"	:	"200T_SP2A1_51"
        case	"200-T SP2A - 3.03"	:	"200T_SP2A3_03"
        case	"200-T SPE - 1.63"	:	"200T_SPE1_63"
        case	"200-T SPE - 3.26"	:	"200T_SPE3_26"
        case	"2101"	:	"2101"
        case	"2108"	:	"2108"
        case	"2110"	:	"2110"
        case	"2510"	:	"2510"
        case	"2512"	:	"2512"
        case	"252 S4"	:	"252S4"
        case	"3000 DF"	:	"3000DF"
        case	"300TSP32m2"	:	"300T_SP3_2m2"
        case	"300TSP33m2"	:	"300T_SP3_3m2"
        case	"3010"	:	"3010"
        case	"308C-HP"	:	"308C_HP"
        case	"336 001"	:	"336_001"
        case	"3M"	:	"3M"
        case	"404 001"	:	"404_001"
        case	"405C-HP"	:	"405C_HP"
        case	"405P-HP"	:	"405P_HP"
        case	"406 001"	:	"406_001"
        case	"406 002"	:	"406_002"
        case	"406 003"	:	"406_003"
        case	"408 001"	:	"408_001"
        case	"408 002"	:	"408_002"
        case	"408C-HP"	:	"408C_HP"
        case	"408P-HP"	:	"408P_HP"
        case	"410 001"	:	"410_001"
        case	"410 001 PLUS"	:	"410_001PLUS"
        case	"410 002"	:	"410_002"
        case	"410 003"	:	"410_003"
        case	"410C-HP"	:	"410C_HP"
        case	"410P-HP"	:	"410P_HP"
        case	"44"	:	"44"
        case	"4X10A"	:	"4X10A"
        case	"4X10B"	:	"4X10B"
        case	"4X10H"	:	"4X10H"
        case	"5000"	:	"5000"
        case	"501 Gen 5"	:	"501Gen5"
        case	"540 00 18-LI"	:	"540_00_18LI"
        case	"540 00 18-TT"	:	"540_00_18TT"
        case	"5400307"	:	"5400307"
        case	"5400408"	:	"5400408"
        case	"5400410"	:	"5400410"
        case	"6000"	:	"6000"
        case	"6-stc"	:	"6stc"
        case	"Acero"	:	"Acero"
        case	"Acero GL"	:	"AceroGL"
        case	"Advanced X"	:	"AdvancedX"
        case	"Advanced XL"	:	"AdvancedXL"
        case	"AE-18"	:	"AE_18"
        case	"AE-21"	:	"AE_21"
        case	"AE-24"	:	"AE_24"
        case	"AE-26"	:	"AE_26"
        case	"AE-32"	:	"AE_32"
        case	"AE-40T"	:	"AE_40T"
        case	"AE-56"	:	"AE_56"
        case	"AP-10"	:	"AP_10"
        case	"AP-20"	:	"AP_20"
        case	"AP-30"	:	"AP_30"
        case	"AP-30C"	:	"AP_30C"
        case	"APA2007"	:	"APA2007"
        case	"ARIS2004"	:	"ARIS2004"
        case	"ARIS2504"	:	"ARIS2504"
        case	"AS406C"	:	"AS406C"
        case	"AS406P"	:	"AS406P"
        case	"AS408C"	:	"AS408C"
        case	"AS408P"	:	"AS408P"
        case	"AS410C"	:	"AS410C"
        case	"AS410P"	:	"AS410P"
        case	"AS412C"	:	"AS412C"
        case	"AS412P"	:	"AS412P"
        case	"ASL0580.S86RS-1.5m2"	:	"ASL0580S86RS1_5m2"
        case	"ASL0580.S86RS-1.82m2"	:	"ASL0580S86RS1_82m2"
        case	"ASL0580.S86RS-2.0m2"	:	"ASL0580S86RS2_0m2"
        case	"ASL0580.S86RS-2.37m2"	:	"ASL0580S86RS2_37m2"
        case	"ASL0580.S86RS-2.72m2"	:	"ASL0580S86RS2_72m2"
        case	"AST20"	:	"AST20"
        case	"AST30"	:	"AST30"
        case	"AST50"	:	"AST50"
        case	"AST70"	:	"AST70"
        case	"AST80"	:	"AST80"
        case	"ATS-10"	:	"ATS_10"
        case	"ATS-20"	:	"ATS_20"
        case	"ATS-30"	:	"ATS_30"
        case	"Bosch FKB-1 (Vert.)"	:	"BoschFKB1Vert"
        case	"Bosch FKC-1 s+w  (Vert. &amp; Horiz.)"	:	"BoschFKC1swVertHorz"
        case	"Bosch FKT-1 s+w  (Vert. &amp; Horiz.)"	:	"BoschFKT1swVertHorz"
        case	"Bosch Thermotechnology Corp."	:	"BoschThermotechnology"
        case	"Bt, ( laser welded )"	:	"Bt_LaserWelded"
        case	"BT1"	:	"BT1"
        case	"Bt (laser welded)"	:	"BtLaserWelded"
        case	"Buderus SKN 3.0- s+w  (Vert. &amp; Horiz.)"	:	"BuderusSKN3swVertHorz"
        case	"Buderus SKS 4.0- s+w  (Vert. &amp; Horiz.)"	:	"BuderusSKS4swVertHorz"
        case	"CFP-C-200"	:	"CFP_C200"
        case	"CL-T-370"	:	"CL_T370"
        case	"CLI M08 5000"	:	"CLI_M08_5000"
        case	"CLI S06  5000"	:	"CLI_S06_5000"
        case	"CLI U12  5000"	:	"CLI_U12_5000"
        case	"Climasol 1.75"	:	"Climasol1_75"
        case	"Climasol 2.00"	:	"Climasol2_00"
        case	"Climasol 2.50"	:	"Climasol2_50"
        case	"Climasol 2.70"	:	"Climasol2_70"
        case	"CLS 1808"	:	"CLS1808"
        case	"CLS 2510"	:	"CLS2510"
        case	"COL-4X8-NL-SG1-SH10US"	:	"COL4X8NL_SG1SH10US"
        case	"COL-4X8-TL-SG1-SD10US"	:	"COL4X8TL_SG1SD10US"
        case	"CPC 12 INOX"	:	"CPC12INOX"
        case	"CPC 12 OEM"	:	"CPC12OEM"
        case	"CPC 12 XL INOX"	:	"CPC12XL_INOX"
        case	"CPC 14 Star Azzurro / CPC 14 OEM MONO"	:	"CPC14StarAzzurro_CPC14OEM_MONO"
        case	"CPC 16 w INOX"	:	"CPC16wINOX"
        case	"CPC 18 INOX"	:	"CPC18INOX"
        case	"CPC 18 OEM"	:	"CPC18OEM"
        case	"CPC 20 w INOX"	:	"CPC20wINOX"
        case	"CPC 21 Star Azzurro / CPC 21 OEM MONO"	:	"CPC21StarAzzurro_CPC21OEM_MONO"
        case	"CPC 30 Star Azzurro / CPC 30 OEM MONO"	:	"CPC30StarAzzurro_CPC30OEM_MONO"
        case	"CPC 32 Allstar"	:	"CPC32Allstar"
        case	"CPC 40 Allstar"	:	"CPC40Allstar"
        case	"CPC 45 Star Azzurro / CPC 45 OEM MONO"	:	"CPC45StarAzzurro_CPC45OEM_MONO"
        case	"CPC 6 INOX"	:	"CPC6INOX"
        case	"CPC 6 OEM"	:	"CPC6OEM"
        case	"CPC 6 XL INOX"	:	"CPC6XL_INOX"
        case	"CR-100-A-P"	:	"CR100AP"
        case	"CR-100-A-SP"	:	"CR100ASP"
        case	"CR-100-BC"	:	"CR100BC"
        case	"CR-110-A-P"	:	"CR110AP"
        case	"CR-110-A-SP"	:	"CR110ASP"
        case	"CR-110-BC"	:	"CR110BC"
        case	"CR-120-A-P"	:	"CR120AP"
        case	"CR-120-A-SP"	:	"CR120ASP"
        case	"CR-120-BC"	:	"CR120BC"
        case	"CR-130-A-P"	:	"CR130AP"
        case	"CR-130-A-SP"	:	"CR130ASP"
        case	"CR-130-BC"	:	"CR130BC"
        case	"CR-130-P"	:	"CR130P"
        case	"CR-130-SP"	:	"CR130SP"
        case	"CR-140-A-P"	:	"CR140AP"
        case	"CR-140-BC"	:	"CR140BC"
        case	"CR-140-P"	:	"CR140P"
        case	"CR-140-SP"	:	"CR140SP"
        case	"CS-40"	:	"CS40"
        case	"CSA2007"	:	"CSA2007"
        case	"CSA2010"	:	"CSA2010"
        case	"CSA2013"	:	"CSA2013"
        case	"CT Black"	:	"CT_Black"
        case	"DF100-10"	:	"DF100_10"
        case	"DF100-20"	:	"DF100_20"
        case	"DF100-30"	:	"DF100_30"
        case	"DF400-20"	:	"DF400_20"
        case	"DF400-30"	:	"DF400_30"
        case	"DLL-C-P01-15"	:	"DLLCP01_15"
        case	"DLL-C-P01-20"	:	"DLLCP01_20"
        case	"DLL-C-P01-30"	:	"DLLCP01_30"
        case	"DSCA-2M"	:	"DSCA_2M"
        default :  UNDEFINED
    endswitch
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar04_Model
  ANNUAL_PROPOSED
    if (LocalStatus( WaterSolar04_Model ) > 0) then UNCHANGED
    else
    switch (noXMLoutput_DHWSolSysRef:Model)
        case	"EC-21"	:	"EC21"
        case	"EC-24 / EC-24-0.75"	:	"EC24EC24_0_75"
        case	"EC-32-1.5"	:	"EC32_1_5"
        case	"EC-32 / EC-32-0.75"	:	"EC32EC323_0_75"
        case	"EC-40-1.5"	:	"EC40_1_5"
        case	"EC-40 / EC-40-0.75"	:	"EC40EC40_0_75"
        case	"ECHO BI 2PV1T"	:	"EchoBI2PV1T"
        case	"ECHO BI 4PV2T"	:	"EchoBI4PV2T"
        case	"ECHO SM 2PV1T"	:	"EchoSM2PV1T"
        case	"ECHO SM 4PV2T"	:	"EchoSM4PV2T"
        case	"ENE 16"	:	"EN16"
        case	"ENE 24"	:	"EN24"
        case	"ENERGY+ARGO 15"	:	"EnergyARGO15"
        case	"ENERGY+ARGO 17"	:	"EnergyARGO17"
        case	"ENERGY+ARGO 19"	:	"EnergyARGO19"
        case	"ENERGY+ARGO 20"	:	"EnergyARGO20"
        case	"ENERGY+ARGO 23"	:	"EnergyARGO23"
        case	"ENERGY+ARGO 25"	:	"EnergyARGO25"
        case	"Energy + ECO 15"	:	"EnergyECO15"
        case	"Energy + ECO 17"	:	"EnergyECO17"
        case	"Energy + ECO 19"	:	"EnergyECO19"
        case	"Energy + ECO 20"	:	"EnergyECO20"
        case	"Energy + ECO 23"	:	"EnergyECO23"
        case	"Energy + ECO 25"	:	"EnergyECO25"
        case	"Energy + EVO 15"	:	"EnergyEVO15"
        case	"Energy + EVO 17"	:	"EnergyEVO17"
        case	"Energy + EVO 19"	:	"EnergyEVO19"
        case	"Energy + EVO 20"	:	"EnergyEVO20"
        case	"Energy + EVO 23"	:	"EnergyEVO23"
        case	"Energy + EVO 25"	:	"EnergyEVO25"
        case	"EP-21"	:	"EP21"
        case	"EP-24 / EP-24-0.75"	:	"EP24EP24_0_75"
        case	"EP-32-1.5"	:	"EP32_1_5"
        case	"EP-32 / EP-32-0.75"	:	"EP32EP32_0_75"
        case	"EP-40-1.5"	:	"EP40_1_5"
        case	"EP-40 / EP-40-0.75"	:	"EP40EP40_0_75"
        case	"ergSol 100-6 df"	:	"ErgSol100_6df"
        case	"ergSol 202 df"	:	"ErgSol202df"
        case	"ergSol 202 hp"	:	"ErgSol202hp"
        case	"ergSol 303df"	:	"ErgSol303df"
        case	"ergSol 303 Dhp"	:	"ErgSol303Dhp"
        case	"ergSol 303 hp"	:	"ErgSol303hp"
        case	"ES2V/2,65 Cu-Al"	:	"ES2V2_65CuAl"
        case	"Essential X"	:	"EssentialX"
        case	"Essential XL"	:	"EssentialXL"
        case	"ETC-10"	:	"ETC_10"
        case	"ETC-20"	:	"ETC_20"
        case	"ETC-30 / ETC-30C"	:	"ETC_30ETC_30C"
        case	"EURO L20 MQ AR"	:	"EuroL20MQAR"
        case	"Euro L42 HTF"	:	"EuroL42HTF"
        case	"FA 2/3"	:	"FA2_3"
        case	"FA 2/4"	:	"FA2_4"
        case	"FA 2/5"	:	"FA2_5"
        case	"FA 2/6"	:	"FA2_6"
        case	"FCC-1S"	:	"FCC1S"
        case	"FH2500"	:	"FH2500"
        case	"FK7250L"	:	"FK7250L"
        case	"FK7250N"	:	"FK7250N"
        case	"FK8209N 3H TSA"	:	"FK8209N3H_TSA"
        case	"FK8209N 4H TSA"	:	"FK8209N4H_TSA"
        case	"FK8209 TSA"	:	"FK8209TSA"
        case	"FK 9251 N/L"	:	"FK9251NL"
        case	"FM-W/S 4"	:	"FMW_S4"
        case	"FP 1.20.0 HE sc"	:	"FP1_20HEsc"
        case	"FP 1.20.0 LE sc"	:	"FP1_20LEsc"
        case	"FP200"	:	"FP200"
        case	"FP200H"	:	"FP200H"
        case	"FP240"	:	"FP240"
        case	"FP240H"	:	"FP240H"
        case	"FP-26SC"	:	"FP26SC"
        case	"FP-32SC"	:	"FP32SC"
        case	"FP3.0-E"	:	"FP3E"
        case	"FP-40SC"	:	"FP40SC"
        case	"FPC-A26"	:	"FPC_A26"
        case	"FPC-A32"	:	"FPC_A32"
        case	"FPC-A40"	:	"FPC_A40"
        case	"FPC1200A"	:	"FPC1200A"
        case	"FPC1200D"	:	"FPC1200D"
        case	"FPE-17"	:	"FPE17"
        case	"FPE-21"	:	"FPE21"
        case	"FPE-30"	:	"FPE30"
        case	"FPW18"	:	"FPW18"
        case	"FPW18U"	:	"FPW18U"
        case	"FPW25"	:	"FPW25"
        case	"FPW25U"	:	"FPW25U"
        case	"FPW30"	:	"FPW30"
        case	"FPW30U"	:	"FPW30U"
        case	"Fresco"	:	"Fresco"
        case	"Fresco GL"	:	"FrescoGL"
        case	"FS-PTY95-2.0"	:	"FS_PTY95_2"
        case	"FS410"	:	"FS410"
        case	"FSC016B"	:	"FSC016B"
        case	"FSC020B"	:	"FSC020B"
        case	"FSC030B"	:	"FSC030B"
        case	"G32"	:	"G32"
        case	"G32-P"	:	"G32P"
        case	"G40"	:	"G40"
        case	"GD150-25"	:	"GD150_25"
        case	"GK 3102 FL"	:	"GK3102FL"
        case	"GK 3102 FL-AR"	:	"GK3102FL_AR"
        case	"GK 3133"	:	"GK3133"
        case	"GK 3133 S"	:	"GK3133S"
        case	"GK 3502 FL"	:	"GK3502FL"
        case	"GK 3502 FL-AR"	:	"GK3502FL_AR"
        case	"GK 3803"	:	"GK3803"
        case	"GK 3803 S"	:	"GK3803S"
        case	"HC1-A"	:	"HC1A"
        case	"HCA-58-18"	:	"HCA58_18"
        case	"HCA-58-20"	:	"HCA58_20"
        case	"HCA-58-24"	:	"HCA58_24"
        case	"HCA-58-30"	:	"HCA58_30"
        case	"Heliostar 252"	:	"Heliostar252"
        case	"HFC-2-S"	:	"HFC2S"
        case	"HP-2010"	:	"HP2010"
        case	"HP-2012"	:	"HP2012"
        case	"HP-2014"	:	"HP2014"
        case	"HP250-10"	:	"HP250_10"
        case	"HP250-20"	:	"HP250_20"
        case	"HP250-30"	:	"HP250_30"
        case	"HP250-50"	:	"HP250_50"
        case	"HP250-70"	:	"HP250_70"
        case	"HP250-80"	:	"HP250_80"
        case	"HP-30SC"	:	"HP30SC"
        case	"HP408"	:	"HP408"
        case	"HP408C"	:	"HP408C"
        case	"HP408Cu"	:	"HP408Cu"
        case	"HP410"	:	"HP410"
        case	"HP410C"	:	"HP410C"
        case	"HP410Cu"	:	"HP410Cu"
        case	"HP450-20"	:	"HP450_20"
        case	"HP450-30"	:	"HP450_30"
        case	"HP450RF-20"	:	"HP450RF_20"
        case	"HSMSC58/1800-15"	:	"HSMSC58_1800_15"
        case	"HSMSC58/1800-18"	:	"HSMSC58_1800_18"
        case	"HSMSC58/1800-20"	:	"HSMSC58_1800_20"
        case	"HSMSC58/1800-24"	:	"HSMSC58_1800_24"
        case	"HSMSC58/1800-30"	:	"HSMSC58_1800_30"
        case	"IC-32"	:	"IC32"
        case	"IC-40"	:	"IC40"
        case	"IS-32"	:	"IS32"
        case	"IS-40"	:	"IS40"
        case	"J"	:	"J"
        case	"JDL-PM10-58-1.8A"	:	"JDLPM10_58_1_8A"
        case	"JDL-PM15-58-1.8A"	:	"JDLPM15_58_1_8A"
        case	"JDL-PM18-58-1.8A"	:	"JDLPM18_58_1_8A"
        case	"JDL-PM20-58-1.8A"	:	"JDLPM20_58_1_8A"
        case	"JDL-PM25-58-1.8A"	:	"JDLPM25_58_1_8A"
        case	"JDL-PM30-58-1.8A"	:	"JDLPM30_58_1_8A"
        case	"JDL-PM36-58-1.8A"	:	"JDLPM36_58_1_8A"
        case	"K420-MS-AL"	:	"K420MS_AL"
        case	"K423-DH"	:	"K423DH"
        case	"K423-MS-AL"	:	"K423MS_AL"
        case	"K425-MS-AL"	:	"K425MS_AL"
        case	"K5-3Giga"	:	"K5_3Giga"
        case	"K5-3Giga+"	:	"K5_3GigaPlus"
        case	"Kf"	:	"Kf"
        case	"KNSC-003.1"	:	"KNSC003_1"
        case	"KS2000 TP AC / TLP AC"	:	"KS2000TPAC_TLPAC"
        case	"KS2300 TP AC / TLP AC"	:	"KS2300TPAC_TLPAC"
        case	"KS2500 TP AC / TLP AC"	:	"KS2500TPAC_TLPAC"
        case	"L"	:	"L"
        case	"L20 MQ AR"	:	"L20MQ_AR"
        case	"LC"	:	"LC"
        case	"LCS"	:	"LCS"
        case	"LH-3-2M"	:	"LH3_2M"
        case	"LN-RG-WF-1.0/10-58/1800-B1"	:	"LNRGWF1_10_58_1800B1"
        case	"LN-RG-WF-1.6/16-47/1500-A"	:	"LNRGWF1_6_16_47_1500A"
        case	"LN-RG-WF-1.8/18-58/1800-B1"	:	"LNRGWF1_8_18_58_1800B1"
        case	"LN-RG-WF-2.0/20-58/1800-B1"	:	"LNRGWF2_20_58_1800B1"
        case	"LN-RG-WF-2.4/24-58/1800-B1"	:	"LNRGWF2_4_24_58_1800B1"
        case	"LN-RG-WF-2.5/25-58/1800-B1"	:	"LNRGWF2_5_25_58_1800B1"
        case	"LN-RG-WF-3.0/30-58/1800-B1"	:	"LNRGWF3_30_58_1800B1"
        case	"Maxol MS 2.5"	:	"MaxolMS2_5"
        case	"MODEL T1"	:	"ModelT1"
        case	"MS-21"	:	"MS_21"
        case	"MS-24"	:	"MS_24"
        case	"MS-26"	:	"MS_26"
        case	"MS-28"	:	"MS_28"
        case	"MS-32"	:	"MS_32"
        case	"MS-40"	:	"MS_40"
        case	"MSC-20"	:	"MSC_20"
        case	"MSC-21"	:	"MSC_21"
        case	"MSC-24"	:	"MSC_24"
        case	"MSC-26"	:	"MSC_26"
        case	"MSC-28"	:	"MSC_28"
        case	"MSC-32"	:	"MSC_32"
        case	"MSC-40"	:	"MSC_40"
        default :  UNDEFINED
    endswitch
    endif
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar04_Model
  ANNUAL_PROPOSED
    if (LocalStatus( WaterSolar04_Model ) > 0) then UNCHANGED
    else
    switch (noXMLoutput_DHWSolSysRef:Model)
        case	"NAS10406"	:	"NAS10406"
        case	"NAS10406A"	:	"NAS10406A"
        case	"NAS10408"	:	"NAS10408"
        case	"NAS10408A"	:	"NAS10408A"
        case	"NAS10410"	:	"NAS10410"
        case	"NAS10410A"	:	"NAS10410A"
        case	"NAS14406"	:	"NAS14406"
        case	"NAS14408"	:	"NAS14408"
        case	"NAS14410"	:	"NAS14410"
        case	"NC-32"	:	"NC32"
        case	"NGE-216-TU"	:	"NGE216TU"
        case	"NGE-224-TU"	:	"NGE224TU"
        case	"NIM15"	:	"NIM15"
        case	"NIM21"	:	"NIM21"
        case	"NIM23"	:	"NIM23"
        case	"NIM25"	:	"NIM25"
        case	"NSC-21"	:	"NSC21"
        case	"NSC-24"	:	"NSC24"
        case	"NSC-26"	:	"NSC26"
        case	"NSC-28"	:	"NSC28"
        case	"NSC-32"	:	"NSC32"
        case	"NSC-40"	:	"NSC40"
        case	"NSC-58-10"	:	"NSC58_10"
        case	"NSC-58-12"	:	"NSC58_12"
        case	"NSC-58-16"	:	"NSC58_16"
        case	"NSC-58-20"	:	"NSC58_20"
        case	"NSC-58-22"	:	"NSC58_22"
        case	"NSC-58-24"	:	"NSC58_24"
        case	"NSC-58-30"	:	"NSC58_30"
        case	"NSC-70-10"	:	"NSC70_10"
        case	"NSC-70-12"	:	"NSC70_12"
        case	"NSC-70-15"	:	"NSC70_15"
        case	"NSC-70-20"	:	"NSC70_20"
        case	"NT-24-10"	:	"NT24_10"
        case	"NT-48-10"	:	"NT48_10"
        case	"NTFLEX10"	:	"NTFLEX10"
        case	"OEM 21"	:	"OEM21"
        case	"OKP-10"	:	"OKP10"
        case	"OKP-20"	:	"OKP20"
        case	"ONS58-15"	:	"ONS58_15"
        case	"ONS58-18"	:	"ONS58_18"
        case	"ONS58-20"	:	"ONS58_20"
        case	"ONS58-24"	:	"ONS58_24"
        case	"OV 10-10 AS/AB"	:	"OV10_10ASAB"
        case	"OV 10-20 AS/AB"	:	"OV10_20ASAB"
        case	"OV 5-16 AS/AB"	:	"OV5_16ASAB"
        case	"OV 5-24 AS/AB"	:	"OV5_24ASAB"
        case	"OV 5-8 AS/AB"	:	"OV5_8ASAB"
        case	"P-100"	:	"P_100"
        case	"PG-F/S"	:	"PG_FS"
        case	"PIEP1020-N01A"	:	"PIEP1020N01A"
        case	"PIEP4896-S01A"	:	"PIEP4896S01A"
        case	"PVT1"	:	"PVT1"
        case	"ROTH R1"	:	"RothR1"
        case	"RS21-BC"	:	"RS21BC"
        case	"RS21-BP"	:	"RS21BP"
        case	"RS21-SC"	:	"RS21SC"
        case	"RS24-BC"	:	"RS24BC"
        case	"RS24-BP"	:	"RS24BP"
        case	"RS32-BC"	:	"RS32BC"
        case	"RS32-BP"	:	"RS32BP"
        case	"RS40-BC"	:	"RS40BC"
        case	"RS40-BP"	:	"RS40BP"
        case	"S32-P"	:	"S32P"
        case	"Sapphire"	:	"Sapphire"
        case	"SB-24-0.75"	:	"SB24_0_75"
        case	"SB-32-0.75"	:	"SB32_0_75"
        case	"SB-40-0.75"	:	"SB40_0_75"
        case	"SC092809BK"	:	"SC092809BK"
        case	"SC5815"	:	"SC5815"
        case	"SC5820"	:	"SC5820"
        case	"SC5825"	:	"SC5825"
        case	"SC5830"	:	"SC5830"
        case	"S-C-771D26"	:	"SC771D26"
        case	"S-C-771D32"	:	"SC771D32"
        case	"S-C-771D40"	:	"SC771D40"
        case	"SCA2000"	:	"SCA2000"
        case	"SCH065"	:	"SCH065"
        case	"SCH090"	:	"SCH090"
        case	"SC-H-10"	:	"SCH10"
        case	"SCH110"	:	"SCH110"
        case	"SCH130"	:	"SCH130"
        case	"SC-H-15"	:	"SCH15"
        case	"SC-H-18"	:	"SCH18"
        case	"SC-H-20"	:	"SCH20"
        case	"SC-H-24"	:	"SCH24"
        case	"SC-H-30"	:	"SCH30"
        case	"SEA-FZ58-18"	:	"SEA_FZ58_18"
        case	"SEIDO 1-16"	:	"SEIDO_1_16"
        case	"SEIDO1-16"	:	"SEIDO1_16"
        case	"SEIDO 1-8"	:	"SEIDO1_8"
        case	"SEIDO 10-10AS/AB"	:	"SEIDO10_10ASAB"
        case	"SEIDO 10-20AS/AB"	:	"SEIDO10_20ASAB"
        case	"SEIDO 2-16"	:	"SEIDO2_16"
        case	"SEIDO 2-8"	:	"SEIDO2_8"
        case	"SEIDO 5-16 AS/AB"	:	"SEIDO5_16ASAB"
        case	"SEIDO 5-8 AS/AB"	:	"SEIDO5_8ASAB"
        case	"SEIDO8-16"	:	"SEIDO8_16"
        case	"SF-B155818"	:	"SF_B155818"
        case	"SF-B185818"	:	"SF_B185818"
        case	"SF-B205818"	:	"SF_B205818"
        case	"SF-B225818"	:	"SF_B225818"
        case	"SF-B245818"	:	"SF_B245818"
        case	"SF-B305818"	:	"SF_B305818"
        case	"SKY PRO 10 CPC 58"	:	"SKYPRO10L_CPC58"
        case	"SKY PRO 10L CPC 58"	:	"SKYPRO10L_CPC58"
        case	"SKY PRO 12 CPC 58"	:	"SKYPRO12_CPC58"
        case	"SKY PRO 12L CPC 58"	:	"SKYPRO12L_CPC58"
        case	"SKY PRO 14 CPC 58"	:	"SKYPRO14_CPC58"
        case	"SKY PRO 14L CPC 58"	:	"SKYPRO14L_CPC58"
        case	"SKY PRO 16 CPC 58"	:	"SKYPRO16_CPC58"
        case	"SKY PRO 16L CPC 58"	:	"SKYPRO16L_CPC58"
        case	"SKY PRO 18 CPC 58"	:	"SKYPRO18_CPC58"
        case	"SKY PRO 18L CPC 58"	:	"SKYPRO18L_CPC58"
        case	"SKY PRO 20 CPC 58"	:	"SKYPRO20_CPC58"
        case	"SKY PRO 20L CPC 58"	:	"SKYPRO20L_CPC58"
        case	"SKY PRO 22 CPC 58"	:	"SKYPRO22_CPC58"
        case	"SKY PRO 8L CPC 58"	:	"SKYPRO8L_CPC58"
        case	"SLAR-24"	:	"SLAR24"
        case	"SLAR-24SPA"	:	"SLAR24SPA"
        case	"SLAR-32"	:	"SLAR32"
        case	"SLAR-32P"	:	"SLAR32P"
        case	"SLAR-32SPA"	:	"SLAR32SPA"
        case	"SLAR-40"	:	"SLAR40"
        case	"SLAR-40P"	:	"SLAR40P"
        case	"SLAR-40SPA"	:	"SLAR40SPA"
        case	"SLCO-30"	:	"SLCO30"
        case	"SLCO-32"	:	"SLCO32"
        case	"SLCO-32P"	:	"SLCO32P"
        case	"SLCO-40"	:	"SLCO40"
        case	"SLCO-40P"	:	"SLCO40P"
        case	"SLEF-24"	:	"SLEF24"
        case	"SLES-30"	:	"SLES30"
        case	"SLES-40"	:	"SLES40"
        case	"SLSG-40"	:	"SLSG40"
        case	"SLSG-40 PLUS"	:	"SLSG40PLUS"
        case	"SLU-1500/12"	:	"SLU1500_12"
        case	"SLU-1080/24"	:	"SLU1800_24"
        case	"SLV030 / SLH030"	:	"SLV030_SLH030"
        case	"SMG100-10"	:	"SMG100_10"
        case	"SMG100-12"	:	"SMG100_12"
        case	"SMG100-16"	:	"SMG100_16"
        case	"SMG100-8"	:	"SMG100_8"
        case	"SMP 2.1"	:	"SMP2_1"
        case	"SOL+20"	:	"SOL20"
        case	"SOL+23"	:	"SOL23"
        case	"SOL+25"	:	"SOL25"
        case	"Sol 25 Plus"	:	"Sol25Plus"
        case	"SOL 27 Premium S"	:	"SOL27PremiumS"
        case	"SOL 27 Premium W"	:	"SOL27PremiumW"
        case	"SOL+29"	:	"SOL29"
        case	"Sol 29 Premium S/W"	:	"Sol29PremiumSW"
        case	"Solarpac TP12"	:	"SolarpacTP12"
        case	"Solarpac TP24"	:	"SolarpacTP24"
        case	"Sol Duc"	:	"SolDuc"
        case	"SP501"	:	"SP501"
        case	"SPA2000"	:	"SPA2000"
        case	"SPA-58/1800-12"	:	"SPA58_1800_12"
        case	"SPA-58/1800-15"	:	"SPA58_1800_15"
        case	"SPA-58/1800-18"	:	"SPA58_1800_18"
        case	"SPA-58/1800-20"	:	"SPA58_1800_20"
        case	"SPA-58/1800-24"	:	"SPA58_1800_24"
        case	"SPA-58/1800-30"	:	"SPA58_1800_30"
        case	"Spark 30"	:	"Spark30"
        case	"Spark 40"	:	"Spark40"
        case	"SPF-ET20HP"	:	"SPF_ET20HP"
        case	"SPF 26"	:	"SPF26"
        case	"SPF 32"	:	"SPF32"
        case	"SPF 40"	:	"SPF40"
        default :  UNDEFINED
    endswitch
    endif
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar04_Model
  ANNUAL_PROPOSED
    if (LocalStatus( WaterSolar04_Model ) > 0) then UNCHANGED
    else
    switch (noXMLoutput_DHWSolSysRef:Model)
        case	"S-Power 10/1000 TPS Inside"	:	"SPower10_1000TPSInside"
        case	"S-Power 20/2000 TPS Inside"	:	"SPower20_2000TPSInside"
        case	"S-Power 30/3000 TPS Inside"	:	"SPower30_3000TPSInside"
        case	"SPP-Monarch-32"	:	"SPP_Monarch32"
        case	"SPP-Monarch-40"	:	"SPP_Monarch40"
        case	"SPP-Spartan-32"	:	"SPP_Spartan32"
        case	"SPP-Spartan-40"	:	"SPP_Spartan40"
        case	"SPP-22"	:	"SPP22"
        case	"SPP-25"	:	"SPP25"
        case	"SPP-30"	:	"SPP30"
        case	"SPP-30A"	:	"SPP30A"
        case	"SR10"	:	"SR10"
        case	"SR15"	:	"SR15"
        case	"SR20"	:	"SR20"
        case	"SR30"	:	"SR30"
        case	"SRT-13S"	:	"SRT13S"
        case	"SRT-215"	:	"SRT215"
        case	"SS-16"	:	"SS16"
        case	"SS-18"	:	"SS18"
        case	"SS-21"	:	"SS21"
        case	"SS-24"	:	"SS24"
        case	"SS-26"	:	"SS26"
        case	"SS-26-FP"	:	"SS26FP"
        case	"SS-28"	:	"SS28"
        case	"SS-32"	:	"SS32"
        case	"SS-32-FP"	:	"SS32FP"
        case	"SS-40"	:	"SS40"
        case	"SS-40-FP"	:	"SS40FP"
        case	"SS-40T"	:	"SS40T"
        case	"SS-50"	:	"SS50"
        case	"S-SC-126S26"	:	"SSC126S26"
        case	"S-SC-126S32"	:	"SSC126S32"
        case	"S-SC-126S40"	:	"SSC126S40"
        case	"SSN65-12"	:	"SSN65_12"
        case	"ST 2000 SELECTIVE"	:	"ST2000SSelective"
        case	"ST 2500 SELECTIVE"	:	"ST2500SSelective"
        case	"STC100"	:	"STC100"
        case	"SunPro21"	:	"SunPro21"
        case	"SunPro24"	:	"SunPro24"
        case	"SunPro40"	:	"SunPro40"
        case	"SunQuest 250"	:	"SunQuest250"
        case	"SunTrac27"	:	"SunTrac27"
        case	"Superline 3XL USB"	:	"Superline3XL_USB"
        case	"Superline 3XL USB-1"	:	"Superline3XL_USB1"
        case	"Superline L USB"	:	"SuperlineL_USB"
        case	"Superline L USB-1"	:	"SuperlineL_USB1"
        case	"Superline XXL USB"	:	"SuperlineXXL_USB"
        case	"Superline XXL USB-1"	:	"SuperlineXXL_USB1"
        case	"SZ58/1800-10HA"	:	"SZ58_1800_10HA"
        case	"SZ58/1800-15HA"	:	"SZ58_1800_15HA"
        case	"SZ58/1800-20HA"	:	"SZ58_1800_20HA"
        case	"SZ58/1800-25HA"	:	"SZ58_1800_25HA"
        case	"SZ58/1800-30HA"	:	"SZ58_1800_30HA"
        case	"T32"	:	"T32"
        case	"T40"	:	"T40"
        case	"T48"	:	"T48"
        case	"T56"	:	"T56"
        case	"TAL 4 S"	:	"TAL4S"
        case	"ThermoPower UDF10"	:	"ThermoPowerUDF10"
        case	"ThermoPower UDF20"	:	"ThermoPowerUDF20"
        case	"ThermoPower UDF30"	:	"ThermoPowerUDF30"
        case	"ThermoPower VHP20"	:	"ThermoPowerVHP20"
        case	"ThermoPower VHP30"	:	"ThermoPowerVHP30"
        case	"TitanPower-AL2"	:	"TitanPowerAL2"
        case	"TitanPower-ALDH29"	:	"TitanPowerALDH29"
        case	"TitanPower-ALDH29-27A"	:	"TitanPowerALDH29_27A"
        case	"TitanPower-ALDH29-A"	:	"TitanPowerALDH29A"
        case	"TitanPower-ALDH40-PS"	:	"TitanPowerALDH40PS"
        case	"TitanPowerPlus-ALDH29P"	:	"TitanPowerPlusALDH29P"
        case	"TitanPowerPlus-ALDH29P-V3"	:	"TitanPowerPlusALDH29P_V3"
        case	"TJ-ZRG58/18A-12"	:	"TJ_ZRG58_18A12"
        case	"TJ-ZRG58/18A-15"	:	"TJ_ZRG58_18A15"
        case	"TJ-ZRG58/18A-18"	:	"TJ_ZRG58_18A18"
        case	"TJ-ZRG58/18A-20"	:	"TJ_ZRG58_18A20"
        case	"TJ-ZRG58/18A-24"	:	"TJ_ZRG58_18A24"
        case	"TJ-ZRG58/18A-30"	:	"TJ_ZRG58_18A30"
        case	"TPH-15/18"	:	"TPH15_18"
        case	"TPH-20/18"	:	"TPH20_18"
        case	"TPH-24/18"	:	"TPH24_18"
        case	"TPH-25/18"	:	"TPH25_18"
        case	"TPH-28/18"	:	"TPH28_18"
        case	"TPH-30/18"	:	"TPH30_18"
        case	"TPH-36/18"	:	"TPH36_18"
        case	"TPU-10/18"	:	"TPU10_18"
        case	"TPU-12/18"	:	"TPU12_18"
        case	"TPU-14/18"	:	"TPU14_18"
        case	"TPU-15/18"	:	"TPU15_18"
        case	"TPU-16/18"	:	"TPU16_18"
        case	"TPU-18/18"	:	"TPU18_18"
        case	"TPU-20/18"	:	"TPU20_18"
        case	"TPU-24/18"	:	"TPU24_18"
        case	"TPU-25/18"	:	"TPU25_18"
        case	"TPU-28/18"	:	"TPU28_18"
        case	"TPU-30/18"	:	"TPU30_18"
        case	"TRB-26"	:	"TRB26"
        case	"TRB-32"	:	"TRB32"
        case	"TRB-40"	:	"TRB40"
        case	"TS-10-58PA"	:	"TS10_58PA"
        case	"TS-10-70PA"	:	"TS10_70PA"
        case	"TS-20-58PA"	:	"TS20_58PA"
        case	"TS-20-70PA"	:	"TS20_70PA"
        case	"TS-22-58PA"	:	"TS22_58PA"
        case	"TS-24-58PA"	:	"TS24_58PA"
        case	"TS-30-58PA"	:	"TS30_58PA"
        case	"TZ47/1500-10U"	:	"TZ47_1500_10U"
        case	"TZ47/1500-12U"	:	"TZ47_1500_12U"
        case	"TZ47/1500-15U"	:	"TZ47_1500_15U"
        case	"TZ47/1500-16U"	:	"TZ47_1500_16U"
        case	"TZ47/1500-18U"	:	"TZ47_1500_18U"
        case	"TZ47/1500-20U"	:	"TZ47_1500_20U"
        case	"TZ47/1500-25U"	:	"TZ47_1500_25U"
        case	"TZ47/1500-30U"	:	"TZ47_1500_30U"
        case	"TZ58/1800-10R"	:	"TZ58_1800_10R"
        case	"TZ58/1800-10R2"	:	"TZ58_1800_10R2"
        case	"TZ58/1800-15R"	:	"TZ58_1800_15R"
        case	"TZ58/1800-15R2"	:	"TZ58_1800_15R2"
        case	"TZ58/1800-20R"	:	"TZ58_1800_20R"
        case	"TZ58/1800-20R2"	:	"TZ58_1800_20R2"
        case	"TZ58/1800-25R"	:	"TZ58_1800_25R"
        case	"TZ58/1800-25R2"	:	"TZ58_1800_25R2"
        case	"TZ58/1800-30R"	:	"TZ58_1800_30R"
        case	"TZ58/1800-30R2"	:	"TZ58_1800_30R2"
        case	"USP-519"	:	"USP519"
        case	"US-SOL_2.72m2"	:	"USSOL2_72m2"
        case	"US-SOL_2.72m2 HORIZONTAL"	:	"USSOL2_72m2Horizontal"
        case	"v4"	:	"V4"
        case	"Varisol DF"	:	"VarisolDF"
        case	"WS0503"	:	"WS0503"
        case	"WT-B58-10"	:	"WTB58_10"
        case	"WT-B58-15"	:	"WTB58_15"
        case	"WT-B58-20"	:	"WTB58_20"
        case	"WT-B58-24"	:	"WTB58_24"
        case	"WT-B58-30"	:	"WTB58_30"
        case	"XKPH58-15"	:	"XKPH58_15"
        case	"XKPH58-20"	:	"XKPH58_20"
        case	"XKPH58-25"	:	"XKPH58_25"
        case	"XKPH58-30"	:	"XKPH58_30"
        case	"YN58-10"	:	"YN58_10"
        case	"YN58-15"	:	"YN58_15"
        case	"YN58-20"	:	"YN58_20"
        case	"YN58-25"	:	"YN58_25"
        case	"YN58-30"	:	"YN58_30"
        default :  UNDEFINED
    endswitch
    endif
ENDRULE

RULE nrcctblRowWaterSolar:WaterSolar05_SolarWaterHeatingCollectorCount
  ANNUAL_PROPOSED
    noXMLoutput_DHWSolSysRef:Count
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar06_SolarWaterHeatingCollectorArea
  ANNUAL_PROPOSED
    int( noXMLoutput_DHWSolSysRef:Area + 0.5 )
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar07_SolarWaterHeatingSavingsFraction
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_DHWSolSysRef:CalculatedSSF ) )
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( WaterSolar07_SolarWaterHeatingSavingsFraction ) > 0) 
    then UNDEFINED
    else "NotApplicable"
    endif
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar08_SolarWaterHeatingCollectorAngleFromNorth
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_DHWSolSysRef:Azimuth ) )
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar09_SolarWaterHeatingCollectorSlope
  ANNUAL_PROPOSED
    atof( Format( "%.0f", noXMLoutput_DHWSolSysRef:Tilt ) )
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar10_SolarWaterHeatingPerformanceSoftware
  ANNUAL_PROPOSED
    "CSE"
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar11_SolarWaterHeatingPerformanceSoftwareVersion
  NRCCPRF
    Proj:CSEVersion
ENDRULE
; NRCC Res DHW
RULE nrcctblRowWaterSolar:WaterSolar12_VolumeCapacity
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_DHWSolSysRef:TankVolume ) )
ENDRULE
RULE nrcctblRowWaterSolar:WaterSolar13_DHWSystemDwellingUnitsCount
  ANNUAL_PROPOSED
    noXMLoutput_DHWSolSysRef:DwellUnitsServed
ENDRULE


; RJH 10/5/22 Switched 2022 Section_WaterCompact implementation from previous 2019 NRCC to Res CF1R implementation

; nrccSection_WaterCompact nrccTableWaterCompact 
;RULE NEW ResSpcDHWFeatures:nrcctblRowWaterCompactRef
;  DATATYPE
;    nrcctblRowWaterCompact
;  INPUTCLASS 
;    Prescribed
;ENDRULE
;RULE NEW nrcctblRowWaterCompact:noXMLoutput_ResSpcDHWFeaturesRef
;  DATATYPE
;    ResSpcDHWFeatures
;  INPUTCLASS 
;    Prescribed
;ENDRULE

;RULE nrcctblRowWaterCompact:Parent
;  ANNUAL_PROPOSED
;    nrccTableWaterCompact:Name
;ENDRULE

;RULE nrcctblRowWaterCompact:WaterCompact01_SpaceName
;  ANNUAL_PROPOSED
;    noXMLoutput_ResSpcDHWFeaturesRef:ParentSpcNameRpt
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact02_DwellingUnitType
;  ANNUAL_PROPOSED
;    switch (noXMLoutput_ResSpcDHWFeaturesRef:DwellingUnitBedroomCnt)
;        case 0 : "StudioUnit"
;        case 1 : "OneBedroom"
;        case 2 : "TwoBedroom"
;        case 3 : "ThreeBedroom"
;        case 4 : "FourBedroom"
;        case 5 : "FivePlusBedroom"
;        default :  UNDEFINED
;    endswitch
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact03_WaterHeatingSystemName
;  ANNUAL_PROPOSED
;    noXMLoutput_ResSpcDHWFeaturesRef:ParentResDHWSysRefRpt
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact04_WaterHeaterToBath
;  ANNUAL_PROPOSED
;    if (IfValidAnd( noXMLoutput_ResSpcDHWFeaturesRef:MasterBathFxtrDistance > 0 ))
;    then atof( Format( "%.2f", noXMLoutput_ResSpcDHWFeaturesRef:MasterBathFxtrDistance ) )
;    else  UNDEFINED  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact04_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( WaterCompact04_WaterHeaterToBath ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact05_WaterHeaterToKitchen
;  ANNUAL_PROPOSED
;    if (IfValidAnd( noXMLoutput_ResSpcDHWFeaturesRef:KitFxtrDistance > 0 ))
;    then atof( Format( "%.2f", noXMLoutput_ResSpcDHWFeaturesRef:KitFxtrDistance ) )
;    else  UNDEFINED  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact05_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( WaterCompact05_WaterHeaterToKitchen ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact06_WaterHeaterToFurthest3rdFixture
;  ANNUAL_PROPOSED
;    if (IfValidAnd( noXMLoutput_ResSpcDHWFeaturesRef:ThirdRoomFxtrDistance > 0 ))
;    then atof( Format( "%.2f", noXMLoutput_ResSpcDHWFeaturesRef:ThirdRoomFxtrDistance ) )
;    else  UNDEFINED  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact06_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( WaterCompact06_WaterHeaterToFurthest3rdFixture ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact07_CompactFactor
;  ANNUAL_PROPOSED
;    if (IfValidAnd( noXMLoutput_ResSpcDHWFeaturesRef:CompactFactor > 0 ))
;    then atof( Format( "%.2f", noXMLoutput_ResSpcDHWFeaturesRef:CompactFactor ) )
;    else  UNDEFINED  endif
;ENDRULE
;RULE nrcctblRowWaterCompact:WaterCompact08_CompactDistributionVerificationRequired
;  ANNUAL_PROPOSED
;    if (noXMLoutput_ResSpcDHWFeaturesRef:CompactDistIdx == 2) then "true" else "false" endif
;ENDRULE



; nrccSection_WaterDWHR nrccTableDWHR moved to procedural rules in "NRCCPRF_Section_WaterDWHR" - RJH 20211117




