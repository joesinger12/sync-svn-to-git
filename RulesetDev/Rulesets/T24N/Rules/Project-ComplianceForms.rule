// Project - PRF-01 Form Inputs
//
// -------------------------------------------------------------------------
//  Copyright (c) 2019, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------



RULE NEW AirSys:ProjRef
  DESCRIPTION
    "Reverse reference for AirSys"
  DATATYPE
    Proj
  LONGFORM
    ProjectReference
  INPUTCLASS
    NotInput
  DEFAULT
    Proj:Name
ENDRULE   

RULE NEW ZnSys:ProjRef
  DESCRIPTION
    "Reverse reference for ZnSys"
  DATATYPE
    Proj
  LONGFORM
    ProjectReference
  INPUTCLASS
    NotInput
  DEFAULT
    Proj:Name
ENDRULE   

RULE NEW VRFSys:ProjRef
  DESCRIPTION
    "Reverse reference for VRFSys"
  DATATYPE
    Proj
  LONGFORM
    ProjectReference
  INPUTCLASS
    NotInput
  DEFAULT
    Proj:Name
ENDRULE   


RULE NEW FluidSys:ProjRef
  DESCRIPTION
    "Reverse reference for FluidSys"
  DATATYPE
    Proj
  LONGFORM
    ProjectReference
  INPUTCLASS
    NotInput
  DEFAULT
    Proj:Name
ENDRULE   

// -----------------------------------------------------------------------------

// ********** Form 1 Defaults  ******

// -----------------------------------------------------------------------------
RULE Proj:CompPathEnv
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewEnv = 1 .OR. 
        Proj:IsAddEnv = 1 .OR. 
        SumChildrenIf( Spc:Mult, Spc:EnvStatus = "Altered" ) > 0 .OR.
        SumChildren( Spc:IsNewEnv ) > 0 ) .AND. (IfValidAnd( Bldg:NonResFlrArea > 0 ) .OR. IfValidAnd( Bldg:HotelMotelGuestRmCnt > 0 )) )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:DuctStatus
  DATATYPE
    Integer
  LONGFORM
    DuctStatus
  INPUTCLASS
    NotInput
  DEFAULT
    if( ( Proj:IsAdd = 1 .OR. Proj:IsAddorAlt = 1 .OR. 
          Proj:IsAlt = 1 .OR. Proj:IsAltOnly = 1 ) .AND.
        ( SumChildrenIf( AirSys:Cnt, AirSys:DuctStatus = 0 ) > 0 .OR. 
          SumChildrenIf( ZnSys:Cnt, ZnSys:DuctStatus = 0 ) > 0 ) ) 
    then 1
    else 0
    endif
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:CompPathMech
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewMech = 1 .OR. 
        Proj:IsAddMech = 1 .OR. 
        Proj:IsPartMech = 1 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewHVAC > 0 ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewVent > 0 ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewExh > 0 ) > 0  .OR. 
        IfValidAnd( DuctStatus > 0 ) > 0 ) .AND. (IfValidAnd( Bldg:NonResFlrArea > 0 ) .OR. IfValidAnd( Bldg:HotelMotelGuestRmCnt > 0 )) )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathLtg
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewLtg = 1 .OR. 
        Proj:IsPartLtg = 1 .OR.
        SumChildrenIf( Spc:Mult, Spc:LtgStatusForComp = "New" ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:LtgStatusForComp = "Altered" ) > 0 ) .AND. 
        (IfValidAnd( Bldg:NonResFlrArea > 0 ) .OR. IfValidAnd( Bldg:HotelMotelGuestRmCnt > 0 )) )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathDHW
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. ( (IfValidAnd( Bldg:NonResFlrArea > 0 ) .AND. IsNewSHW ) .OR. IfValidAnd( Bldg:HotelMotelGuestRmCnt > 0 )) )
    then "Performance"
    else "NA"
    endif
ENDRULE

RULE NEW ResDHWSys:IsDHWSolarSysIncl
  LONGFORM
    IsDomesticHotWaterSolarSystemIncluded
  DATATYPE
    Integer
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( LocalStatus ( DHWSolarSysRef ) > 0 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:SolThrmlComp
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT
    if( ( CompOptDHW = 1 .AND. SumAll(ResDHWSys:IsDHWSolarSysIncl) > 0 ) .OR.
        ( ResCompOptDHW = 1 .AND. SumAll(ResDHWSys:IsDHWSolarSysIncl) > 0 ) )
    then "Performance"
    else "NA"
    endif
ENDRULE
; SAC 2/2/20 - replace AnnualSolFrac w/ CSESolarSysSimValid to set SolThrmlComp (tic #3157)
;    if( CompOptDHW = 1 .AND. SumChildren( ResDHWSys:AnnualSolFrac ) > 0 ) 


// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcKit
  DATATYPE
    Integer
  LONGFORM
    IsProcessKitchen
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( SpcFunc = "Kitchen/Food Preparation Area" .AND.
        HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:HasNewComputerRmHVAC
  DATATYPE
    Integer
  LONGFORM
    HasNewComputerRoomHVAC
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( SpcFunc = "Computer Room" .AND.
        ( HVACStatus = "New" .OR. 
          HVACStatus = "Altered" ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcLab
  DATATYPE
    Integer
  LONGFORM
    IsProcessLaboratory
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2019
    if( SpcFunc = "Scientific Laboratory Area" .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( SpcFunc = "Laboratory, Scientific" .AND. ; JP 211130 space type name change (tic #3301)
          HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathKit
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:IsProcKit ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathComputerRm
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:HasNewComputerRmHVAC ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathLab
  RULESETS
    T24N
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:IsProcLab ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgUncondComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgOutdrComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgSignComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:ResCompPathEnv
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptEnve > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathLtg
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptLtg > 0 ) )
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathMech
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptMech > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathDHW
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT 
    if( IfValidAnd( Proj:ResCompOptDHW > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
; added defaulting to Performance when appropriate - SAC 10/13/22
RULE Proj:PVComp
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
   if ( IfValidAnd( AnalysisVersion > 220000 ) .AND.
        ( IfValidAnd( CommunitySolarProjID > 0 ) .OR.
          IfValidAnd( DCSizeMultiplier > 0 ) .AND. IfValidAnd( PVSizeSum > 0 ) ) )
   then  "Performance"
   else  "NA"  endif
ENDRULE

// -----------------------------------------------------------------------------
; added defaulting to Performance when appropriate - SAC 10/13/22
RULE Proj:BattComp
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
   if ( IfValidAnd( AnalysisVersion > 220000 ) .AND.
        IfValidAnd( BattCapMult > 0 ) .AND. IfValidAnd( BattSizeSum > 0 ) )
   then  "Performance"
   else  "NA"  endif
ENDRULE

// **************** Form 2 Defaults ***************

// -----------------------------------------------------------------------------
RULE Proj:SimpleHVACMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"    
//    if( SumChildren( AirSys:IsComplexSys ) = 0 .AND.
//        SumChildren( ZnSys:IsComplexSys ) = 0 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComplexHVACMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( SumChildren( AirSys:IsComplexSys ) > 0 .OR.
//       SumChildren( ZnSys:IsComplexSys ) > 0 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ElecMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( Proj:CompOptNew = 1 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:SolReadyMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( Proj:CompOptNew = 1 .AND.
//        ( ( Bldg:ResFlrArea > 0 .AND. Bldg:AboveGrdStoryCnt < 10 ) .OR.
//          ( Bldg:ResFlrArea = 0 .AND. Bldg:AboveGrdStoryCnt < 3 ) ) )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcParking
  DATATYPE
    Integer
  LONGFORM
    IsProcessParking
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2019
    if( ( SpcFunc = "Parking Garage Area (Parking Zone)" .OR.
          SpcFunc = "Parking Garage Area (Dedicated Ramps)" .OR.
          SpcFunc = "Parking Garage Area (Daylight Adaptation Zones)" ) .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( ( SpcFunc = "Parking Garage Area (Parking Zone and Ramps)" .OR. ; JP 211130 space type name change (tic #3301)
          SpcFunc = "Parking Garage Area (Daylight Adaptation Zones)" ) .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ParkingGarageMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND.
        SumChildren( Spc:IsProcParking ) > 0 ) 
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComRfrgMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:RfrgWarehouseMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompressedAirMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ProcBlrMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CommKitchenMandComp
  RULESETS
    T24N
  DEFAULT : T24N
    if( CompPathKit = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComputerRoomMandComp
  RULESETS
    T24N
  DEFAULT : T24N
    if( CompPathComputerRm = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LabExhaustMandComp
  RULESETS
    T24N
  DEFAULT : T24N
    if( CompPathLab = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ElevLtgVentMandComp
  RULESETS
    T24N
  DEFAULT : T24N
    if( ( CompPathMech = "Performance" .OR. 
          CompPathLtg = "Performance" ) .AND.
        SumChildren( Spc:ElevCnt ) > 0 )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:EscalSpdCtrlMandComp
  RULESETS
    T24N
  DEFAULT : T24N
    if( SumChildren( Spc:EscalCnt ) > 0 )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System provides outside air (OA). Healthcare facilites are exempt from this test. 

		 Nonresidential: 120.5(a)1 supporting 120.1(c)3

     Multifamily: 160.3(d)1A"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Status <> "Existing" .AND.  
        IfValidAnd( IsHlthCareSys < 1 ) .AND.   
        ServesResZn = 0 .AND.      
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >  0 )
    then 1
    else
		   if( Proj:ResCompPathMech = "Performance" .AND.
		        Status <> "Existing" .AND.  
		        ServesResZn > 0 )
		    then 1   
		    else 0
		    endif
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System is constant volume, single zone AC or heat pump system 
		 (packaged or split)  with JA5 thermostat zonal controls. If EMCS controls 
		 are used instead of JA5 thermostat, use NRCA-MCH-11 instead of this test. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)2 supporting 120.2

     Multifamily: 160.3(d)1B"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Status <> "Existing" .AND. 
        IfValidAnd( IsHlthCareSys < 1 ) .AND. 
        ( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
          Type = "SPVAC" .OR. Type = "SPVHP" .OR. 
          Type = "HV" .OR. Type = "DOASCV" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

RULE NEW AirSys:ResOtherZnRef
  DESCRIPTION
    "Reverse reference for ResOtherZn"
  DATATYPE
    AirSys
  LONGFORM
    AirSystemReference
  INPUTCLASS
    NotInput
  DEFAULT
    AirSys:Name
ENDRULE 

RULE NEW AirSys:ResOtherZnAreaCheck
  DESCRIPTION
    "Residential other zone area served by AirSys"
  DATATYPE
    Integer
  LONGFORM
    ResidentialOtherZoneArea
  INPUTCLASS
    NotInput
  DEFAULT
   if( SumRevRef( ResOtherZn:ozHVACSystem, ResOtherZn:Area ) < 5000 ) 
   then 1
   else 0
   endif
ENDRULE 

RULE NEW AirSys:SingleZnSysCheck
  DESCRIPTION
    "Check to see if system is single zone"
  DATATYPE
    Integer
  LONGFORM
    SingleZoneSystemCheck
  INPUTCLASS
    NotInput
  DEFAULT
    if( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
          Type = "SPVAC" .OR. Type = "SPVHP" .OR. Type = "HV" )
    then 1
    else 0
    endif
ENDRULE 

RULE NEW AirSys:ZnServedAreaCheck
  DESCRIPTION
    "Check to see if zone served area is < 5,000 sf"
  DATATYPE
    Integer
  LONGFORM
    ZoneServedAreaCheck
  INPUTCLASS
    NotInput
  DEFAULT
    if( SumRevRef(ThrmlZn:PriAirCondgSysRef[1], ThrmlZn:FlrArea) < 5000 )
    then 1
    else 0
    endif
ENDRULE 

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: Entirely new ducts or new ducts in an existing building
		 where more than 75% of ducts replaced when part of a constant 
		 volume, single zone HVAC system serving less than 5,000 sf. 
		 More than 25% of the ducts are located outdoors or in unconditioned
		 space, including under a roof that has a U-factor less then the 
		 U-factor of the ceiling. Healthcare facilities are exempt from this test.


		 Nonres: 120.5(a)3 supporting 120.4(g); 141.0(b)2D

     Multifamily: 160.3(d)1C"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance") .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.
        Status <> "Existing"  .AND. 
        SingleZnSysCheck > 0  .AND. 
        DuctStatus = 0  .AND.
        ( DuctLctn = "Unconditioned" .OR. DuctLctn = "Other" ) ) 
    then 
      if ( ServesResZn = 0 .AND. ZnServedAreaCheck > 0 )
      then 1
      else if ( ServesResZn = 1 .AND. ResOtherZnAreaCheck > 0 )
      then 1
      else 0
      endif endif
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

RULE NEW OACtrl:HasEconoCtrls
  DATATYPE
    Integer
  LONGFORM
    HasEconomizerControls
  INPUTCLASS
    NotInput
  DEFAULT
    if( OACtrl:EconoCtrlMthd = "FixedDryBulb" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialDryBulb" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialEnthalpy" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialDryBulbAndEnthalpy" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  HELP
		"Trigger: System has an economizer. Healthcare facilites are exempt from this test. 


		 Nonres: 120.5(a)4 supporting 140.4(e)

     Multifamily: 160.3(d)1D"
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
          IfValidAnd( IsHlthCareSys < 1 ) .AND.
          Status <> "Existing" .AND.
          SumChildren( OACtrl:HasEconoCtrls ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether NRCA-Mch-06A acceptance certificate 
     is required, used for reporting."
  HELP
		"Trigger: System utilizes Demand Control Ventilation (DCV) controls. DCV is 
     required for high occupancy spaces (25 people per 1,000sf) with at least one of 
     the following: economizer, modulating OA control, or a design OA rate of 3,000 cfm
     or more. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)5 supporting 120.1(d)3
     Multifamily: 16.2(c)5C through E"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) > 0 .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.
        Status <> "Existing" )
    then
      if ( SumChildren( OACtrl:HasEconoCtrls ) > 0 .OR.  
           SumChildren( OACtrl:DsgnOAFlow ) > 3000 ) 
      then 1
      else 0
      endif
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  HELP
		"Trigger: VAV space conditioning system supply fans modulate airflow. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)6 supporting 140.4(c)
		 Multifamily: 160.3(d)1F"
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Status <> "Existing".AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.          
        ( Type = "PVAV" .OR. Type = "VAV" .OR.
          Type = "SZVAVAC" .OR. Type = "SZVAVHP" .OR. Type = "SZVAVDFHP" .OR. 
          Type = "DOASVAV" ) ) 
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Systems with Direct Digital Controls (DDC) to the zone level and EMCS. 
     If utilizing JA5 thermostats with DDC, use NRCA-MCH-03 instead of this test. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)10 supporting 110.12(b), 120.2(h), 120.2(j)
     Multifamily: 160.3(d)1J"
  INPUTCLASS
    Default 
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Status <> "Existing" .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.         
        IfValidAnd( CtrlSysType = "DDCToZone" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a packaged Direct Expansion (DX) with 33,000 Bth/hr 
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD)
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)11 supporting 120.2(i)
     Multifamily: 160.3(d)1K"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
          Status <> "Existing" .AND.
          IfValidAnd( IsHlthCareSys < 1 ) .AND.          
          IfValidAnd( ClgCap > 33000 ) .AND.
          SumChildren( OACtrl:HasEconoCtrls ) > 0  .AND.
          ( SubType = "Packaged3Phase" .OR. SubType = "Packaged1Phase" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is an air handler or zonal terminal unit with 33,000 Bth/hr
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD) 
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)12 supporting 120.2(i)
     Multifamily: 160.3(d)1L"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
          Status <> "Existing" .AND.
          IfValidAnd( IsHlthCareSys < 1 ) .AND.  
          IfValidAnd( ClgCap > 33000 ) .AND.
          SumChildren( OACtrl:HasEconoCtrls ) > 0 .AND.
          ( SubType = "Split3Phase" .OR. SubType = "Split1Phase" .OR. SubType = "NA" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a constant or variable volume Direct Expansion (DX) 
     air conditioning system with distributed energy storage (DES/DXAC). 
     Healthcare facilities are exempt from this test. 


     Nonres: 120.5(a)13
     Multifamily: 160.3(d)1M"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a multizone system that with automatic supply air 
     temperature reset controls. Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)15 supporting  140.4(f)
     Multifamily: 160.3(d)1O"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Status <> "Existing" .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.
        IfValidAnd( IsMultiZnSys > 0 )  .AND.
        ( ClgCtrl = "Fixed" .OR.
          ClgCtrl = "Scheduled" .OR.
          ClgCtrl = "OutsideAirReset" .OR.
          ClgCtrl = "WarmestReset" .OR.
          ClgCtrl = "WarmestResetFlowFirst" .OR.
          ClgCtrl = "WarmestResetTemperatureFirst" .OR. 
          ClgCtrl = "FixedDualSetpoint" .OR.
          ClgCtrl = "ScheduledDualSetpoint" .OR. 
          ClgCtrl = "OutsideAirResetDualSetpoint" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE



// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System control is an Energy Management Control System (EMCS). 
     Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)17 supporting 110.12
     Multifamily: 160.3(d)10"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System has occupant sensor ventilation control that turns off ventilation
     air when a space is unoccupied. Healthcare facilities are exempt from test.


     Nonres: 120.5(a)18 supporting 120.2(e)3; Table 120.1-A
     Multifamily: 160.3(d)1R "
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Status <> "Existing" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE



// ===========Zone Systems
// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System provides outside air (OA). Healthcare facilites are exempt from this test. 

		 Nonresidential: 120.5(a)1 supporting 120.1(c)3

     Multifamily: 160.3(d)1A"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Status <> "Existing"  .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System is constant volume, single zone AC or heat pump system 
		 (packaged or split)  with JA5 thermostat zonal controls. If EMCS controls 
		 are used instead of JA5 thermostat, use NRCA-MCH-11 instead of this test. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)2 supporting 120.2

     Multifamily: 160.3(d)1B"

  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
          Type = "PTAC" .OR. Type = "PTHP" .OR.
          Type = "SPVAC" .OR. Type = "SPVHP" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


RULE NEW ZnSys:SingleZnSysCheck
  DESCRIPTION
    "Check to see if system is single zone"
  DATATYPE
    Integer
  LONGFORM
    SingleZoneSystemCheck
  INPUTCLASS
    NotInput
  DEFAULT
    if( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
        Type = "SPVAC" .OR. Type = "SPVHP" .OR. 
        Type = "PTAC" .OR. Type = "PTHP")
    then 1
    else 0
    endif
ENDRULE 

RULE NEW ZnSys:ZnServedAreaCheck
  DESCRIPTION
    "Check to see if zone served area is < 5,000 sf"
  DATATYPE
    Integer
  LONGFORM
    ZoneServedAreaCheck
  INPUTCLASS
    NotInput
  DEFAULT
    if( SumRevRef(ThrmlZn:PriAirCondgSysRef[1], ThrmlZn:FlrArea) < 5000 )
    then 1
    else 0
    endif
ENDRULE 

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: Entirely new ducts or new ducts in an existing building
		 where more than 75% of ducts replaced when part of a constant 
		 volume, single zone HVAC system serving less than 5,000 sf. 
		 More than 25% of the ducts are located outdoors or in unconditioned
		 space, including under a roof that has a U-factor less then the 
		 U-factor of the ceiling. Healthcare facilities are exempt from this test.


		 Nonres: 120.5(a)3 supporting 120.4(g); 141.0(b)2D

     Multifamily: 160.3(d)1C"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.
        Status <> "Existing"  .AND. 
        SingleZnSysCheck > 0  .AND. 
        ZnServedAreaCheck > 0 .AND. 
        DuctStatus = 0  .AND.
        ( DuctLctn = "Unconditioned" .OR. DuctLctn = "Other" ) ) 
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System has an economizer. Healthcare facilites are exempt from this test. 


		 Nonres: 120.5(a)4 supporting 140.4(e)

     Multifamily: 160.3(d)1D"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System utilizes Demand Control Ventilation (DCV) controls. DCV is 
     required for high occupancy spaces (25 people per 1,000sf) with at least one of 
     the following: economizer, modulating OA control, or a design OA rate of 3,000 cfm
     or more. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)5 supporting 120.1(d)3
     Multifamily: 16.2(c)5C through E"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: VAV space conditioning system supply fans modulate airflow. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)6 supporting 140.4(c)
		 Multifamily: 160.3(d)1F"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Systems with Direct Digital Controls (DDC) to the zone level and EMCS. 
     If utilizing JA5 thermostats with DDC, use NRCA-MCH-03 instead of this test. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)10 supporting 110.12(b), 120.2(h), 120.2(j)
     Multifamily: 160.3(d)1J"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a packaged Direct Expansion (DX) with 33,000 Bth/hr 
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD)
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)11 supporting 120.2(i)
     Multifamily: 160.3(d)1K"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is an air handler or zonal terminal unit with 33,000 Bth/hr
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD) 
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)12 supporting 120.2(i)
     Multifamily: 160.3(d)1L"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a constant or variable volume Direct Expansion (DX) 
     air conditioning system with distributed energy storage (DES/DXAC). 
     Healthcare facilities are exempt from this test. 


     Nonres: 120.5(a)13
     Multifamily: 160.3(d)1M"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE



// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a multizone system that with automatic supply air 
     temperature reset controls. Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)15 supporting  140.4(f)
     Multifamily: 160.3(d)1O"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE



// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  HELP
    "Trigger: System control is an Energy Management Control System (EMCS). 
     Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)17 supporting 110.12
     Multifamily: 160.3(d)10"
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System has occupant sensor ventilation control that turns off ventilation
     air when a space is unoccupied. Healthcare facilities are exempt from test.


     Nonres: 120.5(a)18 supporting 120.2(e)3; Table 120.1-A
     Multifamily: 160.3(d)1R "
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System provides outside air (OA). Healthcare facilites are exempt from this test. 

		 Nonresidential: 120.5(a)1 supporting 120.1(c)3

     Multifamily: 160.3(d)1A"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System is constant volume, single zone AC or heat pump system 
		 (packaged or split)  with JA5 thermostat zonal controls. If EMCS controls 
		 are used instead of JA5 thermostat, use NRCA-MCH-11 instead of this test. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)2 supporting 120.2

     Multifamily: 160.3(d)1B"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: Entirely new ducts or new ducts in an existing building
		 where more than 75% of ducts replaced when part of a constant 
		 volume, single zone HVAC system serving less than 5,000 sf. 
		 More than 25% of the ducts are located outdoors or in unconditioned
		 space, including under a roof that has a U-factor less then the 
		 U-factor of the ceiling. Healthcare facilities are exempt from this test.


		 Nonres: 120.5(a)3 supporting 120.4(g); 141.0(b)2D

     Multifamily: 160.3(d)1C"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System has an economizer. Healthcare facilites are exempt from this test. 


		 Nonres: 120.5(a)4 supporting 140.4(e)

     Multifamily: 160.3(d)1D"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: System utilizes Demand Control Ventilation (DCV) controls. DCV is 
     required for high occupancy spaces (25 people per 1,000sf) with at least one of 
     the following: economizer, modulating OA control, or a design OA rate of 3,000 cfm
     or more. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)5 supporting 120.1(d)3
     Multifamily: 16.2(c)5C through E"
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
		"Trigger: VAV space conditioning system supply fans modulate airflow. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)6 supporting 140.4(c)
		 Multifamily: 160.3(d)1F"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Systems with Direct Digital Controls (DDC) to the zone level and EMCS. 
     If utilizing JA5 thermostats with DDC, use NRCA-MCH-03 instead of this test. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)10 supporting 110.12(b), 120.2(h), 120.2(j)
     Multifamily: 160.3(d)1J"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a packaged Direct Expansion (DX) with 33,000 Bth/hr 
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD)
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)11 supporting 120.2(i)
     Multifamily: 160.3(d)1K"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is an air handler or zonal terminal unit with 33,000 Bth/hr
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD) 
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)12 supporting 120.2(i)
     Multifamily: 160.3(d)1L"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a constant or variable volume Direct Expansion (DX) 
     air conditioning system with distributed energy storage (DES/DXAC). 
     Healthcare facilities are exempt from this test. 


     Nonres: 120.5(a)13
     Multifamily: 160.3(d)1M"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Equipment is a multizone system that with automatic supply air 
     temperature reset controls. Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)15 supporting  140.4(f)
     Multifamily: 160.3(d)1O"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System control is an Energy Management Control System (EMCS). 
     Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)17 supporting 110.12
     Multifamily: 160.3(d)10"
  INPUTCLASS
    Default
  DEFAULT
    1
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System has occupant sensor ventilation control that turns off ventilation
     air when a space is unoccupied. Healthcare facilities are exempt from test.


     Nonres: 120.5(a)18 supporting 120.2(e)3; Table 120.1-A
     Multifamily: 160.3(d)1R "
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

//-----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
RULE NEW FluidSys:CHWHWPumpVarSpdFlag
  DATATYPE
    Integer
  LONGFORM
    ChilledWaterHotWaterPumpVariableSpeedFlag
  INPUTCLASS 
    NotInput
  DEFAULT
    if( Type = "HotWater" .OR. Type = "ChilledWater" ) 
    then
      if ( SumChildren( Pump:PumpVarSpdFlag ) > 0  )
      then 1
      else 0
      endif
    else 0
    endif
ENDRULE

RULE NEW FluidSys:CWPumpVarSpdFlag
  DATATYPE
    Integer
  LONGFORM
    CondenserWaterPumpVariableSpeedFlag
  INPUTCLASS 
    NotInput
  DEFAULT
    if( Type = "CondenserWater" ) 
    then
      if ( SumChildren( Pump:PumpVarSpdFlag ) > 0  )
      then 1
      else 0
      endif
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch08A
  RULESETS
    T24N
  HELP
    "Trigger: System is a hydronic  with more than 1 boiler or chiller that require
     isolation controls. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)8 supporting 120.5(a)8; 140.4(k)2&3
     Multifamily: 160.3(d)G supporting 160.3(d)1H; 170.2(c)4I"
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS 
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND. 
        Status <> "Existing" .AND.
        IfValidAnd ( IsHlthCareSys < 1 ) .AND.
        ( IfValidAnd( ChlrCnt > 1 ) .OR. 
          IfValidAnd( BlrCnt > 1 ) .OR. 
          CHWHWPumpVarSpdFlag > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch08A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch09A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System is hydronic with a boiler or chiller design capacity 
     exceeding 500,000 Btu/hr. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)9 supporting 140.4(k)4
     Multifamily: 160.3(d)11"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND. 
        Status <> "Existing" .AND.
        IfValidAnd ( IsHlthCareSys < 1 ) .AND.
        ( Type = "HotWater" .OR. Type = "ChilledWater" ) )
    then
      if ( ( IfValidAnd( ClgCap >= 500000 ) .OR.
          IfValidAnd( HtgCap >= 500000 ) ) .AND.
        ( FluidSys:TempCtrl = "Scheduled" .OR.
          FluidSys:TempCtrl = "OutsideAirReset" .OR.
          FluidSys:TempCtrl = "WetBulbReset" .OR.
          FluidSys:TempCtrl = "FixedDualSetpoint" ) )
      then 1
      else 0
      endif
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch09A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch10A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System is a hydronic system with variable speed pumps. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)7 supporting 140.4(k)6
     Multifamily: 160.3(d)1G"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Status <> "Existing" .AND.
        IfValidAnd ( IsHlthCareSys < 1 ) .AND.
        CHWHWPumpVarSpdFlag > 0 .OR. CWPumpVarSpdFlag > 0  )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch10A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch11A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: Systems with Direct Digital Controls (DDC) to the zone level and EMCS. 
     If utilizing JA5 thermostats with DDC, use NRCA-MCH-03 instead of this test. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)10 supporting 110.12(b), 120.2(h), 120.2(j)
     Multifamily: 160.3(d)1J"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Status <> "Existing" .AND.
        IfValidAnd( IsHlthCareSys < 1 ) .AND.
        IfValidAnd( CtrlType = "DDC" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch15A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System includes thermal energy storage in conjunction with
     chilled water air conditioning system. Healthcare facilities are exempt from test.  


     Nonres: 120.5(a)14
     Multifamily: 160.3(d)1N"
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Type = "ChilledWater" .AND.
        ( Status <> "Existing" ) .AND.
        IfValidAnd ( IsHlthCareSys < 1 ) .AND.
        SumChildren( ThrmlEngyStor:IsNew ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch15A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

//-----------------------------------------------------------------------------



// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch17A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System is a water-cooled chiller seved by cooling towers that utilizes 
     condenser water temp reset controls. Healthcare failities are exempt from test. 


     Nonres:  120.5(a)16
     Multifamily: 160.0(d)1P "
  INPUTCLASS
    Default
  DEFAULT
    if( ( Proj:CompPathMech = "Performance" .OR. Proj:ResCompPathMech = "Performance" ) .AND.
        Type = "CondenserWater" .AND.
        ( Status <> "Existing" ) .AND.
        IfValidAnd ( IsHlthCareSys < 1 ) .AND.
        ( TempCtrl = "Scheduled" .OR.
          TempCtrl = "OutsideAirReset" .OR.
          TempCtrl = "WetBulbReset" .OR.
          TempCtrl = "FixedDualSetpoint" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch17A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch18A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  HELP
    "Trigger: System control is an Energy Management Control System (EMCS). 
     Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)17 supporting 110.12
     Multifamily: 160.3(d)10"
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIEnvE
  DESCRIPTION
    "Certificate of installation - Envelope"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathEnv = "Performance" .OR. ResCompPathEnv = "Performance")
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIEnv01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathEnv = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW FenCons:IsNFRCRtd
  DATATYPE
    Integer
  LONGFORM
    IsNFRCRated
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( FenCons:CertificationMthd = "NFRCRated" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW FenCons:IsDefRtd
  DATATYPE
    Integer
  LONGFORM
    IsNFRCRated
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( FenCons:CertificationMthd = "DefaultPerformance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ResZnGrp:IsWinNew
  DATATYPE
    Integer
  LONGFORM
    IsWindowNew
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( SumChildrenIf( ResWin:IsNew, ResWin:Status <> "Existing" ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCAEnv02F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathEnv = "Performance" )
    then 
       if ( SumChildrenIf( FenCons:IsNFRCRtd, FenCons:Status <> "Existing" ) > 0 .OR.
            SumChildrenIf( FenCons:IsDefRtd, FenCons:Status <> "Existing" ) > 0 )
       then 1
       else 0
       endif
    else 
      if ( ResCompPathEnv = "Performance" .AND.
           SumChildren( ResZnGrp:IsWinNew ) > 0 )
      then 1 
      else 0
      endif
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW ResZnGrp:IsWinClerestory
  DATATYPE
    Integer
  LONGFORM
    IsWindowNew
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( SumChildrenIf( ResWin:IsClerestory, ResWin:Status <> "Existing" ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAEnv03F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathEnv = "Performance" )
    then 
       if ( SumChildren( Win:IsClerestory ) > 0 .OR.
            SumChildren( IntLtgSys:HasDayltgDevice ) > 0 ) 
       then 1
       else 0
       endif
    else 
      if ( ResCompPathEnv = "Performance" )
      then
        if ( SumChildren( ResZnGrp:IsWinClerestory ) > 0 .OR.
             SumChildren( IntLtgSys:HasDayltgDevice ) > 0 ) 
        then 1
        else 0
        endif
      else 0
      endif
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILtiE
  DESCRIPTION
    "Certificate of installation - Lighting"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .OR. ResCompPathLtg = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:HasDayltgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDaylightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( DayltgCtrlType = "Continuous" .OR.
        DayltgCtrlType = "ContinuousPlusOff" .OR.
        DayltgCtrlType = "SteppedSwitching" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasLtgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasLightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-1to125SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-126to250SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-251to500SF" .OR.
        IntLtgSys:PAFCredType[1] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[1] = "DemandResponsiveControl" .OR. 
        IntLtgSys:PAFCredType[1] = "Clerestories" .OR. 
        IntLtgSys:PAFCredType[1] = "HorizontalSlats" .OR. 
        IntLtgSys:PAFCredType[1] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[2] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[2] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[2] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[2] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[2] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[2] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[3] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[3] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[3] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[3] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[3] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[3] = "LightShelves" )
    then 1  
    else if( IntLtgSys:PAFCredType[4] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[4] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[4] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[4] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[4] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[4] = "LightShelves" )             
    then 1
    else if( IntLtgSys:PAFCredType[5] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[5] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[5] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[5] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[5] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[5] = "LightShelves" )   
    then 1
    else 0
    endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasDayltgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDaylightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DaylightDimmingPlusOff" .OR. 
        IntLtgSys:PAFCredType[2] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[3] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[4] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[5] = "DaylightDimmingPlusOff" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasDayltgDevice
  DATATYPE
    Integer
  LONGFORM
    HasDaylightDevice
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "Clerestories" .OR. 
        IntLtgSys:PAFCredType[1] = "HorizontalSlats" .OR. 
        IntLtgSys:PAFCredType[1] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[2] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[2] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[2] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[3] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[3] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[3] = "LightShelves" )
    then 1  
    else if( IntLtgSys:PAFCredType[4] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[4] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[4] = "LightShelves" )             
    then 1
    else if( IntLtgSys:PAFCredType[5] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[5] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[5] = "LightShelves" )   
    then 1
    else 0
    endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasOccSensorCtrls
  DATATYPE
    Integer
  LONGFORM
    HasOccupantSensorControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "OccupantSensingControls-1to125SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-126to250SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[2] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[2] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[2] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[3] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[3] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[3] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[4] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[4] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[4] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[5] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[5] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[5] = "OccupantSensingControls-251to500SF" )
    then 1                
    else 0
    endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasDemandResponseCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDemandResponsiveControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[2] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[3] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[4] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[5] = "DemandResponsiveControl" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasInstitutionalTuning
  DATATYPE
    Integer
  LONGFORM
    HasInstitutionalTuning
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "InstitutionalTuning" .OR. 
        IntLtgSys:PAFCredType[2] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[3] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[4] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[5] = "InstitutionalTuning" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti04E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti05E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( IntLtgSys:HasLtgCtrls ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsVideoconferencingStudio
  DATATYPE
    Integer
  LONGFORM
    IsVideoconferencingStudio
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( SpcFunc = "Videoconferencing Studio" )
    then 1
    else 0
    endif
ENDRULE

// ------------------------------------------------------------------------------
RULE NEW IntLtgSys:HasVideoConfAllow
  DATATYPE
    Integer
  LONGFORM
    HasVideoConferencingAllowance
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IntLtgSys:AllowType = "VideoconferencingStudioLighting" )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCILti06E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( Spc:IsVideoconferencingStudio ) > 0 .AND. 
        SumChildren( IntLtgSys:HasVideoConfAllow ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND. 
        ( SumChildren( Win:Area ) > 0 .OR.
          SumChildren( Skylt:Area ) > 0 .OR.
          SumChildren( Spc:HasDayltgCtrls ) > 0  ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti04A  // 
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND.
        ( SumChildren( Bldg:NonResFlrArea ) > 10000 .OR. 
          SumChildren( IntLtgSys:HasDemandResponseCtrls ) > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( IntLtgSys:HasInstitutionalTuning ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIMchE
  DESCRIPTION
    "Certificate of installation - Mechanical"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathMech = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIMch01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathMech = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch02A ) + 
    SumChildren(  ZnSys:NRCAMch02A ) + 
    SumChildren( VRFSys:NRCAMch02A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch03A ) + 
    SumChildren(  ZnSys:NRCAMch03A ) + 
    SumChildren( VRFSys:NRCAMch03A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch04H ) + 
    SumChildren(  ZnSys:NRCAMch04H ) + 
    SumChildren( VRFSys:NRCAMch04H )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildrenIf( AirSys:NRCAMch05A, AirSys:Status <> "Existing" ) + 
    SumChildrenIf( ZnSys:NRCAMch05A, ZnSys:Status <> "Existing" ) + 
    SumChildrenIf( VRFSys:NRCAMch05A, VRFSys:Status <> "Existing" )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch06A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch06A ) + 
    SumChildren(  ZnSys:NRCAMch06A ) + 
    SumChildren( VRFSys:NRCAMch06A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch07A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch07A ) + 
    SumChildren(  ZnSys:NRCAMch07A ) + 
    SumChildren( VRFSys:NRCAMch07A )
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch11A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch11A ) + 
    SumChildren(  ZnSys:NRCAMch11A ) + 
    SumChildren( VRFSys:NRCAMch11A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch12A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch12A ) + 
    SumChildren(  ZnSys:NRCAMch12A ) + 
    SumChildren( VRFSys:NRCAMch12A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch13A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch13A ) + 
    SumChildren(  ZnSys:NRCAMch13A ) + 
    SumChildren( VRFSys:NRCAMch13A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch14A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch14A ) + 
    SumChildren(  ZnSys:NRCAMch14A ) + 
    SumChildren( VRFSys:NRCAMch14A )
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch16A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch16A ) + 
    SumChildren(  ZnSys:NRCAMch16A ) + 
    SumChildren( VRFSys:NRCAMch16A )
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch18A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch18A ) + 
    SumChildren(  ZnSys:NRCAMch18A ) + 
    SumChildren( VRFSys:NRCAMch18A )
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch19A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch19A ) + 
    SumChildren(  ZnSys:NRCAMch19A ) + 
    SumChildren( VRFSys:NRCAMch19A )
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: System provides outside air (OA). Healthcare facilites are exempt from this test. 

		 Nonresidential: 120.5(a)1 supporting 120.1(c)3

     Multifamily: 160.3(d)1A"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch02A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch02A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: System is constant volume, single zone AC or heat pump system 
		 (packaged or split)  with JA5 thermostat zonal controls. If EMCS controls 
		 are used instead of JA5 thermostat, use NRCA-MCH-11 instead of this test. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)2 supporting 120.2

     Multifamily: 160.3(d)1B"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch03A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch03A > 0 ) ) 
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: Entirely new ducts or new ducts in an existing building
		 where more than 75% of ducts replaced when part of a constant 
		 volume, single zone HVAC system serving less than 5,000 sf. 
		 More than 25% of the ducts are located outdoors or in unconditioned
		 space, including under a roof that has a U-factor less then the 
		 U-factor of the ceiling. Healthcare facilities are exempt from this test.


		 Nonres: 120.5(a)3 supporting 120.4(g); 141.0(b)2D

     Multifamily: 160.3(d)1C"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch04H ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch04H > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: System has an economizer. Healthcare facilites are exempt from this test. 


		 Nonres: 120.5(a)4 supporting 140.4(e)

     Multifamily: 160.3(d)1D"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch05A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch05A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch06A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: System utilizes Demand Control Ventilation (DCV) controls. DCV is 
     required for high occupancy spaces (25 people per 1,000sf) with at least one of 
     the following: economizer, modulating OA control, or a design OA rate of 3,000 cfm
     or more. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)5 supporting 120.1(d)3
     Multifamily: 16.2(c)5C through E"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch06A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch06A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch07A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
		"Trigger: VAV space conditioning system supply fans modulate airflow. 
		 Healthcare facilites are exempt from this test.


		 Nonres: 120.5(a)6 supporting 140.4(c)
		 Multifamily: 160.3(d)1F"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch07A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch07A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch08A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System is a hydronic  with more than 1 boiler or chiller that require
     isolation controls. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)8 supporting 120.5(a)8; 140.4(k)2&3
     Multifamily: 160.3(d)G supporting 160.3(d)1H; 170.2(c)4I"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch08A ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch09A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System is hydronic with a boiler or chiller design capacity 
     exceeding 500,000 Btu/hr. Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)9 supporting 140.4(k)4
     Multifamily: 160.3(d)11"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch09A ) .OR.
        IfValidAnd( ResProj:NRCAMch09A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch10A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System is a hydronic system with variable speed pumps. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)7 supporting 140.4(k)6
     Multifamily: 160.3(d)1G"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch10A ) .OR.
        IfValidAnd( ResProj:NRCAMch10A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch11A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Systems with Direct Digital Controls (DDC) to the zone level and EMCS. 
     If utilizing JA5 thermostats with DDC, use NRCA-MCH-03 instead of this test. 
     Healthcare facilites are exempt from this test. 


     Nonres: 120.5(a)10 supporting 110.12(b), 120.2(h), 120.2(j)
     Multifamily: 160.3(d)1J"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( ( SumChildren( FluidSys:NRCAMch11A ) + 
        SumChildren( Bldg:NRCAMch11A ) > 0 ) .OR. 
        IfValidAnd( ResProj:NRCAMch11A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch12A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Equipment is a packaged Direct Expansion (DX) with 33,000 Bth/hr 
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD)
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)11 supporting 120.2(i)
     Multifamily: 160.3(d)1K"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch12A ) > 0 .OR.
        IfValidAnd( ResProj:NRCAMch12A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch13A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Equipment is an air handler or zonal terminal unit with 33,000 Bth/hr
     of cooling capacity, an economizer, and fault detection and diagnostic (FDD) 
     system. Healthcare facilites are exempt from this test.


     Nonres: 120.5(a)12 supporting 120.2(i)
     Multifamily: 160.3(d)1L"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch13A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch13A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch14A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Equipment is a constant or variable volume Direct Expansion (DX) 
     air conditioning system with distributed energy storage (DES/DXAC). 
     Healthcare facilities are exempt from this test. 


     Nonres: 120.5(a)13
     Multifamily: 160.3(d)1M"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"

  DEFAULT
    if( SumChildren( Bldg:NRCAMch14A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch14A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch15A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System includes thermal energy storage in conjunction with
     chilled water air conditioning system. Healthcare facilities are exempt from test.  


     Nonres: 120.5(a)14
     Multifamily: 160.3(d)1N"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch15A ) .OR.
        IfValidAnd( ResProj:NRCAMch15A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch16A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Equipment is a multizone system that with automatic supply air 
     temperature reset controls. Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)15 supporting  140.4(f)
     Multifamily: 160.3(d)1O"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch16A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch16A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch17A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System is a water-cooled chiller seved by cooling towers that utilizes 
     condenser water temp reset controls. Healthcare failities are exempt from test. 


     Nonres:  120.5(a)16
     Multifamily: 160.0(d)1P "
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch17A ) .OR.
        IfValidAnd( ResProj:NRCAMch17A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch18A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System control is an Energy Management Control System (EMCS). 
     Healthcare facilities are exempt from test. 


     Nonres: 120.5(a)17 supporting 110.12
     Multifamily: 160.3(d)10"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( ( SumChildren( FluidSys:NRCAMch18A ) + 
        SumChildren( Bldg:NRCAMch18A ) > 0 ) .OR. 
        IfValidAnd( ResProj:NRCAMch18A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch19A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: System has occupant sensor ventilation control that turns off ventilation
     air when a space is unoccupied. Healthcare facilities are exempt from test.


     Nonres: 120.5(a)18 supporting 120.2(e)3; Table 120.1-A
     Multifamily: 160.3(d)1R "
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( Bldg:NRCAMch19A ) > 0 .OR. 
        IfValidAnd( ResProj:NRCAMch19A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch20H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Multifamily dwelling unit ventilation equipment serving individual 
     dwelling units for IAQ ventilation and local mechanical exhaust requirements 
     in a building with 4 or more habitable stories.  


     Nonres: N/A
     Multifamily: 160.2(b)2 "
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2022 ver 3.0 to 3.1)"
  DEFAULT : T24N
    if( IfValidAnd( ResProj:NRCAMch20H > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch21H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Multifamily dwelling unit ventilation system is not a balanced system. 
     Supply and exhaust CFMs must be within 10% of each other to be considered 
     balanced for buildings with 4 or more habitable stories.


     Nonres: N/A
     Multifamily: 160.2(b)2ivb2"
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2022 ver 3.0 to 3.1)"
  DEFAULT : T24N
    if( IfValidAnd( ResProj:NRCAMch21A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch22A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Multifamily dwelling unit ventilation provided by central ventilation
     system for buildings with 4 or more habitable stories.


     Nonres: N/A
     Multifamily: 160.2(b)2C & 160.2(b)2v"
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IfValidAnd( ResProj:NRCAMch22A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch23A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  HELP
    "Trigger: Multifamily dwelling unit ventilation provided by a central HRV 
     or ERV system for buildings with 4 or more habitable stories.


     Nonres: N/A
     Multifamily: 160.2(b)2Av & 170.2(c)3Bvb"
  INPUTCLASS
    NotInput
  DEFAULT : T24N
    if( IfValidAnd( ResProj:NRCAMch23A > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. Proj:NRCAMch04H = 1 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVMch24H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. Proj:ExcptCondHERSEnvAirLkge = "Yes" )
    then 1
    else 0
    endif
ENDRULE




// -----------------------------------------------------------------------------
RULE Proj:NRCVMch27H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. ( Proj:NRCAMch02A = 1 .OR. Proj:NRCAMch20H = 1  ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVMch32H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND.
        ( SumChildren( AirSys:IsExhSys ) > 0 .OR.
          SumChildren( ZnSys:IsExhSys ) > 0  ) )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPlbE
  DESCRIPTION
    "Certificate of installation - Plumbing"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
		if( Proj:CompOptDHW = 1 )
		then 1
		else 0
		endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:HighRiseResLivingUnitCnt
  LONGFORM
    HighRiseResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:HighRiseResLivingUnitCnt ) 
ENDRULE

RULE NEW Proj:LowRiseResLivingUnitCnt
  LONGFORM
    LowRiseResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:LowRiseResLivingUnitCnt ) 
ENDRULE

RULE NEW Proj:ResLivingUnitCnt
  LONGFORM
    ResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:ResLivingUnitCnt ) 
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:HotelMotelGuestRmCnt
  LONGFORM
    HotelMotelGuestRoomCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:HotelMotelGuestRmCnt ) 
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWSysIsCentral
  LONGFORM
    ResidentialDomesticHotWaterSystemIsCentral
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. SumChildrenIf( ResDHWSys:CentralDHW, ResDHWSys:Status = "New" ) > 0 )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ResDHWSys:ResDHWSysIsIndividual
  LONGFORM
    ResidentialDomesticHotWaterSystemIsIndividual
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. IfValidAnd( ResDHWSys:CentralDHW = 0 ) )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWSysIsIndividual
  LONGFORM
    ResidentialDomesticHotWaterSystemIsIndividual
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. SumChildrenIf( ResDHWSys:ResDHWSysIsIndividual, ResDHWSys:Status = "New" ) > 0 )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND. 
       Proj:ResDHWSysIsCentral > 0  )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb03E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0  )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWHERSChk
  LONGFORM
    ResidentialDomesticHotWaterHeatingHERSCheck
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. 
        ( Proj:ExcptCondHERSResDHWSysPipeIns = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysParallelPiping = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysRecircDemCtrlPushButton = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysRecircDemCtrlOccSensor = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysCompactDistSys = "Yes" .OR.
          Proj:ExcptCondHERSDrainWtrHtRcvrySys = "Yes" ) )
    then 1 
    else 0
    endif
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb21E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsCentral > 0 .AND. Proj:ResDHWHERSChk = 1 )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb22E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0 .AND. Proj:ResDHWHERSChk = 1)
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCVPlb21H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsCentral > 0 .AND. Proj:ResDHWHERSChk = 1  )
   then 1
   else 0
   endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVPlb22H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0 .AND. Proj:ResDHWHERSChk = 1  )
   then 1
   else 0
   endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISabE
  DESCRIPTION
    "Certificate of installation - Solar Hot Water Heating, PV and Battery"
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    if( Proj:SolThrmlComp = "Performance" .OR. 
        Proj:PVComp = "Performance" .OR.
        Proj:BattComp = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISth01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( Proj:SolThrmlComp = "Performance" )
    then 1
    else 0
    endif
 DEFAULT : T24N
   UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIElc01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISpv01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILto01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILto02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALto02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILts01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc01F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc02F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( Proj:CompPathKit = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc03F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( Proj:ParkingGarageMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc04F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc05F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc06F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc07F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc08F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc12F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  PREVIOUSNAMES
    NRCAPrc12
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( Proj:ElevLtgVentMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc13F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  PREVIOUSNAMES
    NRCAPrc13
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( Proj:EscalSpdCtrlMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc14F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N
    if( Proj:CompPathLab = "Performance" )
    then 1
    else 0
    endif
ENDRULE




// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc15F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( Proj:CompPathMech = "Performance" .AND.
        SumChildrenIf( Spc:LabFumeHoodVertAutoSashCtrlFrac, Spc:SpcFunc = "Scientific Laboratory Area" ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( Proj:CompPathMech = "Performance" .AND.
        SumChildrenIf( Spc:LabFumeHoodVertAutoSashCtrlFrac, Spc:SpcFunc = "Laboratory, Scientific" ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPrc01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( NRCAPrc02F = 1 .OR. NRCAPrc14F = 1 .OR. NRCAPrc15F = 1 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE


// TotStaticPress, for reporting
RULE Fan:TotStaticPressRpt
  DESCRIPTION
    "The fan total static pressure used for reporting."
  INPUTCLASS
    NotInput
  REPORTPRECISION
    3  
  ANNUAL
    if( IfValidAnd( ParentComp = "AirSys" ) )
    then
      if( AirSys:IsPropSys > 0 .AND. AirSeg:Type = "Relief" )
      then // Report user value for relief fans since they are modeled w/ 0 power. See Ticket 2843
        ValidOr( u:TotStaticPress, 0 ) 
      else TotStaticPress
      endif 
    else TotStaticPress
    endif
ENDRULE


// ----------------------------------------------------------------------------------------------------
// ************ Reporting rules for aggregating system names for NRCA Mch forms for Table M ***********

// NRCAMchSysList[1] - NRCAMch02A AirSys
// NRCAMchSysList[2] - NRCAMch02A ZnSys
// NRCAMchSysList[3] - NRCAMch02A VRFSys
// NRCAMchSysList[4] - NRCAMch03A AirSys
// NRCAMchSysList[5] - NRCAMch03A ZnSys    
// NRCAMchSysList[6] - NRCAMch03A VRFSys   
// NRCAMchSysList[7] - NRCAMch04H AirSys
// NRCAMchSysList[8] - NRCAMch04H ZnSys 
// NRCAMchSysList[9] - NRCAMch04H VRFSys
// NRCAMchSysList[10] - NRCAMch05A AirSys
// NRCAMchSysList[11] - NRCAMch05A ZnSys 
// NRCAMchSysList[12] - NRCAMch05A VRFSys
// NRCAMchSysList[13] - NRCAMch06A AirSys
// NRCAMchSysList[14] - NRCAMch06A ZnSys 
// NRCAMchSysList[15] - NRCAMch06A VRFSys
// NRCAMchSysList[16] - NRCAMch07A AirSys
// NRCAMchSysList[17] - NRCAMch07A ZnSys 
// NRCAMchSysList[18] - NRCAMch07A VRFSys
// NRCAMchSysList[19] - NRCAMch08A FluidSys
// NRCAMchSysList[20] - NRCAMch09A FluidSys
// NRCAMchSysList[21] - NRCAMch10A FluidSys
// NRCAMchSysList[22] - NRCAMch11A AirSys 
// NRCAMchSysList[23] - NRCAMch11A ZnSys  
// NRCAMchSysList[24] - NRCAMch11A VRFSys 
// NRCAMchSysList[25] - NRCAMch11A FluidSys
// NRCAMchSysList[26] - NRCAMch12A AirSys 
// NRCAMchSysList[27] - NRCAMch12A ZnSys  
// NRCAMchSysList[28] - NRCAMch12A VRFSys 
// NRCAMchSysList[29] - NRCAMch13A AirSys
// NRCAMchSysList[30] - NRCAMch13A ZnSys 
// NRCAMchSysList[31] - NRCAMch13A VRFSys
// NRCAMchSysList[32] - NRCAMch14A AirSys
// NRCAMchSysList[33] - NRCAMch14A ZnSys 
// NRCAMchSysList[34] - NRCAMch14A VRFSys
// NRCAMchSysList[35] - NRCAMch15A FluidSys  
// NRCAMchSysList[36] - NRCAMch16A AirSys
// NRCAMchSysList[37] - NRCAMch16A ZnSys 
// NRCAMchSysList[38] - NRCAMch16A VRFSys
// NRCAMchSysList[39] - NRCAMch17A FluidSys  
// NRCAMchSysList[40] - NRCAMch18A AirSys
// NRCAMchSysList[41] - NRCAMch18A ZnSys 
// NRCAMchSysList[42] - NRCAMch18A VRFSys
// NRCAMchSysList[43] - NRCAMch18A FluidSys  
// NRCAMchSysList[44] - NRCAMch19A AirSys
// NRCAMchSysList[45] - NRCAMch19A ZnSys 
// NRCAMchSysList[46] - NRCAMch19A VRFSys


RULE Proj:NRCAMchSysList[1]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 02A form"
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch02A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch02A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
   endif
ENDRULE

RULE Proj:NRCAMchSysList[2]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 02A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch02A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch02A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[3]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 02A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch02A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch02A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[4]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 03A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch03A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch03A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[5]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 03A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch03A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch03A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[6]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 03A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch03A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch03A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[7]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 04H form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch04H) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch04H = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[8]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 04H form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch04H) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch04H = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[9]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 04H form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch04H) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch04H = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[10]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 05A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch05A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch05A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[11]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 05A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch05A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch05A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[12]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 05A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch05A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch05A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[13]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 06A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch06A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch06A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[14]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 06A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch06A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch06A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[15]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 06A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch06A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch06A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[16]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 07A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch07A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch07A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[17]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 07A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch07A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch07A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[18]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 07A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch07A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch07A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[19]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 08A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch08A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch08A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[20]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 09A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch09A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch09A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[21]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 10A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch10A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch10A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[22]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 11A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch11A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch11A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[23]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 11A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch11A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch11A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[24]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 11A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch11A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch11A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[25]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 11A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch11A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch11A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[26]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 12A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch12A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch12A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[27]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 12A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch12A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch12A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[28]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 12A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch12A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch12A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[29]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 13A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch13A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch13A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[30]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 13A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch13A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch13A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[31]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 13A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch13A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch13A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[32]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 14A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch14A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch14A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[33]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 14A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch14A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch14A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[34]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 14A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch14A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch14A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[35]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 15A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch15A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch15A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[36]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 16A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch16A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch16A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[37]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 16A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch16A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch16A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[38]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 16A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch16A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch16A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[39]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 17A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch17A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch17A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[40]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 18A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch18A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch18A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[41]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 18A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch18A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch18A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[42]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 18A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch18A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch18A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[43]
  DESCRIPTION
    "List of FluidSys systems which trigger the NRCA Mch 18A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( FluidSys:NRCAMch18A) > 0 )
   then
      ListRevRefIf( FluidSys:ProjRef, FluidSys:NRCAMch18A = 1, "%s", ", %s", " and %s.", FluidSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[44]
  DESCRIPTION
    "List of AirSys systems which trigger the NRCA Mch 19A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( AirSys:NRCAMch19A) > 0 )
   then
      ListRevRefIf( AirSys:ProjRef, AirSys:NRCAMch19A = 1, "%s", ", %s", " and %s.", AirSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[45]
  DESCRIPTION
    "List of ZnSys systems which trigger the NRCA Mch 19A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( ZnSys:NRCAMch19A) > 0 )
   then
      ListRevRefIf( ZnSys:ProjRef, ZnSys:NRCAMch19A = 1, "%s", ", %s", " and %s.", ZnSys:Name )
   else
      UNDEFINED
    endif
ENDRULE

RULE Proj:NRCAMchSysList[46]
  DESCRIPTION
    "List of VRFSys systems which trigger the NRCA Mch 19A form"
  INPUTCLASS
    NotInput
  DEFAULT
    if ( SumChildren( VRFSys:NRCAMch19A) > 0 )
   then
      ListRevRefIf( VRFSys:ProjRef, VRFSys:NRCAMch19A = 1, "%s", ", %s", " and %s.", VRFSys:Name )
   else
      UNDEFINED
    endif
ENDRULE



