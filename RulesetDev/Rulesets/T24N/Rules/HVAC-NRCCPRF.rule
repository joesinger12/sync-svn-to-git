// HVAC - NRCCPRF XML (section H*)
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2021, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------


; nrccSection_HvacDry nrccTableHvacDry 
RULE NEW AirSys:nrcctblRowHvacDryRef
  DATATYPE
    nrcctblRowHvacDry
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacDry:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowHvacDry:Parent
  ANNUAL_PROPOSED
    nrccTableHvacDry:Name
ENDRULE

; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
; nrccHvacDry06b
RULE NEW AirSys:nrccHvacDry06bRef
  DATATYPE
    nrccHvacDry06b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06b:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_AirSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry06c
RULE NEW AirSys:nrccHvacDry06cRef
  DATATYPE
    nrccHvacDry06c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06c:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrccHvacDry06bRef)) then noXMLoutput_AirSysRef:nrccHvacDry06bRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08b
RULE NEW AirSys:nrccHvacDry08bRef
  DATATYPE
    nrccHvacDry08b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08b:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_AirSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08c
RULE NEW AirSys:nrccHvacDry08cRef
  DATATYPE
    nrccHvacDry08c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08c:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrccHvacDry08bRef)) then noXMLoutput_AirSysRef:nrccHvacDry08bRef:Name
    else UNCHANGED
    endif
ENDRULE


RULE NEW ZnSys:nrcctblRowHvacDryRef
  DATATYPE
    nrcctblRowHvacDry
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacDry:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE

; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
; nrccHvacDry06b
RULE NEW ZnSys:nrccHvacDry06bRef
  DATATYPE
    nrccHvacDry06b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06b:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_ZnSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry06c
RULE NEW ZnSys:nrccHvacDry06cRef
  DATATYPE
    nrccHvacDry06c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06c:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrccHvacDry06bRef)) then noXMLoutput_ZnSysRef:nrccHvacDry06bRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08b
RULE NEW ZnSys:nrccHvacDry08bRef
  DATATYPE
    nrccHvacDry08b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08b:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_ZnSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08c
RULE NEW ZnSys:nrccHvacDry08cRef
  DATATYPE
    nrccHvacDry08c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08c:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrccHvacDry08bRef)) then noXMLoutput_ZnSysRef:nrccHvacDry08bRef:Name
    else UNCHANGED
    endif
ENDRULE


RULE NEW VRFSys:nrcctblRowHvacDryRef
  DATATYPE
    nrcctblRowHvacDry
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacDry:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE

; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
; nrccHvacDry06b
RULE NEW VRFSys:nrccHvacDry06bRef
  DATATYPE
    nrccHvacDry06b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06b:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_VRFSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry06c
RULE NEW VRFSys:nrccHvacDry06cRef
  DATATYPE
    nrccHvacDry06c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry06c:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry06c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrccHvacDry06bRef)) then noXMLoutput_VRFSysRef:nrccHvacDry06bRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08b
RULE NEW VRFSys:nrccHvacDry08bRef
  DATATYPE
    nrccHvacDry08b
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08b:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08b:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrcctblRowHvacDryRef)) then noXMLoutput_VRFSysRef:nrcctblRowHvacDryRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacDry08c
RULE NEW VRFSys:nrccHvacDry08cRef
  DATATYPE
    nrccHvacDry08c
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacDry08c:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacDry08c:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrccHvacDry08bRef)) then noXMLoutput_VRFSysRef:nrccHvacDry08bRef:Name
    else UNCHANGED
    endif
ENDRULE




RULE nrcctblRowHvacDry:HvacDry01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then noXMLoutput_VRFSysRef:Name
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry02_AirSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry02_ZoneSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Type
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then "VRF"
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry02a_AirSubType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef))
    then
        switch (noXMLoutput_AirSysRef:SubType)
            case "Packaged3Phase" : "SinglePackaged3Phase"
            case "Packaged1Phase" : "SinglePackaged1Phase"
            case "Split3Phase"    : "Split3Phase"
            case "Split1Phase"    : "Split1Phase"
            case "CRAC"           : "CRAC"
            case "CRAH"           : "CRAH"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry02a_ZoneSubType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef))
    then 
        if (IfValidAnd( noXMLoutput_ZnSysRef:Type = "VRF" )==0) 
        then
            switch (noXMLoutput_ZnSysRef:SubType)
                case "Packaged3Phase" : "SinglePackaged3Phase"
                case "Packaged1Phase" : "SinglePackaged1Phase"
                case "Split3Phase"    : "Split3Phase"
                case "Split1Phase"    : "Split1Phase"
                case "Wall"           : "Wall"
                case "Floor"          : "Floor"
                case "Room"           : "Room"
                case "Other"          : "Other"
                case "Embedded"       : "Embedded"
                case "Panel"          : "Panel"
                default :  UNDEFINED
            endswitch
        else UNDEFINED
        endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry03_HvacEquipmentCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Cnt
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Cnt
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then noXMLoutput_VRFSysRef:Cnt
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry04_HeatingDesignCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:HtgCap / 1000 ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:HtgCap / 1000 ) )
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then atof( Format( "%.2f", noXMLoutput_VRFSysRef:HtgCapNetRtd / 1000 ) )
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry05_HeatingSupplementalCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:SuppHtgCap / 1000 ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef))
         then
            if (IfValidAnd( noXMLoutput_ZnSysRef:Type = "VRF" )==0) 
            then atof( Format( "%.2f", noXMLoutput_ZnSysRef:SuppHtgCap / 1000 ) )
            else UNDEFINED
            endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacDry05_HeatingSupplementalCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; RJH 20230701 Added "HSPF/COP" and "HSPF2/COP" per GH Issue #83
RULE nrcctblRowHvacDry:HvacDry06a_EfficiencyType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt != "NA") 
                                                       then switch (noXMLoutput_AirSysRef:HtgEffUnitRpt)
                                                                case "AFUE" : "AFUE"
                                                                case "COP"  : "COP"
                                                                case "HSPF" : "HSPF"
                                                                case "HSPF2" : "HSPF2"
                                                                case "ThrmlEff" : "ThermalEfficiency"
                                                                case "HSPF/COP" : "COP"
                                                                case "HSPF2/COP" : "COP"
                                                                default :  UNDEFINED
                                                            endswitch
                                                       else UNDEFINED 
                                                       endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt != "NA")
                                                           then switch (noXMLoutput_ZnSysRef:HtgEffUnitRpt)
                                                                    case "AFUE" : "AFUE"
                                                                    case "COP"  : "COP"
                                                                    case "HSPF" : "HSPF"
                                                                    case "HSPF2" : "HSPF2"
                                                                    case "ThrmlEff" : "ThermalEfficiency"
                                                                    case "HSPF/COP" : "COP"
                                                                    case "HSPF2/COP" : "COP"
                                                                    default :  UNDEFINED
                                                                endswitch
                                                           else UNDEFINED 
                                                           endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt != "NA")
                                                            then switch (noXMLoutput_VRFSysRef:HtgEffUnitRpt)
                                                                    case "AFUE" : "AFUE"
                                                                    case "COP"  : "COP"
                                                                    case "HSPF" : "HSPF"
                                                                    case "HSPF2" : "HSPF2"
                                                                    case "ThrmlEff" : "ThermalEfficiency"
                                                                    case "HSPF/COP" : "COP"
                                                                    case "HSPF2/COP" : "COP"
                                                                    default :  UNDEFINED
                                                                 endswitch
                                                            else UNDEFINED 
                                                            endif
    else UNDEFINED
    endif endif endif
ENDRULE
; RJH 20230701 Added "HSPF/COP" and "HSPF2/COP" per GH Issue #83
RULE nrcctblRowHvacDry:HvacDry06a_EfficiencyType[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt != "NA") 
                                                       then switch (noXMLoutput_AirSysRef:HtgEffUnitRpt)
                                                                case "HSPF/COP" : "HSPF"
                                                                case "HSPF2/COP" : "HSPF2"
                                                                default :  UNDEFINED
                                                            endswitch
                                                       else UNDEFINED 
                                                       endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt != "NA")
                                                           then switch (noXMLoutput_ZnSysRef:HtgEffUnitRpt)
                                                                    case "HSPF/COP" : "HSPF"
                                                                    case "HSPF2/COP" : "HSPF2"
                                                                    default :  UNDEFINED
                                                                endswitch
                                                           else UNDEFINED 
                                                           endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt != "NA")
                                                            then switch (noXMLoutput_VRFSysRef:HtgEffUnitRpt)
                                                                    case "HSPF/COP" : "HSPF"
                                                                    case "HSPF2/COP" : "HSPF2"
                                                                    default :  UNDEFINED
                                                                 endswitch
                                                            else UNDEFINED 
                                                            endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry06a_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacDry06a_EfficiencyType[1] ) > 0 .OR. LocalStatus( HvacDry06a_EfficiencyType[2] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


RULE nrccHvacDry06b:HvacDry06b_EfficiencyAFUE
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "AFUE") then atof( noXMLoutput_AirSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "AFUE") then atof( noXMLoutput_ZnSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "AFUE") then atof( noXMLoutput_VRFSysRef:HtgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry06b:HvacDry06b_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "COP") then atof( noXMLoutput_AirSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "COP") then atof( noXMLoutput_ZnSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "COP") then atof( noXMLoutput_VRFSysRef:HtgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry06b:HvacDry06b_EfficiencyHSPF
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF" .OR. noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF2") then atof( noXMLoutput_AirSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF" .OR. noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF2") then atof( noXMLoutput_ZnSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF" .OR. noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF2") then atof( noXMLoutput_VRFSysRef:HtgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry06b:HvacDry06b_ThermalEfficiency
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "ThrmlEff") then atof( noXMLoutput_AirSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "ThrmlEff") then atof( noXMLoutput_ZnSysRef:HtgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "ThrmlEff") then atof( noXMLoutput_VRFSysRef:HtgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry06b:HvacDry06b_EfficiencyNA
  ANNUAL_PROPOSED
    if (LocalStatus( HvacDry06b_EfficiencyAFUE ) > 0 .OR. LocalStatus( HvacDry06b_EfficiencyCOP ) > 0 .OR. LocalStatus( HvacDry06b_EfficiencyHSPF ) > 0 .OR. LocalStatus( HvacDry06b_ThermalEfficiency ) > 0 )
    then  UNDEFINED  
    else  if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
          then switch (noXMLoutput_AirSysRef:HtgEffRpt)
                    case "NA - See Boiler" : "BoilerNA"
                    case "Elec. Res."      : "ElectricResistanceNA"
                    case "NA"              : "EfficiencyNA"
                    default                : UNDEFINED
               endswitch
          else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
               then switch (noXMLoutput_ZnSysRef:HtgEffRpt)
                        case "NA - See Boiler" : "BoilerNA"
                        case "Elec. Res."      : "ElectricResistanceNA"
                        case "NA"              : "EfficiencyNA"
                        default                : UNDEFINED
                    endswitch
               else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) 
                    then switch (noXMLoutput_VRFSysRef:HtgEffRpt)
                            case "NA - See Boiler" : "BoilerNA"
                            case "Elec. Res."      : "ElectricResistanceNA"
                            case "NA"              : "EfficiencyNA"
                            default                : UNDEFINED
                            endswitch
                    else UNDEFINED
                    endif
               endif
          endif
    endif
ENDRULE



RULE nrccHvacDry06c:HvacDry06c_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_AirSysRef:HtgEffCOPRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_ZnSysRef:HtgEffCOPRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_VRFSysRef:HtgEffCOPRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry06c:HvacDry06c_EfficiencyHSPF
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_AirSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_AirSysRef:HtgEffHSPFRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_ZnSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_ZnSysRef:HtgEffHSPFRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF/COP" .OR. noXMLoutput_VRFSysRef:HtgEffUnitRpt == "HSPF2/COP") then atof( noXMLoutput_VRFSysRef:HtgEffHSPFRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE




RULE nrcctblRowHvacDry:HvacDry07_CoolingSensibleDesignCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:ClgCap / 1000 ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:ClgCap / 1000 ) )
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then atof( Format( "%.2f", noXMLoutput_VRFSysRef:ClgCapNetRtd / 1000 ) )
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry08a_EfficiencyType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then switch (noXMLoutput_AirSysRef:ClgEffUnitRpt)
            case "EER"        : "EER"
            case "SEER/EER"   : "EER"
            case "SEER"       : "SEER"
            case "EER2"       : "EER2"
            case "SEER2/EER2" : "EER2"
            case "SEER2"      : "SEER2"
            default :  UNDEFINED
         endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
         then switch (noXMLoutput_ZnSysRef:ClgEffUnitRpt)
                case "EER"        : "EER"
                case "SEER/EER"   : "EER"
                case "SEER"       : "SEER"
                case "EER2"       : "EER2"
                case "SEER2/EER2" : "EER2"
                case "SEER2"      : "SEER2"
                default :  UNDEFINED
              endswitch
         else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) 
              then switch (noXMLoutput_VRFSysRef:ClgEffUnitRpt)
                    case "EER"        : "EER"
                    case "SEER/EER"   : "EER"
                    case "SEER"       : "SEER"
                    case "EER2"       : "EER2"
                    case "SEER2/EER2" : "EER2"
                    case "SEER2"      : "SEER2"
                    default :  UNDEFINED
                  endswitch
              else UNDEFINED
              endif
         endif
    endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry08a_EfficiencyType[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then switch (noXMLoutput_AirSysRef:ClgEffUnitRpt)
            case "SEER/EER"   : "SEER"
            case "SEER2/EER2" : "SEER2"
            default :  UNDEFINED
         endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
         then switch (noXMLoutput_ZnSysRef:ClgEffUnitRpt)
                case "SEER/EER"   : "SEER"
                case "SEER2/EER2" : "SEER2"
                default :  UNDEFINED
              endswitch
         else if (LocalCompAssigned(noXMLoutput_VRFSysRef))
              then switch (noXMLoutput_VRFSysRef:ClgEffUnitRpt)
                     case "SEER/EER"   : "SEER"
                     case "SEER2/EER2" : "SEER2"
                     default :  UNDEFINED
                   endswitch
              else UNDEFINED
              endif
         endif
    endif
ENDRULE
RULE nrcctblRowHvacDry:HvacDry08a_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacDry08a_EfficiencyType[1] ) > 0 .OR. LocalStatus( HvacDry08a_EfficiencyType[2] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrccHvacDry08b:HvacDry08b_EfficiencyEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:ClgEffUnitRpt == "EER" .OR. noXMLoutput_AirSysRef:ClgEffUnitRpt == "EER2") then atof( noXMLoutput_AirSysRef:ClgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:ClgEffUnitRpt == "EER" .OR. noXMLoutput_ZnSysRef:ClgEffUnitRpt == "EER2") then atof( noXMLoutput_ZnSysRef:ClgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:ClgEffUnitRpt == "EER" .OR. noXMLoutput_VRFSysRef:ClgEffUnitRpt == "EER2") then atof( noXMLoutput_VRFSysRef:ClgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrccHvacDry08b:HvacDry08b_EfficiencySEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER" .OR. noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER2") then atof( noXMLoutput_AirSysRef:ClgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER" .OR. noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER2") then atof( noXMLoutput_ZnSysRef:ClgEffRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER" .OR. noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER2") then atof( noXMLoutput_VRFSysRef:ClgEffRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE

RULE nrccHvacDry08b:HvacDry08b_EfficiencyNA
  ANNUAL_PROPOSED
    if (LocalStatus( HvacDry08b_EfficiencyEER ) > 0 .OR. LocalStatus( HvacDry08b_EfficiencySEER ) > 0)
    then  UNDEFINED  
    else    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER2/EER2") 
                                                               then UNDEFINED else if (noXMLoutput_AirSysRef:ClgEffRpt == "NA - See Chiller") then "ChillerNA" else "EfficiencyNA" endif endif
            else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER2/EER2") 
                                                               then UNDEFINED else if (noXMLoutput_ZnSysRef:ClgEffRpt == "NA - See Chiller") then "ChillerNA" else "EfficiencyNA" endif endif
            else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER2/EER2") 
                                                               then UNDEFINED else if (noXMLoutput_VRFSysRef:ClgEffRpt == "NA - See Chiller") then "ChillerNA" else "EfficiencyNA" endif endif
            else UNDEFINED
            endif endif endif
    endif
ENDRULE

RULE nrccHvacDry08c:HvacDry08c_EfficiencyEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then if (noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER2/EER2") 
         then atof( noXMLoutput_AirSysRef:ClgEffEERRpt ) 
         else UNDEFINED 
         endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
         then if (noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER2/EER2") 
              then atof( noXMLoutput_ZnSysRef:ClgEffEERRpt ) 
              else UNDEFINED 
              endif
         else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) 
              then if (noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER2/EER2") 
                   then atof( noXMLoutput_VRFSysRef:ClgEffEERRpt ) 
                   else UNDEFINED 
                   endif
              else UNDEFINED
              endif
         endif 
    endif
ENDRULE
RULE nrccHvacDry08c:HvacDry08c_EfficiencySEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then if (noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_AirSysRef:ClgEffUnitRpt == "SEER2/EER2") then atof( noXMLoutput_AirSysRef:ClgEffSEERRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_ZnSysRef:ClgEffUnitRpt == "SEER2/EER2") then atof( noXMLoutput_ZnSysRef:ClgEffSEERRpt ) else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER/EER" .OR. noXMLoutput_VRFSysRef:ClgEffUnitRpt == "SEER2/EER2") then atof( noXMLoutput_VRFSysRef:ClgEffSEERRpt ) else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE



RULE nrcctblRowHvacDry:afterchildren_HvacDry09_EconomizerControlMethod
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:EconoCtrlRpt)
            case "No Economizer" : "NoEconomizer"
            case "Fixed Drybulb Economizer" : "FixedDryBulb"
            case "Differential Drybulb Economizer" : "DifferentialDryBulb"
            case "Differential Enthalpy Economizer" : "DifferentialEnthalpy"
            case "Differential Enthalpy and Drybulb Economizer" : "DifferentialDryBulbAndEnthalpy"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacDry:afterchildren_HvacDry09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_HvacDry09_EconomizerControlMethod ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacDry:afterchildren_HvacDry10_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) 
    then
        switch (noXMLoutput_VRFSysRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif endif
ENDRULE






; nrccSection_Hvacdwell nrccTableHvacdwell 
RULE NEW ResSCSysRpt:nrcctblRowHvacdwellRef
  DATATYPE
    nrcctblRowHvacdwell
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacdwell:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowHvacdwell:Parent
  ANNUAL_PROPOSED
    nrccTableHvacdwell:Name
ENDRULE

; nrccHvacdwellCoolEffic
RULE NEW ResSCSysRpt:nrccHvacdwellCoolEfficRef
  DATATYPE
    nrccHvacdwellCoolEffic
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacdwellCoolEffic:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacdwellCoolEffic:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrcctblRowHvacdwellRef)) then noXMLoutput_ResSCSysRptRef:nrcctblRowHvacdwellRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacdwellSingleEffic
RULE NEW ResSCSysRpt:nrccHvacdwellSingleEfficRef
  DATATYPE
    nrccHvacdwellSingleEffic
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacdwellSingleEffic:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacdwellSingleEffic:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef)) then noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacdwellEER_SEER
RULE NEW ResSCSysRpt:nrccHvacdwellEER_SEERRef
  DATATYPE
    nrccHvacdwellEER_SEER
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacdwellEER_SEER:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacdwellEER_SEER:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef)) then noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacdwellCoolEffic_NotApplicable
RULE NEW ResSCSysRpt:nrccHvacdwellCoolEffic_NotApplicableRef
  DATATYPE
    nrccHvacdwellCoolEffic_NotApplicable
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacdwellCoolEffic_NotApplicable:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacdwellCoolEffic_NotApplicable:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef)) then noXMLoutput_ResSCSysRptRef:nrccHvacdwellCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE


RULE nrcctblRowHvacdwell:Hvacdwell01_DwellingUnitName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then noXMLoutput_ResSCSysRptRef:ParentNameRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell02_HvacEquipmentName[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then noXMLoutput_ResSCSysRptRef:HtPumpSystem
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then noXMLoutput_ResSCSysRptRef:HeatSystem
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then ( noXMLoutput_ResSCSysRptRef:CentralHtgClgSystem + " (" + noXMLoutput_ResSCSysRptRef:HeatSysName + ")" )
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then noXMLoutput_ResSCSysRptRef:HeatSysName
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell02_HvacEquipmentName[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
         then noXMLoutput_ResSCSysRptRef:CoolSystem
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE

; RJH 3/10/2023 Added per GH Issue #42
RULE nrcctblRowHvacdwell:Hvacdwell03_ResidentialSpaceConditioningSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then switch( noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt )
            case "Other Heating and Cooling System"     : "HeatingCoolingSystemOther"
            case "Heat Pump Heating and Cooling System" : "HeatPumpHeatingCooling"
            case "Central Heating and Cooling System"   : "VariableOA_VentilationCentralHeatingCooling"
            default  :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell03_ResidentialSpaceConditioningSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; RJH 3/10/2023 Modified per GH Issue #41
RULE nrcctblRowHvacdwell:Hvacdwell03b_ResidentialHeatingSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then switch( noXMLoutput_ResSCSysRptRef:HeatingType )
            case "CntrlFurnace"       : "CentralGasFurnace"
            case "WallFurnaceFan"     : "GasWallFurnace"
            case "Boiler"             : "Boiler"
            case "Electric"           : "Electric"
            case "CombHydro"          : "CombinedHydronic"
            case "WallFurnaceGravity" : "GasWallFurnace"
            case "FloorFurnace"       : "FloorFurnace"
            case "RoomHeater"         : "GasSpaceHeater"
            case "WoodHeat"           : "WoodHeat"
            case "PkgGasFurnace"      : "GasPackagedFurnace"
            case "ElecCombHydro"      : "ElectricCombinedHydronic"
            case "Four-pipe fan coil"        : "FourPipeFanCoil"
            case "Water source heat pump"    : "WaterSourceHeatPump"
            case "Variable refrigerant flow" : "VRF"
            case "SplitHeatPump"             : "CentralSplitHP"
            case "PkgTermHeatPump"           : "PTHP"
            case "SglPkgVertHeatPump"        : "SPVHP"
            case "SDHVSplitHeatPump"         : "SmallDuctHighVelocityHP"
            case "DuctlessMiniSplitHeatPump"         : "DuctlessMiniSplitHP"
            case "DuctlessMultiSplitHeatPump"        : "DuctlessMultiSplitHP"
            case "DuctlessVRFHeatPump"               : "DuctlessVRF_HP"
            case "DuctedMiniSplitHeatPump"           : "DuctedMiniSplitHP"
            case "DuctedMultiSplitHeatPump"          : "DuctedMultiSplitHP"
            case "Ducted+DuctlessMultiSplitHeatPump" : "DuctedDuctlessMultiSplitHP"
            case "PkgHeatPump"          : "PTHP"
            case "LrgPkgHeatPump"       : "CentralLargePackagedHP"
            case "RoomHeatPump"         : "RoomHP"
            case "AirToWaterHeatPump"   : "AirToWaterHeatPump"
            case "GroundSourceHeatPump" : "GroundSourceHeatPump"
			case "VCHP"                 : ( switch( EnumString( noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts ) )                       
											   case "Unducted"          : "VCHP_IndoorUnitDuctless"
											   case "Ducted"            : "VCHP_IndoorUnitDucted"
											   case "Partially Ducted"  : "VCHP_IndoorUnitDuctedAndDuctless"
											   default                  : "VCHP"
										    endswitch  )
            case "VCHP2"                : "VCHP2"
            default  :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell03b_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell03b_ResidentialHeatingSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell03c_ResidentialCoolingSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
         then switch( noXMLoutput_ResSCSysRptRef:CoolingType )
                case "NoCooling"         : "NoCooling"
                case "SplitAirCond"      : "CentralSplitAC"
                case "Boiler"            : "Boiler"
                case "PkgTermAirCond"    : "PTAC"
                case "SglPkgVertAirCond" : "SPVAC"
                case "PkgAirCond"        : "CentralPackagedAC"
                case "LrgPkgAirCond"     : "CentralLargePackagedAC"
                case "SDHVSplitAirCond"  : "SmallDuctHighVelocityAC"
                case "DuctlessMiniSplitAirCond"  : "DuctlessSplitAC"
                case "DuctlessMultiSplitAirCond" : "DuctlessMultiSplitAC"
                case "DuctlessVRFAirCond"        : "DuctlessVRF_AC"
                case "DuctedMiniSplitAirCond"    : "DuctedMiniSplitAC"
                case "DuctedMultiSplitAirCond"   : "DuctedMultiSplitAC"
                case "Ducted+DuctlessMultiSplitAirCond" : "DuctedDuctlessMultiSplitAC"
                case "RoomAirCond"        : "RoomAC"
                case "EvapCondenser"      : "EvaporativelyCooledCondenser"
                case "EvapDirect"         : "EvaporativeDirect"
                case "EvapIndirDirect"    : "EvaporativeIndirectDirect"
                case "EvapIndirect"       : "EvaporativeIndirect"
                case "Four-pipe fan coil"        : "FourPipeFanCoil"
                case "Water source heat pump"    : "WaterSourceHeatPump"
                case "Variable refrigerant flow" : "VRF"
                case "SplitHeatPump"             : "CentralSplitHP"
                case "PkgTermHeatPump"           : "PTHP"
                case "SglPkgVertHeatPump"        : "SPVHP"
                case "SDHVSplitHeatPump"         : "SmallDuctHighVelocityHP"
                case "DuctlessMiniSplitHeatPump"         : "DuctlessMiniSplitHP"
                case "DuctlessMultiSplitHeatPump"        : "DuctlessMultiSplitHP"
                case "DuctlessVRFHeatPump"               : "DuctlessVRF_HP"
                case "DuctedMiniSplitHeatPump"           : "DuctedMiniSplitHP"
                case "DuctedMultiSplitHeatPump"          : "DuctedMultiSplitHP"
                case "Ducted+DuctlessMultiSplitHeatPump" : "DuctedDuctlessMultiSplitHP"
                case "PkgHeatPump"          : "PTHP"
                case "LrgPkgHeatPump"       : "CentralLargePackagedHP"
                case "RoomHeatPump"         : "RoomHP"
                case "AirToWaterHeatPump"   : "AirToWaterHeatPump"
                case "GroundSourceHeatPump" : "GroundSourceHeatPump"
			    case "VCHP"                 : ( switch( EnumString( noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts ) )                       
											       case "Unducted"          : "VCHP_IndoorUnitDuctless"
											       case "Ducted"            : "VCHP_IndoorUnitDucted"
											       case "Partially Ducted"  : "VCHP_IndoorUnitDuctedAndDuctless"
											       default                  : "VCHP"
										        endswitch  )
                case "VCHP2"                : "VCHP2"
                default  :  UNDEFINED
             endswitch
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell03c_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell03c_ResidentialCoolingSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell04_HvacEquipmentCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then noXMLoutput_ResSCSysRptRef:ReferenceCount
    else UNDEFINED
    endif
ENDRULE
; prevent outputting ResSCSysRptRef:HVACDistRef for VCHP systems - SAC 06/20/23 (gh issue #49)
; list VCHP sys name as Hvacdwell05_SpaceConditioningDistributionSystemName when ducted VCHP - SAC 07/02/23 (gh issue #49)
RULE nrcctblRowHvacdwell:Hvacdwell05_SpaceConditioningDistributionSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef) .AND.
        IfValidAnd( noXMLoutput_ResSCSysRptRef:HeatingType = "VCHP" )==0)
    then noXMLoutput_ResSCSysRptRef:HVACDistRef
    else if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef) .AND.
             IfValidAnd( noXMLoutput_ResSCSysRptRef:HeatingType = "VCHP" ) .AND.
             ( IfValidAnd( noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts = "Ducted" ) .OR.
               IfValidAnd( noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts = "Partially Ducted" ) ))
    then noXMLoutput_ResSCSysRptRef:HtPumpSystem
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell05_SpaceConditioningDistributionSystemName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; prevent outputting ResSCSysRptRef:HVACFanRef for VCHP systems - SAC 06/20/23 (gh issue #49)
; list VCHP sys name as Hvacdwell06_FanSystemName for VCHP systems - SAC 07/02/23 (gh issue #49)
RULE nrcctblRowHvacdwell:Hvacdwell06_FanSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef) .AND.
        IfValidAnd( noXMLoutput_ResSCSysRptRef:HeatingType = "VCHP" )==0)
    then noXMLoutput_ResSCSysRptRef:HVACFanRef
    else if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef) .AND.
             IfValidAnd( noXMLoutput_ResSCSysRptRef:HeatingType = "VCHP" ) .AND.
             LocalCompAssigned(noXMLoutput_ResSCSysRptRef:HtPumpSystem))
    then noXMLoutput_ResSCSysRptRef:HtPumpSystem
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell06_FanSystemName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell07_HeatPumpHeatCapacity47F
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:HtPumpCap47 ) )
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:HtPumpCap47 ) )
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then UNDEFINED
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell07_HeatPumpHeatCapacity47F ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell08_HeatPumpHeatCapacity17F
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:HtPumpCap17 ) )
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell08_HeatPumpHeatCapacity17F ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell09_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then noXMLoutput_ResSCSysRptRef:HeatEfficType
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then noXMLoutput_ResSCSysRptRef:HeatEfficType
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then noXMLoutput_ResSCSysRptRef:HeatEfficType
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell09_EfficiencyType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell10_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "COP") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "COP") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "COP") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell10_EfficiencyHSPF
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell10_EfficiencyHSPF2
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell10_EfficiencyAFUE
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
         then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "AFUE") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System")
              then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "AFUE") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Water source heat pump")
                             then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "AFUE") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell10_EfficiencyCOP ) > 0 .OR. LocalStatus( Hvacdwell10_EfficiencyHSPF ) > 0 .OR. LocalStatus( Hvacdwell10_EfficiencyHSPF2 ) > 0 .OR. LocalStatus( Hvacdwell10_EfficiencyAFUE ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacdwell:Hvacdwell11_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell12_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell13_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE

RULE nrcctblRowHvacdwell:Hvacdwell14_CoolingTotalOutput
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System")
         then if (noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
              then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:ClgCapNetRtd ) )
              else UNDEFINED
              endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:Hvacdwell14_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell14_CoolingTotalOutput ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


; nrccHvacdwellSingleEffic - ONLY ONE efficiency value reported

RULE nrccHvacdwellSingleEffic:Hvacdwell15_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0) then noXMLoutput_ResSCSysRptRef:CoolEfficType[1] else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell15_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell15_EfficiencyType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; String efficiency type for downstream reporting
RULE nrccHvacdwellSingleEffic:Hvacdwell15a_EfficiencyTypeString
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0) then noXMLoutput_ResSCSysRptRef:CoolEfficType[1] else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell15a_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell15a_EfficiencyTypeString ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencySEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencySEER2
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER2 ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEER2
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2 ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEERa
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERa") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERa ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEERb
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERb") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERb ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEER2a
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2a") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2a ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyEER2b
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2b") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2b ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_EfficiencyCEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:HeatingType == "LrgPkgHeatPump")
         then UNDEFINED
         else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Other Heating and Cooling System" .AND. (noXMLoutput_ResSCSysRptRef:CoolingType == "NoCooling" .OR. noXMLoutput_ResSCSysRptRef:CoolingType == "LrgPkgAirCond"))
              then UNDEFINED
              else if (noXMLoutput_ResSCSysRptRef:ParentHVACSysTypeRpt == "Central Heating and Cooling System" .AND. noXMLoutput_ResSCSysRptRef:ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                   then UNDEFINED
                   else if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "CEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolCEER ) ) else UNDEFINED endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellSingleEffic:Hvacdwell16_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell16_EfficiencySEER ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencySEER2 ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEER ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEER2 ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyCEER ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


; nrccHvacdwellEER_SEER - TWO efficiency values reported

; RJH 1/19/23 Switch order so that EER or EER2 come before SEER or SEER2
RULE nrccHvacdwellEER_SEER:Hvacdwell15_EfficiencyType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef))
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0 .AND. LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[2] ) > 0)
         then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER" .OR. noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2")
              then noXMLoutput_ResSCSysRptRef:CoolEfficType[2]
              else noXMLoutput_ResSCSysRptRef:CoolEfficType[1]
              endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell15_EfficiencyType[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef))
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0 .AND. LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[2] ) > 0)
         then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER" .OR. noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2")
              then noXMLoutput_ResSCSysRptRef:CoolEfficType[1]
              else noXMLoutput_ResSCSysRptRef:CoolEfficType[2]
              endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell15_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell15_EfficiencyType[1] ) > 0 .OR. LocalStatus( Hvacdwell15_EfficiencyType[2] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; String efficiency type for downstream reporting
RULE nrccHvacdwellEER_SEER:Hvacdwell15a_EfficiencyTypeString
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell15_EfficiencyType[1] ) > 0 .AND. LocalStatus( Hvacdwell15_EfficiencyType[2] ) > 0)
    then  Hvacdwell15_EfficiencyType[1] + Hvacdwell15_EfficiencyType[2]  else  UNDEFINED  endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell15a_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell15a_EfficiencyTypeString ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; RJH 1/19/23 Switch order so that EER(2) comes before SEER(2)
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER_SEER[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER_SEER[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER2_SEER2[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER2_SEER2[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEERa_EERb[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERa") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERa ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEERa_EERb[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EERb") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERb ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER2a_EER2b[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2a") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2a ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_EfficiencyEER2a_EER2b[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2b") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2b ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacdwellEER_SEER:Hvacdwell16_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Hvacdwell16_EfficiencyEER_SEER[1] ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEER_SEER[2] ) > 0 .OR.
        LocalStatus( Hvacdwell16_EfficiencyEER2_SEER2[1] ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEER2_SEER2[2] ) > 0 .OR.
        LocalStatus( Hvacdwell16_EfficiencyEERa_EERb[1] ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEERa_EERb[2] ) > 0 .OR.
        LocalStatus( Hvacdwell16_EfficiencyEER2a_EER2b[1] ) > 0 .OR. LocalStatus( Hvacdwell16_EfficiencyEER2a_EER2b[2] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE



; nrccHvacdwellCoolEffic_NotApplicable - NO efficiency values reported

RULE nrccHvacdwellCoolEffic_NotApplicable:Hvacdwell15_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE
RULE nrccHvacdwellCoolEffic_NotApplicable:Hvacdwell16_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE







; RJH 11/8/23 2022-CBECC-Com-Schema Issue #111
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell17_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef))
    then
        switch (noXMLoutput_ResSCSysRptRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell17_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell17_Status ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; RJH 10/16/22 LMCC only
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell18_IsAirflowVerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HERSAHUAirFlow > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell18_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell18_IsAirflowVerificationRequired ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell19_AirflowRequiredMinimumTarget
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HERSAHUAirFlow > 0)) then atof( noXMLoutput_ResSCSysRptRef:HERSAirFlowRptMsg ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell19_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell19_AirflowRequiredMinimumTarget ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell20_EER_VerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HERSEER > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell20_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell20_EER_VerificationRequired ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell21_SEER_VerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HERSSEER > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell21_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell21_SEER_VerificationRequired ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell22_RefrigerantChargeVerificationRequired
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HERSACCharg > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell22_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell22_RefrigerantChargeVerificationRequired ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE

RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell23_VerificationRequiredHSPF
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem[1]:HERSHtPumpRef:HSPF > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell23_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell23_VerificationRequiredHSPF ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell24_VerificationRequiredCapacity47F
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem[1]:HERSHtPumpRef:Capacity > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell24_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell24_VerificationRequiredCapacity47F ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell25_VerificationRequiredCapacity17F
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem[1]:HERSHtPumpRef:Capacity17 > 0)) then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell25_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell25_VerificationRequiredCapacity17F ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell26_CompressorSpeedType
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:CoolCompType == "Single Speed")) then "SingleSpeed" else "MultiSpeed" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell26_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell26_CompressorSpeedType ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell27_IsFanCertifiedNonContinuous
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem:IsAvailable > 0) .AND.
             IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem:ShowVCHPDucts > 0) .AND. 
             EnumValue(noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts) > 0)
         then if (IfValidAnd(noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPCertAutoFan > 0)) then "true" else "false" endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell27_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell27_IsFanCertifiedNonContinuous ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell28_ThermostatType
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if ((EnumValue(ResProj:RunScope) != 1 .OR. IfValidAnd( ResProj:IsAddAlone != 0 )) .AND. EnumValue(noXMLoutput_ResSCSysRptRef:Status) = 1) 
         then  "NotApplicable"
         else if (LocalCompAssigned( noXMLoutput_ResSCSysRptRef:HtPumpSystem ) > 0)
              then if (T24RHeatingEquipment:SetbackTstatReqd( "CodeBase", EnumValue(Proj:StdDesignBase), "SysType", noXMLoutput_ResSCSysRptRef:HtPumpSystem:TypeAbbrevStr ) > 0)
                   then  "SetbackThermostat"
                   else  "NonSetbackThermostat"  
                   endif 
              else if (LocalCompAssigned( noXMLoutput_ResSCSysRptRef:HeatSystem ) > 0)
                   then if (T24RHeatingEquipment:SetbackTstatReqd( "CodeBase", EnumValue(Proj:StdDesignBase), "SysType", noXMLoutput_ResSCSysRptRef:HeatSystem:TypeAbbrev ) > 0)
                        then  "SetbackThermostat"
                        else  "NonSetbackThermostat"
                        endif
                   else if (LocalCompAssigned( noXMLoutput_ResSCSysRptRef:CoolSystem ) > 0)
                        then if (T24RCoolingEquipment:SetbackTstatReqd( "CodeBase", EnumValue(Proj:StdDesignBase), "SysType", noXMLoutput_ResSCSysRptRef:CoolSystem:TypeAbbrev ) > 0)
                             then  "SetbackThermostat"
                             else  "NonSetbackThermostat"
                             endif
                        else  "NonSetbackThermostat"
                        endif
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacdwell:afterchildren_Hvacdwell28_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( afterchildren_Hvacdwell28_ThermostatType ) > 0)
    then  UNDEFINED  else  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then "NotApplicable" else UNDEFINED endif  endif
ENDRULE


; nrcctblRowDFHP
RULE NEW ResSCSysRpt:nrcctblRowDFHPRef
  DATATYPE
    nrcctblRowDFHP
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowDFHP:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowDFHP:Parent
  ANNUAL_PROPOSED
    nrccTableDFHP:Name
ENDRULE

; nrccCoolingEfficDfhp
RULE NEW ResSCSysRpt:nrccCoolingEfficDfhpRef
  DATATYPE
    nrccCoolingEfficDfhp
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccCoolingEfficDfhp:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccCoolingEfficDfhp:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrcctblRowDFHPRef)) then noXMLoutput_ResSCSysRptRef:nrcctblRowDFHPRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccCoolingSingleEfficDfhp
RULE NEW ResSCSysRpt:nrccCoolingSingleEfficDfhpRef
  DATATYPE
    nrccCoolingSingleEfficDfhp
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccCoolingSingleEfficDfhp:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrccCoolingSingleEfficDfhpRef)) then noXMLoutput_ResSCSysRptRef:nrccCoolingSingleEfficDfhpRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccCoolingEER_IEER_Dfhp
RULE NEW ResSCSysRpt:nrccCoolingEER_IEER_DfhpRef
  DATATYPE
    nrccCoolingEER_IEER_Dfhp
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccCoolingEER_IEER_Dfhp:noXMLoutput_ResSCSysRptRef
  DATATYPE
    ResSCSysRpt
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef:nrccCoolingEfficDfhpRef)) then noXMLoutput_ResSCSysRptRef:nrccCoolingEfficDfhpRef:Name
    else UNCHANGED
    endif
ENDRULE


RULE nrcctblRowDFHP:Dfhp01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then noXMLoutput_ResSCSysRptRef:HtPumpSystem
    else UNDEFINED
    endif
ENDRULE

; RJH 3/10/2023 Modified per GH Issue #41
RULE nrcctblRowDFHP:Dfhp02a_ResidentialHeatingSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then switch( noXMLoutput_ResSCSysRptRef:HeatingType )
            case "CntrlFurnace"       : "CentralGasFurnace"
            case "WallFurnaceFan"     : "GasWallFurnace"
            case "Boiler"             : "Boiler"
            case "Electric"           : "Electric"
            case "CombHydro"          : "CombinedHydronic"
            case "WallFurnaceGravity" : "GasWallFurnace"
            case "FloorFurnace"       : "FloorFurnace"
            case "RoomHeater"         : "GasSpaceHeater"
            case "WoodHeat"           : "WoodHeat"
            case "PkgGasFurnace"      : "GasPackagedFurnace"
            case "ElecCombHydro"      : "ElectricCombinedHydronic"
            case "Four-pipe fan coil"        : "FourPipeFanCoil"
            case "Water source heat pump"    : "WaterSourceHeatPump"
            case "Variable refrigerant flow" : "VRF"
            case "SplitHeatPump"             : "CentralSplitHP"
            case "PkgTermHeatPump"           : "PTHP"
            case "SglPkgVertHeatPump"        : "SPVHP"
            case "SDHVSplitHeatPump"         : "SmallDuctHighVelocityHP"
            case "DuctlessMiniSplitHeatPump"         : "DuctlessMiniSplitHP"
            case "DuctlessMultiSplitHeatPump"        : "DuctlessMultiSplitHP"
            case "DuctlessVRFHeatPump"               : "DuctlessVRF_HP"
            case "DuctedMiniSplitHeatPump"           : "DuctedMiniSplitHP"
            case "DuctedMultiSplitHeatPump"          : "DuctedMultiSplitHP"
            case "Ducted+DuctlessMultiSplitHeatPump" : "DuctedDuctlessMultiSplitHP"
            case "PkgHeatPump"          : "PTHP"
            case "LrgPkgHeatPump"       : "CentralLargePackagedHP"
            case "RoomHeatPump"         : "RoomHP"
            case "AirToWaterHeatPump"   : "AirToWaterHeatPump"
            case "GroundSourceHeatPump" : "GroundSourceHeatPump"
			case "VCHP"                 : ( switch( EnumString( noXMLoutput_ResSCSysRptRef:HtPumpSystem:VCHPDucts ) )                       
											   case "Unducted"          : "VCHP_IndoorUnitDuctless"
											   case "Ducted"            : "VCHP_IndoorUnitDucted"
											   case "Partially Ducted"  : "VCHP_IndoorUnitDuctedAndDuctless"
											   default                  : "VCHP"
										    endswitch  )
            case "VCHP2"                : "VCHP2"
            default  :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
;0, ResHtPumpSys:TypeAbbrev,  4
;0, ResHtPumpSys:StdType,  4
;2,              0,    "type unknown"
;2,              4,    "SplitHeatPump"
;2,             26,    "PkgTermHeatPump"            ; SAC 6/19/20 (tic #1225)
;2,             24,    "SglPkgVertHeatPump"         ; SAC 6/19/20 (tic #1226)
;2,             19,    "SDHVSplitHeatPump"           ; SAC 1/7/16 - added (tic 598)
;2,             10,    "DuctlessMiniSplitHeatPump"     
;2,             20,    "DuctlessMultiSplitHeatPump"  ; DR 8/29/16 - added (tic 632)
;2,             21,    "DuctlessVRFHeatPump" 	      ; DR 8/29/16 - added (tic 632)
;2,             28,    "DuctedMiniSplitHeatPump"             ; SAC 6/19/20 (tic #1229)
;2,             30,    "DuctedMultiSplitHeatPump"            ; SAC 6/19/20 (tic #1229)
;2,             32,    "Ducted+DuctlessMultiSplitHeatPump"   ; SAC 6/19/20 (tic #1229)
;2,              5,    "PkgHeatPump"
;2,              6,    "LrgPkgHeatPump"
;2,              7,    "RoomHeatPump"
;2,             11,    "AirToWaterHeatPump"
;2,             12,    "GroundSourceHeatPump"
;2,             22,    "VCHP"     ; SAC 11/1/18
;2,             33,    "VCHP2"    ; SAC 03/24/22



RULE nrcctblRowDFHP:Dfhp02b_FurnaceUnitHeater
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then "FurnaceCentral"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp03a_HeatPumpHeatCapacity47F
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:HtPumpCap47 ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp03b_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then "NotApplicable"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp04a_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then noXMLoutput_ResSCSysRptRef:HeatEfficType
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp04b_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) then noXMLoutput_ResSCSysRptRef:SuppHeatEfficType
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp05a_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "COP") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp05a_EfficiencyHSPF
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:HeatEfficType == "HSPF") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinHeatEffic ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp05a_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Dfhp05a_EfficiencyCOP ) > 0 .OR. LocalStatus( Dfhp05a_EfficiencyHSPF ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowDFHP:Dfhp05b_EfficiencyAFUE
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:SuppHeatEfficType == "AFUE") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinSuppHeatEffic ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDFHP:Dfhp05b_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Dfhp05b_EfficiencyAFUE ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


; nrccCoolingSingleEfficDfhp - ONLY ONE efficiency value reported

RULE nrccCoolingSingleEfficDfhp:Dfhp06a_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0) then noXMLoutput_ResSCSysRptRef:CoolEfficType[1] else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE

RULE nrccCoolingSingleEfficDfhp:Dfhp06b_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE

; String efficiency type for downstream reporting
RULE nrccCoolingSingleEfficDfhp:Dfhp06c_EfficiencyTypeString
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0) then noXMLoutput_ResSCSysRptRef:CoolEfficType[1] else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp06c_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Dfhp06c_EfficiencyTypeString ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencySEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEER2
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencySEER2
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEERa
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERa") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERa ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEERb
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERb") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERb ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEER2a
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2a") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2a ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyEER2b
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2b") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2b ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingSingleEfficDfhp:Dfhp07a_EfficiencyCEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "CEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolCEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE


; nrccCoolingEER_IEER_Dfhp - TWO efficiency values reported

; RJH 1/19/23 Switch order so that EER or EER2 come before SEER or SEER2
RULE nrccCoolingEER_IEER_Dfhp:Dfhp06a_EfficiencyType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef))
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0 .AND. LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[2] ) > 0)
         then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER" .OR. noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2")
              then noXMLoutput_ResSCSysRptRef:CoolEfficType[2]
              else noXMLoutput_ResSCSysRptRef:CoolEfficType[1]
              endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp06a_EfficiencyType[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef))
    then if (LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[1] ) > 0 .AND. LocalStatus( noXMLoutput_ResSCSysRptRef:CoolEfficType[2] ) > 0)
         then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER" .OR. noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2")
              then noXMLoutput_ResSCSysRptRef:CoolEfficType[1]
              else noXMLoutput_ResSCSysRptRef:CoolEfficType[2]
              endif
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE

RULE nrccCoolingEER_IEER_Dfhp:Dfhp06b_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE

; String efficiency type for downstream reporting
RULE nrccCoolingEER_IEER_Dfhp:Dfhp06c_EfficiencyTypeString
  ANNUAL_PROPOSED
    if (LocalStatus( Dfhp06a_EfficiencyType[1] ) > 0 .AND. LocalStatus( Dfhp06a_EfficiencyType[2] ) > 0)
    then  Dfhp06a_EfficiencyType[1] + Dfhp06a_EfficiencyType[2]  else  UNDEFINED  endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp06c_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Dfhp06c_EfficiencyTypeString ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; RJH 1/19/23 Switch order so that EER(2) comes before SEER(2)

RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER_SEER[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER_SEER[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER2_SEER2[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER2_SEER2[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "SEER2") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolSEER2 ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07b_NotApplicableMessage
  ANNUAL_PROPOSED
    "NotApplicable"
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEERa_EERb[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EERa") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERa ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEERa_EERb[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EERb") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEERb ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER2a_EER2b[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[1] == "EER2a") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2a ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrccCoolingEER_IEER_Dfhp:Dfhp07a_EfficiencyEER2a_EER2b[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResSCSysRptRef)) 
    then if (noXMLoutput_ResSCSysRptRef:CoolEfficType[2] == "EER2b") then atof( Format( "%.2f", noXMLoutput_ResSCSysRptRef:MinCoolEER2b ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE








; nrccSection_Hvacdwell nrccTableHvacCommonMF 
RULE NEW ResHVACSys:nrcctblRowHvacCommonMFRef
  DATATYPE
    nrcctblRowHvacCommonMF
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacCommonMF:noXMLoutput_ResHVACSysRef
  DATATYPE
    ResHVACSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowHvacCommonMF:Parent
  ANNUAL_PROPOSED
    nrccTableHvacCommonMF:Name
ENDRULE

; nrccHvacCommonMFCoolEffic
RULE NEW ResHVACSys:nrccHvacCommonMFCoolEfficRef
  DATATYPE
    nrccHvacCommonMFCoolEffic
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacCommonMFCoolEffic:noXMLoutput_ResHVACSysRef
  DATATYPE
    ResHVACSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacCommonMFCoolEffic:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef:nrcctblRowHvacCommonMFRef)) then noXMLoutput_ResHVACSysRef:nrcctblRowHvacCommonMFRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacCommonMFSingleEffic
RULE NEW ResHVACSys:nrccHvacCommonMFSingleEfficRef
  DATATYPE
    nrccHvacCommonMFSingleEffic
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacCommonMFSingleEffic:noXMLoutput_ResHVACSysRef
  DATATYPE
    ResHVACSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacCommonMFSingleEffic:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef)) then noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacCommonMFEER_SEER
RULE NEW ResHVACSys:nrccHvacCommonMFEER_SEERRef
  DATATYPE
    nrccHvacCommonMFEER_SEER
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacCommonMFEER_SEER:noXMLoutput_ResHVACSysRef
  DATATYPE
    ResHVACSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacCommonMFEER_SEER:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef)) then noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacCommonMFCoolEffic_NotApplicable
RULE NEW ResHVACSys:nrccHvacCommonMFCoolEffic_NotApplicableRef
  DATATYPE
    nrccHvacCommonMFCoolEffic_NotApplicable
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacCommonMFCoolEffic_NotApplicable:noXMLoutput_ResHVACSysRef
  DATATYPE
    ResHVACSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacCommonMFCoolEffic_NotApplicable:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef)) then noXMLoutput_ResHVACSysRef:nrccHvacCommonMFCoolEfficRef:Name
    else UNCHANGED
    endif
ENDRULE


RULE nrcctblRowHvacCommonMF:HvacCommonMF01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) then noXMLoutput_ResHVACSysRef:Name
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF02_HvacEquipmentName[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then noXMLoutput_ResHVACSysRef:HtPumpSystem[1]
         else if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
              then noXMLoutput_ResHVACSysRef:HeatSystem[1]
              else if (noXMLoutput_ResHVACSysRef:Type == "Central Heating and Cooling System")
                   then noXMLoutput_ResHVACSysRef:HVACCentralRef[1]
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF03_ResidentialSpaceConditioningSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then switch( noXMLoutput_ResHVACSysRef:Type )
            case "Other Heating and Cooling System"     : "HeatingCoolingSystemOther"
            case "Heat Pump Heating and Cooling System" : "HeatPumpHeatingCooling"
            case "Central Heating and Cooling System"   : "VariableOA_VentilationCentralHeatingCooling"
            default  :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF03_ResidentialSpaceConditioningSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF03b_ResidentialHeatingSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then   switch( noXMLoutput_ResHVACSysRef:HtPumpSysTypeAbbrev )
                case "SplitHeatPump"             : "CentralSplitHP"
                case "PkgTermHeatPump"           : "PTHP"
                case "SglPkgVertHeatPump"        : "SPVHP"
                case "SDHVSplitHeatPump"         : "SmallDuctHighVelocityHP"
                case "DuctlessMiniSplitHeatPump"         : "DuctlessMiniSplitHP"
                case "DuctlessMultiSplitHeatPump"        : "DuctlessMultiSplitHP"
                case "DuctlessVRFHeatPump"               : "DuctlessVRF_HP"
                case "DuctedMiniSplitHeatPump"           : "DuctedMiniSplitHP"
                case "DuctedMultiSplitHeatPump"          : "DuctedMultiSplitHP"
                case "Ducted+DuctlessMultiSplitHeatPump" : "DuctedDuctlessMultiSplitHP"
                case "PkgHeatPump"          : "PTHP"
                case "LrgPkgHeatPump"       : "CentralLargePackagedHP"
                case "RoomHeatPump"         : "RoomHP"
                case "AirToWaterHeatPump"   : "AirToWaterHeatPump"
                case "GroundSourceHeatPump" : "GroundSourceHeatPump"
			    case "VCHP"                 : ( switch( EnumString( noXMLoutput_ResHVACSysRef:HtPumpSystem[1]:VCHPDucts ) )                       
											       case "Unducted"          : "VCHP_IndoorUnitDuctless"
											       case "Ducted"            : "VCHP_IndoorUnitDucted"
											       case "Partially Ducted"  : "VCHP_IndoorUnitDuctedAndDuctless"
											       default                  : "VCHP"
										        endswitch  )
                case "VCHP2"                : "VCHP2"
                default  :  UNDEFINED
             endswitch
         else if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
              then switch( noXMLoutput_ResHVACSysRef:HeatSysTypeAbbrev )
                    case "CntrlFurnace"       : "CentralGasFurnace"
                    case "WallFurnaceFan"     : "GasWallFurnace"
                    case "Boiler"             : "Boiler"
                    case "Electric"           : "Electric"
                    case "CombHydro"          : "CombinedHydronic"
                    case "WallFurnaceGravity" : "GasWallFurnace"
                    case "FloorFurnace"       : "FloorFurnace"
                    case "RoomHeater"         : "GasSpaceHeater"
                    case "WoodHeat"           : "WoodHeat"
                    case "PkgGasFurnace"      : "GasPackagedFurnace"
                    default  :  UNDEFINED
                 endswitch
              else if (noXMLoutput_ResHVACSysRef:Type == "Central Heating and Cooling System")
                   then switch( noXMLoutput_ResHVACSysRef:CentralEqpType )
                        case "Four-pipe fan coil"        : "FourPipeFanCoil"
                        case "Water source heat pump"    : "GasWallFurnace"
                        case "Variable refrigerant flow" : "VRF"
                        default  :  UNDEFINED
                     endswitch
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF03b_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF03b_ResidentialHeatingSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF03c_ResidentialCoolingSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
         then switch( noXMLoutput_ResHVACSysRef:CoolSysTypeAbbrev )
                case "NoCooling"         : "NoCooling"
                case "SplitAirCond"      : "CentralSplitAC"
                case "Boiler"            : "Boiler"
                case "PkgTermAirCond"    : "PTAC"
                case "SglPkgVertAirCond" : "SPVAC"
                case "PkgAirCond"        : "CentralPackagedAC"
                case "LrgPkgAirCond"     : "CentralLargePackagedAC"
                case "SDHVSplitAirCond"  : "SmallDuctHighVelocityAC"
                case "DuctlessMiniSplitAirCond"  : "DuctlessSplitAC"
                case "DuctlessMultiSplitAirCond" : "DuctlessMultiSplitAC"
                case "DuctlessVRFAirCond"        : "DuctlessVRF_AC"
                case "DuctedMiniSplitAirCond"    : "DuctedMiniSplitAC"
                case "DuctedMultiSplitAirCond"   : "DuctedMultiSplitAC"
                case "Ducted+DuctlessMultiSplitAirCond" : "DuctedDuctlessMultiSplitAC"
                case "RoomAirCond"        : "RoomAC"
                case "EvapCondenser"      : "EvaporativelyCooledCondenser"
                case "EvapDirect"         : "EvaporativeDirect"
                case "EvapIndirDirect"    : "EvaporativeIndirectDirect"
                case "EvapIndirect"       : "EvaporativeIndirect"
                default  :  UNDEFINED
             endswitch
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF03c_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF03c_ResidentialCoolingSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF04_HvacEquipmentCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then noXMLoutput_ResHVACSysRef:HtPumpSystemCount[1]
         else if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
              then noXMLoutput_ResHVACSysRef:HeatSystemCount[1]
              else if (noXMLoutput_ResHVACSysRef:Type == "Central Heating and Cooling System")
                   then noXMLoutput_ResHVACSysRef:CentralEquipCount[1]
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE

; prevent outputting ResHVACSys:DistribSystem for VCHP systems - SAC 06/20/23 (gh issue #49)
; list VCHP sys name as HvacCommonMF05_SpaceConditioningDistributionSystemName when ducted VCHP - SAC 07/02/23 (gh issue #49)
RULE nrcctblRowHvacCommonMF:HvacCommonMF05_SpaceConditioningDistributionSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef) .AND.
        IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSysTypeAbbrev = "VCHP" )==0)
    then noXMLoutput_ResHVACSysRef:DistribSystem
    else if (LocalCompAssigned(noXMLoutput_ResHVACSysRef) .AND.
             IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSysTypeAbbrev = "VCHP" ) .AND.
             ( IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSystem[1]:VCHPDucts = "Ducted" ) .OR.
               IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSystem[1]:VCHPDucts = "Partially Ducted" ) ))
    then noXMLoutput_ResHVACSysRef:HtPumpSystem[1]
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF05_SpaceConditioningDistributionSystemName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

; prevent outputting ResHVACSys:Fan for VCHP systems - SAC 06/20/23 (gh issue #49)
; list VCHP sys name as HvacCommonMF06_FanSystemName for VCHP systems - SAC 07/02/23 (gh issue #49)
RULE nrcctblRowHvacCommonMF:HvacCommonMF06_FanSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef) .AND.
        IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSysTypeAbbrev = "VCHP" )==0)
    then noXMLoutput_ResHVACSysRef:Fan
    else if (LocalCompAssigned(noXMLoutput_ResHVACSysRef) .AND.
             IfValidAnd( noXMLoutput_ResHVACSysRef:HtPumpSysTypeAbbrev = "VCHP" ) .AND.
             LocalCompAssigned(noXMLoutput_ResHVACSysRef:HtPumpSystem[1]))
    then noXMLoutput_ResHVACSysRef:HtPumpSystem[1]
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF06_FanSystemName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF07_HeatPumpHeatCapacity47F
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then atof( Format( "%.2f", noXMLoutput_ResHVACSysRef:HPSysCap47 ) )
         else if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
              then UNDEFINED
              else if (noXMLoutput_ResHVACSysRef:Type == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResHVACSysRef:HVACCentralRef:Type == "Variable refrigerant flow")
                        then atof( Format( "%.2f", noXMLoutput_ResHVACSysRef:HPSysCap47 ) )
                        else if (noXMLoutput_ResHVACSysRef:HVACCentralRef:Type == "Water source heat pump")
                             then UNDEFINED
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF07_HeatPumpHeatCapacity47F ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowHvacCommonMF:HvacCommonMF08_HeatPumpHeatCapacity17F
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then atof( Format( "%.2f", noXMLoutput_ResHVACSysRef:HPSysCap17 ) )
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF08_HeatPumpHeatCapacity17F ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


RULE nrcctblRowHvacCommonMF:HvacCommonMF09_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResHVACSysRef)) 
    then if (noXMLoutput_ResHVACSysRef:Type == "Heat Pump Heating and Cooling System")
         then noXMLoutput_ResHVACSysRef:HtPumpSystem[1]:EffLabel1
         else if (noXMLoutput_ResHVACSysRef:Type == "Other Heating and Cooling System")
              then if (noXMLoutput_ResHVACSysRef:HeatSystem[1]:DisplayAFUE) then "AFUE" else UNDEFINED endif
              else if (noXMLoutput_ResHVACSysRef:Type == "Central Heating and Cooling System")
                   then if (noXMLoutput_ResHVACSysRef:HVACCentralRef:Type == "Variable refrigerant flow")
                        then UNDEFINED
                        else if (noXMLoutput_ResHVACSysRef:HVACCentralRef:Type == "Water source heat pump")
                             then "COP"
                             else UNDEFINED
                             endif
                        endif
                   else UNDEFINED
                   endif
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacCommonMF:HvacCommonMF09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacCommonMF09_EfficiencyType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE









; nrccSection_Fan nrccTableFan 
RULE NEW AirSys:nrcctblRowFanRef
  DATATYPE
    nrcctblRowFan
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowFan:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW ZnSys:nrcctblRowFanRef
  DATATYPE
    nrcctblRowFan
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowFan:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowFan:Parent
  ANNUAL_PROPOSED
    nrccTableFan:Name
ENDRULE

RULE nrcctblRowFan:Fan01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Name
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan02_FanCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Cnt
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Cnt
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan03_VentSystemOA
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:SysVentFlow ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:SysVentFlow ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan04_FanFlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:FlowCap ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:FlowCap ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan04_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan04_FanFlowCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; RJH 9/17//22 remove ModelingMethod for NRCC/LMCC 2022
;RULE nrcctblRowFan:Fan05_ModelingMethod
;  ANNUAL_PROPOSED
;    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) then noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:ModelingMthd
;    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then noXMLoutput_ZnSysRef:RptFanRef:ModelingMthd
;    else UNDEFINED
;    endif endif
;ENDRULE
;RULE nrcctblRowFan:Fan05_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( Fan05_ModelingMethod ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE
RULE nrcctblRowFan:Fan05_MotorBHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:ModelingMthd == "BrakeHorsePower") then atof( Format( "%.2f", noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef))  
        then if (noXMLoutput_ZnSysRef:RptFanRef:ModelingMthd == "BrakeHorsePower") then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan05_FanPowerPerFlow
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:ModelingMthd == "PowerPerUnitFlow") then atof( Format( "%.2f", noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef))  
        then if (noXMLoutput_ZnSysRef:RptFanRef:ModelingMthd == "PowerPerUnitFlow") then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan05_TotalStaticPressure
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:ModelingMthd == "StaticPressure") then atof( Format( "%.2f", noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef))  
        then if (noXMLoutput_ZnSysRef:RptFanRef:ModelingMthd == "StaticPressure") then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan05_MotorBHP ) > 0 .OR. LocalStatus( Fan05_FanPowerPerFlow ) > 0 .OR. LocalStatus( Fan05_TotalStaticPressure ) > 0 )
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan06_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) 
    then
        switch (noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:ModelingMthd)
            case "StaticPressure"   : "InH2O"
            case "BrakeHorsePower"  : "BHP"
            case "PowerPerUnitFlow" : "Watts"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
    then
        switch (noXMLoutput_ZnSysRef:RptFanRef:ModelingMthd)
            case "StaticPressure"   : "InH2O"
            case "BrakeHorsePower"  : "BHP"
            case "PowerPerUnitFlow" : "Watts"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan06_FanPowerUnits ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan07_ControlMethod
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) then noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:CtrlMthd
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then noXMLoutput_ZnSysRef:RptFanRef:CtrlMthd
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowFan:Fan07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan07_ControlMethod ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan08_FanFunction
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:Type)) 
    then if (noXMLoutput_AirSysRef:RetAirSegRef:Type == "Return") 
         then "Return"
         else if (noXMLoutput_AirSysRef:RetAirSegRef:Type == "Relief") 
              then "Relief"
              else UNDEFINED
              endif
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan08_FanFunction ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan09_FanFlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:FlowCap ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan09_FanFlowCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
; RJH 9/17//22 remove ModelingMethod for NRCC/LMCC 2022
;RULE nrcctblRowFan:Fan10_ModelingMethod
;  ANNUAL_PROPOSED
;    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) then noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:ModelingMthd
;    else UNDEFINED
;    endif
;ENDRULE
;RULE nrcctblRowFan:Fan10_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( Fan10_ModelingMethod ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE
RULE nrcctblRowFan:Fan10_MotorBHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:ModelingMthd == "BrakeHorsePower") then atof( Format( "%.2f", noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan10_FanPowerPerFlow
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:ModelingMthd == "PowerPerUnitFlow") then atof( Format( "%.2f", noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan10_TotalStaticPressure
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) 
        then if (noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:ModelingMthd == "StaticPressure") then atof( Format( "%.2f", noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:PwrRpt ) ) 
        else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan10_MotorBHP ) > 0 .OR. LocalStatus( Fan10_FanPowerPerFlow ) > 0 .OR. LocalStatus( Fan10_TotalStaticPressure ) > 0 )
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan11_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) 
    then
        switch (noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:ModelingMthd)
            case "StaticPressure"   : "InH2O"
            case "BrakeHorsePower"  : "BHP"
            case "PowerPerUnitFlow" : "Watts"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan11_FanPowerUnits ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan12_ControlMethod
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef)) then noXMLoutput_AirSysRef:RetAirSegRef:RptFanRef:CtrlMthd
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFan:Fan12_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Fan12_ControlMethod ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowFan:Fan13_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef)) 
    then
        switch (noXMLoutput_AirSysRef:SupAirSegRef:RptFanRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
    then
        switch (noXMLoutput_ZnSysRef:RptFanRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE


; nrccSection_Fan nrccTableMFFan 
RULE NEW ResFanSys:nrcctblRowMFFanRef
  DATATYPE
    nrcctblRowMFFan
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowMFFan:noXMLoutput_ResFanSysRef
  DATATYPE
    ResFanSys
  INPUTCLASS 
    Prescribed
ENDRULE

; nrccSection_Fan nrccTableMFFan for VCHP systems - SAC 07/02/23 (gh issue #49)
RULE NEW ResHtPumpSys:nrcctblRowMFFanRef
  DATATYPE
    nrcctblRowMFFan
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowMFFan:noXMLoutput_ResHtPumpSysRef
  DATATYPE
    ResHtPumpSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowMFFan:Parent
  ANNUAL_PROPOSED
    nrccTableMFFan:Name
ENDRULE

RULE nrcctblRowMFFan:MFFan01_FanName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResFanSysRef)) then noXMLoutput_ResFanSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_ResHtPumpSysRef)) then noXMLoutput_ResHtPumpSysRef:Name
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowMFFan:MFFan02_ResidentialFanType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResFanSysRef)) 
    then
        switch (noXMLoutput_ResFanSysRef:Type)
            case "Single Speed Fan" : "FixedSpeed"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ResHtPumpSysRef)) then "HvacFan"   ; ??
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowMFFan:MFFan03_FanPowerPerFlow
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResFanSysRef)) then atof( Format( "%.2f", noXMLoutput_ResFanSysRef:WperCFMCool ) )
    else if (LocalCompAssigned(noXMLoutput_ResHtPumpSysRef)) then 0.35   ; ??
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowMFFan:MFFan04_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResFanSysRef)) then "WattsPerCFM"
    else if (LocalCompAssigned(noXMLoutput_ResHtPumpSysRef)) then "WattsPerCFM"   ; ??
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowMFFan:MFFan05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResFanSysRef)) then "NotApplicable"
    else if (LocalCompAssigned(noXMLoutput_ResHtPumpSysRef)) then "NotApplicable"   ; ??
    else UNDEFINED
    endif endif
ENDRULE




; nrccSection_Fan nrccTableFanIAQ 
RULE NEW ResIAQFan:nrcctblRowFanIAQRef
  DATATYPE
    nrcctblRowFanIAQ
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowFanIAQ:noXMLoutput_ResIAQFanRef
  DATATYPE
    ResIAQFan
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW ResCentralVentSys:nrcctblRowFanIAQRef
  DATATYPE
    nrcctblRowFanIAQ
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowFanIAQ:noXMLoutput_ResCentralVentSysRef
  DATATYPE
    ResCentralVentSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowFanIAQ:Parent
  ANNUAL_PROPOSED
    nrccTableFanIAQ:Name
ENDRULE

RULE nrcctblRowFanIAQ:FanIAQ01_FanName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then noXMLoutput_ResIAQFanRef:Name
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then noXMLoutput_ResCentralVentSysRef:Name
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ02_VentilationSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then
        switch (noXMLoutput_ResIAQFanRef:IAQFanType)
            case "Exhaust"  : "ExhaustVent"
            case "Supply"   : "SupplyVent"
            case "Balanced" : "Balanced"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then 
            switch (noXMLoutput_ResCentralVentSysRef:Type)
                case "Exhaust"  : "ExhaustVent"
                case "Supply"   : "SupplyVent"
                case "Balanced" : "Balanced"
                default :  UNDEFINED
            endswitch
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ03_FanFlowCapacity[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then atof( Format( "%.2f", noXMLoutput_ResIAQFanRef:IAQCFM ) )
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then if (noXMLoutput_ResCentralVentSysRef:Type == "Supply" .OR. noXMLoutput_ResCentralVentSysRef:Type == "Balanced")
              then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:SupFanCap ) )
              else if (noXMLoutput_ResCentralVentSysRef:Type == "Exhaust")
                   then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:ExhFanCap ) )
                   else UNDEFINED
                   endif
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ03_FanFlowCapacity[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then UNDEFINED
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then if (noXMLoutput_ResCentralVentSysRef:Type == "Balanced")
              then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:ExhFanCap ) )
              else UNDEFINED
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ04_FanPowerPerFlow[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then atof( Format( "%.2f", noXMLoutput_ResIAQFanRef:WperCFMIAQ ) )
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then if (noXMLoutput_ResCentralVentSysRef:Type == "Supply" .OR. noXMLoutput_ResCentralVentSysRef:Type == "Balanced")
              then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:SupFanPwrIdx ) )
              else if (noXMLoutput_ResCentralVentSysRef:Type == "Exhaust")
                   then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:ExhFanPwrIdx ) )
                   else UNDEFINED
                   endif
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ04_FanPowerPerFlow[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef)) 
    then UNDEFINED
    else if (LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
         then if (noXMLoutput_ResCentralVentSysRef:Type == "Balanced")
              then atof( Format( "%.2f", noXMLoutput_ResCentralVentSysRef:ExhFanPwrIdx ) )
              else UNDEFINED
              endif
         else UNDEFINED
         endif
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ05_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef) .OR. LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) 
    then "WattsPerCFM"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanIAQ:FanIAQ06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResIAQFanRef) .OR. LocalCompAssigned(noXMLoutput_ResCentralVentSysRef)) then "NotApplicable"
    else UNDEFINED
    endif
ENDRULE


; cf1rSection_Distmf nrccTableDuctMF
RULE NEW ResDuctSeg:nrcctblRowDuctMFRef
  DATATYPE
    nrcctblRowDuctMF
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowDuctMF:noXMLoutput_ResDuctSegRef
  DATATYPE
    ResDuctSeg
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowDuctMF:Parent
  ANNUAL_PROPOSED
    nrccTableDuctMF:Name
ENDRULE


RULE nrcctblRowDuctMF:Ductmf01_SpaceConditioningDistributionSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then noXMLoutput_ResDuctSegRef:ParentSysNameRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf01_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf01_SpaceConditioningDistributionSystemName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf02_AirSegmentName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then noXMLoutput_ResDuctSegRef:Name
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf02_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf02_AirSegmentName ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf03_AirSegmentType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then noXMLoutput_ResDuctSegRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf03_AirSegmentType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf04_DuctNominalDiameter
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) 
    then
        switch (noXMLoutput_ResDuctSegRef:Diameter)
            case "3 in"  : 3
            case "4 in"  : 4
            case "5 in"  : 5
            case "6 in"  : 6
            case "7 in"  : 7
            case "8 in"  : 8
            case "9 in"  : 9
            case "10 in" : 10
            case "12 in" : 12
            case "14 in" : 14
            case "16 in" : 16
            case "18 in" : 18
            case "20 in" : 20
            case "22 in" : 22
            case "24 in" : 24
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf04_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf04_DuctNominalDiameter ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf05_DuctRValue
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) 
    then
        switch (noXMLoutput_ResDuctSegRef:InsulRValue)
            case "R-0"   : "R0.0"
            case "R-2.1" : "R2.1"
            case "R-4.2" : "R4.2"
            case "R-6"   : "R6"
            case "R-8"   : "R8"
            case "R-10"  : "R10"
            case "R-12"  : "R12"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf05_DuctRValue ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf06_DuctLength
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then atof( Format( "%.2f", noXMLoutput_ResDuctSegRef:Length ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf06_DuctLength ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf07_AtticInsulationRValue
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) 
    then
        switch (noXMLoutput_ResDuctSegRef:AtticInsulRValue)
            case "R-30"  : 30
            case "R-38"  : 38
            case "R-40"  : 40
            case "R-43"  : 43
            case "R-49"  : 49
            case "R-60"  : 60
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf07_AtticInsulationRValue ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf08_AtticInsulationThickness
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then atof( Format( "%.2f", noXMLoutput_ResDuctSegRef:AtticInsulDepth ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf08_AtticInsulationThickness ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf09_AtticInsulationType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) then noXMLoutput_ResDuctSegRef:AtticInsulType
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf09_AtticInsulationType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf10_DuctBuriedLevel
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) 
    then
        switch (noXMLoutput_ResDuctSegRef:BuriedLevel)
            case "Not"       : "NotBuried"
            case "Partially" : "PartiallyBuried"
            case "Fully"     : "AllBuried"
            case "Deeply"    : "DeeplyBuried"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf10_DuctBuriedLevel ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf11_BuriedDuctInsulationDevice
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ResDuctSegRef)) 
    then
        switch (noXMLoutput_ResDuctSegRef:ContainmentSystem)
            case "not required"       : "NoContainer"
            case "Containment System" : "Container"
            case "Lowered Chase"      : "LoweredChase"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowDuctMF:Ductmf11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Ductmf11_BuriedDuctInsulationDevice ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE



; nrccSection_FanExh nrccTableFanExh 
RULE NEW Fan:nrcctblRowFanExhRef
  DATATYPE
    nrcctblRowFanExh
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowFanExh:noXMLoutput_FanExhRef
  DATATYPE
    Fan
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowFanExh:Parent
  ANNUAL_PROPOSED
    nrccTableFanExh:Name
ENDRULE

RULE nrcctblRowFanExh:FanExh01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) then noXMLoutput_FanExhRef:ParentSysNameRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh02_ThermalZoneName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) then noXMLoutput_FanExhRef:ParentSysZnServedAsExhRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh03_FanCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) then noXMLoutput_FanExhRef:SysCnt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh04_ExhaustFlowRate
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) then atof( Format( "%.2f", noXMLoutput_FanExhRef:FlowCap ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh05_MotorBHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) 
    then if (noXMLoutput_FanExhRef:PwrUnitRpt == "bhp") 
         then atof( Format( "%.2f", noXMLoutput_FanExhRef:PwrRpt ) )
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh05_MotorWatts
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) 
    then if (noXMLoutput_FanExhRef:PwrUnitRpt == "W/cfm") 
         then atof( Format( "%.2f", noXMLoutput_FanExhRef:PwrRpt ) )
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh05_TotalStaticPressure
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) 
    then if (noXMLoutput_FanExhRef:PwrUnitRpt == "inH2O") 
         then atof( Format( "%.2f", noXMLoutput_FanExhRef:PwrRpt ) )
         else UNDEFINED
         endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh06_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) 
    then
        switch (noXMLoutput_FanExhRef:PwrUnitRpt)
            case "inH2O" : "InH2O"
            case "bhp"   : "BHP"
            case "W/cfm" : "WattsPerCFM"
            default      :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh07_FanControl
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) then noXMLoutput_FanExhRef:ParentSysFanCtrlRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowFanExh:FanExh08_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FanExhRef)) 
    then
        switch (noXMLoutput_FanExhRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE


; nrccSection_HvacWet nrccTableHvacWet 
RULE NEW Blr:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_BlrRef
  DATATYPE
    Blr
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW Chlr:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_ChlrRef
  DATATYPE
    Chlr
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW HX:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_HXRef
  DATATYPE
    HX
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW HtRej:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_HtRejRef
  DATATYPE
    HtRej
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW ThrmlEngyStor:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_ThrmlEngyStorRef
  DATATYPE
    ThrmlEngyStor
  INPUTCLASS 
    Prescribed
ENDRULE
; RJH 8/23/22 added for WtrHtr
RULE NEW WtrHtr:nrcctblRowHvacWetRef
  DATATYPE
    nrcctblRowHvacWet
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacWet:noXMLoutput_WtrHtrRef
  DATATYPE
    WtrHtr
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowHvacWet:Parent
  ANNUAL_PROPOSED
    nrccTableHvacWet:Name
ENDRULE

RULE nrcctblRowHvacWet:HvacWet01_HvacEquipmentName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) then noXMLoutput_BlrRef:Name
    else if (LocalCompAssigned(noXMLoutput_ChlrRef)) then noXMLoutput_ChlrRef:Name
    else if (LocalCompAssigned(noXMLoutput_HXRef)) then noXMLoutput_HXRef:Name
    else if (LocalCompAssigned(noXMLoutput_HtRejRef)) then noXMLoutput_HtRejRef:Name
    else if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef)) then noXMLoutput_ThrmlEngyStorRef:Name
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then noXMLoutput_WtrHtrRef:Name                ; RJH 8/23/22 added for WtrHtr
    else UNDEFINED
    endif endif endif endif endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet02_BoilerType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) then noXMLoutput_BlrRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet02_ChillerType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ChlrRef)) then noXMLoutput_ChlrRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet02_HeatRejectionType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_HtRejRef)) then noXMLoutput_HtRejRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet02_HeatExchangerType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_HXRef)) then noXMLoutput_HXRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet02_ThermalEnergyStorageType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef)) then noXMLoutput_ThrmlEngyStorRef:Type
    else UNDEFINED
    endif
ENDRULE
; RJH 8/23/22 added for WtrHtr
RULE nrcctblRowHvacWet:HvacWet02_WaterHeaterType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) 
    then 
        switch (noXMLoutput_WtrHtrRef:Type)
            case "HeatPumpSplit"    : "HeatPumpWaterHeater"
            case "HeatPumpPackaged" : "HeatPumpWaterHeater"
            default                 :  noXMLoutput_WtrHtrRef:Type
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet03_FluidSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) then noXMLoutput_BlrRef:ParentSysNameRpt
    else if (LocalCompAssigned(noXMLoutput_ChlrRef)) then noXMLoutput_ChlrRef:ParentSysNameRpt
    else if (LocalCompAssigned(noXMLoutput_HXRef)) then noXMLoutput_HXRef:ParentSysNameRpt
    else if (LocalCompAssigned(noXMLoutput_HtRejRef)) then noXMLoutput_HtRejRef:ParentSysNameRpt
    else if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef)) then noXMLoutput_ThrmlEngyStorRef:ParentSysNameRpt
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then noXMLoutput_WtrHtrRef:ParentSysNameRpt                ; RJH 8/23/22 added for WtrHtr
    else UNDEFINED
    endif endif endif endif endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet04_HvacEquipmentCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_ChlrRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_HXRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_HtRejRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef)) then 1
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef)) then noXMLoutput_WtrHtrRef:Cnt                ; RJH 8/23/22 added for WtrHtr
    else UNDEFINED
    endif endif endif endif endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet05_TEStorageCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef) .AND. IfValidAnd(noXMLoutput_ThrmlEngyStorRef:StorCap > 0)) then atof( Format( "%.2f", noXMLoutput_ThrmlEngyStorRef:StorCap ) )
    else UNDEFINED
    endif
ENDRULE
; RJH 8/23/22 added for WtrHtr
RULE nrcctblRowHvacWet:HvacWet05_StorageCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. IfValidAnd(noXMLoutput_WtrHtrRef:StorCap > 0)) then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:StorCap ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacWet05_TEStorageCapacity ) > 0 .OR. LocalStatus( HvacWet05_StorageCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet06_CapacityRated
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef) .AND. LocalStatus(noXMLoutput_BlrRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_BlrRef:CapRtd/1000 ) )
    else if (LocalCompAssigned(noXMLoutput_HXRef) .AND. LocalStatus(noXMLoutput_HXRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_HXRef:CapRtd/1000 ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet06_ChillerCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ChlrRef) .AND. LocalStatus(noXMLoutput_ChlrRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_ChlrRef:CapRtd/1000 ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet06_CoolingTowerCapacityRated
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_HtRejRef) .AND. LocalStatus(noXMLoutput_HtRejRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_HtRejRef:CapRtd/1000 ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet06_TERatedCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef) .AND. LocalStatus(noXMLoutput_ThrmlEngyStorRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_ThrmlEngyStorRef:CapRtd/1000 ) )
    else UNDEFINED
    endif
ENDRULE
; RJH 8/23/22 added for WtrHtr
RULE nrcctblRowHvacWet:HvacWet06_RatedCapacityKBtuh
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. LocalStatus(noXMLoutput_WtrHtrRef:CapRtd) > 0 ) then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:CapRtd/1000 ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet07_CapacityUnits
  ANNUAL_PROPOSED
    "KBtuHr"
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_EfficiencyAFUE
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef) .AND. IfValidAnd(noXMLoutput_BlrRef:EffUnitRpt = "AFUE") ) then atof( Format( "%.2f", noXMLoutput_BlrRef:AFUE ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_ThermalEfficiency
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef) .AND. IfValidAnd(noXMLoutput_BlrRef:EffUnitRpt = "Thrml. Eff") ) then atof( Format( "%.2f", noXMLoutput_BlrRef:ThrmlEff ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_CombustionEfficiency
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef) .AND. IfValidAnd(noXMLoutput_BlrRef:EffUnitRpt = "Comb. Eff") ) then atof( Format( "%.2f", noXMLoutput_BlrRef:CombEff ) )
    else UNDEFINED
    endif
ENDRULE
; RJH 8/23/22 modified for WtrHtr
RULE nrcctblRowHvacWet:HvacWet08_EfficiencyCOP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ChlrRef) .AND. IfValidAnd(noXMLoutput_ChlrRef:EffUnitRpt = "COP")) then atof( Format( "%.2f", noXMLoutput_ChlrRef:COP ) )
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef) .AND. IfValidAnd(noXMLoutput_WtrHtrRef:COP > 0)) then atof( Format( "%.2f", noXMLoutput_WtrHtrRef:COP ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_EfficiencyEER
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ChlrRef) .AND. IfValidAnd(noXMLoutput_ChlrRef:EffUnitRpt = "EER") ) then atof( Format( "%.2f", noXMLoutput_ChlrRef:EER ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_EfficiencyKWperTon
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ChlrRef) .AND. IfValidAnd(noXMLoutput_ChlrRef:EffUnitRpt = "kW/ton") ) then atof( Format( "%.2f", noXMLoutput_ChlrRef:KwPerTon ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_TotalFanHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_HtRejRef)) then atof( Format( "%.2f", noXMLoutput_HtRejRef:TotFanHP ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet08_EfficiencyNA
  ANNUAL_PROPOSED
    if (LocalStatus( HvacWet08_EfficiencyAFUE ) > 0 .OR. LocalStatus( HvacWet08_ThermalEfficiency ) > 0 .OR. LocalStatus( HvacWet08_CombustionEfficiency ) > 0 .OR. 
        LocalStatus( HvacWet08_EfficiencyCOP ) > 0 .OR. LocalStatus( HvacWet08_EfficiencyEER ) > 0 .OR. LocalStatus( HvacWet08_EfficiencyKWperTon ) > 0 .OR.
        LocalStatus( HvacWet08_TotalFanHP ) > 0)
    then  UNDEFINED  else  "EfficiencyNA"  endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet09_EfficiencyType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) 
    then
        switch (noXMLoutput_BlrRef:EffUnitRpt)
            case "AFUE"       : "AFUE"
            case "Comb. Eff"  : "CombustionEfficiency"
            case "Thrml. Eff" : "ThermalEfficiency"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ChlrRef)) 
    then
        switch (noXMLoutput_ChlrRef:EffUnitRpt)
            case "COP"    : "COP"
            case "EER"    : "EER"
            case "kW/ton" : "KWperTon"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_HtRejRef)) 
    then "HP"
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef))     ; RJH 8/23/22 added for WtrHtr
    then "COP"
    else UNDEFINED
    endif endif endif endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacWet09_EfficiencyType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowHvacWet:HvacWet10_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_BlrRef)) 
    then
        switch (noXMLoutput_BlrRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ChlrRef)) 
    then
        switch (noXMLoutput_ChlrRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_HXRef)) 
    then
        switch (noXMLoutput_HXRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_HtRejRef)) 
    then
        switch (noXMLoutput_HtRejRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ThrmlEngyStorRef)) 
    then
        switch (noXMLoutput_ThrmlEngyStorRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_WtrHtrRef))      ; RJH 8/23/22 added for WtrHtr
    then
        switch (noXMLoutput_WtrHtrRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif endif endif endif endif
ENDRULE


; nrccSection_Pump nrccTablePump 
RULE NEW Pump:nrcctblRowPumpRef
  DATATYPE
    nrcctblRowPump
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowPump:noXMLoutput_PumpRef
  DATATYPE
    Pump
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowPump:Parent
  ANNUAL_PROPOSED
    nrccTablePump:Name
ENDRULE

RULE nrcctblRowPump:Pump01_PumpName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then noXMLoutput_PumpRef:Name
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump02_HvacEquipmentName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then noXMLoutput_PumpRef:ParentNameRpt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump03_PumpCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then noXMLoutput_PumpRef:Cnt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump04_PumpMotorHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then atof( Format( "%.2f", noXMLoutput_PumpRef:MtrHP ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump05_PumpPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then "BHP"
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump06_FlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then atof( Format( "%.2f", noXMLoutput_PumpRef:FlowCap ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump07_IsVSD
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) then if (noXMLoutput_PumpRef:SpdCtrl = "VariableSpeed") then "true" else "false" endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowPump:Pump08_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_PumpRef)) 
    then switch (noXMLoutput_PumpRef:ParentStatusRpt)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE


; nrccSection_HvacSpec nrccTableHvacSpec 
RULE NEW AirSys:nrcctblRowHvacSpecRef
  DATATYPE
    nrcctblRowHvacSpec
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacSpec:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE

; nrccHvacSpec04Choice
RULE NEW AirSys:nrccHvacSpec04ChoiceRef
  DATATYPE
    nrccHvacSpec04Choice
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04Choice:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04Choice:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrcctblRowHvacSpecRef)) then noXMLoutput_AirSysRef:nrcctblRowHvacSpecRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacSpec04
RULE NEW AirSys:nrccHvacSpec04Ref
  DATATYPE
    nrccHvacSpec04
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:nrccHvacSpec04ChoiceRef)) then noXMLoutput_AirSysRef:nrccHvacSpec04ChoiceRef:Name
    else UNCHANGED
    endif
ENDRULE

RULE NEW ZnSys:nrcctblRowHvacSpecRef
  DATATYPE
    nrcctblRowHvacSpec
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacSpec:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE

; nrccHvacSpec04Choice
RULE NEW ZnSys:nrccHvacSpec04ChoiceRef
  DATATYPE
    nrccHvacSpec04Choice
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04Choice:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04Choice:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrcctblRowHvacSpecRef)) then noXMLoutput_ZnSysRef:nrcctblRowHvacSpecRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacSpec04
RULE NEW ZnSys:nrccHvacSpec04Ref
  DATATYPE
    nrccHvacSpec04
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:nrccHvacSpec04ChoiceRef)) then noXMLoutput_ZnSysRef:nrccHvacSpec04ChoiceRef:Name
    else UNCHANGED
    endif
ENDRULE

RULE NEW VRFSys:nrcctblRowHvacSpecRef
  DATATYPE
    nrcctblRowHvacSpec
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacSpec:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE

; nrccHvacSpec04Choice
RULE NEW VRFSys:nrccHvacSpec04ChoiceRef
  DATATYPE
    nrccHvacSpec04Choice
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04Choice:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04Choice:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrcctblRowHvacSpecRef)) then noXMLoutput_VRFSysRef:nrcctblRowHvacSpecRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacSpec04
RULE NEW VRFSys:nrccHvacSpec04Ref
  DATATYPE
    nrccHvacSpec04
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04:noXMLoutput_VRFSysRef
  DATATYPE
    VRFSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_VRFSysRef:nrccHvacSpec04ChoiceRef)) then noXMLoutput_VRFSysRef:nrccHvacSpec04ChoiceRef:Name
    else UNCHANGED
    endif
ENDRULE

RULE NEW FluidSys:nrcctblRowHvacSpecRef
  DATATYPE
    nrcctblRowHvacSpec
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHvacSpec:noXMLoutput_FluidSysRef
  DATATYPE
    FluidSys
  INPUTCLASS 
    Prescribed
ENDRULE

; nrccHvacSpec04Choice
RULE NEW FluidSys:nrccHvacSpec04ChoiceRef
  DATATYPE
    nrccHvacSpec04Choice
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04Choice:noXMLoutput_FluidSysRef
  DATATYPE
    FluidSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04Choice:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FluidSysRef:nrcctblRowHvacSpecRef)) then noXMLoutput_FluidSysRef:nrcctblRowHvacSpecRef:Name
    else UNCHANGED
    endif
ENDRULE

; nrccHvacSpec04
RULE NEW FluidSys:nrccHvacSpec04Ref
  DATATYPE
    nrccHvacSpec04
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrccHvacSpec04:noXMLoutput_FluidSysRef
  DATATYPE
    FluidSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE nrccHvacSpec04:Parent
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FluidSysRef:nrccHvacSpec04ChoiceRef)) then noXMLoutput_FluidSysRef:nrccHvacSpec04ChoiceRef:Name
    else UNCHANGED
    endif
ENDRULE



RULE nrcctblRowHvacSpec:Parent
  ANNUAL_PROPOSED
    nrccTableHvacSpec:Name
ENDRULE



RULE nrcctblRowHvacSpec:HvacSpec01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then noXMLoutput_VRFSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_FluidSysRef)) then noXMLoutput_FluidSysRef:Name
    else UNDEFINED
    endif endif endif endif
ENDRULE
RULE nrcctblRowHvacSpec:HvacSpec02_AirSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacSpec:HvacSpec02_ZoneSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Type
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then "VRF"
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHvacSpec:HvacSpec02_FluidSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_FluidSysRef)) then noXMLoutput_FluidSysRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHvacSpec:HvacSpec03_OperableWindowsHaveInterlock
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then  if (noXMLoutput_AirSysRef:OperableWinInterlockRpt != "NA") 
                                                        then 
                                                            switch (noXMLoutput_AirSysRef:OperableWinInterlockRpt)
                                                                case "Yes" : "true"
                                                                case "No"  : "false"
                                                                default :  UNDEFINED
                                                            endswitch
                                                        else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then if (noXMLoutput_ZnSysRef:OperableWinInterlockRpt != "NA") 
                                                           then 
                                                               switch (noXMLoutput_ZnSysRef:OperableWinInterlockRpt)
                                                                   case "Yes" : "true"
                                                                   case "No"  : "false"
                                                                   default :  UNDEFINED
                                                               endswitch
                                                           else UNDEFINED endif
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) then if (noXMLoutput_VRFSysRef:OperableWinInterlockRpt != "NA") 
                                                            then 
                                                                switch (noXMLoutput_VRFSysRef:OperableWinInterlockRpt)
                                                                    case "Yes" : "true"
                                                                    case "No"  : "false"
                                                                    default :  UNDEFINED
                                                                endswitch
                                                            else UNDEFINED endif
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowHvacSpec:HvacSpec03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( HvacSpec03_OperableWindowsHaveInterlock ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE



RULE nrccHvacSpec04:HvacSpec04_HvacControls[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[1])
            case "DDC Controls" : "DDC"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:SysCtrlRpt[1])
            case "Heat Recovery" : "HeatRecovery"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_VRFSysRef)) 
    then
        switch (noXMLoutput_VRFSysRef:SysCtrlRpt)
            case "Heat Recovery" : "HeatRecovery"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_FluidSysRef)) 
    then
        switch (noXMLoutput_FluidSysRef:SysCtrlRpt[1])
            case "DDC Controls" : "DDC"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif endif endif
ENDRULE
RULE nrccHvacSpec04:HvacSpec04_HvacControls[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[2])
            case "Single Maximum Reheat Controls" : "SingleMaxReheat"
            case "Dual Maximum Reheat Controls"   : "DualMaxReheat"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_FluidSysRef)) 
    then
        switch (noXMLoutput_FluidSysRef:SysCtrlRpt[2])
            case "Fixed Temperature Control"               : "FixedTempControl"
            case "Scheduled Temperature Control"           : "ScheduledTempControl"
            case "Outside Air Reset Temperature Control"   : "OutsideAirReset"
            case "Wet Bulb Reset Temperature Control"      : "TempResetWB"
            case "Fixed Dual Setpoint Temperature Control" : "Fixed2SetpointTempControl"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE


RULE nrccHvacSpec04:HvacSpec04_HvacControls[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[3])
            case "Zones With CO2Sensor Vent. Control" : "ZoneWithCO2Sensor"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE


RULE nrccHvacSpec04:HvacSpec04_HvacControls[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[4])
            case "Fixed Supply Air Temp."                            : "FixedSupplyAirTemp"
            case "Supply Air Temp. Reset on Outside Air Temp."       : "SupplyAirTempResetOA"
            case "Scheduled Supply Air Temp."                        : "SupplyAirTempScheduled"
            case "Warmest Zone Supply Air Temp. Reset - Flow First"  : "WarmestZoneResetFlow"
            case "Warmest Zone Supply Air Temp. Reset - Temp. First" : "WarmestZoneResetTemp"
            case "Warmest Zone Supply Air Temp. Reset"               : "WarmestZoneReset"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE

RULE nrccHvacSpec04:HvacSpec04_HvacControls[5]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[6])
            case "Heat Recovery" : "HeatRecovery"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE

RULE nrccHvacSpec04:HvacSpec04_HvacControls[6]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[8])
            case "Optimum Start" : "OptimumStart"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacSpec04:HvacSpec04_HvacControls[7]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[9])
            case "Fault Indicator Display" : "FID"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:SysCtrlRpt[2])
            case "Fault Indicator Display" : "FID"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE
RULE nrccHvacSpec04:HvacSpec04_HvacControls[8]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[10])
            case "Supply inlet, filter, and H/ERV core accessible per RACM Reference Manual" : "VentEquipAccessible"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:SysCtrlRpt[3])
            case "Supply inlet, filter, and H/ERV core accessible per RACM Reference Manual" : "VentEquipAccessible"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE

RULE nrccHvacSpec04:HvacSpec04_EconomizerControlMethod[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[5])
            case "Fixed Drybulb Economizer"                     : "FixedDryBulb"
            case "Differential Drybulb Economizer"              : "DifferentialDryBulb"
            case "Differential Enthalpy Economizer"             : "DifferentialEnthalpy"
            case "Differential Enthalpy and Drybulb Economizer" : "DifferentialDryBulbAndEnthalpy"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrccHvacSpec04:HvacSpec04_EvaporativeCoolerType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) 
    then
        switch (noXMLoutput_AirSysRef:SysCtrlRpt[7])
            case "Evaporative Cooler (Direct)"              : "Direct"
            case "Evaporative Cooler (Direct and Indirect)" : "DirectIndirect"
            case "Evaporative Cooler (Indirect)"            : "Indirect"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE




;RULE nrccHvacSpec04Choice:HvacSpec04_NotApplicableMessage
;  ANNUAL_PROPOSED
;    if (LocalStatus( HvacSpec04_HvacControls[1] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[2] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[3] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[4] ) > 0 .OR.
;        LocalStatus( HvacSpec04_HvacControls[5] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[6] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[7] ) > 0 .OR. LocalStatus( HvacSpec04_HvacControls[8] ) > 0)
;    then  UNDEFINED  else  "NotApplicable"  endif
;ENDRULE




; nrccSection_VentNR nrccTableVentNR 
RULE NEW ThrmlZn:nrcctblRowVentNRRef
  DATATYPE
    nrcctblRowVentNR
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowVentNR:noXMLoutput_ThrmlZnRef
  DATATYPE
    ThrmlZn
  INPUTCLASS 
    Prescribed
ENDRULE

RULE NEW ResOtherZn:nrcctblRowVentNRRef
  DATATYPE
    nrcctblRowVentNR
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowVentNR:noXMLoutput_ResOtherZnRef
  DATATYPE
    ResOtherZn
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowVentNR:Parent
  ANNUAL_PROPOSED
    nrccTableVentNR:Name
ENDRULE

RULE nrcctblRowVentNR:Vent01_ThermalZoneName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then if (noXMLoutput_ThrmlZnRef:Type = "Conditioned" .AND. noXMLoutput_ThrmlZnRef:VentStd = "Other")
         then noXMLoutput_ThrmlZnRef:Name + " " + noXMLoutput_ThrmlZnRef:VentStdDesc + " ventilation"
         else noXMLoutput_ThrmlZnRef:Name
         endif
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then noXMLoutput_ResOtherZnRef:Name 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent01a_VentilationStandardDescription
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) then noXMLoutput_ThrmlZnRef:VentStdDesc
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent02_VentilationSpaceFunctions
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then noXMLoutput_ThrmlZnRef:VentFuncList
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then noXMLoutput_ResOtherZnRef:VentSpcFunc 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent03_OccupancyCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:OccNumSim ) )
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then noXMLoutput_ResOtherZnRef:OccNumSim 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Vent03_OccupancyCount ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentNR:Vent04_VentSystemOA
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:VentFlow ) )
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then atof( Format( "%.2f", noXMLoutput_ResOtherZnRef:TotalIAQCFM ) ) 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent05_ExhaustFlowRate
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then if (noXMLoutput_ThrmlZnRef:MinExhFlow > 0) 
         then atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:MinExhFlow ) ) 
         else atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:ExhFlow ) ) 
         endif
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then atof( Format( "%.2f", noXMLoutput_ResOtherZnRef:TotalExhCFM ) ) 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent06_ThermalZoneFloorArea
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) 
    then atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:FlrArea ) )
    else if (LocalCompAssigned(noXMLoutput_ResOtherZnRef)) 
         then atof( Format( "%.2f", noXMLoutput_ResOtherZnRef:CondFloorArea ) ) 
         else UNDEFINED 
         endif
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent07_MechVentControls[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) then if (noXMLoutput_ThrmlZnRef:HasDCV = 1) then "DCV" else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent07_MechVentControls[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ThrmlZnRef)) then if (noXMLoutput_ThrmlZnRef:HasOccSensorCtrl = 1) then "OccupantSensors" else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentNR:Vent07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Vent07_MechVentControls[1] ) > 0 .OR. LocalStatus( Vent07_MechVentControls[2] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE


; nrccSection_VentRes nrccTableVentRes 
RULE NEW DwellUnitType:nrcctblRowVentResRef
  DATATYPE
    nrcctblRowVentRes
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowVentRes:noXMLoutput_DwellUnitTypeRef
  DATATYPE
    DwellUnitType
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowVentRes:Parent
  ANNUAL_PROPOSED
    nrccTableVentRes:Name
ENDRULE

RULE nrcctblRowVentRes:VentRes01_ResidentialDwellingUnitName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) then noXMLoutput_DwellUnitTypeRef:Name
    else UNDEFINED
    endif
ENDRULE

; RJH 6/26/23 Added VentRes01b_VentilationSystemType per GH 2022-CBECC-NonRes-PRF-Schema Issue #68
RULE nrcctblRowVentRes:VentRes01b_VentilationSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Individual IAQ Fans" )
         then if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust" )
              then "ExhaustVent"
              else if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Supply" )
                   then "SupplyVent"
                   else if ( noXMLoutput_DwellUnitTypeRef:IAQHRVCFMxSRE > 0 )
                        then "BalancedHRV"
                        else "Balanced"
                        endif 
                   endif 
              endif
         else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Minimum Exhaust IAQ Fan" .AND. noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust" )
              then "ExhaustVent"
              else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Default Minimum Balanced IAQ Fan" )
                   then "Balanced"
                   else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Central Supply / Central Exhaust" )
                        then if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust")
                             then "ExhaustCentralVent"
                             else if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Supply")
                                  then "SupplyCentralVent"
                                  else "BalancedCentralVent"
                                  endif 
                             endif
                        else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Central Exhaust" .AND. noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust")
                             then "ExhaustCentralVent"
                             else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Central Supply" .AND. noXMLoutput_DwellUnitTypeRef:IAQSysType = "Supply")
                                  then "SupplyCentralVent"
                                  else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Central Supply / Individual Exhaust" )
                                       then if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust")
                                            then "ExhaustVent"
                                            else if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Supply")
                                                 then "SupplyCentralVent"
                                                 else "Balanced"
                                                 endif 
                                            endif
                                       else if ( noXMLoutput_DwellUnitTypeRef:IAQOption = "Central Exhaust / Individual Supply" )
                                            then if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Exhaust")
                                                 then "ExhaustCentralVent"
                                                 else if ( noXMLoutput_DwellUnitTypeRef:IAQSysType = "Supply")
                                                      then "SupplyVent"
                                                      else "Balanced"
                                                      endif 
                                                 endif
                                            else UNDEFINED
                                            endif
                                       endif
                                  endif
                             endif 
                        endif 
                   endif 
              endif 
         endif
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowVentRes:VentRes02_VentilationSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : "DefaultMinIAQ"
            case "Minimum Exhaust IAQ Fan"             : "ExhaustMinIAQ"
            case "Individual IAQ Fans"                 : "IndividualIAQ"
            case "Central Supply / Central Exhaust"    : "SupplyAndExhaustCentral"
            case "Central Supply / Individual Exhaust" : "SupplyCentralIndExhaust"
            case "Central Exhaust / Individual Supply" : "ExhaustCentralIndSupply"
            case "Central Supply"                      : "SupplyCentralVent"
            case "Central Exhaust"                     : "ExhaustCentralVent"
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes03_VentilationSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : UNDEFINED
            case "Central Supply / Central Exhaust"    : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:CentralVentSysRef ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:Type)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:CentralVentSysRef ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:Type)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:CentralVentSysRef ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:Type)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:CentralVentSysRef ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:Type)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust"                     : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:CentralVentSysRef ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:Type)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes03_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes03_VentilationSystemType ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes04_FanFlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : UNDEFINED
            case "Central Supply / Central Exhaust"    : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanCap ) )
            case "Central Supply / Individual Exhaust" : UNDEFINED
            case "Central Exhaust / Individual Supply" : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanCap ) )
            case "Central Supply"                      : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanCap ) )
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes04_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes04_FanFlowCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes05_FanPowerPerFlow
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : UNDEFINED
            case "Central Supply / Central Exhaust"    : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanPwrIdx ) )
            case "Central Supply / Individual Exhaust" : UNDEFINED
            case "Central Exhaust / Individual Supply" : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanPwrIdx ) )
            case "Central Supply"                      : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:SupFanPwrIdx ) )
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes05_FanPowerPerFlow ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes06_ExhaustFlowRate
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : UNDEFINED
            case "Central Supply / Central Exhaust"    : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanCap ) )
            case "Central Supply / Individual Exhaust" : UNDEFINED
            case "Central Exhaust / Individual Supply" : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanCap ) )
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanCap ) )
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes06_ExhaustFlowRate ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes07_FanPowerPerFlow
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : UNDEFINED
            case "Central Supply / Central Exhaust"    : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanPwrIdx ) )
            case "Central Supply / Individual Exhaust" : UNDEFINED
            case "Central Exhaust / Individual Supply" : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanPwrIdx ) )
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:CentralVentSysRef:ExhFanPwrIdx ) )
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes07_FanPowerPerFlow ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowVentRes:VentRes08_VentilationSystemType[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Minimum Exhaust IAQ Fan"             : "Exhaust"
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes08_VentilationSystemType[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes08_VentilationSystemType[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes08_VentilationSystemType[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then switch (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType)
                                                                case "Balanced" : "Balanced"
                                                                case "Supply"   : "SupplyVent"
                                                                case "Exhaust"  : "ExhaustVent"
                                                                default :  UNDEFINED
                                                              endswitch
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes08_VentilationSystemType[1] ) > 0 .OR. LocalStatus( VentRes08_VentilationSystemType[2] ) > 0 .OR. LocalStatus( VentRes08_VentilationSystemType[3] ) > 0 .OR. LocalStatus( VentRes08_VentilationSystemType[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes09_FanCount[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : 1
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[1]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[1]
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[1]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes09_FanCount[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[2]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[2]
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[2]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes09_FanCount[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[3]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[3]
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[3]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes09_FanCount[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[4]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[4]
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then noXMLoutput_DwellUnitTypeRef:IAQFanCnt[4]
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes09_FanCount[1] ) > 0 .OR. LocalStatus( VentRes09_FanCount[2] ) > 0 .OR. LocalStatus( VentRes09_FanCount[3] ) > 0 .OR. LocalStatus( VentRes09_FanCount[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes10_FanFlowCapacity[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:MinIAQCFM ) )
            case "Minimum Exhaust IAQ Fan"             : atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:MinIAQCFM ) )
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes10_FanFlowCapacity[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes10_FanFlowCapacity[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes10_FanFlowCapacity[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes10_FanFlowCapacity[1] ) > 0 .OR. LocalStatus( VentRes10_FanFlowCapacity[2] ) > 0 .OR. LocalStatus( VentRes10_FanFlowCapacity[3] ) > 0 .OR. LocalStatus( VentRes10_FanFlowCapacity[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes11_FanPowerPerFlow[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[1] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes11_FanPowerPerFlow[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[2] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes11_FanPowerPerFlow[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[3] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes11_FanPowerPerFlow[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQWpCFM[4] ) )
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes11_FanPowerPerFlow[1] ) > 0 .OR. LocalStatus( VentRes11_FanPowerPerFlow[2] ) > 0 .OR. LocalStatus( VentRes11_FanPowerPerFlow[3] ) > 0 .OR. LocalStatus( VentRes11_FanPowerPerFlow[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes12_SensibleRecoveryEfficiency[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes12_SensibleRecoveryEfficiency[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes12_SensibleRecoveryEfficiency[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes12_SensibleRecoveryEfficiency[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQSRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes12_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes12_SensibleRecoveryEfficiency[1] ) > 0 .OR. LocalStatus( VentRes12_SensibleRecoveryEfficiency[2] ) > 0 .OR. LocalStatus( VentRes12_SensibleRecoveryEfficiency[3] ) > 0 .OR. LocalStatus( VentRes12_SensibleRecoveryEfficiency[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowVentRes:VentRes13_AdjustedSensibleRecoveryEfficiency[1]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[1] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[1] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes13_AdjustedSensibleRecoveryEfficiency[2]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[2] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[2] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes13_AdjustedSensibleRecoveryEfficiency[3]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[3] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[3] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes13_AdjustedSensibleRecoveryEfficiency[4]
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_DwellUnitTypeRef)) 
    then switch (noXMLoutput_DwellUnitTypeRef:IAQOption)
            case "Default Minimum Balanced IAQ Fan"    : UNDEFINED
            case "Minimum Exhaust IAQ Fan"             : UNDEFINED
            case "Individual IAQ Fans"                 : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply / Central Exhaust"    : UNDEFINED
            case "Central Supply / Individual Exhaust" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Exhaust / Individual Supply" : if (LocalCompAssigned( noXMLoutput_DwellUnitTypeRef:IAQFanRef[4] ) > 0) 
                                                         then if (noXMLoutput_DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == "Balanced") then atof( Format( "%.2f", noXMLoutput_DwellUnitTypeRef:IAQASRE[4] ) ) else UNDEFINED endif
                                                         else UNDEFINED
                                                         endif
            case "Central Supply"                      : UNDEFINED
            case "Central Exhaust"                     : UNDEFINED
            default :  UNDEFINED
         endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowVentRes:VentRes13_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( VentRes13_AdjustedSensibleRecoveryEfficiency[1] ) > 0 .OR. LocalStatus( VentRes13_AdjustedSensibleRecoveryEfficiency[2] ) > 0 .OR. LocalStatus( VentRes13_AdjustedSensibleRecoveryEfficiency[3] ) > 0 .OR. LocalStatus( VentRes13_AdjustedSensibleRecoveryEfficiency[4] ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE





; nrccSection_Zone nrccTableZone 
RULE NEW TrmlUnit:nrcctblRowZoneRef
  DATATYPE
    nrcctblRowZone
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowZone:noXMLoutput_TrmlUnitRef
  DATATYPE
    TrmlUnit
  INPUTCLASS 
    Prescribed
ENDRULE

RULE NEW ZnSys:nrcctblRowZoneRef
  DATATYPE
    nrcctblRowZone
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowZone:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE


RULE nrcctblRowZone:Parent
  ANNUAL_PROPOSED
    nrccTableZone:Name
ENDRULE

RULE nrcctblRowZone:Zone01_TerminalUnitName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then noXMLoutput_TrmlUnitRef:Name
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowZone:Zone01_ZoneSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then noXMLoutput_ZnSysRef:Name
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowZone:Zone02_ThermalZoneName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) then noXMLoutput_TrmlUnitRef:ZnServedRef
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:CtrlZnRef
    else UNDEFINED
    endif endif
ENDRULE

RULE nrcctblRowZone:Zone03_TerminalUnitType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then 
        switch (noXMLoutput_TrmlUnitRef:Type)
            case "Uncontrolled"   : "Uncontrolled"
            case "VAVReheatBox"   : "VAV_ReheatBox"
            case "ParallelFanBox" : "ParallelFanBox"
            case "SeriesFanBox"   : "SeriesFanBox"
            case "VAVNoReheatBox" : "VAV_NoReheatBox"
            case "ActiveBeam"     : "ActiveBeam"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowZone:Zone03_ZoneSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then noXMLoutput_ZnSysRef:Type
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowZone:Zone04_TerminalUnitCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then noXMLoutput_TrmlUnitRef:SysCnt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowZone:Zone04_ZoneSysCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then noXMLoutput_ZnSysRef:Cnt
    else UNDEFINED
    endif
ENDRULE

RULE nrcctblRowZone:Zone05_HeatingRatedCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef:CoilHtgRef)) then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:CoilHtgRef:CapTotNetRtd/1000 ) ) 
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:CoilHtgRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:CoilHtgRef:CapTotNetRtd/1000 ) ) 
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowZone:Zone05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone05_HeatingRatedCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone06_CoolingRatedCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef:CoilClgRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:CoilClgRef:CapTotNetRtd/1000 ) ) 
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowZone:Zone06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone06_CoolingRatedCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone07_RatedFlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:PriAirFlowMax ) ) 
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef) .AND. noXMLoutput_ZnSysRef:Type == "VentilationOnly") 
         then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RtdFlowCap ) ) 
         else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
              then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:FlowCap ) ) 
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowZone:Zone07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone07_RatedFlowCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone08_AirFlowMinimum
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:PriAirFlowMin ) ) 
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:FlowMin ) ) 
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowZone:Zone08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone08_AirFlowMinimum ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone09_DesignAirFlowMinimumRatio
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:PriAirFlowMinFrac ) ) 
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:FlowMinFrac ) ) 
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowZone:Zone09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone09_DesignAirFlowMinimumRatio ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone10_MotorBHP
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_bhp > 0)) 
         then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:FanPwrRpt_bhp ) ) 
         else UNDEFINED 
         endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef) .AND. noXMLoutput_ZnSysRef:Type == "VentilationOnly") 
         then UNDEFINED 
         else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
              then if (noXMLoutput_ZnSysRef:RptFanRef:PwrUnitRpt = "bhp") 
                   then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
                   else UNDEFINED 
                   endif  
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowZone:Zone10_FanPowerModeled
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_wcfm > 0)) 
         then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:FanPwrRpt_wcfm ) ) 
         else UNDEFINED 
         endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef) .AND. noXMLoutput_ZnSysRef:Type == "VentilationOnly") 
         then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RtdPwrIdx ) ) 
         else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
              then if (noXMLoutput_ZnSysRef:RptFanRef:PwrUnitRpt = "W/cfm") 
                   then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
                   else UNDEFINED 
                   endif  
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowZone:Zone10_TotalStaticPressure
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_inH2O > 0)) 
         then atof( Format( "%.2f", noXMLoutput_TrmlUnitRef:FanPwrRpt_inH2O ) ) 
         else UNDEFINED 
         endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef) .AND. noXMLoutput_ZnSysRef:Type == "VentilationOnly") 
         then UNDEFINED 
         else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
              then if (noXMLoutput_ZnSysRef:RptFanRef:PwrUnitRpt = "inH2O") 
                   then atof( Format( "%.2f", noXMLoutput_ZnSysRef:RptFanRef:PwrRpt ) ) 
                   else UNDEFINED 
                   endif  
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowZone:Zone10_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone10_MotorBHP ) > 0 .OR. LocalStatus( Zone10_FanPowerModeled ) > 0 .OR. LocalStatus( Zone10_TotalStaticPressure ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone11_FanPowerUnits
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) 
    then if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_bhp > 0)) 
         then "BHP"
         else if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_wcfm > 0))
              then "Watts"
              else if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanPwrRpt_inH2O > 0))
                   then "InH2O"
                   else UNDEFINED
                   endif
              endif
         endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef) .AND. noXMLoutput_ZnSysRef:Type == "VentilationOnly") 
         then "Watts" 
         else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) 
              then
                switch (noXMLoutput_ZnSysRef:RptFanRef:PwrUnitRpt)
                    case "inH2O" : "InH2O"
                    case "bhp"   : "BHP"
                    case "W/cfm" : "Watts"
                    default :  UNDEFINED
                endswitch
    else UNDEFINED
    endif endif endif
ENDRULE
RULE nrcctblRowZone:Zone11_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone11_FanPowerUnits ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone12_FanControl
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:FanCtrl)
            case "Continuous" : "Continuous"
            case "Cycling"    : "Cycling"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowZone:Zone12_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Zone12_FanControl ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE

RULE nrcctblRowZone:Zone13_IsVSD
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_TrmlUnitRef)) then if (IfValidAnd(noXMLoutput_TrmlUnitRef:FanRpt_IsVSD > 0)) then "true" else "false" endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef:RptFanRef)) then if (noXMLoutput_ZnSysRef:RptFanRef:CtrlMthd = "VariableSpeedDrive") then "true" else "false" endif
    else "false"
    endif endif
ENDRULE


; nrccSection_Evap nrccTableEvap 
RULE NEW EvapClr:nrcctblRowEvapRef
  DATATYPE
    nrcctblRowEvap
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowEvap:noXMLoutput_EvapClrRef
  DATATYPE
    EvapClr
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowEvap:Parent
  ANNUAL_PROPOSED
    nrccTableEvap:Name
ENDRULE

RULE nrcctblRowEvap:Evap01_EvaporativeCoolerName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef)) then noXMLoutput_EvapClrRef:Name
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap02_EvaporativeCoolerType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef)) then noXMLoutput_EvapClrRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap03_EvaporativeCoolerCount
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef)) then noXMLoutput_EvapClrRef:SysCnt
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap04_Effectiveness
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef)) then atof( Format( "%.2f", noXMLoutput_EvapClrRef:Eff ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap05_PumpPower
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef)) then atof( Format( "%.2f", noXMLoutput_EvapClrRef:PumpPwr ) )
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap05_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Evap05_PumpPower ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowEvap:Evap06_SecondaryFanFlowCapacity
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef) .AND. noXMLoutput_EvapClrRef:Type != "Direct") 
    then if (LocalStatus( noXMLoutput_EvapClrRef:SecFanFlowCap ) > 0) then atof( Format( "%.2f", noXMLoutput_EvapClrRef:SecFanFlowCap ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap06_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Evap06_SecondaryFanFlowCapacity ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowEvap:Evap07_SecondaryFanTotalEfficiency
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef) .AND. noXMLoutput_EvapClrRef:Type != "Direct") 
    then if (LocalStatus( noXMLoutput_EvapClrRef:SecFanTotEff ) > 0) then atof( Format( "%.2f", noXMLoutput_EvapClrRef:SecFanTotEff ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap07_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Evap07_SecondaryFanTotalEfficiency ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowEvap:Evap08_SecondaryFanTotalStaticPressure
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef) .AND. noXMLoutput_EvapClrRef:Type != "Direct") 
    then if (LocalStatus( noXMLoutput_EvapClrRef:SecFanTotStaticPress ) > 0) then atof( Format( "%.2f", noXMLoutput_EvapClrRef:SecFanTotStaticPress ) ) else UNDEFINED endif
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap08_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Evap08_SecondaryFanTotalStaticPressure ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE
RULE nrcctblRowEvap:Evap09_SecondaryAirSource
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_EvapClrRef) .AND. noXMLoutput_EvapClrRef:Type != "Direct") 
    then
        switch (noXMLoutput_EvapClrRef:SecAirSrc)
            case "Return"  : "ReturnAir"
            case "Outdoor" : "OutdoorAir"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowEvap:Evap09_NotApplicableMessage
  ANNUAL_PROPOSED
    if (LocalStatus( Evap09_SecondaryAirSource ) > 0)
    then  UNDEFINED  else  "NotApplicable"  endif
ENDRULE



; nrccSection_HtRecovery nrccTableHtRecovery 
RULE NEW AirSys:nrcctblRowHtRecoveryRef
  DATATYPE
    nrcctblRowHtRecovery
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHtRecovery:noXMLoutput_AirSysRef
  DATATYPE
    AirSys
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW ZnSys:nrcctblRowHtRecoveryRef
  DATATYPE
    nrcctblRowHtRecovery
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowHtRecovery:noXMLoutput_ZnSysRef
  DATATYPE
    ZnSys
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowHtRecovery:Parent
  ANNUAL_PROPOSED
    nrccTableHtRecovery:Name
ENDRULE

RULE nrcctblRowHtRecovery:HtRecovery01_HvacSystemName
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Name
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Name
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery02_AirSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef)) then noXMLoutput_AirSysRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery02_ZoneSystemType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:Type
    else UNDEFINED
    endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery03_HvacCertificationType
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef)) then noXMLoutput_AirSysRef:HtRcvryRef:HtRcvryCertification
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then noXMLoutput_ZnSysRef:HtRcvryCertification
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery04_HeatingSensibleEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:HtgSensEff100 ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:HtgSensEff100 ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery05_HeatingLatentEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef))
        then if (noXMLoutput_AirSysRef:HtRcvryRef:HtRcvryCertification == "HVI" .OR. noXMLoutput_AirSysRef:HtRcvryRef:RcvryType == "SensibleOnly") then 0.0 else atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:HtgLatEff100 ) ) endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
        then if (noXMLoutput_ZnSysRef:HtRcvryCertification == "HVI" .OR. noXMLoutput_ZnSysRef:RcvryType == "SensibleOnly") then 0.0 else atof( Format( "%.2f", noXMLoutput_ZnSysRef:HtgLatEff100 ) ) endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery06_HeatingTotalEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef))
        then if (noXMLoutput_AirSysRef:HtRcvryRef:HtRcvryCertification == "HVI") then 0.0 else atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:HtgTotEff100 ) ) endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
        then if (noXMLoutput_ZnSysRef:HtRcvryCertification == "HVI") then 0.0 else atof( Format( "%.2f", noXMLoutput_ZnSysRef:HtgTotEff100 ) ) endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery07_CoolingSensibleEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef)) then atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:ClgSensEff100 ) )
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) then atof( Format( "%.2f", noXMLoutput_ZnSysRef:ClgSensEff100 ) )
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery08_CoolingLatentEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef))
        then if (noXMLoutput_AirSysRef:HtRcvryRef:HtRcvryCertification == "HVI" .OR. noXMLoutput_AirSysRef:HtRcvryRef:RcvryType == "SensibleOnly") then 0.0 else atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:ClgLatEff100 ) ) endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
        then if (noXMLoutput_ZnSysRef:HtRcvryCertification == "HVI" .OR. noXMLoutput_ZnSysRef:RcvryType == "SensibleOnly") then 0.0 else atof( Format( "%.2f", noXMLoutput_ZnSysRef:ClgLatEff100 ) ) endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery09_CoolingTotalEffectiveness100
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef))
        then if (noXMLoutput_AirSysRef:HtRcvryRef:HtRcvryCertification == "HVI") then 0.0 else atof( Format( "%.2f", noXMLoutput_AirSysRef:HtRcvryRef:ClgTotEff100 ) ) endif
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
        then if (noXMLoutput_ZnSysRef:HtRcvryCertification == "HVI") then 0.0 else atof( Format( "%.2f", noXMLoutput_ZnSysRef:ClgTotEff100 ) ) endif
    else UNDEFINED
    endif endif
ENDRULE
RULE nrcctblRowHtRecovery:HtRecovery10_Status
  ANNUAL_PROPOSED
    if (LocalCompAssigned(noXMLoutput_AirSysRef:HtRcvryRef)) 
    then
        switch (noXMLoutput_AirSysRef:HtRcvryRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else if (LocalCompAssigned(noXMLoutput_ZnSysRef)) 
    then
        switch (noXMLoutput_ZnSysRef:Status)
            case "New"      : "New"
            case "Existing" : "ExistingUnchanged"
            case "Altered"  : "ExistingAlteration"
            default :  UNDEFINED
        endswitch
    else UNDEFINED
    endif endif
ENDRULE
