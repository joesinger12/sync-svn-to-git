; -------------------------------------------------------------------------
; Rulelists pertaining to:   Population of NRCCPRF XML objects
; CEC Title-24 Nonresidential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2020, California Energy Commission
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST "NRCCPRF_Proposed"  1 0 0 1
  ; ----------------------------------------------------------------------
  ; Rules to clear past NRCCPRF objects and create those objects populated w/ Proposed model info
   "Delete existing NRCCPRF objects"    nrccComplianceDocumentPackage:Action  = {  DeleteComp()  }

;   "Default Proj:SoftwareVersionDetail to SoftwareVersion if undefined"    Proj:SoftwareVersionDetail  =    ; SAC 2/13/20 (tic #1192)
;      {  if (LocalStatus( SoftwareVersionDetail ) < 1 .AND. LocalStatus( SoftwareVersion ) > 0)
;         then  SoftwareVersion  else  UNCHANGED  endif  }

   "Create & initialize new nrccComplianceDocumentPackage object"
      Proj:Action  = {  CreateComp( nrccComplianceDocumentPackage, "NRCC CompDocPckg", "NRCCPRF_Init_nrccComplianceDocumentPackage" )  }
   "Create & initialize new nrccDocID object"
      nrccComplianceDocumentPackage:Action  = {  CreateChildren( nrccDocID,        1, "NRCC DocID",      "NRCCPRF_Init_nrccDocID" )  }
   "Create & initialize new nrccPayload object"
      nrccComplianceDocumentPackage:Action  = {  CreateChildren( nrccPayload,      1, "NRCC Payload",    "NRCCPRF_Init_nrccPayload" )  }
   "Create & initialize new nrccDocumentData object"
      nrccComplianceDocumentPackage:Action  = {  CreateChildren( nrccDocumentData, 1, "NRCC DocData" )  }     ; no init needed - "NRCCPRF_Init_nrccDocumentData" )  }

;   "Set nrccDocumentData:ProjectNotes"   nrccDocumentData:ProjectNotes   =  { Project:Notes }

   "Set nrccComplianceDocumentPackage:afterchildren_Report"   nrccComplianceDocumentPackage:afterchildren_Report   = {  " "  }
   "Set nrccComplianceDocumentPackage:afterchildren_Report2"  nrccComplianceDocumentPackage:afterchildren_Report2  = {  " "  }
   "Set nrccComplianceDocumentPackage:afterchildren_Input"  nrccComplianceDocumentPackage:afterchildren_Input  = {  " "  }

   "Create & initialize new nrccHeader object"
      nrccDocumentData:Action  = {  CreateChildren( nrccHeader,       1, "NRCC Header",     "NRCCPRF_Init_nrccHeader" )  }

   "Create nrccNRCCPRF object"
      nrccDocumentData:Action  = {  CreateChildren( nrccNRCCPRF,   1, "NRCC Main" )  }     ; no init needed
   "set nrccnRCCPRF:noXMLoutput_UseObjectName for LMCC reporting"    nrccnRCCPRF:noXMLoutput_UseObjectName =      ; SAC 10/09/22 (tic #3393)
      {  if (IfValidAnd( Proj:IsLowRiseMFam > 0 )) then  "lMCCPRF01E"  else  UNDEFINED  endif  }

   "Create nrccSection_Info object"
      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_Info,    1, "NRCC Info" )  }
;      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_Info,    1, "NRCC SecA", "NRCCPRF_Auto_nrccSection_Info" )  }

   "Create nrccSection_Proj object"
      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_Proj,    1, "NRCC Proj" )  }


  ; Section_DwellInfo table only for NRCC-MF & LMCC projects (RJH 10/1/22 Created from CF1RPRF Section_H)
   "Call subordinate rulelist to handle Section_DwellInfo"
      nrccNRCCPRF:Action = {  if (IfValidAnd( Proj:ResDwellUnits > 0 )) 
                              then  EvalRulelist( "CF1RPRF01E_cf1rSection_DwellInfo_Proposed_MultiFamily" )
                              else  UNCHANGED  endif }

  ; Section_DwellType table only for NRCC-MF & LMCC projects (RJH 10/1/22 Created from CF1RPRF Section_I)
   "Call subordinate rulelist to handle Section_DwellType"
      nrccNRCCPRF:Action = {  if (IfValidAnd( Proj:ResDwellUnits > 0 )) 
                              then  EvalRulelist( "CF1RPRF01E_cf1rSection_DwellType_Proposed_MultiFamily" )
                              else  UNCHANGED  endif }

;  ...
;  ...


   "Create nrccSection_C22Result1 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result1,    1, "NRCC C22Result1" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result2 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result2,    1, "NRCC C22Result2" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result3 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result3,    1, "NRCC C22Result3" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result4 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) 
                                 then if ( (enumvalue(Proj:CompType) >= 12 .AND. enumvalue(Proj:CompType) <= 22)  ; RJH 20230702 Nonresidential Project: Other EAA compliance scopes (CompType 12-22)
                                            .OR. enumvalue(Proj:ResCompType) = 22 )                               ; Multifamily/mixed-use Project: ExistingAdditionAndAlteration (ResCompType 22)
                                      then UNDEFINED
                                      else CreateChildren( nrccSection_C22Result4,    1, "NRCC C22Result4" ) 
                                      endif
                                 else UNDEFINED endif  }

   "Create nrccSection_C22Result5 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) 
                                 then if ( (enumvalue(Proj:CompType) >= 12 .AND. enumvalue(Proj:CompType) <= 22)  ; RJH 20230702 Nonresidential Project: Other EAA compliance scopes (CompType 12-22)
                                            .OR. enumvalue(Proj:ResCompType) = 22 )                               ; Multifamily/mixed-use Project: ExistingAdditionAndAlteration (ResCompType 22)
                                      then UNDEFINED
                                      else CreateChildren( nrccSection_C22Result5,    1, "NRCC C22Result5" ) 
                                      endif
                                 else UNDEFINED endif  }

   "Create nrccSection_C22Result6Tier object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result6Tier,    1, "NRCC C22Result6Tier" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result7 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result7,    1, "NRCC C22Result7" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result8 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result8,    1, "NRCC C22Result8" ) else UNDEFINED endif  }

   "Create nrccSection_C22Result9 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion >= 220000) then CreateChildren( nrccSection_C22Result9,    1, "NRCC C22Result9" ) else UNDEFINED endif  }
   "Create nrccSection_C22Result9 nrccTableUMLHC22 object"              nrccSection_C22Result9:Action  =
      {  CreateChildren( nrccTableUMLHC22, 1, "NRCC UMLHC22 table" )  }


   "Create nrccSection_Result1 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion < 220000) then CreateChildren( nrccSection_Result1,    1, "NRCC Result1" ) else UNDEFINED endif  }

   "Create nrccSection_Result2 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion < 220000) then CreateChildren( nrccSection_Result2,    1, "NRCC Result2" ) else UNDEFINED endif  }

   "Create nrccSection_Result3 object"
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion < 220000) then CreateChildren( nrccSection_Result3,    1, "NRCC Result3" ) else UNDEFINED endif  }

   "Create nrccSection_Result4 object" 
      nrccNRCCPRF:Action    = {  if (Proj:AnalysisVersion < 220000) then CreateChildren( nrccSection_Result4,    1, "NRCC Result4" ) else UNDEFINED endif  }
   "Create nrccSection_Result4 nrccTableUMLH object"              nrccSection_Result4:Action  =
      {  CreateChildren( nrccTableUMLH, 1, "NRCC UMLH table" )  }
; moved rules requiring Proposed simulation results to 'NRCCPRF_ap_PostSim' rulelist - SAC 04/14/21

   "Create nrccSection_Except object"
      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_Except,    1, "NRCC Except" )  }
  ; Rule to Delete empty nrccSection_Except located in RULELIST "NRCCPRF_ap_PostSim"

   "Create cf1rSection_FeatMF object (NRCC-MF & LMCC)"        ; SAC 08/22/22 (LMCC)
      nrccNRCCPRF:Action    = {  if (IfValidAnd( Proj:ResDwellUnits > 0 )) 
                                 then  CreateChildren( cf1rSection_FeatMF, 1, "CF1R SecE" )
                                 else  UNCHANGED  endif  }
   "Populate NRCC-MF/LMCC Special Features list (cf1rSection_FeatMF)"    cf1rSection_FeatMF:Action =     ; SAC 08/22/22 (LMCC)
      {  if (ComponentCount( cf1rSection_FeatMF) < 1) then  UNCHANGED
         else  EvalRulelist( "LMCCPRF_Proposed_MFam_SpecialFeatures" )  endif  }

   "Create cf1rSection_HersSum object (LMCC only)"            ; SAC 08/22/22 (LMCC)
      nrccNRCCPRF:Action    = {  if (IfValidAnd( Proj:IsLowRiseMFam > 0 ) .OR. IfValidAnd(Proj:IsHighRiseMFam > 0)) 
                                 then  CreateChildren( cf1rSection_HersSum, 1, "CF1R SecEa" )
                                 else  UNCHANGED  endif  }
   "Populate LMCC HERS list (cf1rSection_HersSum)"      cf1rSection_HersSum:Action =    ; SAC 08/22/22 (LMCC)
      {  if (ComponentCount( cf1rSection_HersSum) < 1) then  UNCHANGED
         else  EvalRulelist( "CF1RPRF01E_Proposed_HERSFeatures" )  endif  }

; duplicate of above section???
   "Create nrccSection_HERS object"
      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_HERS,    1, "NRCC HERS" )  }
  ; Rule to Delete empty nrccSection_HERS located in RULELIST "NRCCPRF_ap_PostSim"

   "Create nrccSection_Remarks object"
      nrccNRCCPRF:Action    = {  CreateChildren( nrccSection_Remarks,    1, "NRCC Remarks" )  }
  ; Rule to Delete empty nrccSection_Remarks RJH 03/01/24 corrected improper deletion
   "DELETE empty nrccSection_Remarks object"
      nrccSection_Remarks:Action   = {  if (GlobalStatus( Proj:NarrativeDetails ) > 0) 
                                        then if (Proj:NarrativeDetails != " - specify - ") 
                                             then UNCHANGED  
                                             else  DeleteComp()  
                                             endif
                                        else DeleteComp()
                                        endif }


   "Create cf1rSection_PV (PV) object (NRCC & LMCC)"           ; SAC 08/23/22
      nrccNRCCPRF:Action    = {  if ( IfValidAnd( Proj:AnalysisVersion > 220000 ) .AND.
                                      ( IfValidAnd( Proj:CommunitySolarProjID > 0 ) .OR.
                                        IfValidAnd( Proj:DCSizeMultiplier > 0 ) ) ) 
                                 then   if (Proj:PVComp = "Performance") then CreateChildren( cf1rSection_PV, 1, "CF1R SecDa" ) else UNCHANGED endif
                                 else  UNCHANGED  endif  }
   "Create cf1rTablePV object"
      cf1rSection_PV:Action = {  if (ComponentCount( cf1rSection_PV ) > 0) then  CreateChildren( cf1rTablePV, 1, "EDR_PV" )  else  UNCHANGED  endif  }  
   "Populate cf1rTablePV NRCC/LMCC PV table row for CommunitySolar via rulelist"   cf1rTablePV:Action =     ; logic to NOT create row if no cf1rSection_PV present - SAC 10/13/22
      {  if (ComponentCount( cf1rSection_PV ) > 0 .AND. IfValidAnd( Proj:CommunitySolarProjID > 0 ))
         then  CreateChildren( cf1rtblRowPV, 1, "NRCC CommSlrPVRow", "CF1RPRF01E_Section_Da_Row1_CommunitySolar" )
         else  UNCHANGED  endif  }
   "Populate PVArray NRCC/LMCC PV table row via rulelist"      PVArray:Action =              ; logic to NOT create row if no cf1rSection_PV present - SAC 10/13/22
      {  if (ComponentCount( cf1rSection_PV ) < 1 .OR. 
             IfValidAnd( Proj:CommunitySolarProjID > 0 ) .OR. IfValidAnd( DCSysSize > 0 ) == 0 .OR.
             IfValidAnd( Az >= 0 )==0 .OR. IfValidAnd( Az <= 360 )==0 .OR.
             IfValidAnd( TiltAngle >= 0 )==0 .OR. IfValidAnd( TiltAngle <= 90 )==0) then  UNDEFINED
         else  EvalRulelist( "CF1RPRF01E_Section_Da_PVArray", 1 )  endif  }



  ; Section_PVBatBldgTypes
   "Create nrccSection_PVBatBldgTypes object" 
      nrccNRCCPRF:Action    = {  if ( IfValidAnd( Proj:AnalysisVersion > 220000 ) .AND.
                                      ( IfValidAnd( Proj:CommunitySolarProjID > 0 ) .OR.
                                        IfValidAnd( Proj:DCSizeMultiplier > 0 ) ) ) 
                                 then   if (Proj:PVComp = "Performance") then CreateChildren( nrccSection_PVBatBldgTypes, 1, "NRCC PVBatBldgTypes" ) else UNCHANGED endif
                                 else  UNCHANGED  endif  }
   "Create nrccSection_PVBatBldgTypes nrccTablePVBatBldgTypes object"                 nrccSection_PVBatBldgTypes:Action  =
      {  CreateChildren( nrccTablePVBatBldgTypes, 1, "NRCC PVBatBldgTypes table" )  }
  ; ----------------------------------------------------------------------

  ; Rules to create individual PVBatBldgTypes table rows for Proj:CondPVBattBldgTypeArea[*] >= 0
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[1] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[1]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[1] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[2] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[2]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[2] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[3] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[3]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[3] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[4] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[4]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[4] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[5] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[5]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[5] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[6] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[6]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[6] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[7] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[7]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[7] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
   "Create nrcctblRowPVBatBldgTypes table row for Proj:CondPVBattBldgTypeArea[10] >= 0"
      Proj:NRCC_PVBatBldgTypesRow[8]   = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) 
                                           then  UNDEFINED
                                           else if (IfValidAnd( CondPVBattBldgTypeArea[10] >= 0 ))
                                                then  CreateComp( nrcctblRowPVBatBldgTypes, Format( "%s PVBatBldgTypes tblRow", Name ) )  
                                                else  UNDEFINED  
                                                endif 
                                           endif }
 ; ----------------------------------------------------------------------
   ; Rules to populate individual PVBatBldgTypes table rows for Proj:CondPVBattBldgTypeArea[*] >= 0
   "Set Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes01_BldgOccType = {  "Grocery"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[1] >= 0)) then CondPVBattBldgTypeArea[1] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[1]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[1] >= 0)) then UncondPVBattBldgTypeArea[1] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes01_BldgOccType = {  "HighRiseMultifamily"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[2] >= 0)) then CondPVBattBldgTypeArea[2] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[2]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[2] >= 0)) then UncondPVBattBldgTypeArea[2] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes01_BldgOccType = {  "OfficeFinancialUnleased"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[3] >= 0)) then CondPVBattBldgTypeArea[3] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[3]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[3] >= 0)) then UncondPVBattBldgTypeArea[3] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes01_BldgOccType = {  "Retail"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[4] >= 0)) then CondPVBattBldgTypeArea[4] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[4]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[4] >= 0)) then UncondPVBattBldgTypeArea[4] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes01_BldgOccType = {  "School"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[5] >= 0)) then CondPVBattBldgTypeArea[5] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[5]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[5] >= 0)) then UncondPVBattBldgTypeArea[5] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes01_BldgOccType = {  "Warehouse"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[6] >= 0)) then CondPVBattBldgTypeArea[6] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[6]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[6] >= 0)) then UncondPVBattBldgTypeArea[6] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes01_BldgOccType = {  "Other"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[7] >= 0)) then CondPVBattBldgTypeArea[7] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[7]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[7] >= 0)) then UncondPVBattBldgTypeArea[7] else UNCHANGED endif }

   "Set Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes01_BldgOccType"   Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes01_BldgOccType = {  "None"  }
   "Set Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes02_CondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes02_CondFloorArea = { if (IfValidAnd(CondPVBattBldgTypeArea[10] >= 0)) then CondPVBattBldgTypeArea[10] else UNCHANGED endif }
   "Set Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes03_UnCondFloorArea"   Proj:NRCC_PVBatBldgTypesRow[8]:PVBatBldgTypes03_UnCondFloorArea = { if (IfValidAnd(UncondPVBattBldgTypeArea[10] >= 0)) then UncondPVBattBldgTypeArea[10] else UNCHANGED endif }


   "Set nrcctblRowPVBatBldgTypes parent"   nrcctblRowPVBatBldgTypes:Parent  = { if (ComponentCount( nrccTablePVBatBldgTypes ) < 1) then UNCHANGED else nrccTablePVBatBldgTypes:Name endif }
  ; END of Section_PVBatBldgTypes rules
  ; ----------------------------------------------------------------------


   "Create cf1rSection_Bat (Batt) object (NRCC & LMCC)"         ; SAC 08/23/22
      nrccNRCCPRF:Action    = {  if (IfValidAnd( Proj:AnalysisVersion > 220000 ) .AND. IfValidAnd( Proj:BattCapMult > 0 )) 
                                 then  if (Proj:BattComp = "Performance") then CreateChildren( cf1rSection_Bat, 1, "CF1R SecDb" ) else UNCHANGED endif
                                 else  UNCHANGED  endif  }
   "Create cf1rTableBat object"
      cf1rSection_Bat:Action = {  if (ComponentCount( cf1rSection_Bat ) > 0) then  CreateChildren( cf1rTableBat, 1, "EDR_Bat" )  else  UNCHANGED  endif  }  
   "Populate Batt NRCC/LMCC table row via rulelist"      Batt:Action = 
      {  if (ComponentCount( cf1rSection_Bat ) < 1) then  UNDEFINED
         else  EvalRulelist( "CF1RPRF01E_Section_Db_Batt", 1 )  endif  }


   "Create nrccSection_BatExcept object"                               nrccNRCCPRF:Action       =
      {  if (Proj:BattComp != "Performance") 
         then  UNCHANGED
         else if (SumAll( Spc:BattReq_PartOfLargeTenantArea ) > 0 .OR. SumAll( ResOtherZn:BattReq_PartOfLargeTenantArea ) > 0) 
              then CreateChildren( nrccSection_BatExcept, 1, "NRCC BatExcept" ) 
              else UNCHANGED
              endif
         endif  }
   "Create nrccSection_BatExcept nrccTableCRRC object"                 nrccSection_BatExcept:Action  =
      {  CreateChildren( nrccTableBatExcept, 1, "NRCC BatExcept table" )  }

   ; reversed logic on setting PartOfLargeTenantArea exception - flag only if TotBldgArea <= 5k or (ShowBattReq_PartOfLargeTenantArea true and BattReq_PartOfLargeTenantArea UNchecked) - SAC 01/22/23
   "Create nrcctblRowBatExcept object for each pertinent Spc"     Spc:nrcctblRowBatExceptRef =
      {  if (LocalCompAssigned( nrcctblRowBatExceptRef ) > 0 .OR.
             ComponentCount( nrccTableBatExcept ) < 1 .OR.
             ( IfValidAnd( Bldg:TotCondFlrArea > 5000 ) .AND.
               ( ShowBattReq_PartOfLargeTenantArea < 1 .OR. BattReq_PartOfLargeTenantArea > 0 ) ))
         then  UNDEFINED
         else CreateComp( nrcctblRowBatExcept, Format( "%s BatExcept tblRow", Name ) )
         endif  }
   "Set Spc:nrcctblRowBatExceptRef:noXMLoutput_SpcRef"    Spc:nrcctblRowBatExceptRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowBatExcept object for each pertinent ResOtherZn"     ResOtherZn:nrcctblRowBatExceptRef =
      {  if (LocalCompAssigned( nrcctblRowBatExceptRef ) > 0 .OR.
             ComponentCount( nrccTableBatExcept ) < 1 .OR.
             ( IfValidAnd( Bldg:TotCondFlrArea > 5000 ) .AND.
               ( ShowBattReq_PartOfLargeTenantArea < 1 .OR. BattReq_PartOfLargeTenantArea > 0 ) ))
         then  UNDEFINED
         else CreateComp( nrcctblRowBatExcept, Format( "%s BatExcept tblRow", Name ) )
         endif  }
   "Set ResOtherZn:nrcctblRowBatExceptRef:noXMLoutput_ResOtherZnRef"    ResOtherZn:nrcctblRowBatExceptRef:noXMLoutput_ResOtherZnRef = {  Name  }

  ; Rule to Delete empty nrccSection_BatExcept
   "DELETE empty nrccSection_BatExcept object"
      nrccSection_BatExcept:Action   = {  if (ComponentCount( nrcctblRowBatExcept ) < 1) then  DeleteComp()  else  UNCHANGED  endif }

;  ...
;  ...


   "Create nrccSection_Env object"
      nrccNRCCPRF:Action    = {  if (Proj:CompPathEnv == "Performance" .OR. Proj:ResCompPathEnv == "Performance") 
                                 then CreateChildren( nrccSection_Env,    1, "NRCC Env" )
                                 else UNCHANGED 
                                 endif }

   "Create nrccSection_CRRC object"                               nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv != "Performance" .OR. SumAcrossIf( ConsAssm:AreaNew, ConsAssm:CompatibleSurfTypeRpt = "Roof" ) < 1) then  UNCHANGED
         else  CreateChildren( nrccSection_CRRC, 1, "NRCC CRRC" )  endif  }
   "Create nrccSection_CRRC nrccTableCRRC object"                 nrccSection_CRRC:Action  =
      {  CreateChildren( nrccTableCRRC, 1, "NRCC CRRC table" )  }
   "Create nrcctblRowCRRC object for each pertinent ConsAssm"     ConsAssm:nrcctblRowCRRCRef =
      {  if (LocalCompAssigned( nrcctblRowCRRCRef ) > 0 .OR.
             ComponentCount( nrccTableCRRC ) < 1 .OR.
             IfValidAnd( AreaNew > 0.1 )==0) then  UNDEFINED
         else if (IfValidAnd(CompatibleSurfTypeRpt == "Roof") .AND. IfValidAnd(HasCRRCProdID == 1))
              then CreateComp( nrcctblRowCRRC, Format( "%s CRRC tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set ConsAssm:nrcctblRowCRRCRef:noXMLoutput_ConsAssmRef"    ConsAssm:nrcctblRowCRRCRef:noXMLoutput_ConsAssmRef = {  Name  }

  ; Rule to Delete empty nrccSection_CRRC
   "DELETE empty nrccSection_CRRC object"
      nrccSection_CRRC:Action   = {  if (ComponentCount( nrcctblRowCRRC ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_CRRCmf object"                               nrccNRCCPRF:Action       =
      {  if (Proj:ResCompPathEnv != "Performance") then  UNCHANGED
         else  CreateChildren( nrccSection_CRRCmf, 1, "NRCC CRRCmf" )  endif  }
   "Create nrccSection_CRRCmf nrccTableCRRCmf object"                 nrccSection_CRRCmf:Action  =
      {  CreateChildren( nrccTableCRRCmf, 1, "NRCC CRRCmf table" )  }

   "Create nrcctblRowCRRCmf object for each pertinent ResCathedralCeiling"     ResCathedralCeiling:nrcctblRowCRRCmfRef =
      {  if (LocalCompAssigned( nrcctblRowCRRCmfRef ) > 0 .OR.
             ComponentCount( nrccTableCRRCmf ) < 1 .OR.
             IfValidAnd( Area > 0.1 )==0) then  UNDEFINED
         else CreateComp( nrcctblRowCRRCmf, Format( "%s CRRCmf tblRow", Name ) )
         endif  }
   "Set ResCathedralCeiling:nrcctblRowCRRCmfRef:noXMLoutput_ResCathedralCeilingRef"    ResCathedralCeiling:nrcctblRowCRRCmfRef:noXMLoutput_ResCathedralCeilingRef = {  Name  }

   "Create nrcctblRowCRRCmf object for each pertinent ResAttic"     ResAttic:nrcctblRowCRRCmfRef =
      {  if (LocalCompAssigned( nrcctblRowCRRCmfRef ) > 0 .OR.
             ComponentCount( nrccTableCRRCmf ) < 1 .OR.
             IfValidAnd( Area > 0.1 )==0) then  UNDEFINED
         else CreateComp( nrcctblRowCRRCmf, Format( "%s CRRCmf tblRow", Name ) )
         endif  }
   "Set ResAttic:nrcctblRowCRRCmfRef:noXMLoutput_ResAtticRef"    ResAttic:nrcctblRowCRRCmfRef:noXMLoutput_ResAtticRef = {  Name  }

  ; Rule to Delete empty nrccSection_CRRCmf
   "DELETE empty nrccSection_CRRCmf object"
      nrccSection_CRRCmf:Action   = {  if (ComponentCount( nrcctblRowCRRCmf ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


  ; Section_Attic table only if Attics exist in the project
   "Call subordinate rulelist to handle Section_Attic"
      nrccNRCCPRF:Action = {  if (Proj:CompPathEnv == "Performance" .OR. Proj:ResCompPathEnv == "Performance")
                              then if ( ComponentCount( ResAttic ) > 0 ) 
                                   then  EvalRulelist( "CF1RPRF01E_cf1rSection_Attic_Proposed" )
                                   else  UNCHANGED  
                                   endif
                              else UNCHANGED
                              endif }


   "Create nrccSection_AirBar object"                               nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv != "Performance") then  UNCHANGED
         else  CreateChildren( nrccSection_AirBar, 1, "NRCC AirBar" )  endif  }
   "Create nrccSection_AirBar nrccTableAirBar object"                 nrccSection_AirBar:Action  =
      {  CreateChildren( nrccTableAirBar, 1, "NRCC AirBar table" )  }
   "Create nrcctblRowAirBar object for each pertinent Story"     Story:nrcctblRowAirBarRef =
      {  if (LocalCompAssigned( nrcctblRowAirBarRef ) > 0 .OR. ComponentCount( nrccTableAirBar ) < 1) 
         then  UNDEFINED
         else CreateComp( nrcctblRowAirBar, Format( "%s AirBar tblRow", Name ) )
         endif  }
   "Set Story:nrcctblRowAirBarRef:noXMLoutput_StoryRef"    Story:nrcctblRowAirBarRef:noXMLoutput_StoryRef = {  Name  }

  ; Rule to Delete empty nrccSection_AirBar
   "DELETE empty nrccSection_AirBar object"
      nrccSection_AirBar:Action   = {  if (ComponentCount( nrcctblRowAirBar ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_Opaq object"                               nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv == "Performance" .OR. Proj:ResCompPathEnv == "Performance") 
         then CreateChildren( nrccSection_Opaq, 1, "NRCC Opaq" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Opaq nrccTableOpaq object"                 nrccSection_Opaq:Action  =
      {  CreateChildren( nrccTableOpaq, 1, "NRCC Opaq table" )  }
   "Create nrcctblRowOpaq object for each pertinent ConsAssm"     ConsAssm:nrcctblRowOpaqRef =
      {  if (LocalCompAssigned( nrcctblRowOpaqRef ) > 0 .OR.
             ComponentCount( nrccTableOpaq ) < 1 .OR.
             (IfValidAnd( AreaNew > 0.1 )==0 .AND. IfValidAnd( AreaExisting > 0.1 )==0 .AND. IfValidAnd( AreaAltered > 0.1 )==0)) then  UNDEFINED
         else  CreateComp( nrcctblRowOpaq, Format( "%s Opaq tblRow", Name ) )
         endif  }
   "Set ConsAssm:nrcctblRowOpaqRef:noXMLoutput_ConsAssmRef"    ConsAssm:nrcctblRowOpaqRef:noXMLoutput_ConsAssmRef = {  Name  }

   "Create nrccOpaq09 child object for each nrcctblRowOpaq"     ConsAssm:nrccOpaq09Ref =
      {  if (IfValidAnd( AreaNew > 0.1 )==0 .AND. IfValidAnd( AreaExisting > 0.1 )==0 .AND. IfValidAnd( AreaAltered > 0.1 )==0) then  UNDEFINED
         else  CreateComp( nrccOpaq09, Format( "%s Opaq09", Name ) )
         endif  }
   "Set ConsAssm:nrccOpaq09Ref:noXMLoutput_ConsAssmRef"    ConsAssm:nrccOpaq09Ref:noXMLoutput_ConsAssmRef = {  Name  }

   "Create nrccOpaq09Slab child object for each Slab nrcctblRowOpaq"     ConsAssm:nrccOpaq09SlabRef =
      {  if ((IfValidAnd( AreaNew > 0.1 )==0 .AND. IfValidAnd( AreaExisting > 0.1 )==0 .AND. IfValidAnd( AreaAltered > 0.1 )==0) .OR.
             CompatibleSurfaceType != "UndergroundFloor" .OR. SlabType == "- specify -") then  UNDEFINED
         else  CreateComp( nrccOpaq09Slab, Format( "%s Opaq09Slab", Name ) )
         endif  }
   "Set ConsAssm:nrccOpaq09SlabRef:noXMLoutput_ConsAssmRef"    ConsAssm:nrccOpaq09SlabRef:noXMLoutput_ConsAssmRef = {  Name  }

   "Create nrccOpaq09Layers child object for each nrcctblRowOpaq except UndergroundFloor"     ConsAssm:nrccOpaq09LayersRef =
      {  if ((IfValidAnd( AreaNew > 0.1 )==0 .AND. IfValidAnd( AreaExisting > 0.1 )==0 .AND. IfValidAnd( AreaAltered > 0.1 )==0) .OR.
             CompatibleSurfaceType == "UndergroundFloor") then  UNDEFINED
         else  CreateComp( nrccOpaq09Layers, Format( "%s Opaq09Layers", Name ) )
         endif  }
   "Set ConsAssm:nrccOpaq09LayersRef:noXMLoutput_ConsAssmRef"    ConsAssm:nrccOpaq09LayersRef:noXMLoutput_ConsAssmRef = {  Name  }

   ; RJH 10/15/22 Add ResConsAssm rows to existing table, merging property elements where possible
   "Create nrcctblRowOpaq object for each pertinent ResConsAssm"     ResConsAssm:nrcctblRowOpaqRef =
      {  if (LocalCompAssigned( nrcctblRowOpaqRef ) > 0 .OR.
             ComponentCount( nrccTableOpaq ) < 1 .OR.
             IfValidAnd( AssignedSurfaceArea > 0.1 )==0) then  UNDEFINED
         else  CreateComp( nrcctblRowOpaq, Format( "%s Opaq tblRow", Name ) )
         endif  }
   "Set ResConsAssm:nrcctblRowOpaqRef:noXMLoutput_ResConsAssmRef"    ResConsAssm:nrcctblRowOpaqRef:noXMLoutput_ResConsAssmRef = {  Name  }

   "Create nrccOpaq09 child object for each ResConsAssm nrcctblRowOpaq"     ResConsAssm:nrccOpaq09Ref =
      {  if (IfValidAnd( AssignedSurfaceArea > 0.1 )==0) then  UNDEFINED
         else  CreateComp( nrccOpaq09, Format( "%s Opaq09", Name ) )
         endif  }
   "Set ResConsAssm:nrccOpaq09Ref:noXMLoutput_ResConsAssmRef"    ResConsAssm:nrccOpaq09Ref:noXMLoutput_ResConsAssmRef = {  Name  }

   "Create nrccOpaq09Layers child object for each ResConsAssm nrcctblRowOpaq"     ResConsAssm:nrccOpaq09LayersRef =
      {  if (IfValidAnd( AssignedSurfaceArea > 0.1 )==0) then  UNDEFINED
         else  CreateComp( nrccOpaq09Layers, Format( "%s Opaq09Layers", Name ) )
         endif  }
   "Set ResConsAssm:nrccOpaq09LayersRef:noXMLoutput_ResConsAssmRef"    ResConsAssm:nrccOpaq09LayersRef:noXMLoutput_ResConsAssmRef = {  Name  }


  ; Rule to Delete empty nrccSection_Opaq
   "DELETE empty nrccSection_Opaq object"
      nrccSection_Opaq:Action   = {  if (ComponentCount( nrcctblRowOpaq ) < 1) then  DeleteComp()  else  UNCHANGED  endif }

   "Create nrccSection_Door object"                               nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv == "Performance") 
         then CreateChildren( nrccSection_Door, 1, "NRCC Door" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Door nrccTableDoor object"                 nrccSection_Door:Action  =
      {  CreateChildren( nrccTableDoor, 1, "NRCC Door table" )  }
   "Create nrcctblRowDoor object for each pertinent DrCons"     DrCons:nrcctblRowDoorRef =
      {  if (LocalCompAssigned( nrcctblRowDoorRef ) > 0 .OR.
             ComponentCount( nrccTableDoor ) < 1) then  UNDEFINED
         else  CreateComp( nrcctblRowDoor, Format( "%s Door tblRow", Name ) )
         endif  }
   "Set DrCons:nrcctblRowDoorRef:noXMLoutput_DrConsRef"    DrCons:nrcctblRowDoorRef:noXMLoutput_DrConsRef = {  Name  }
  ; Rule to Delete empty nrccSection_Door
   "DELETE empty nrccTableDoor object"
      nrccSection_Door:Action   = {  if (ComponentCount( nrcctblRowDoor ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


  ; Section_Doormf table only if ResDoor instances in the project
   "Call subordinate rulelist to handle Section_Doormf"
      nrccNRCCPRF:Action = {  if (Proj:ResCompPathEnv == "Performance")
                              then if ( ComponentCount( ResDr ) > 0 ) 
                                   then  EvalRulelist( "CF1RPRF01E_cf1rSection_Doormf_Proposed" )
                                   else  UNCHANGED  
                                   endif
                              else UNCHANGED
                              endif }


   "Create nrccSection_Fen object"                               nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv == "Performance") 
         then CreateChildren( nrccSection_Fen, 1, "NRCC Fenestration" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Fen nrccTableFen object"                 nrccSection_Fen:Action  =
      {  CreateChildren( nrccTableFen, 1, "NRCC Fenestration table" )  }
   "Create nrcctblRowFen object for each pertinent FenCons"     FenCons:nrcctblRowFenRef =
      {  if (LocalCompAssigned( nrcctblRowFenRef ) > 0 .OR.
             ComponentCount( nrccTableFen ) < 1) then  UNDEFINED
         else if (IfValidAnd( AreaNew > 0 ) .OR. IfValidAnd( AreaAltered > 0 ) .OR. IfValidAnd( AreaExisting > 0 )) 
              then CreateComp( nrcctblRowFen, Format( "%s Fenestration tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set FenCons:nrcctblRowFenRef:noXMLoutput_FenConsRef"    FenCons:nrcctblRowFenRef:noXMLoutput_FenConsRef = {  Name  }
  ; Rule to Delete empty nrccSection_Fen
   "DELETE empty nrccSection_Fen object"
      nrccSection_Fen:Action   = {  if (ComponentCount( nrcctblRowFen ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


  ; Section_Fenmf table only if ResWin or ResSkylt instances in the project
   "Call subordinate rulelist to handle Section_Fenmf"
      nrccNRCCPRF:Action = {  if (Proj:ResCompPathEnv == "Performance")
                              then if ( ComponentCount( ResWin ) > 0 .OR. ComponentCount( ResSkylt ) > 0 ) 
                                   then  EvalRulelist( "CF1RPRF01E_cf1rSection_Fenmf_Proposed" )
                                   else  UNCHANGED  
                                   endif
                              else UNCHANGED
                              endif }


   ; setup Window Parent Azimuth to be used in populating Overhang data in table
   "Set Win:ParentAzimuthRpt"   Win:ParentAzimuthRpt = 
      {  Parent( Azimuth )  }

   "Create nrccSection_OverHang object"                   nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv != "Performance" .AND. Proj:ResCompPathEnv != "Performance") then  UNCHANGED
         else  CreateChildren( nrccSection_OverHang, 1, "NRCC OverHang" )  endif  }
   "Create nrccSection_OverHang nrccTableOverHang object"           nrccSection_OverHang:Action  =
      {  CreateChildren( nrccTableOverHang, 1, "NRCC OverHang table" )  }
   
   "Create nrcctblRowOverHang object for each pertinent Win"     Win:nrcctblRowOverHangRef =
      {  if (LocalCompAssigned( nrcctblRowOverHangRef ) > 0 .OR.
             ComponentCount( nrccTableOverHang ) < 1 .OR.
             IfValidAnd( EnableWinShades > 0 )==0 .OR.
             IfValidAnd( Area > 0 )==0 .OR.
             IfValidAnd( OverhangDepth >= 0.05 )==0) then  UNDEFINED
         else  CreateComp( nrcctblRowOverHang, Format( "%s OverHang tblRow", Name ) )
         endif  }
   "Set Win:nrcctblRowOverHangRef:noXMLoutput_WinRef"    Win:nrcctblRowOverHangRef:noXMLoutput_WinRef = {  Name  }
   
   "Create nrcctblRowOverHang object for each pertinent ResWin"     ResWin:nrcctblRowOverHangRef =
      {  if (LocalCompAssigned( nrcctblRowOverHangRef ) > 0 .OR.
             ComponentCount( nrccTableOverHang ) < 1 .OR.
             IfValidAnd( ModelFinsOverhang > 0 )==0 .OR.
             IfValidAnd( Area > 0 )==0 .OR.
             IfValidAnd( OverhangDepth >= 0.05 )==0) then  UNDEFINED
         else  CreateComp( nrcctblRowOverHang, Format( "%s OverHang tblRow", Name ) )
         endif  }
   "Set ResWin:nrcctblRowOverHangRef:noXMLoutput_ResWinRef"    ResWin:nrcctblRowOverHangRef:noXMLoutput_ResWinRef = {  Name  }
  
  ; Rule to Delete empty nrccSection_OverHang
   "DELETE empty nrccSection_OverHang object"
      nrccSection_OverHang:Action   = {  if (ComponentCount( nrcctblRowOverHang ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_Fins object"                   nrccNRCCPRF:Action       =
      {  if (Proj:CompPathEnv != "Performance" .AND. Proj:ResCompPathEnv != "Performance") then  UNCHANGED
         else  CreateChildren( nrccSection_Fins, 1, "NRCC Fins" )  endif  }
   "Create nrccSection_Fins nrccTableFins object"           nrccSection_Fins:Action  =
      {  CreateChildren( nrccTableFins, 1, "NRCC Fins table" )  }

   "Create nrcctblRowFins object for each pertinent Win"     Win:nrcctblRowFinsRef =
      {  if (LocalCompAssigned( nrcctblRowFinsRef ) > 0 .OR.
             ComponentCount( nrccTableFins ) < 1 .OR.
             IfValidAnd( EnableWinShades > 0 )==0 .OR.
             IfValidAnd( Area > 0 )==0 ) then  UNDEFINED
         else  if (IfValidAnd(LeftFinDepth >= 0.05) .OR. IfValidAnd(RightFinDepth >= 0.05)) 
               then CreateComp( nrcctblRowFins, Format( "%s Fins tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set Win:nrcctblRowFinsRef:noXMLoutput_WinRef"    Win:nrcctblRowFinsRef:noXMLoutput_WinRef = {  Name  }

   "Create nrcctblRowFins object for each pertinent ResWin"     ResWin:nrcctblRowFinsRef =
      {  if (LocalCompAssigned( nrcctblRowFinsRef ) > 0 .OR.
             ComponentCount( nrccTableFins ) < 1 .OR.
             IfValidAnd( ModelFinsOverhang > 0 )==0 .OR.
             IfValidAnd( Area > 0 )==0 ) then  UNDEFINED
         else  if (IfValidAnd(LeftFinDepth >= 0.05) .OR. IfValidAnd(RightFinDepth >= 0.05)) 
               then CreateComp( nrcctblRowFins, Format( "%s Fins tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set ResWin:nrcctblRowFinsRef:noXMLoutput_ResWinRef"    ResWin:nrcctblRowFinsRef:noXMLoutput_ResWinRef = {  Name  }

  ; Rule to Delete empty nrccSection_Fins
   "DELETE empty nrccSection_Fins object"
      nrccSection_Fins:Action   = {  if (ComponentCount( nrcctblRowFins ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   ; setup HSPF/HSPF2 and COP report values to be used in populating Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Set AirSys:HtgEffHSPFRpt"  AirSys:HtgEffHSPFRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "HSPF2/COP" ) )
             then Format( FltToStr( MaxChild( CoilHtg:HtPumpHSPF2 ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) )
             else if( IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
                  then Format( FltToStr( MaxChild( CoilHtg:HtPumpHSPF ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set AirSys:HtgEffCOPRpt"  AirSys:HtgEffCOPRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "HSPF2/COP" ) .OR. IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
             then Format( FltToStr( MaxChild( CoilHtg:HtPumpCOPRnd ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) ) 
             else UNDEFINED
             endif
        else UNDEFINED
        endif }

   ; setup SEER and EER report values to be used in populating Section_HvacDry data - RJH 11/04/21 Updated for SEER2/EER2 10/20/22
   "Set AirSys:ClgEffEERRpt"  AirSys:ClgEffEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then if( MaxChild( CoilClg:DXEER2 ) > 0 )
                  then Format( FltToStr( MaxChild( CoilClg:DXEER2 ), MaxChild( CoilClg:EERSEERRndScl ) ) ) 
                  else UNDEFINED
                  endif
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( MaxChild( CoilClg:DXEERRnd ), MaxChild( CoilClg:EERSEERRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set AirSys:ClgEffSEERRpt"  AirSys:ClgEffSEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then if( MaxChild( CoilClg:DXSEER2 ) > 0 )
                  then Format( FltToStr( MaxChild( CoilClg:DXSEER2 ), MaxChild( CoilClg:EERSEERRndScl ) ) ) 
                  else UNDEFINED
                  endif
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( MaxChild( CoilClg:DXSEERRnd ), MaxChild( CoilClg:EERSEERRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }


   ; setup HSPF/HSPF2 and COP report values to be used in populating Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Set ZnSys:HtgEffHSPFRpt"  ZnSys:HtgEffHSPFRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "HSPF2/COP" ) )
             then Format( FltToStr( MaxChild( CoilHtg:HtPumpHSPF2 ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) )
             else if( IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
                  then Format( FltToStr( MaxChild( CoilHtg:HtPumpHSPF ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set ZnSys:HtgEffCOPRpt"  ZnSys:HtgEffCOPRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "HSPF2/COP" ) .OR. IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
             then Format( FltToStr( MaxChild( CoilHtg:HtPumpCOPRnd ), MaxChild( CoilHtg:HSPFCOPRndScl ) ) ) 
             else UNDEFINED
             endif
        else UNDEFINED
        endif }

   "Set ZnSys:ClgEffEERRpt"  ZnSys:ClgEffEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then if( MaxChild( CoilClg:DXEER2 ) > 0 )
                  then Format( FltToStr( MaxChild( CoilClg:DXEER2 ), MaxChild( CoilClg:EERSEERRndScl ) ) ) 
                  else UNDEFINED
                  endif
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( MaxChild( CoilClg:DXEERRnd ), MaxChild( CoilClg:EERSEERRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set ZnSys:ClgEffSEERRpt"  ZnSys:ClgEffSEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then if( MaxChild( CoilClg:DXEER2 ) > 0 )
                  then Format( FltToStr( MaxChild( CoilClg:DXSEER2 ), MaxChild( CoilClg:EERSEERRndScl ) ) ) 
                  else UNDEFINED
                  endif
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( MaxChild( CoilClg:DXSEERRnd ), MaxChild( CoilClg:EERSEERRndScl ) ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }



   ; setup HSPF/HSPF2 and COP report values to be used in populating Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Set VRFSys:HtgEffHSPFRpt"  VRFSys:HtgEffHSPFRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "HSPF" ) )
             then Format( FltToStr( HSPFRnd, 2 ) )
             else if( IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
                  then Format( FltToStr( HSPFRnd, 2 ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set VRFSys:HtgEffCOPRpt"  VRFSys:HtgEffCOPRpt = 
      { if( IfValidAnd( HtgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( HtgEffUnitRpt = "COP" ) .OR. IfValidAnd( HtgEffUnitRpt = "HSPF/COP" ) )
             then Format( FltToStr( COPRnd, 2 ) ) 
             else UNDEFINED
             endif
        else UNDEFINED
        endif }

   "Set VRFSys:ClgEffEERRpt"  VRFSys:ClgEffEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then Format( FltToStr( EERRnd, 2 ) )
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( EERRnd, 2 ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }
   "Set VRFSys:ClgEffSEERRpt"  VRFSys:ClgEffSEERRpt = 
      { if( IfValidAnd( ClgEffUnitRpt != "NA" ) )
        then if( IfValidAnd( ClgEffUnitRpt = "SEER2/EER2" ) )
             then Format( FltToStr( SEERRnd, 2 ) )
             else if( IfValidAnd( ClgEffUnitRpt = "SEER/EER" ) )
                  then Format( FltToStr( SEERRnd, 2 ) )        
                  else UNDEFINED
                  endif
             endif
        else UNDEFINED
        endif }



   "Create nrccSection_HvacDry object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance" .OR. Proj:ResCompPathMech == "Performance") 
         then  CreateChildren( nrccSection_HvacDry, 1, "HVAC Dry" )
         else UNCHANGED 
         endif }
   "Create nrccSection_HvacDry nrccTableHvacDry object"              nrccSection_HvacDry:Action  =
      {  CreateChildren( nrccTableHvacDry, 1, "HVAC Dry table" )  }

   "Create nrcctblRowHvacDry object for each pertinent AirSys"     AirSys:nrcctblRowHvacDryRef =
      {  if (LocalCompAssigned( nrcctblRowHvacDryRef ) > 0 .OR.
             ComponentCount( nrccTableHvacDry ) < 1 .OR.
             ComponentCount( AirSys ) < 1 .OR.
             IfValidAnd( Type == "Exhaust" ) .OR.
             ( IfValidAnd( BaseSysNum > 0 ) .AND. IfValidAnd ( ServesResZn = 0) ) .OR.
             IfValidAnd( ExcludeFromRpt > 0 ) .OR.
             IfValidAnd( IsHlthCareSys > 0 ) ) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacDry, Format( "%s HvacDry tblRow", Name ) )
         endif  }

   "Set AirSys:nrcctblRowHvacDryRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowHvacDryRef:noXMLoutput_AirSysRef = 
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else Name
         endif  }

   ; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Create nrccHvacDry06b child object for each AirSys nrcctblRowHvacDry"     AirSys:nrccHvacDry06bRef =
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry06b, Format( "%s HvacDry06b", Name ) )
         endif  }
   "Set AirSys:nrccHvacDry06bRef:noXMLoutput_AirSysRef"    AirSys:nrccHvacDry06bRef:noXMLoutput_AirSysRef = {  Name  }

   "Create nrccHvacDry06c child object for each AirSys HSPF/COP nrcctblRowHvacDry"     AirSys:nrccHvacDry06cRef =
      {  if ( IfValidAnd( HtgEffUnitRpt == "HSPF/COP" ) .OR. IfValidAnd( HtgEffUnitRpt == "HSPF2/COP" ) ) then  CreateComp( nrccHvacDry06c, Format( "%s HvacDry06c", Name ) )
         else  UNDEFINED
         endif  }
   "Set AirSys:nrccHvacDry06cRef:noXMLoutput_AirSysRef"    AirSys:nrccHvacDry06cRef:noXMLoutput_AirSysRef = {  Name  }

   "Create nrccHvacDry08b child object for each AirSys nrcctblRowHvacDry"     AirSys:nrccHvacDry08bRef =
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry08b, Format( "%s HvacDry08b", Name ) )
         endif  }
   "Set AirSys:nrccHvacDry08bRef:noXMLoutput_AirSysRef"    AirSys:nrccHvacDry08bRef:noXMLoutput_AirSysRef = {  Name  }

   "Create nrccHvacDry08c child object for each AirSys SEER/EER nrcctblRowHvacDry"     AirSys:nrccHvacDry08cRef =
      {  if ( IfValidAnd( ClgEffUnitRpt == "SEER/EER" ) .OR. IfValidAnd( ClgEffUnitRpt == "SEER2/EER2" ) ) then  CreateComp( nrccHvacDry08c, Format( "%s HvacDry08c", Name ) )
         else  UNDEFINED
         endif  }
   "Set AirSys:nrccHvacDry08cRef:noXMLoutput_AirSysRef"    AirSys:nrccHvacDry08cRef:noXMLoutput_AirSysRef = {  Name  }


   "Create nrcctblRowHvacDry object for each pertinent ZnSys"     ZnSys:nrcctblRowHvacDryRef =
      {  if (LocalCompAssigned( nrcctblRowHvacDryRef ) > 0 .OR.
             ComponentCount( nrccTableHvacDry ) < 1 .OR.
             ComponentCount( ZnSys ) < 1 .OR.
             IfValidAnd( Type == "VRF" ) .OR.
             IfValidAnd( Type == "Exhaust" ) .OR.
             IfValidAnd( Type == "VentilationOnly" ) .OR.
             IfValidAnd( BaseSysNum > 0 ) .OR.
             IfValidAnd( IsHlthCareSys > 0 ) ) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacDry, Format( "%s HvacDry tblRow", Name ) )
         endif  }
   "Set ZnSys:nrcctblRowHvacDryRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowHvacDryRef:noXMLoutput_ZnSysRef = 
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else Name
         endif  }

   ; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Create nrccHvacDry06b child object for each ZnSys nrcctblRowHvacDry"     ZnSys:nrccHvacDry06bRef =
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry06b, Format( "%s HvacDry06b", Name ) )
         endif  }
   "Set ZnSys:nrccHvacDry06bRef:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacDry06bRef:noXMLoutput_ZnSysRef = {  Name  }

   "Create nrccHvacDry06c child object for each ZnSys HSPF/COP nrcctblRowHvacDry"     ZnSys:nrccHvacDry06cRef =
      {  if ( IfValidAnd( HtgEffUnitRpt == "HSPF/COP" ) .OR. IfValidAnd( HtgEffUnitRpt == "HSPF2/COP" ) ) then  CreateComp( nrccHvacDry06c, Format( "%s HvacDry06c", Name ) )
         else  UNDEFINED
         endif  }
   "Set ZnSys:nrccHvacDry06cRef:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacDry06cRef:noXMLoutput_ZnSysRef = {  Name  }

   "Create nrccHvacDry08b child object for each ZnSys nrcctblRowHvacDry"     ZnSys:nrccHvacDry08bRef =
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry08b, Format( "%s HvacDry08b", Name ) )
         endif  }
   "Set ZnSys:nrccHvacDry08bRef:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacDry08bRef:noXMLoutput_ZnSysRef = {  Name  }

   "Create nrccHvacDry08c child object for each ZnSys SEER/EER nrcctblRowHvacDry"     ZnSys:nrccHvacDry08cRef =
      {  if ( IfValidAnd( ClgEffUnitRpt == "SEER/EER" ) .OR. IfValidAnd( ClgEffUnitRpt == "SEER2/EER2" ) ) then  CreateComp( nrccHvacDry08c, Format( "%s HvacDry08c", Name ) )
         else  UNDEFINED
         endif  }
   "Set ZnSys:nrccHvacDry08cRef:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacDry08cRef:noXMLoutput_ZnSysRef = {  Name  }


   "Create nrcctblRowHvacDry object for each pertinent VRFSys"     VRFSys:nrcctblRowHvacDryRef =
      {  if (LocalCompAssigned( nrcctblRowHvacDryRef ) > 0 .OR.
             ComponentCount( nrccTableHvacDry ) < 1 .OR.
             ComponentCount( VRFSys ) < 1) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacDry, Format( "%s HvacDry tblRow", Name ) )
         endif  }
   "Set VRFSys:nrcctblRowHvacDryRef:noXMLoutput_VRFSysRef"    VRFSys:nrcctblRowHvacDryRef:noXMLoutput_VRFSysRef = 
      {  if (ComponentCount( VRFSys ) < 1) then  UNDEFINED
         else Name
         endif  }

   ; setup HSPF/HSPF2 and COP reporting in Section_HvacDry data - RJH 7/01/23 GH Issue #83
   "Create nrccHvacDry06b child object for each VRFSys nrcctblRowHvacDry"     VRFSys:nrccHvacDry06bRef =
      {  if (ComponentCount( VRFSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry06b, Format( "%s HvacDry06b", Name ) )
         endif  }
   "Set VRFSys:nrccHvacDry06bRef:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacDry06bRef:noXMLoutput_VRFSysRef = {  Name  }

   "Create nrccHvacDry06c child object for each VRFSys HSPF/COP nrcctblRowHvacDry"     VRFSys:nrccHvacDry06cRef =
      {  if ( IfValidAnd( HtgEffUnitRpt == "HSPF/COP" ) .OR. IfValidAnd( HtgEffUnitRpt == "HSPF2/COP" ) ) then  CreateComp( nrccHvacDry06c, Format( "%s HvacDry06c", Name ) )
         else  UNDEFINED
         endif  }
   "Set VRFSys:nrccHvacDry06cRef:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacDry06cRef:noXMLoutput_VRFSysRef = {  Name  }

   "Create nrccHvacDry08b child object for each VRFSys nrcctblRowHvacDry"     VRFSys:nrccHvacDry08bRef =
      {  if (ComponentCount( VRFSys ) < 1) then  UNDEFINED
         else  CreateComp( nrccHvacDry08b, Format( "%s HvacDry08b", Name ) )
         endif  }
   "Set VRFSys:nrccHvacDry08bRef:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacDry08bRef:noXMLoutput_VRFSysRef = {  Name  }

   "Create nrccHvacDry08c child object for each VRFSys SEER/EER nrcctblRowHvacDry"     VRFSys:nrccHvacDry08cRef =
      {  if ( IfValidAnd( ClgEffUnitRpt == "SEER/EER" ) .OR. IfValidAnd( ClgEffUnitRpt == "SEER2/EER2" ) ) then  CreateComp( nrccHvacDry08c, Format( "%s HvacDry08c", Name ) )
         else  UNDEFINED
         endif  }
   "Set VRFSys:nrccHvacDry08cRef:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacDry08cRef:noXMLoutput_VRFSysRef = {  Name  }


  ; Rule to Delete empty nrccSection_HvacDry
   "DELETE empty nrccTableHvacDry object"
      nrccSection_HvacDry:Action   = {  if (ComponentCount( nrcctblRowHvacDry ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   ; setup ResSCSysRpt Parent Name and HVACSysType to be used in populating Section_Hvacdwell - RJH 10/11/22
   "Set ResSCSysRpt:ParentNameRpt"   ResSCSysRpt:ParentNameRpt = 
      {  Parent( Name ) }
   "Set ResSCSysRpt:ParentHVACSysTypeRpt"   ResSCSysRpt:ParentHVACSysTypeRpt = 
      {  Parent( HVACSysType ) }
   "Set ResSCSysRpt:ParentCentralEqpTypeRpt"   ResSCSysRpt:ParentCentralEqpTypeRpt = 
      {  Parent( CentralEqpType ) }
   "Set ResSCSysRpt:ParentDualFuelRpt"   ResSCSysRpt:ParentDualFuelRpt = 
      {  Parent( HPModelDualFuel ) }
   "Set ResSCSysRpt:ParentNumAssigningDUsRpt"   ResSCSysRpt:ParentNumAssigningDUsRpt = 
      {  Parent( NumAssigningDUs ) }


   "Create nrccSection_Hvacdwell object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance" .OR. Proj:ResCompPathMech == "Performance") 
         then CreateChildren( nrccSection_Hvacdwell, 1, "Hvacdwell" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Hvacdwell nrccTableHvacdwell object"              nrccSection_Hvacdwell:Action  =
      {  CreateChildren( nrccTableHvacdwell, 1, "Hvacdwell table" )  }
   "Create nrcctblRowHvacdwell object for each pertinent ResSCSysRpt"     ResSCSysRpt:nrcctblRowHvacdwellRef =
      {  if (LocalCompAssigned( nrcctblRowHvacdwellRef ) > 0 .OR.
             ComponentCount( nrccTableHvacdwell ) < 1 .OR.
             ComponentCount( ResSCSysRpt ) < 1 ) 
         then  UNDEFINED
         else  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
               then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .OR. ParentHVACSysTypeRpt == "Other Heating and Cooling System")
                    then CreateComp( nrcctblRowHvacdwell, Format( "%s Hvacdwell tblRow", Name ) )
                    else if (ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                         then if (ParentCentralEqpTypeRpt == "Variable refrigerant flow" .OR. ParentCentralEqpTypeRpt == "Water source heat pump")
                              then CreateComp( nrcctblRowHvacdwell, Format( "%s Hvacdwell tblRow", Name ) )
                              else UNDEFINED
                              endif
                         else UNDEFINED
                         endif
                    endif
               else UNDEFINED 
               endif
         endif  }
   "Set ResSCSysRpt:nrcctblRowHvacdwellRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrcctblRowHvacdwellRef:noXMLoutput_ResSCSysRptRef = 
      {  if (ComponentCount( ResSCSysRpt ) < 1) 
         then  UNDEFINED
         else  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
               then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .OR. ParentHVACSysTypeRpt == "Other Heating and Cooling System")
                    then Name
                    else if (ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                         then if (ParentCentralEqpTypeRpt == "Variable refrigerant flow" .OR. ParentCentralEqpTypeRpt == "Water source heat pump")
                              then Name
                              else UNDEFINED
                              endif
                         else UNDEFINED
                         endif
                    endif
               else UNDEFINED 
               endif
         endif  }

   "Create nrccHvacdwellCoolEffic child object for each nrcctblRowHvacdwell"     ResSCSysRpt:nrccHvacdwellCoolEfficRef =
      {  if (ComponentCount( ResSCSysRpt ) < 1) then  UNDEFINED
         else  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
               then CreateComp( nrccHvacdwellCoolEffic, Format( "%s nrccHvacdwellCoolEffic", Name ) ) 
               else UNDEFINED 
               endif
         endif  }
   "Set ResSCSysRpt:nrccHvacdwellCoolEfficRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccHvacdwellCoolEfficRef:noXMLoutput_ResSCSysRptRef = {  Name  }

; nrccHvacdwellSingleEffic - ONLY ONE efficiency value reported
   "Create nrccHvacdwellSingleEffic child object for each applicable nrcctblRowHvacdwell"     ResSCSysRpt:nrccHvacdwellSingleEfficRef =
      {  if (IfValidAnd(ParentNumAssigningDUsRpt > 0))
         then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
              then switch (HeatingType)
                     case "PkgTermHeatPump"      : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                     case "SglPkgVertHeatPump"   : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                     case "LrgPkgHeatPump"       : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )  ; But elements 15 and 16 are NotApplicable
                     case "RoomHeatPump"         : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                     case "AirToWaterHeatPump"   : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                     case "GroundSourceHeatPump" : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                     default :  UNDEFINED
                   endswitch
              else  if (ParentHVACSysTypeRpt == "Other Heating and Cooling System")
                    then switch (CoolingType)
                           case "NoCooling"         : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )  ; But elements 15 and 16 are NotApplicable
                           case "PkgTermAirCond"    : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                           case "SglPkgVertAirCond" : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                           case "LrgPkgAirCond"     : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )  ; But elements 15 and 16 are NotApplicable
                           case "RoomAirCond"       : CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                           default :  UNDEFINED
                         endswitch
                    else if (ParentHVACSysTypeRpt == "Central Heating and Cooling System")
                         then if (ParentCentralEqpTypeRpt == "Variable refrigerant flow")
                              then CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )  ; But elements 15 and 16 are NotApplicable
                              else if (ParentCentralEqpTypeRpt == "Water source heat pump")
                                   then CreateComp( nrccHvacdwellSingleEffic, Format( "%s HvacdwellSingleEffic", Name ) )
                                   else UNDEFINED
                                   endif
                              endif
                         else UNDEFINED
                         endif
                    endif
              endif
         else UNDEFINED 
         endif  }
   "Set ResSCSysRpt:nrccHvacdwellSingleEfficRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccHvacdwellSingleEfficRef:noXMLoutput_ResSCSysRptRef = {  Name  }

; nrccHvacdwellEER_SEER - TWO efficiency values reported
   "Create nrccHvacdwellEER_SEER child object for each applicable nrcctblRowHvacdwell"     ResSCSysRpt:nrccHvacdwellEER_SEERRef =
      {  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
         then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System")
              then switch (HeatingType)
                     case "SplitHeatPump"              : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "SDHVSplitHeatPump"          : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "DuctlessMiniSplitHeatPump"  : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "DuctlessMultiSplitHeatPump" : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "DuctlessVRFHeatPump"        : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "DuctedMiniSplitHeatPump"    : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "DuctedMultiSplitHeatPump"   : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "Ducted+DuctlessMultiSplitHeatPump" : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "PkgHeatPump"                : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "VCHP"                       : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     case "VCHP2"                      : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                     default :  UNDEFINED
                   endswitch
              else  if (ParentHVACSysTypeRpt == "Other Heating and Cooling System")
                    then switch (CoolingType)
                           case "SplitAirCond"                     : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "PkgAirCond"                       : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "SDHVSplitAirCond"                 : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "DuctlessMiniSplitAirCond"         : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "DuctlessMultiSplitAirCond"        : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "DuctlessVRFAirCond"               : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "DuctedMiniSplitAirCond"           : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "DuctedMultiSplitAirCond"          : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "Ducted+DuctlessMultiSplitAirCond" : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           case "EvapCondenser"                    : CreateComp( nrccHvacdwellEER_SEER, Format( "%s HvacdwellEER_SEER", Name ) )
                           default :  UNDEFINED
                         endswitch
                    else UNDEFINED
                    endif
              endif
         else UNDEFINED 
         endif  }
   "Set ResSCSysRpt:nrccHvacdwellEER_SEERRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccHvacdwellEER_SEERRef:noXMLoutput_ResSCSysRptRef = {  Name  }




; nrccHvacdwellCoolEffic_NotApplicable - NO efficiency values reported
   "Create nrccHvacdwellCoolEffic_NotApplicable child object for each applicable nrcctblRowHvacdwell"     ResSCSysRpt:nrccHvacdwellCoolEffic_NotApplicableRef =
      {  if (LocalCompAssigned(nrccHvacdwellSingleEfficRef) .OR. LocalCompAssigned(nrccHvacdwellEER_SEERRef)) 
         then UNDEFINED
         else CreateComp( nrccHvacdwellCoolEffic_NotApplicable, Format( "%s nrccHvacdwellCoolEffic_NotApplicable", Name ) )
         endif  }
   "Set ResSCSysRpt:nrccHvacdwellCoolEffic_NotApplicableRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccHvacdwellCoolEffic_NotApplicableRef:noXMLoutput_ResSCSysRptRef = {  Name  }







   "Create nrccSection_Hvacdwell nrccTableDFHP object"              nrccSection_Hvacdwell:Action  =
      {  CreateChildren( nrccTableDFHP, 1, "DFHP table" )  }
   "Create nrcctblRowDFHP object for each pertinent ResSCSysRpt"     ResSCSysRpt:nrcctblRowDFHPRef =
      {  if (LocalCompAssigned( nrcctblRowDFHPRef ) > 0 .OR.
             ComponentCount( nrccTableDFHP ) < 1 .OR.
             ComponentCount( ResSCSysRpt ) < 1 ) 
         then  UNDEFINED
         else  if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. IfValidAnd( ParentDualFuelRpt > 0 ))
               then CreateComp( nrcctblRowDFHP, Format( "%s DFHP tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set ResSCSysRpt:nrcctblRowDFHPRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrcctblRowDFHPRef:noXMLoutput_ResSCSysRptRef = 
      {  if (ComponentCount( ResSCSysRpt ) < 1) then  UNDEFINED
         else  if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. IfValidAnd( ParentDualFuelRpt > 0 ))
               then Name
               else UNCHANGED
               endif
         endif  }

   "Create nrccCoolingEfficDfhp child object for each nrcctblRowDFHP"     ResSCSysRpt:nrccCoolingEfficDfhpRef =
      {  if (ComponentCount( ResSCSysRpt ) < 1) then  UNDEFINED
         else  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
               then CreateComp( nrccCoolingEfficDfhp, Format( "%s nrccCoolingEfficDfhp", Name ) ) 
               else UNDEFINED 
               endif
         endif  }
   "Set ResSCSysRpt:nrccCoolingEfficDfhpRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccCoolingEfficDfhpRef:noXMLoutput_ResSCSysRptRef = {  Name  }


; CoolingSingleEfficDfhp - ONLY ONE efficiency value reported
   "Create nrccCoolingSingleEfficDfhp child object for each applicable nrcctblRowDFHP"     ResSCSysRpt:nrccCoolingSingleEfficDfhpRef =
      {  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
         then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. IfValidAnd( ParentDualFuelRpt > 0 ))
              then if (HeatingType == "SglPkgVertHeatPump")
                   then CreateComp( nrccCoolingSingleEfficDfhp, Format( "%s CoolingSingleEfficDfhp", Name ) )
                   else UNDEFINED
                   endif
              else UNDEFINED
              endif
         else UNDEFINED
         endif  }
   "Set ResSCSysRpt:nrccCoolingSingleEfficDfhpRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccCoolingSingleEfficDfhpRef:noXMLoutput_ResSCSysRptRef = {  Name  }


; CoolingEER_IEER_Dfhp - TWO efficiency values reported
   "Create nrccCoolingEER_IEER_Dfhp child object for each applicable nrcctblRowDFHP"     ResSCSysRpt:nrccCoolingEER_IEER_DfhpRef =
      {  if (IfValidAnd(ParentNumAssigningDUsRpt > 0)) 
         then if (ParentHVACSysTypeRpt == "Heat Pump Heating and Cooling System" .AND. IfValidAnd( ParentDualFuelRpt > 0 ))
              then if (HeatingType != "SglPkgVertHeatPump")
                   then CreateComp( nrccCoolingEER_IEER_Dfhp, Format( "%s CoolingEER_IEER_Dfhp", Name ) )
                   else UNDEFINED
                   endif
              else UNDEFINED
              endif
         else UNDEFINED
         endif  }
   "Set ResSCSysRpt:nrccCoolingEER_IEER_DfhpRef:noXMLoutput_ResSCSysRptRef"    ResSCSysRpt:nrccCoolingEER_IEER_DfhpRef:noXMLoutput_ResSCSysRptRef = {  Name  }


  ; Rules to Delete empty nrccSection_Hvacdwell tables and overall section
   "DELETE empty nrccTableHvacdwell object"
      nrccTableHvacdwell:Action   = {  if (ComponentCount( nrcctblRowHvacdwell ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccTableDFHP object"
      nrccTableDFHP:Action   = {  if (ComponentCount( nrcctblRowDFHP ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccSection_Hvacdwell object"
      nrccSection_Hvacdwell:Action   = {  if (ComponentCount( nrcctblRowHvacdwell ) < 1 .AND. ComponentCount( nrcctblRowDFHP ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   ; setup Fan references to be used in populating Fan data in table - SAC 06/28/21
   ; Also used in populating Section_Zone - RJH 09/30/21
   "Set ZnSys:RptFanRef"   ZnSys:RptFanRef = 
      {  MaxChildComp( Fan:FlowCap )  }
   "Set AirSeg:RptFanRef"  AirSeg:RptFanRef = 
      {  MaxChildComp( Fan:FlowCap )  }

   "Create nrccSection_Fan object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance" .OR. Proj:ResCompPathMech == "Performance") 
         then CreateChildren( nrccSection_Fan, 1, "Fan" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Fan nrccTableFan object"              nrccSection_Fan:Action  =
      {  CreateChildren( nrccTableFan, 1, "Fan table" )  }
   "Create nrcctblRowFan object for each pertinent AirSys"     AirSys:nrcctblRowFanRef =
      {  if (LocalCompAssigned( nrcctblRowFanRef ) > 0 .OR.
             ComponentCount( nrccTableFan ) < 1 .OR.
             ComponentCount( AirSys ) < 1 .OR.
             IfValidAnd( Type == "Exhaust" ) .OR.
             IfValidAnd( BaseSysNum > 0 ) .OR.
             IfValidAnd( ExcludeFromRpt > 0 ) ) then  UNDEFINED
         else  CreateComp( nrcctblRowFan, Format( "%s Fan tblRow", Name ) )
         endif  }
   "Set AirSys:nrcctblRowFanRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowFanRef:noXMLoutput_AirSysRef = 
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowFan object for each pertinent ZnSys"     ZnSys:nrcctblRowFanRef =
      {  if (LocalCompAssigned( nrcctblRowFanRef ) > 0 .OR.
             ComponentCount( nrccTableFan ) < 1 .OR.
             ComponentCount( ZnSys ) < 1 .OR.
             IfValidAnd( ExcludeFromRpt > 0 ) .OR.
             (IfValidAnd(Type == "Furnace") .AND. IfValidAnd(FurnaceType == "Gravity")) ) then  UNDEFINED
         else if ( IfValidAnd(BaseSysNum == 0) .AND.
                   IfValidAnd(IsActiveBeam == 0) .AND.
                   IfValidAnd(Type != "VentilationOnly") .AND.
                   ( IfValidAnd(Type != "Exhaust") .OR. IfValidAnd(Type != "Baseboard") .OR. IfValidAnd(Type != "PassiveBeam") .OR. IfValidAnd(Type != "Radiant") ) .OR.
                   ( IfValidAnd( Type != "Furnace" ) .AND. IfValidAnd( RptFanRef:IsDummy != 1 ) ) )
              then CreateComp( nrcctblRowFan, Format( "%s Fan tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set ZnSys:nrcctblRowFanRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowFanRef:noXMLoutput_ZnSysRef = 
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  
  
   "Create nrccSection_Fan nrccTableMFFan object"              nrccSection_Fan:Action  =
      {  CreateChildren( nrccTableMFFan, 1, "MFFan table" )  }
   "Create nrcctblRowMFFan object for each pertinent ResFanSys"     ResFanSys:nrcctblRowMFFanRef =
      {  if (LocalCompAssigned( nrcctblRowMFFanRef ) > 0 .OR.
             ComponentCount( nrccTableMFFan ) < 1 .OR.
             ComponentCount( ResFanSys ) < 1) then  UNDEFINED
         else  if (FloorAreaServed > 0) then CreateComp( nrcctblRowMFFan, Format( "%s MFFan tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResFanSys:nrcctblRowMFFanRef:noXMLoutput_ResFanSysRef"    ResFanSys:nrcctblRowMFFanRef:noXMLoutput_ResFanSysRef = 
      {  if (ComponentCount( ResFanSys ) < 1) then  UNDEFINED
         else if (FloorAreaServed > 0) then Name else UNDEFINED endif
         endif  }

   ; create nrcctblRowMFFan objects for each VCHP system referenced in analysis - SAC 07/02/23 (gh issue #49)
   "Create nrcctblRowMFFan object for each pertinent ResHtPumpSys"     ResHtPumpSys:nrcctblRowMFFanRef =
      {  if (LocalCompAssigned( nrcctblRowMFFanRef ) > 0 .OR.
             ComponentCount( nrccTableMFFan ) < 1 .OR.
             IfValidAnd( Type = "VCHP - Meets requirements of the VCHP compliance option" )==0) then  UNDEFINED
         else  if (FloorAreaServed > 0) then CreateComp( nrcctblRowMFFan, Format( "%s MFFan tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResHtPumpSys:nrcctblRowMFFanRef:noXMLoutput_ResHtPumpSysRef"    ResHtPumpSys:nrcctblRowMFFanRef:noXMLoutput_ResHtPumpSysRef = 
      {  Name  }


   "Create nrccSection_Fan nrccTableFanIAQ object"              nrccSection_Fan:Action  =
      {  CreateChildren( nrccTableFanIAQ, 1, "FanIAQ table" )  }
   "Create nrcctblRowFanIAQ object for each pertinent ResIAQFan"     ResIAQFan:nrcctblRowFanIAQRef =
      {  if (LocalCompAssigned( nrcctblRowFanIAQRef ) > 0 .OR.
             ComponentCount( nrccTableFanIAQ ) < 1 .OR.
             ComponentCount( ResIAQFan ) < 1) then  UNDEFINED
         else  if (NumAssignments > 0) then CreateComp( nrcctblRowFanIAQ, Format( "%s FanIAQ tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResIAQFan:nrcctblRowFanIAQRef:noXMLoutput_ResIAQFanRef"    ResIAQFan:nrcctblRowFanIAQRef:noXMLoutput_ResIAQFanRef = 
      {  if (ComponentCount( ResIAQFan ) < 1) then  UNDEFINED
         else if (NumAssignments > 0) then Name else UNDEFINED endif
         endif  }
   "Create nrcctblRowFanIAQ object for each pertinent ResCentralVentSys"     ResCentralVentSys:nrcctblRowFanIAQRef =
      {  if (LocalCompAssigned( nrcctblRowFanIAQRef ) > 0 .OR.
             ComponentCount( nrccTableFanIAQ ) < 1 .OR.
             ComponentCount( ResCentralVentSys ) < 1) then  UNDEFINED
         else  if (FloorAreaServed > 0) then CreateComp( nrcctblRowFanIAQ, Format( "%s FanIAQ tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResCentralVentSys:nrcctblRowFanIAQRef:noXMLoutput_ResCentralVentSysRef"    ResCentralVentSys:nrcctblRowFanIAQRef:noXMLoutput_ResCentralVentSysRef = 
      {  if (ComponentCount( ResCentralVentSys ) < 1) then  UNDEFINED
         else if (FloorAreaServed > 0) then Name else UNDEFINED endif
         endif  }
  
  
  ; Rule to Delete empty nrccSection_Fan tables and overall section
   "DELETE empty nrccTableFan object"
      nrccTableFan:Action   = {  if (ComponentCount( nrcctblRowFan ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccTableMFFan object"
      nrccTableMFFan:Action   = {  if (ComponentCount( nrcctblRowMFFan ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccTableFanIAQ object"
      nrccTableFanIAQ:Action   = {  if (ComponentCount( nrcctblRowFanIAQ ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccSection_Fan object"
      nrccSection_Fan:Action   = {  if (ComponentCount( nrcctblRowFan ) < 1 .AND. ComponentCount( nrcctblRowMFFan ) < 1 .AND. ComponentCount( nrcctblRowFanIAQ ) < 1) then  DeleteComp()  else  UNCHANGED  endif }





; RJH 10/1/22 Moved creation of Section_Aa from CF1RPRF01E_Master.rule to NRCCPRF-Rulelists.rule to handle NRCC/LMCC Section_Distmf
  ; ----------------------------------------------------------------------
  ; Section_Distmf H4. MULTIFAMILY HVAC DISTRIBUTION
   "Create & initialize new cf1rSection_Distmf object"    ; SAC 5/25/19 - added logic to prevent cf1rSection_Aa creation when no HVACDist objects serve Zones
      nrccNRCCPRF:Action  = {  if ( SumAll( HVACDist:FloorAreaServed ) < 1 .AND.
                                    SumAcrossIf( ResHVACSys:HPSysVCHPFanPwr, ResHVACSys:FloorAreaServed[1] > 1 ) < 1 .AND.
                                    SumAcrossIf( AirSys:IsResSys, AirSys:ServesResZn = 1 ) < 1 ) 
                               then  UNCHANGED
                               else if (Proj:ResCompPathMech == "Performance") then CreateChildren( cf1rSection_Distmf, 1, "Section_Distmf" ) else UNDEFINED endif
                               endif  }     ; no init needed
   "Call subordinate rulelist to populate TableDistributionMF table"
      nrccNRCCPRF:Action  = {  if (ComponentCount( cf1rSection_Distmf ) < 1) 
                               then  UNCHANGED
                               else  EvalRulelist( "CF1RPRF01E_cf1rSection_Distmf_Proposed" )  
                               endif  }

   ; setup ResDuctSeg Parent reference to be used in populating nrccTableDuctMF - RJH 10/31/22
   "Set ResDuctSeg:ParentSysNameRpt"   ResDuctSeg:ParentSysNameRpt = 
      { Parent( Name ) }
  
   "Create cf1rSection_Distmf nrccTableDuctMF object"              cf1rSection_Distmf:Action  =
      {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. SumAll( HVACDist:ReportDuctDesign ) > 0)
         then  CreateChildren( nrccTableDuctMF, 1, "MFDuct table" )
         else  UNCHANGED  endif  }

   "Create nrcctblRowDuctMF object for each pertinent ResDuctSeg"     ResDuctSeg:nrcctblRowDuctMFRef =
      {  if (LocalCompAssigned( nrcctblRowDuctMFRef ) > 0 .OR.
             ComponentCount( nrccTableDuctMF ) < 1 .OR.
             ComponentCount( ResDuctSeg ) < 1) 
         then  UNDEFINED
         else if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. IfValidAnd( Parent(ReportDuctDesign) > 0 ) .AND. IfValidAnd( ErrorID = 0 ))
              then CreateComp( nrcctblRowDuctMF, Format( "%s MFDuct tblRow", Name ) )
              else  UNDEFINED
              endif
         endif  }  

   "Set ResDuctSeg:nrcctblRowDuctMFRef:noXMLoutput_ResDuctSegRef"    ResDuctSeg:nrcctblRowDuctMFRef:noXMLoutput_ResDuctSegRef = 
      {  if (ComponentCount( ResDuctSeg ) < 1) then  UNDEFINED
         else if (IfValidAnd(Proj:IsLowRiseMFam > 0 ) .AND. IfValidAnd( Parent(ReportDuctDesign) > 0 ) .AND. IfValidAnd( ErrorID = 0 )) then Name else UNDEFINED endif
         endif  }
  
  ; Rule to Delete empty Section_Distmf tables and overall section
   "DELETE empty cf1rTableDistributionMF object"
      cf1rTableDistributionMF:Action   = {  if (ComponentCount( cf1rtblRowDistMF ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty nrccTableDuctMF object"
      nrccTableDuctMF:Action   = {  if (ComponentCount( nrcctblRowDuctMF ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty cf1rTableDistributionMFHERS object"
      cf1rTableDistributionMFHERS:Action   = {  if (ComponentCount( cf1rtblRowDistMFHERS ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
   "DELETE empty cf1rSection_Distmf object"
      cf1rSection_Distmf:Action   = {  if (ComponentCount( cf1rtblRowDistMF ) < 1 .AND. ComponentCount( nrcctblRowDuctMF ) < 1 .AND. ComponentCount( cf1rtblRowDistMFHERS ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
  



   ; setup Fan Parent Report properties to be used in populating FanExh data in table - RJH 06/30/21
   "Set Fan:ParentSysNameRpt"   Fan:ParentSysNameRpt = 
      {  if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "AirSys" ))
            then Parent2( Name )
         else if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "ZnSys" ))
            then Parent( Name )
         else UNDEFINED
         endif endif }
   "Set Fan:ParentSysZnServedAsExhRpt"   Fan:ParentSysZnServedAsExhRpt = 
      {  if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "AirSys" ))
            then Parent2( ZnServedAsExhSys )
         else if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "ZnSys" ))
            then Parent( ZnServedAsExhSys )
         else UNDEFINED
         endif endif }
   "Set Fan:ParentSysFanCtrlRpt"   Fan:ParentSysFanCtrlRpt = 
      {  if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "AirSys" ))
         then if (IfValidAnd(Parent2(FanCtrl) == "Continuous"))
              then "Continuous"
              else "NotContinuous"
              endif
         else if (Parent( Type ) == "Exhaust" .AND. IfValidAnd( ParentComp == "ZnSys" ))
              then if (IfValidAnd(Parent(FanCtrl) == "Continuous"))
                   then "Continuous"
                   else "NotContinuous"
                   endif
              else UNDEFINED
              endif
         endif  }

   "Create nrccSection_FanExh object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_FanExh, 1, "FanExh" )
         else UNCHANGED 
         endif }
   "Create nrccSection_FanExh nrccTableFan object"              nrccSection_FanExh:Action  =
      {  CreateChildren( nrccTableFanExh, 1, "FanExh table" )  }
   "Create nrcctblRowFanExh object for each pertinent Fan"     Fan:nrcctblRowFanExhRef =
      {  if (LocalCompAssigned( nrcctblRowFanExhRef ) > 0 .OR.
             ComponentCount( nrccTableFanExh ) < 1 .OR.
             ComponentCount( Fan ) < 1 .OR.
             IfValidAnd(Parent(Type) != "Exhaust") .OR.
             (IfValidAnd(ParentComp == "AirSys") .AND. IfValidAnd(Parent2(IsHlthCareSys) > 0)) .OR.
             (IfValidAnd(ParentComp == "ZnSys") .AND. IfValidAnd(Parent(ExcludeFromRpt) > 0) ) ) then  UNDEFINED
; BaseSysNum throws an error            (IfValidAnd(ParentComp == "ZnSys") .AND. IfValidAnd(Parent(ExcludeFromRpt) > 0) .AND. IfValidAnd(Parent(BaseSysNum) > 0)) ) then  UNDEFINED
         else  CreateComp( nrcctblRowFanExh, Format( "%s FanExh tblRow", Name ) )
         endif  }
   "Set Fan:nrcctblRowFanExhRef:noXMLoutput_FanExhRef"    Fan:nrcctblRowFanExhRef:noXMLoutput_FanExhRef = 
      {  if (ComponentCount( Fan ) < 1 .OR.
             Parent( Type ) != "Exhaust") then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_FanExh
   "DELETE empty nrccSection_FanExh object"
      nrccSection_FanExh:Action   = {  if (ComponentCount( nrcctblRowFanExh ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   ; setup Equipment Parent Names to be used in populating HVACWet data in table
   "Set Blr:ParentSysNameRpt"   Blr:ParentSysNameRpt = 
      {  Parent( Name )  }
   "Set Chlr:ParentSysNameRpt"   Chlr:ParentSysNameRpt = 
      {  Parent( Name )  }
   "Set HX:ParentSysNameRpt"   HX:ParentSysNameRpt = 
      {  Parent( Name )  }
   "Set HtRej:ParentSysNameRpt"   HtRej:ParentSysNameRpt = 
      {  Parent( Name )  }
   "Set ThrmlEngyStor:ParentSysNameRpt"   ThrmlEngyStor:ParentSysNameRpt = 
      {  Parent( Name )  }
; RJH 8/23/22 added for WtrHtr
   "Set WtrHtr:ParentSysNameRpt"   WtrHtr:ParentSysNameRpt = 
      {  Parent( Name )  }
   "Set WtrHtr:ParentSysTypeRpt"   WtrHtr:ParentSysTypeRpt = 
      {  Parent( Type )  }


   "Create nrccSection_HvacWet object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_HvacWet, 1, "HvacWet" )
         else UNCHANGED 
         endif }
   "Create nrccSection_HvacWet nrccTableHvacWet object"              nrccSection_HvacWet:Action  =
      {  CreateChildren( nrccTableHvacWet, 1, "HvacWet table" )  }
   "Create nrcctblRowHvacWet object for each pertinent Blr"     Blr:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( Blr ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
         endif  }
   "Set Blr:nrcctblRowHvacWetRef:noXMLoutput_BlrRef"    Blr:nrcctblRowHvacWetRef:noXMLoutput_BlrRef = 
      {  if (ComponentCount( Blr ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowHvacWet object for each pertinent Chlr"     Chlr:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( Chlr ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
         endif  }
   "Set Chlr:nrcctblRowHvacWetRef:noXMLoutput_ChlrRef"    Chlr:nrcctblRowHvacWetRef:noXMLoutput_ChlrRef = 
      {  if (ComponentCount( Chlr ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowHvacWet object for each pertinent HX"     HX:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( HX ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
         endif  }
   "Set HX:nrcctblRowHvacWetRef:noXMLoutput_HXRef"    HX:nrcctblRowHvacWetRef:noXMLoutput_HXRef = 
      {  if (ComponentCount( HX ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowHvacWet object for each pertinent HtRej"     HtRej:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( HtRej ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
         endif  }
   "Set HtRej:nrcctblRowHvacWetRef:noXMLoutput_HtRejRef"    HtRej:nrcctblRowHvacWetRef:noXMLoutput_HtRejRef = 
      {  if (ComponentCount( HtRej ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowHvacWet object for each pertinent ThrmlEngyStor"     ThrmlEngyStor:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( ThrmlEngyStor ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
         endif  }
   "Set ThrmlEngyStor:nrcctblRowHvacWetRef:noXMLoutput_ThrmlEngyStorRef"    ThrmlEngyStor:nrcctblRowHvacWetRef:noXMLoutput_ThrmlEngyStorRef = 
      {  if (ComponentCount( ThrmlEngyStor ) < 1) then  UNDEFINED
         else Name
         endif  }
; RJH 8/23/22 added for WtrHtr
   "Create nrcctblRowHvacWet object for each pertinent WtrHtr"     WtrHtr:nrcctblRowHvacWetRef =
      {  if (LocalCompAssigned( nrcctblRowHvacWetRef ) > 0 .OR.
             ComponentCount( nrccTableHvacWet ) < 1 .OR.
             ComponentCount( WtrHtr ) < 1 .OR.
             Parent( IsBaseSys ) > 0) then  UNDEFINED
         else if (ParentSysTypeRpt = "HotWater" .AND. Type != "Conventional" .AND. FluidSysHtg = 1)
              then CreateComp( nrcctblRowHvacWet, Format( "%s HvacWet tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set WtrHtr:nrcctblRowHvacWetRef:noXMLoutput_WtrHtrRef"    WtrHtr:nrcctblRowHvacWetRef:noXMLoutput_WtrHtrRef = 
      {  if (ComponentCount( WtrHtr ) < 1) then  UNDEFINED
         else Name
         endif  }

  ; Rule to Delete empty nrccSection_HvacWet
   "DELETE empty nrccSection_HvacWet object"
      nrccSection_HvacWet:Action   = {  if (ComponentCount( nrcctblRowHvacWet ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   ; setup Equipment Parent Name and Status to be used in populating Pump data in table
   "Set Pump:ParentNameRpt"   Pump:ParentNameRpt = 
      {  if (ParentComponentType() = "FluidSeg") 
         then Parent2( Name )
         else Parent( Name )
         endif }
   "Set Pump:ParentStatusRpt"   Pump:ParentStatusRpt = 
      {  if (ParentComponentType() = "FluidSeg") 
         then Parent2( Status )
         else Parent( Status )
         endif }


   "Create nrccSection_Pump object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_Pump, 1, "Pump" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Pump nrccTablePump object"              nrccSection_Pump:Action  =
      {  CreateChildren( nrccTablePump, 1, "Pump table" )  }
   "Create nrcctblRowPump object for each pertinent Pump"     Pump:nrcctblRowPumpRef =
      {  if (LocalCompAssigned( nrcctblRowPumpRef ) > 0 .OR.
             ComponentCount( nrccTablePump ) < 1 .OR.
             ComponentCount( Pump ) < 1 .OR.
             Parent2( IsBaseSys ) > 0) then  UNDEFINED
         else  CreateComp( nrcctblRowPump, Format( "%s Pump tblRow", Name ) )
         endif  }
   "Set Pump:nrcctblRowPumpRef:noXMLoutput_PumpRef"    Pump:nrcctblRowPumpRef:noXMLoutput_PumpRef = 
      {  if (ComponentCount( Pump ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_Pump
   "DELETE empty nrccSection_Pump object"
      nrccSection_Pump:Action   = {  if (ComponentCount( nrcctblRowPump ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_HvacSpec object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_HvacSpec, 1, "HVAC Spec" )
         else UNCHANGED 
         endif }
   "Create nrccSection_HvacSpec nrccTableHvacSpec object"              nrccSection_HvacSpec:Action  =
      {  CreateChildren( nrccTableHvacSpec, 1, "HVAC Spec table" )  }

   "Create nrcctblRowHvacSpec object for each pertinent AirSys"     AirSys:nrcctblRowHvacSpecRef =
      {  if (LocalCompAssigned( nrcctblRowHvacSpecRef ) > 0 .OR.
             ComponentCount( nrccTableHvacSpec ) < 1 .OR.
             IfValidAnd( Type == "Exhaust" ) .OR.
             IfValidAnd( BaseSysNum > 0 ) .OR.
             IfValidAnd( IsHlthCareSys > 0 ) .OR.
             IfValidAnd( ExcludeFromRpt > 0 ) .OR.
             (SysCtrlRpt[1] == "NA" .AND. SysCtrlRpt[2] == "NA" .AND. SysCtrlRpt[3] == "NA" .AND. SysCtrlRpt[4] == "NA" .AND. SysCtrlRpt[5] == "NA" .AND. 
              SysCtrlRpt[6] == "NA" .AND. SysCtrlRpt[7] == "NA" .AND. SysCtrlRpt[8] == "NA" .AND. SysCtrlRpt[9] == "NA" .AND. SysCtrlRpt[10] == "NA" .AND. 
              OperableWinInterlockRpt == "NA") ) then  UNDEFINED
         else if (SysCtrlRpt[1] != "NA" .OR. SysCtrlRpt[2] != "NA" .OR. SysCtrlRpt[3] != "NA" .OR. SysCtrlRpt[4] != "NA" .OR. SysCtrlRpt[5] != "NA" .OR. 
                  SysCtrlRpt[6] != "NA" .OR. SysCtrlRpt[7] != "NA" .OR. SysCtrlRpt[8] != "NA" .OR. SysCtrlRpt[9] != "NA" .OR. SysCtrlRpt[10] != "NA" .OR. 
                  OperableWinInterlockRpt != "NA") 
              then CreateComp( nrcctblRowHvacSpec, Format( "%s HvacSpec tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set AirSys:nrcctblRowHvacSpecRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowHvacSpecRef:noXMLoutput_AirSysRef = {  Name }
   "Create nrccHvacSpec04Choice child object for each AirSys nrcctblRowHvacSpec"     AirSys:nrccHvacSpec04ChoiceRef =
      {  CreateComp( nrccHvacSpec04Choice, Format( "%s HvacSpec04Choice", Name ) )  }
   "Set AirSys:nrccHvacSpec04ChoiceRef:noXMLoutput_AirSysRef"    AirSys:nrccHvacSpec04ChoiceRef:noXMLoutput_AirSysRef = {  Name  }
   "Create nrccHvacSpec04 child object for each AirSys nrcctblRowHvacSpec"     AirSys:nrccHvacSpec04Ref =
      {  CreateComp( nrccHvacSpec04, Format( "%s HvacSpec04", Name ) ) }
   "Set AirSys:nrccHvacSpec04Ref:noXMLoutput_AirSysRef"    AirSys:nrccHvacSpec04Ref:noXMLoutput_AirSysRef = {  Name  }

   "Create nrcctblRowHvacSpec object for each pertinent ZnSys"     ZnSys:nrcctblRowHvacSpecRef =
      {  if (LocalCompAssigned( nrcctblRowHvacSpecRef ) > 0 .OR.
             ComponentCount( nrccTableHvacSpec ) < 1 .OR.
             IFValidAnd( Type = "VRF" ) .OR.
             (SysCtrlRpt[1] == "NA" .AND. SysCtrlRpt[2] == "NA" .AND. SysCtrlRpt[3] == "NA" .AND. OperableWinInterlockRpt == "NA") ) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacSpec, Format( "%s HvacSpec tblRow", Name ) )
         endif  }
   "Set ZnSys:nrcctblRowHvacSpecRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowHvacSpecRef:noXMLoutput_ZnSysRef = {  Name  }
   "Create nrccHvacSpec04Choice child object for each pertinent ZnSys nrcctblRowHvacSpec"     ZnSys:nrccHvacSpec04ChoiceRef =
      {  if (IFValidAnd( Type = "VRF" )) then  UNDEFINED
         else  CreateComp( nrccHvacSpec04Choice, Format( "%s HvacSpec04Choice", Name ) )
         endif  }
   "Set ZnSys:nrccHvacSpec04ChoiceRef:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacSpec04ChoiceRef:noXMLoutput_ZnSysRef = {  Name  }
   "Create nrccHvacSpec04 child object for each pertinent ZnSys nrcctblRowHvacSpec"     ZnSys:nrccHvacSpec04Ref =
      {  if (IFValidAnd( Type = "VRF" )) then  UNDEFINED
         else  CreateComp( nrccHvacSpec04, Format( "%s HvacSpec04", Name ) )
         endif  }
   "Set ZnSys:nrccHvacSpec04Ref:noXMLoutput_ZnSysRef"    ZnSys:nrccHvacSpec04Ref:noXMLoutput_ZnSysRef = {  Name  }

   "Create nrcctblRowHvacSpec object for each pertinent VRFSys"     VRFSys:nrcctblRowHvacSpecRef =
      {  if (LocalCompAssigned( nrcctblRowHvacSpecRef ) > 0 .OR.
             ComponentCount( nrccTableHvacSpec ) < 1 .OR.
             (SysCtrlRpt == "NA" .AND. OperableWinInterlockRpt == "NA") ) then  UNDEFINED
         else  CreateComp( nrcctblRowHvacSpec, Format( "%s HvacSpec tblRow", Name ) )
         endif  }
   "Set VRFSys:nrcctblRowHvacSpecRef:noXMLoutput_VRFSysRef"    VRFSys:nrcctblRowHvacSpecRef:noXMLoutput_VRFSysRef = {  Name  } 
   "Create nrccHvacSpec04Choice child object for each pertinent VRFSys nrcctblRowHvacSpec"     VRFSys:nrccHvacSpec04ChoiceRef =
      {  CreateComp( nrccHvacSpec04Choice, Format( "%s HvacSpec04Choice", Name ) )  }
   "Set VRFSys:nrccHvacSpec04ChoiceRef:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacSpec04ChoiceRef:noXMLoutput_VRFSysRef = {  Name  }
   "Create nrccHvacSpec04 child object for each pertinent VRFSys nrcctblRowHvacSpec"     VRFSys:nrccHvacSpec04Ref =
      {  CreateComp( nrccHvacSpec04, Format( "%s HvacSpec04", Name ) )  }
   "Set VRFSys:nrccHvacSpec04Ref:noXMLoutput_VRFSysRef"    VRFSys:nrccHvacSpec04Ref:noXMLoutput_VRFSysRef = {  Name  }

   "Create nrcctblRowHvacSpec object for each pertinent FluidSys"     FluidSys:nrcctblRowHvacSpecRef =
      {  if (LocalCompAssigned( nrcctblRowHvacSpecRef ) > 0 .OR.
             ComponentCount( nrccTableHvacSpec ) < 1 .OR.
             IsBaseSys > 0) then  UNDEFINED
         else if (SysCtrlRpt[1] != "NA" .OR. SysCtrlRpt[2] != "NA") 
              then CreateComp( nrcctblRowHvacSpec, Format( "%s HvacSpec tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set FluidSys:nrcctblRowHvacSpecRef:noXMLoutput_FluidSysRef"    FluidSys:nrcctblRowHvacSpecRef:noXMLoutput_FluidSysRef = {  Name  }
   "Create nrccHvacSpec04Choice child object for each pertinent FluidSys nrcctblRowHvacSpec"     FluidSys:nrccHvacSpec04ChoiceRef =
      {  CreateComp( nrccHvacSpec04Choice, Format( "%s HvacSpec04Choice", Name ) ) }
   "Set FluidSys:nrccHvacSpec04ChoiceRef:noXMLoutput_FluidSysRef"    FluidSys:nrccHvacSpec04ChoiceRef:noXMLoutput_FluidSysRef = {  Name  }
   "Create nrccHvacSpec04 child object for each pertinent FluidSys nrcctblRowHvacSpec"     FluidSys:nrccHvacSpec04Ref =
      {  CreateComp( nrccHvacSpec04, Format( "%s HvacSpec04", Name ) ) }
   "Set FluidSys:nrccHvacSpec04Ref:noXMLoutput_FluidSysRef"    FluidSys:nrccHvacSpec04Ref:noXMLoutput_FluidSysRef = {  Name  }

  ; Rule to Delete empty nrccHvacSpec04 and set nrccHvacSpec04Choice:HvacSpec04_NotApplicableMessage in RULELIST "NRCCPRF_ap_PostSim"

  ; Rule to Delete empty nrccSection_HvacSpec
   "DELETE empty nrccTableHvacSpec object"
      nrccSection_HvacSpec:Action   = {  if (ComponentCount( nrcctblRowHvacSpec ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_VentNR object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance" .OR. Proj:ResCompPathMech == "Performance") 
         then CreateChildren( nrccSection_VentNR, 1, "Vent" )
         else UNCHANGED 
         endif }
   "Create nrccSection_VentNR nrccTableVentNR object"              nrccSection_VentNR:Action  =
      {  CreateChildren( nrccTableVentNR, 1, "VentNR table" )  }
   "Create nrcctblRowVentNR object for each pertinent ThrmlZn"     ThrmlZn:nrcctblRowVentNRRef =
      {  if (LocalCompAssigned( nrcctblRowVentNRRef ) > 0 .OR.
             ComponentCount( nrccTableVentNR ) < 1 .OR.
             ComponentCount( ThrmlZn ) < 1 .OR.
             IFValidAnd( CondgStatus = 0 ) .OR.
             IFValidAnd( HasUnknownHVAC != 0 ) .OR.
             IFValidAnd( OccClass != "Nonresidential") ) then  UNDEFINED
         else  CreateComp( nrcctblRowVentNR, Format( "%s VentNR tblRow", Name ) )
         endif  }
   "Set ThrmlZn:nrcctblRowVentNRRef:noXMLoutput_ThrmlZnRef"    ThrmlZn:nrcctblRowVentNRRef:noXMLoutput_ThrmlZnRef = 
      {  if (ComponentCount( ThrmlZn ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowVentNR object for each pertinent ResOtherZn"     ResOtherZn:nrcctblRowVentNRRef =
      {  if (LocalCompAssigned( nrcctblRowVentNRRef ) > 0 .OR.
             ComponentCount( nrccTableVentNR ) < 1 .OR.
             ComponentCount( ResOtherZn ) < 1 .OR.
             IFValidAnd( Type != "Conditioned")) then  UNDEFINED
         else  if (IFValidAnd( CondFloorArea > 0)) then CreateComp( nrcctblRowVentNR, Format( "%s VentNR tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResOtherZn:nrcctblRowVentNRRef:noXMLoutput_ResOtherZnRef"    ResOtherZn:nrcctblRowVentNRRef:noXMLoutput_ResOtherZnRef = 
      {  if (ComponentCount( ResOtherZn ) < 1 .OR. IFValidAnd( Type != "Conditioned")) then  UNDEFINED
         else if (IFValidAnd( CondFloorArea > 0)) then Name else UNCHANGED endif
         endif  }
  ; Rule to Delete empty nrccSection_VentNR
   "DELETE empty nrccSection_VentNR object"
      nrccSection_VentNR:Action   = {  if (ComponentCount( nrcctblRowVentNR ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_VentRes object"   nrccNRCCPRF:Action =
      {  if (Proj:ResCompPathMech == "Performance") 
         then CreateChildren( nrccSection_VentRes, 1, "VentRes" )
         else UNCHANGED 
         endif }
   "Create nrccSection_VentRes nrccTableVentRes object"              nrccSection_VentRes:Action  =
      {  CreateChildren( nrccTableVentRes, 1, "VentRes table" )  }
   "Create nrcctblRowVentRes object for each pertinent DwellUnitType"     DwellUnitType:nrcctblRowVentResRef =
      {  if (LocalCompAssigned( nrcctblRowVentResRef ) > 0 .OR.
             ComponentCount( nrccTableVentRes ) < 1 .OR.
             ComponentCount( DwellUnitType ) < 1) then  UNDEFINED
         else  CreateComp( nrcctblRowVentRes, Format( "%s VentRes tblRow", Name ) )
         endif  }
   "Set DwellUnitType:nrcctblRowVentResRef:noXMLoutput_DwellUnitTypeRef"    DwellUnitType:nrcctblRowVentResRef:noXMLoutput_DwellUnitTypeRef = 
      {  if (ComponentCount( DwellUnitType ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_VentRes
   "DELETE empty nrccSection_VentRes object"
      nrccSection_VentRes:Action   = {  if (ComponentCount( nrcctblRowVentRes ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   ; setup TrmlUnit Fan Power report values to be used in populating Section_Zone data - RJH 11/18/22
   "Set TrmlUnit:FanPwrRpt_bhp"  TrmlUnit:FanPwrRpt_bhp = 
      { if (SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "bhp") > 0)
        then SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "bhp")
        else UNDEFINED
        endif  }
   "Set TrmlUnit:FanPwrRpt_wcfm"  TrmlUnit:FanPwrRpt_wcfm = 
      { if (SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "W/cfm") > 0)
        then SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "W/cfm")
        else UNDEFINED
        endif  }
   "Set TrmlUnit:FanPwrRpt_inH2O"  TrmlUnit:FanPwrRpt_inH2O = 
      { if (SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "inH2O") > 0)
        then SumChildrenIf(Fan:PwrRpt, Fan:PwrUnitRpt = "inH2O")
        else UNDEFINED
        endif  }
   "Set TrmlUnit:FanRpt_IsVSD"  TrmlUnit:FanRpt_IsVSD = 
      { if (SumChildrenIf(Fan:SysCnt, Fan:CtrlMthd = "VariableSpeedDrive") > 0)
        then SumChildrenIf(Fan:SysCnt, Fan:CtrlMthd = "VariableSpeedDrive")
        else UNDEFINED
        endif  }

   "Create nrccSection_Zone object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_Zone, 1, "Zone" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Zone nrccTableZone object"              nrccSection_Zone:Action  =
      {  CreateChildren( nrccTableZone, 1, "Zone table" )  }

   "Create nrcctblRowZone object for each pertinent TrmlUnit"     TrmlUnit:nrcctblRowZoneRef =
      {  if (LocalCompAssigned( nrcctblRowZoneRef ) > 0 .OR.
             ComponentCount( nrccTableZone ) < 1 .OR.
             ComponentCount( TrmlUnit ) < 1) then  UNDEFINED
         else  if (IfValidAnd(Parent(BaseSysNum) = 0) .OR. IfValidAnd(Parent(IsHlthCareSys) = 0))
               then CreateComp( nrcctblRowZone, Format( "%s Zone tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set TrmlUnit:nrcctblRowZoneRef:noXMLoutput_TrmlUnitRef"    TrmlUnit:nrcctblRowZoneRef:noXMLoutput_TrmlUnitRef = 
      {  if (ComponentCount( TrmlUnit ) < 1) then  UNDEFINED
         else Name
         endif  }

   "Create nrcctblRowZone object for each pertinent ZnSys"     ZnSys:nrcctblRowZoneRef =
      {  if (LocalCompAssigned( nrcctblRowZoneRef ) > 0 .OR.
             ComponentCount( nrccTableZone ) < 1 .OR.
             ComponentCount( ZnSys ) < 1 .OR.
             IFValidAnd( Type = "Baseboard" ) .OR.
             IFValidAnd( Type = "Exhaust" ) .OR.
             (IfValidAnd(Type == "Furnace") .AND. IfValidAnd(FurnaceType == "Gravity")) ) then  UNDEFINED
         else  if (IfValidAnd(BaseSysNum = 0) .OR. IfValidAnd(IsHlthCareSys = 0))
               then CreateComp( nrcctblRowZone, Format( "%s Zone tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set ZnSys:nrcctblRowZoneRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowZoneRef:noXMLoutput_ZnSysRef = 
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else Name
         endif  }

  ; Rule to Delete empty nrccSection_Zone
   "DELETE empty nrccTableZone object"
      nrccSection_Zone:Action   = {  if (ComponentCount( nrcctblRowZone ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_Evap object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_Evap, 1, "Evap" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Evap nrccTableEvap object"           nrccSection_Evap:Action  =
      {  CreateChildren( nrccTableEvap, 1, "NRCC Evap table" )  }
   "Create nrcctblRowEvap object for each pertinent EvapClr"     EvapClr:nrcctblRowEvapRef =
      {  if (LocalCompAssigned( nrcctblRowEvapRef ) > 0 .OR.
             ComponentCount( nrccTableEvap ) < 1 .OR.
             ComponentCount( EvapClr ) < 1 ) then  UNDEFINED
         else  if (IfValidAnd(SysCnt > 0))
               then CreateComp( nrcctblRowEvap, Format( "%s Evap tblRow", Name ) )
               else UNDEFINED
               endif
         endif  }
   "Set EvapClr:nrcctblRowEvapRef:noXMLoutput_EvapClrRef"    EvapClr:nrcctblRowEvapRef:noXMLoutput_EvapClrRef = 
      {  if (ComponentCount( EvapClr ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_Evap
   "DELETE empty nrccSection_Evap object"
      nrccSection_Evap:Action   = {  if (ComponentCount( nrcctblRowEvap ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_HtRecovery object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathMech == "Performance") 
         then CreateChildren( nrccSection_HtRecovery, 1, "HtRecovery" )
         else UNCHANGED 
         endif }
   "Create nrccSection_HtRecovery nrccTableHtRecovery object"              nrccSection_HtRecovery:Action  =
      {  CreateChildren( nrccTableHtRecovery, 1, "HtRecovery table" )  }

   "Create nrcctblRowHtRecovery object for each pertinent AirSys"     AirSys:nrcctblRowHtRecoveryRef =
      {  if (LocalCompAssigned( nrcctblRowHtRecoveryRef ) > 0 .OR.
             ComponentCount( nrccTableHtRecovery ) < 1 .OR.
             ComponentCount( AirSys ) < 1 .OR.
             BaseSysNum != 0 .OR.
             Type == "Exhaust" .OR.
             LocalCompAssigned( HtRcvryRef ) < 1) then  UNDEFINED
         else  CreateComp( nrcctblRowHtRecovery, Format( "%s HtRecovery tblRow", Name ) )
         endif  }
   "Set AirSys:nrcctblRowHtRecoveryRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowHtRecoveryRef:noXMLoutput_AirSysRef = 
      {  if (ComponentCount( AirSys ) < 1 .OR.
             BaseSysNum != 0 .OR.
             Type = "Exhaust" .OR.
             LocalCompAssigned( HtRcvryRef ) < 1) then  UNDEFINED
         else Name
         endif  }

   "Create nrcctblRowHtRecovery object for each pertinent ZnSys"     ZnSys:nrcctblRowHtRecoveryRef =
      {  if (LocalCompAssigned( nrcctblRowHtRecoveryRef ) > 0 .OR.
             ComponentCount( nrccTableHtRecovery ) < 1 .OR.
             ComponentCount( ZnSys ) < 1 .OR.
             BaseSysNum != 0 .OR.
             Type == "Exhaust" .OR.
             Type != "VentilationOnly" .OR.
             IFValidAnd( SysCtrlRpt[1] != "Heat Recovery" ) ) then  UNDEFINED
         else  CreateComp( nrcctblRowHtRecovery, Format( "%s HtRecovery tblRow", Name ) )
         endif  }
   "Set ZnSys:nrcctblRowHtRecoveryRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowHtRecoveryRef:noXMLoutput_ZnSysRef = 
      {  if (ComponentCount( ZnSys ) < 1 .OR.
             BaseSysNum != 0 .OR.
             Type == "Exhaust" .OR.
             Type != "VentilationOnly" .OR.
             IFValidAnd( SysCtrlRpt[1] != "Heat Recovery" ) ) then  UNDEFINED
         else Name
         endif  }

  ; Rule to Delete empty nrccSection_HtRecovery
   "DELETE empty nrccTableHtRecovery object"
      nrccSection_HtRecovery:Action   = {  if (ComponentCount( nrcctblRowHtRecovery ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   ; Section_Water
   "Create nrccSection_Water object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
         then CreateChildren( nrccSection_Water, 1, "NRCC Water" )
         else UNCHANGED 
         endif }
   "Create nrccSection_Water nrccTableWater object"              nrccSection_Water:Action  =
      {  CreateChildren( nrccTableWater, 1, "NRCC Water table" )  }
   "Create nrcctblRowWater object for each pertinent ResWtrHtr"     ResWtrHtr:nrcctblRowWaterRef =
      {  if (LocalCompAssigned( nrcctblRowWaterRef ) > 0 .OR.
             ComponentCount( nrccTableWater ) < 1 .OR.
             ComponentCount( ResWtrHtr ) < 1) then  UNDEFINED
         else if (NumIndivAssignedDUFracs > 0) ; RJH 9/4/23 GitHub Issue #101 modification instead of testing ResDHWSys:CentralRecircType = 'Non-Central' or ResDHWSys:CentralSysType != 'HPWH'
              then if (FloorAreaServed > 0) then CreateComp( nrcctblRowWater, Format( "%s Water tblRow", Name ) ) else UNDEFINED endif
              else UNDEFINED
              endif
         endif  }
   "Set ResWtrHtr:nrcctblRowWaterRef:noXMLoutput_ResWtrHtrRef"    ResWtrHtr:nrcctblRowWaterRef:noXMLoutput_ResWtrHtrRef = 
      {  if (ComponentCount( ResWtrHtr ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowWater object for each pertinent WtrHtr"     WtrHtr:nrcctblRowWaterRef =
      {  if (LocalCompAssigned( nrcctblRowWaterRef ) > 0 .OR.
             ComponentCount( nrccTableWater ) < 1 .OR.
             ComponentCount( WtrHtr ) < 1) then  UNDEFINED
         else  CreateComp( nrcctblRowWater, Format( "%s Water tblRow", Name ) )
         endif  }
   "Set WtrHtr:nrcctblRowWaterRef:noXMLoutput_WtrHtrRef"    WtrHtr:nrcctblRowWaterRef:noXMLoutput_WtrHtrRef = 
      {  if (ComponentCount( WtrHtr ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_Water
   "DELETE empty nrccTableWater object"
      nrccSection_Water:Action   = {  if (ComponentCount( nrcctblRowWater ) < 1) then  DeleteComp()  else  UNCHANGED  endif }




   ; setup ResDHWSys child ResWtrHtr:Name to be used in populating nrccSection_WaterMF data
   "Set ResDHWSys:ResWtrHtrName[1]"   ResDHWSys:ResWtrHtrName[1] = 
      {  if (ChildCount( ResWtrHtr ) > 0) 
         then  ChildRef  ( ResWtrHtr:Name, 1 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[2]"   ResDHWSys:ResWtrHtrName[2] = 
      {  if (ChildCount( ResWtrHtr ) > 1) 
         then  ChildRef  ( ResWtrHtr:Name, 2 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[3]"   ResDHWSys:ResWtrHtrName[3] = 
      {  if (ChildCount( ResWtrHtr ) > 2) 
         then  ChildRef  ( ResWtrHtr:Name, 3 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[4]"   ResDHWSys:ResWtrHtrName[4] = 
      {  if (ChildCount( ResWtrHtr ) > 3) 
         then  ChildRef  ( ResWtrHtr:Name, 4 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[5]"   ResDHWSys:ResWtrHtrName[5] = 
      {  if (ChildCount( ResWtrHtr ) > 4) 
         then  ChildRef  ( ResWtrHtr:Name, 5 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[6]"   ResDHWSys:ResWtrHtrName[6] = 
      {  if (ChildCount( ResWtrHtr ) > 5) 
         then  ChildRef  ( ResWtrHtr:Name, 6 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[7]"   ResDHWSys:ResWtrHtrName[7] = 
      {  if (ChildCount( ResWtrHtr ) > 6) 
         then  ChildRef  ( ResWtrHtr:Name, 7 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[8]"   ResDHWSys:ResWtrHtrName[8] = 
      {  if (ChildCount( ResWtrHtr ) > 7) 
         then  ChildRef  ( ResWtrHtr:Name, 8 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[9]"   ResDHWSys:ResWtrHtrName[9] = 
      {  if (ChildCount( ResWtrHtr ) > 8) 
         then  ChildRef  ( ResWtrHtr:Name, 9 )
         else UNDEFINED
         endif  }
   "Set ResDHWSys:ResWtrHtrName[10]"   ResDHWSys:ResWtrHtrName[10] = 
      {  if (ChildCount( ResWtrHtr ) > 9) 
         then  ChildRef  ( ResWtrHtr:Name, 10 )
         else UNDEFINED
         endif  }

   ; setup DwellUnitType:CompactDistribEnumVal and ResDHWSys flags to be used in populating Section_WaterMF
   "Set DwellUnitType:CompactDistribEnumVal"   DwellUnitType:CompactDistribEnumVal = 
      {  EnumValue( CompactDistrib )  }
   "Set ResDHWSys:IsCompactDistrib"   ResDHWSys:IsCompactDistrib = 
      {  SumRevRef( DwellUnitType:DHWSysRef, DwellUnitType:CompactDistribEnumVal )  }
   "Set ResDHWSys:PipeInsVerifReq"   ResDHWSys:PipeInsVerifReq = 
      {  SumRevRef( ResDHWSysRpt:DHWSysRef, ResDHWSysRpt:HERSAllPipesIns )  }
   "Set ResDHWSys:ParPipingVerReq"   ResDHWSys:ParPipingVerReq = 
      {  SumRevRef( ResDHWSysRpt:DHWSysRef, ResDHWSysRpt:HERSParallelPipe )  }
   "Set ResDHWSys:RecirCtrlVerReq"   ResDHWSys:RecirCtrlVerReq = 
      {  SumRevRef( ResDHWSysRpt:DHWSysRef, ResDHWSysRpt:HERSPointOfUse )  }


   "Create nrccSection_WaterMF object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
         then CreateChildren( nrccSection_WaterMF, 1, "NRCC WaterMF" )
         else UNCHANGED 
         endif }
   "Create nrccSection_WaterMF nrccTableWaterMF object"              nrccSection_WaterMF:Action  =
      {  CreateChildren( nrccTableWaterMF, 1, "NRCC WaterMF table" )  }
   "Create nrcctblRowWaterMF object for each pertinent ResDHWSys"     ResDHWSys:nrcctblRowWaterMFRef =
      {  if (LocalCompAssigned( nrcctblRowWaterMFRef ) > 0 .OR.
             ComponentCount( nrccTableWaterMF ) < 1 .OR.
             ComponentCount( ResDHWSys ) < 1) then  UNDEFINED
         else if (FloorAreaServed > 0) then CreateComp( nrcctblRowWaterMF, Format( "%s WaterMF tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResDHWSys:nrcctblRowWaterMFRef:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrcctblRowWaterMFRef:noXMLoutput_ResDHWSysRef = 
      {  if (ComponentCount( ResDHWSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_WaterMF
   "DELETE empty nrccTableWaterMF object"
      nrccSection_WaterMF:Action   = {  if (ComponentCount( nrcctblRowWaterMF ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_WaterCHPWH object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
         then CreateChildren( nrccSection_WaterCHPWH, 1, "NRCC WaterCHPWH" )
         else UNCHANGED 
         endif }
   "Create nrccSection_WaterCHPWH nrccTableCHPWH object"              nrccSection_WaterCHPWH:Action  =
      {  CreateChildren( nrccTableCHPWH, 1, "NRCC CHPWH table" )  }
; NRCC Res DHW
   "Create nrcctblRowCHPWH object for each pertinent ResDHWSys"     ResDHWSys:nrcctblRowCHPWHRef =
      {  if (LocalCompAssigned( nrcctblRowCHPWHRef ) > 0 .OR.
             ComponentCount( nrccTableCHPWH ) < 1 .OR.
             ComponentCount( ResDHWSys ) < 1 .OR.
             ResDHWSys:CentralDHW == 0 .OR.
             ResDHWSys:CentralDHWType != "HPWH" .OR.
             ResDHWSys:FloorAreaServed <= 0) then  UNDEFINED
         else if(ResDHWSys:CentralRecircType != "Non-Central" .AND. ResDHWSys:CentralDHWType = "HPWH") then CreateComp( nrcctblRowCHPWH, Format( "%s CHPWH tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResDHWSys:nrcctblRowCHPWHRef:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrcctblRowCHPWHRef:noXMLoutput_ResDHWSysRef = 
      {  if (ComponentCount( ResDHWSys ) < 1) then  UNDEFINED
         else Name
         endif  }

; NRCC Res DHW
   "Create nrccWaterCHPWH02 child object for each nrcctblRowCHPWH"     ResDHWSys:nrccWaterCHPWH02Ref =
      {  if (ComponentCount( ResDHWSys ) < 1 .OR.
             ResDHWSys:CentralDHW == 0 .OR.
             ResDHWSys:CentralDHWType != "HPWH" .OR.
             ResDHWSys:FloorAreaServed <= 0) then  UNDEFINED
         else if(ResDHWSys:CentralRecircType != "Non-Central" .AND. ResDHWSys:CentralDHWType = "HPWH") then CreateComp( nrccWaterCHPWH02, Format( "%s WaterCHPWH02", Name ) ) else UNDEFINED endif
         endif  }

   "Set ResDHWSys:nrccWaterCHPWH02Ref:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrccWaterCHPWH02Ref:noXMLoutput_ResDHWSysRef = {  Name  }

  ; Rule to Delete empty nrccSection_WaterCHPWH
   "DELETE empty nrccTableCHPWH object"
      nrccSection_WaterCHPWH:Action   = {  if (ComponentCount( nrcctblRowCHPWH ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_LpTank object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
         then CreateChildren( nrccSection_LpTank, 1, "NRCC LpTank" )
         else UNCHANGED 
         endif }
   "Create nrccSection_LpTank nrccTableLpTank object"              nrccSection_LpTank:Action  =
      {  CreateChildren( nrccTableLpTank, 1, "NRCC LpTank table" )  }
; NRCC Res DHW
   "Create nrcctblRowLpTank object for each pertinent ResDHWSys"     ResDHWSys:nrcctblRowLpTankRef =
      {  if (LocalCompAssigned( nrcctblRowLpTankRef ) > 0 .OR.
             ComponentCount( nrccTableLpTank ) < 1 .OR.
             ComponentCount( ResDHWSys ) < 1 .OR.
             ResDHWSys:CentralDHW == 0 .OR.
             ResDHWSys:CentralDHWType != "HPWH" .OR.
             ResDHWSys:CHPWHLoopTankConfig == "None (return to Primary)" .OR.
             ResDHWSys:FloorAreaServed <= 0) then  UNDEFINED
         else if(ResDHWSys:CentralRecircType != "Non-Central" .AND. ResDHWSys:CentralDHWType = "HPWH") then CreateComp( nrcctblRowLpTank, Format( "%s LpTank tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ResDHWSys:nrcctblRowLpTankRef:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrcctblRowLpTankRef:noXMLoutput_ResDHWSysRef = 
      {  if (ComponentCount( ResDHWSys ) < 1) then  UNDEFINED
         else Name
         endif  }

; NRCC Res DHW
   "Create nrccLpTank02 child object for each nrcctblRowLpTank"     ResDHWSys:nrccLpTank02Ref =
      {  if (ComponentCount( ResDHWSys ) < 1 .OR. ResDHWSys:CentralDHW == 0 .OR. ResDHWSys:CentralDHWType != "HPWH" .OR. ResDHWSys:CHPWHLoopTankConfig == "None (return to Primary)") then  UNDEFINED
         else  CreateComp( nrccLpTank02, Format( "%s LpTank02", Name ) )
         endif  }
   "Set ResDHWSys:nrccLpTank02Ref:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrccLpTank02Ref:noXMLoutput_ResDHWSysRef = {  Name  }

  ; Rule to Delete empty nrccSection_LpTank
   "DELETE empty nrccTableLpTank object"
      nrccSection_LpTank:Action   = {  if (ComponentCount( nrcctblRowLpTank ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_RecircLp object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
         then CreateChildren( nrccSection_RecircLp, 1, "NRCC RecircLp" )
         else UNCHANGED 
         endif }
   "Create nrccSection_RecircLp nrccTableRecircLp object"              nrccSection_RecircLp:Action  =
      {  CreateChildren( nrccTableRecircLp, 1, "NRCC RecircLp table" )  }
; NRCC Res DHW
   "Create nrcctblRowRecircLp object for each pertinent ResDHWSys"     ResDHWSys:nrcctblRowRecircLpRef =
      {  if (LocalCompAssigned( nrcctblRowRecircLpRef ) > 0 .OR.
             ComponentCount( nrccTableRecircLp ) < 1 .OR.
             ComponentCount( ResDHWSys ) < 1 .OR.
             IfValidAnd( ResDHWSys:CentralDHW != 0 )==0 .OR.
             IfValidAnd( ResDHWSys:NRecircLoops > 0 )==0 .OR.
             ResDHWSys:CentralRecircType != "Central with Recirculation") then  UNDEFINED
         else if (IfValidAnd( ResDHWSys:IsRecircSystem == 1 ) .AND. IfValidAnd( ResDHWSys:FloorAreaServed > 0 )) 
              then CreateComp( nrcctblRowRecircLp, Format( "%s RecircLp tblRow", Name ) ) 
              else UNDEFINED endif
         endif  }
   "Set ResDHWSys:nrcctblRowRecircLpRef:noXMLoutput_ResDHWSysRef"    ResDHWSys:nrcctblRowRecircLpRef:noXMLoutput_ResDHWSysRef = 
      {  if (ComponentCount( ResDHWSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_RecircLp
   "DELETE empty nrccTableRecircLp object"
      nrccSection_RecircLp:Action   = {  if (ComponentCount( nrcctblRowRecircLp ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_WaterSolar object"   nrccNRCCPRF:Action =
      {  if ((Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") .AND. Proj:SolThrmlComp == "Performance") 
         then CreateChildren( nrccSection_WaterSolar, 1, "NRCC WaterSolar" )
         else UNCHANGED 
         endif }
   "Create nrccSection_WaterSolar nrccTableWaterSolar object"              nrccSection_WaterSolar:Action  =
      {  CreateChildren( nrccTableWaterSolar, 1, "NRCC WaterSolar table" )  }
   "Create nrcctblRowWaterSolar object for each pertinent DHWSolSys"     DHWSolSys:nrcctblRowWaterSolarRef =
      {  if (LocalCompAssigned( nrcctblRowWaterSolarRef ) > 0 .OR.
             ComponentCount( nrccTableWaterSolar ) < 1 .OR.
             ComponentCount( DHWSolSys ) < 1 .OR.
             DHWSolSys:FloorAreaServed <= 0 ) then  UNDEFINED
         else  CreateComp( nrcctblRowWaterSolar, Format( "%s WaterSolar tblRow", Name ) )
         endif  }
   "Set DHWSolSys:nrcctblRowWaterSolarRef:noXMLoutput_DHWSolSysRef"    DHWSolSys:nrcctblRowWaterSolarRef:noXMLoutput_DHWSolSysRef = 
      {  if (ComponentCount( DHWSolSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_WaterSolar
   "DELETE empty nrccTableWaterSolar object"
      nrccSection_WaterSolar:Action   = {  if (ComponentCount( nrcctblRowWaterSolar ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



; RJH 10/5/22 Switched 2022 Section_WaterCompact implementation from previous 2019 NRCC to Res CF1R Section_Tcd implementation

   ; setup ResSpcDHWFeatures Parent Space Name and ResDHWSysRef to be used in populating Section_WaterCompact data in table
;   "Set ResSpcDHWFeatures:ParentSpcNameRpt"   ResSpcDHWFeatures:ParentSpcNameRpt = 
;      {  Parent( Name )  }
;   "Set ResSpcDHWFeatures:ParentResDHWSysRefRpt"   ResSpcDHWFeatures:ParentResDHWSysRefRpt = 
;      {  Parent( ResDHWSysRef )  }


;   "Create nrccSection_WaterCompact object"   nrccNRCCPRF:Action =
;      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
;         then CreateChildren( nrccSection_WaterCompact, 1, "WaterCompact" )
;         else UNCHANGED 
;         endif }
;   "Create nrccSection_WaterCompact nrccTableWaterCompact object"              nrccSection_WaterCompact:Action  =
;      {  CreateChildren( nrccTableWaterCompact, 1, "WaterCompact table" )  }
;   "Create nrcctblRowWaterCompact object for each pertinent ResSpcDHWFeatures"     ResSpcDHWFeatures:nrcctblRowWaterCompactRef =
;      {  if (LocalCompAssigned( nrcctblRowWaterCompactRef ) > 0 .OR.
;             ComponentCount( nrccTableWaterCompact ) < 1 .OR.
;             ComponentCount( ResSpcDHWFeatures ) < 1 .OR.
;             IfValidAnd( CompactDistErrorID = 0 )==0 .OR.
;             IfValidAnd( CompactDistIdx > 0 )==0) then  UNDEFINED
;         else  CreateComp( nrcctblRowWaterCompact, Format( "%s WaterCompact tblRow", Name ) )
;         endif  }
;   "Set ResSpcDHWFeatures:nrcctblRowWaterCompactRef:noXMLoutput_ResSpcDHWFeaturesRef"    ResSpcDHWFeatures:nrcctblRowWaterCompactRef:noXMLoutput_ResSpcDHWFeaturesRef = 
;      {  if (ComponentCount( ResSpcDHWFeatures ) < 1) then  UNDEFINED
;         else Name
;         endif  }

  ; Rule to Delete empty nrccSection_WaterCompact
;   "DELETE empty nrccSection_WaterCompact object"
;      nrccSection_WaterCompact:Action   = {  if (ComponentCount( nrcctblRowWaterCompact ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


; ----------------------------------------------------------------------
  ; Section_WaterCompact Water Heating - Compact Distribution table
   "Create & initialize new cf1rSection_WaterCompact object"
      nrccnRCCPRF:Action  = {  if ( (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") .AND. IfValidAnd( ResProj:IsMultiFamily > 0.5 ) .AND. SumAll( DwellUnitType:ReportCompactDist ) > 0 )
                                  then  CreateChildren( cf1rSection_WaterCompact, 1, "Section_WaterCompact" )
                                  else  UNCHANGED
                                  endif  }
   "Create & initialize new cf1rTableWaterCompact object"
      cf1rSection_WaterCompact:Action   = {  CreateChildren( cf1rTableWaterCompact, 1, "TableWaterCompact" )  }     ; no init needed
  ; ----------------------------------------------------------------------
  ; Rules to create individual Water Heating - Compact Distribution table rows

;ResDHWSys:CentralRecircType = 'Non-Central'

   "Create cf1rtblRowCompact for all MFam DwellUnitType instances w/ Compact Distrib-1"
      DwellUnitType:CF1R_CompactMFRow[1]   = {  if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( ReportCompactDist > 0 ) .AND. IfValidAnd( CDCompatible[1] > 0 ) .AND. IfValidAnd( DUFloorAreaServed > 0 ) .AND. CompactDistrib != "not compact")
                                                then  CreateComp( cf1rtblRowCompact, Name + "-1-TableWaterCompactRow" )  else  UNDEFINED  endif  }
   "Create cf1rtblRowCompact for all MFam DwellUnitType instances w/ Compact Distrib-2"
      DwellUnitType:CF1R_CompactMFRow[2]   = {  if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( ReportCompactDist > 0 ) .AND. IfValidAnd( CDCompatible[2] > 0 ) .AND. IfValidAnd( DUFloorAreaServed > 0 ) .AND. CompactDistrib != "not compact")
                                                then  CreateComp( cf1rtblRowCompact, Name + "-2-TableWaterCompactRow" )  else  UNDEFINED  endif  }
   "Create cf1rtblRowCompact for all MFam DwellUnitType instances w/ Compact Distrib-3"
      DwellUnitType:CF1R_CompactMFRow[3]   = {  if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( ReportCompactDist > 0 ) .AND. IfValidAnd( CDCompatible[3] > 0 ) .AND. IfValidAnd( DUFloorAreaServed > 0 ) .AND. CompactDistrib != "not compact")
                                                then  CreateComp( cf1rtblRowCompact, Name + "-3-TableWaterCompactRow" )  else  UNDEFINED  endif  }
   "Create cf1rtblRowCompact for all MFam DwellUnitType instances w/ Compact Distrib-4"
      DwellUnitType:CF1R_CompactMFRow[4]   = {  if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( ReportCompactDist > 0 ) .AND. IfValidAnd( CDCompatible[4] > 0 ) .AND. IfValidAnd( DUFloorAreaServed > 0 ) .AND. CompactDistrib != "not compact")
                                                then  CreateComp( cf1rtblRowCompact, Name + "-4-TableWaterCompactRow" )  else  UNDEFINED  endif  }
   "Create cf1rtblRowCompact for all MFam DwellUnitType instances w/ Compact Distrib-5"
      DwellUnitType:CF1R_CompactMFRow[5]   = {  if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( ReportCompactDist > 0 ) .AND. IfValidAnd( CDCompatible[5] > 0 ) .AND. IfValidAnd( DUFloorAreaServed > 0 ) .AND. CompactDistrib != "not compact")
                                                then  CreateComp( cf1rtblRowCompact, Name + "-5-TableWaterCompactRow" )  else  UNDEFINED  endif  }
   ; ----------------------------------------------------------------------
   ; Rules to populate Water Heating - Compact Distribution table rows for all MFam DwellUnitType instances w/ Compact Distrib
   "Setup DwellUnitType:CF1R_CompactMFRow[1] via subordinate rulelist"     DwellUnitType:Action  = {
         if (LocalCompAssigned( CF1R_CompactMFRow[1] ) > 0) then  EvalRulelist( "Setup_DwellUnitType_CF1R_CompactMFRow_1", 1 )  else  UNCHANGED  endif  }
   "Setup DwellUnitType:CF1R_CompactMFRow[2] via subordinate rulelist"     DwellUnitType:Action  = {
         if (LocalCompAssigned( CF1R_CompactMFRow[2] ) > 0) then  EvalRulelist( "Setup_DwellUnitType_CF1R_CompactMFRow_2", 1 )  else  UNCHANGED  endif  }
   "Setup DwellUnitType:CF1R_CompactMFRow[3] via subordinate rulelist"     DwellUnitType:Action  = {
         if (LocalCompAssigned( CF1R_CompactMFRow[3] ) > 0) then  EvalRulelist( "Setup_DwellUnitType_CF1R_CompactMFRow_3", 1 )  else  UNCHANGED  endif  }
   "Setup DwellUnitType:CF1R_CompactMFRow[4] via subordinate rulelist"     DwellUnitType:Action  = {
         if (LocalCompAssigned( CF1R_CompactMFRow[4] ) > 0) then  EvalRulelist( "Setup_DwellUnitType_CF1R_CompactMFRow_4", 1 )  else  UNCHANGED  endif  }
   "Setup DwellUnitType:CF1R_CompactMFRow[5] via subordinate rulelist"     DwellUnitType:Action  = {
         if (LocalCompAssigned( CF1R_CompactMFRow[5] ) > 0) then  EvalRulelist( "Setup_DwellUnitType_CF1R_CompactMFRow_5", 1 )  else  UNCHANGED  endif  }

   "Set cf1rtblRowCompact parent"   cf1rtblRowCompact:Parent  = { cf1rTableWaterCompact:Name  }

  ; Rule to Delete empty cf1rSection_WaterCompact
   "DELETE empty cf1rSection_WaterCompact object"
      cf1rSection_WaterCompact:Action   = {  if (ComponentCount( cf1rtblRowCompact ) < 1) then  DeleteComp()  else  UNCHANGED  endif }

  ; END of Water Heating - Compact Distribution table rules
  ; ----------------------------------------------------------------------




; RJH 10/5/22 Switched 2022 Section_WaterDWHR implementation from previous 2019 NRCC to Res CF1R Section_Tdw implementation

   ; setup ResSpcDHWFeatures Parent Space Name and ResDHWSysRef to be used in populating Section_WaterDWHR data in table
;   "Set ResSpcDHWFeatures:ParentSpcNameRpt"   ResSpcDHWFeatures:ParentSpcNameRpt = 
;      {  Parent( Name )  }
;   "Set ResSpcDHWFeatures:ParentResDHWSysRefRpt"   ResSpcDHWFeatures:ParentResDHWSysRefRpt = 
;      {  Parent( ResDHWSysRef )  }


;   "Create nrccSection_WaterDWHR object"   nrccNRCCPRF:Action =
;      {  if (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") 
;         then CreateChildren( nrccSection_WaterDWHR, 1, "WaterDWHR" )
;         else UNCHANGED 
;         endif }
;   "Create nrccSection_WaterDWHR nrccTableDWHR object"              nrccSection_WaterDWHR:Action  =
;      {  CreateChildren( nrccTableDWHR, 1, "DWHR table" )  }


  ; Rules to create individual Water Heating - Drain Water Heat Recovery (DWHR) table rows
;   "Create & populate all DWHR table rows"
;      nrccSection_WaterDWHR:Action = {  EvalRulelist( "NRCCPRF_Section_WaterDWHR" )  }
;   "Set nrcctblRowDWHR parent"   nrcctblRowDWHR:Parent  = { nrccTableDWHR:Name  }


  ; Rule to Delete empty nrccSection_WaterDWHR
;   "DELETE empty nrccSection_WaterDWHR object"
;      nrccSection_WaterDWHR:Action   = {  if (ComponentCount( nrcctblRowDWHR ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


  ; ----------------------------------------------------------------------
  ; Section_WaterDWHR Water Heating - Drain Water Heat Recovery (DWHR) table
      ; SAC 7/16/19 - added logic to create section for MFam models (tic #1139)
   "Create & initialize new cf1rSection_WaterDWHR object"
      nrccnRCCPRF:Action  = {  if ( (Proj:CompPathDHW == "Performance" .OR. Proj:ResCompPathDHW == "Performance") .AND. IfValidAnd( ResProj:IsMultiFamily > 0.5 ) .AND. SumAll( DwellUnitType:HaveShowerDWHR ) > 0 )
                                  then  CreateChildren( cf1rSection_WaterDWHR, 1, "Section_WaterDWHR" )
                                  else  UNCHANGED
                                  endif  }

   "Create & initialize new cf1rTableDWHR object"
      cf1rSection_WaterDWHR:Action   = {  CreateChildren( cf1rTableDWHR, 1, "TableDWHR" )  }     ; no init needed
  ; ----------------------------------------------------------------------
  ; Rules to create individual Water Heating - Drain Water Heat Recovery (DWHR) table rows
   "Create & populate all DWHR table rows"
      cf1rSection_WaterDWHR:Action   = {  if (ResProj:IsMultiFamily > 0.5)
                                          then  EvalRulelist( "CF1RPRF01E_TableDWHR_MFam" )
                                          else  UNCHANGED  endif  }
   "Set cf1rtblRowDWHR parent"   cf1rtblRowDWHR:Parent  = { cf1rTableDWHR:Name  }
  ; END of Water Heating - Drain Water Heat Recovery (DWHR) table rules
  ; ----------------------------------------------------------------------



   "Create nrccSection_ProcGarage object"
      nrccNRCCPRF:Action    = {  if (Proj:CompPathMech == "Performance") 
                                 then CreateChildren( nrccSection_ProcGarage, 1, "NRCC ProcGarage" )
                                 else UNCHANGED 
                                 endif }
   "Create nrccSection_ProcGarage nrccTableProcGarage object"              nrccSection_ProcGarage:Action  =
      {  CreateChildren( nrccTableProcGarage, 1, "NRCC ProcGarage table" )  }
   "Create nrcctblRowProcGarage object for each pertinent AirSys"     AirSys:nrcctblRowProcGarageRef =
      {  if (LocalCompAssigned( nrcctblRowProcGarageRef ) > 0 .OR.
             ComponentCount( nrccTableProcGarage ) < 1 .OR.
             ComponentCount( AirSys ) < 1 ) then  UNDEFINED
         else if (IfValidAnd(ExhSysType == "ParkingGarage")) then CreateComp( nrcctblRowProcGarage, Format( "%s ProcGarage tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set AirSys:nrcctblRowProcGarageRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowProcGarageRef:noXMLoutput_AirSysRef = 
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else Name
         endif  }
   "Create nrcctblRowProcGarage object for each pertinent ZnSys"     ZnSys:nrcctblRowProcGarageRef =
      {  if (LocalCompAssigned( nrcctblRowProcGarageRef ) > 0 .OR.
             ComponentCount( nrccTableProcGarage ) < 1 .OR.
             ComponentCount( ZnSys ) < 1 ) then  UNDEFINED
         else if (IfValidAnd(ExhSysType == "ParkingGarage")) then CreateComp( nrcctblRowProcGarage, Format( "%s ProcGarage tblRow", Name ) ) else UNDEFINED endif
         endif  }
   "Set ZnSys:nrcctblRowProcGarageRef:noXMLoutput_ZnSysRef"    ZnSys:nrcctblRowProcGarageRef:noXMLoutput_ZnSysRef = 
      {  if (ComponentCount( ZnSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_ProcGarage
   "DELETE empty nrccTableProcGarage object"
      nrccSection_ProcGarage:Action   = {  if (ComponentCount( nrcctblRowProcGarage ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_ProcKitch object"
      nrccNRCCPRF:Action    = {  if (Proj:CompPathMech == "Performance") 
                                 then CreateChildren( nrccSection_ProcKitch, 1, "NRCC ProcKitch" )
                                 else UNCHANGED 
                                 endif }
   "Create nrccSection_ProcKitch nrccTableProcKitch object"              nrccSection_ProcKitch:Action  =
      {  CreateChildren( nrccTableProcKitch, 1, "NRCC ProcKitch table" )  }
   "Create nrcctblRowProcKitch object for each pertinent Spc"     Spc:nrcctblRowProcKitchRef =
      {  if (LocalCompAssigned( nrcctblRowProcKitchRef ) > 0 .OR.
             ComponentCount( nrccTableProcKitch ) < 1 .OR.
             ComponentCount( Spc ) < 1 ) then  UNDEFINED
         else if (IfValidAnd(SpcFunc == "Kitchen/Food Preparation Area") .AND. IfValidAnd(Proj:CompPathKit == "Performance") 
                  .AND. (IfValidAnd(KitExhHoodFlow > 0) .OR. IfValidAnd(KitExhHoodLen > 0)))
              then CreateComp( nrcctblRowProcKitch, Format( "%s ProcKitch tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowProcKitchRef:noXMLoutput_SpcRef"    Spc:nrcctblRowProcKitchRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrccTableKitchHoodsRef object for each pertinent Spc"     Spc:nrccTableKitchHoodsRef =
      {  if (LocalCompAssigned( nrcctblRowProcKitchRef ) < 1 )
         then  UNDEFINED
         else  CreateComp( nrccTableKitchHoods, Format( "%s TableKitchHoods", Name ) )
         endif  }
   "Set Spc:nrccTableKitchHoodsRef:noXMLoutput_SpcRef"    Spc:nrccTableKitchHoodsRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowKitchHoodsRef1 object for each pertinent Spc"     Spc:nrcctblRowKitchHoodsRef1 =
      {  if (LocalCompAssigned( nrccTableKitchHoodsRef ) < 1) then UNDEFINED
         else if (LocalStatus( KitExhHoodStyle[1] ) > 0 .AND. KitExhHoodStyle[1] != "None") 
         then CreateComp( nrcctblRowKitchHoods, Format( "%s ProcKitchRowKitchHoods1", Name ) )
         else UNDEFINED
         endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef1:noXMLoutput_SpcRef"                  Spc:nrcctblRowKitchHoodsRef1:noXMLoutput_SpcRef                  = {  Name  }
   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch02_KitchenExhaustHoodStyle" Spc:nrcctblRowKitchHoodsRef1:ProcKitch02_KitchenExhaustHoodStyle = { 
        if (LocalStatus( KitExhHoodStyle[1] ) > 0) 
        then
            switch (KitExhHoodStyle[1])
                case "BackshelfOrPassover" : "BackshelfPassover"
                case "DoubleIsland"        : "DoubleIsland"
                case "Eyebrow"             : "Eyebrow"
                case "None"                : "None"
                case "SingleIsland"        : "SingleIsland"
                case "WallMountedCanopy"   : "WallMountedCanopy"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch03_KitchenExhaustHoodDuty" Spc:nrcctblRowKitchHoodsRef1:ProcKitch03_KitchenExhaustHoodDuty = { 
        if (LocalStatus( KitExhHoodDuty[1] ) > 0 .AND. LocalStatus( KitExhHoodStyle[1] ) > 0) 
        then
            switch (KitExhHoodDuty[1])
                case "Light"      : "LightDuty"
                case "Medium"     : "MediumDuty"
                case "Heavy"      : "HeavyDuty"
                case "ExtraHeavy" : "ExtraHeavyDuty"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch03_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef1:ProcKitch03_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef1:ProcKitch03_KitchenExhaustHoodDuty ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[1] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch04_KitchenExhaustHoodLength" Spc:nrcctblRowKitchHoodsRef1:ProcKitch04_KitchenExhaustHoodLength = { 
        if (LocalStatus( KitExhHoodLen[1] ) > 0 .AND. LocalStatus( KitExhHoodStyle[1] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodLen[1] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch04_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef1:ProcKitch04_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef1:ProcKitch04_KitchenExhaustHoodLength ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[1] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch05_KitchenExhaustHoodFlow" Spc:nrcctblRowKitchHoodsRef1:ProcKitch05_KitchenExhaustHoodFlow = { 
        if (LocalStatus( KitExhHoodFlow[1] ) > 0 .AND. LocalStatus( KitExhHoodStyle[1] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodFlow[1] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef1:ProcKitch05_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef1:ProcKitch05_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef1:ProcKitch05_KitchenExhaustHoodFlow ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[1] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }


   "Create nrcctblRowKitchHoodsRef2 object for each pertinent Spc"     Spc:nrcctblRowKitchHoodsRef2 =
      {  if (LocalCompAssigned( nrccTableKitchHoodsRef ) < 1) then UNDEFINED
         else if (LocalStatus( KitExhHoodStyle[2] ) > 0 .AND. KitExhHoodStyle[2] != "None") 
         then CreateComp( nrcctblRowKitchHoods, Format( "%s ProcKitchRowKitchHoods2", Name ) )
         else UNDEFINED
         endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef2:noXMLoutput_SpcRef"                  Spc:nrcctblRowKitchHoodsRef2:noXMLoutput_SpcRef                  = {  Name  }
   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch02_KitchenExhaustHoodStyle" Spc:nrcctblRowKitchHoodsRef2:ProcKitch02_KitchenExhaustHoodStyle = { 
        if (LocalStatus( KitExhHoodStyle[2] ) > 0) 
        then
            switch (KitExhHoodStyle[2])
                case "BackshelfOrPassover" : "BackshelfPassover"
                case "DoubleIsland"        : "DoubleIsland"
                case "Eyebrow"             : "Eyebrow"
                case "None"                : "None"
                case "SingleIsland"        : "SingleIsland"
                case "WallMountedCanopy"   : "WallMountedCanopy"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch03_KitchenExhaustHoodDuty" Spc:nrcctblRowKitchHoodsRef2:ProcKitch03_KitchenExhaustHoodDuty = { 
        if (LocalStatus( KitExhHoodDuty[2] ) > 0 .AND. LocalStatus( KitExhHoodStyle[2] ) > 0) 
        then
            switch (KitExhHoodDuty[2])
                case "Light"      : "LightDuty"
                case "Medium"     : "MediumDuty"
                case "Heavy"      : "HeavyDuty"
                case "ExtraHeavy" : "ExtraHeavyDuty"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch03_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef2:ProcKitch03_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef2:ProcKitch03_KitchenExhaustHoodDuty ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[2] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch04_KitchenExhaustHoodLength" Spc:nrcctblRowKitchHoodsRef2:ProcKitch04_KitchenExhaustHoodLength = { 
        if (LocalStatus( KitExhHoodLen[2] ) > 0 .AND. LocalStatus( KitExhHoodStyle[2] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodLen[2] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch04_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef2:ProcKitch04_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef2:ProcKitch04_KitchenExhaustHoodLength ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[2] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch05_KitchenExhaustHoodFlow" Spc:nrcctblRowKitchHoodsRef2:ProcKitch05_KitchenExhaustHoodFlow = { 
        if (LocalStatus( KitExhHoodFlow[2] ) > 0 .AND. LocalStatus( KitExhHoodStyle[2] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodFlow[2] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef2:ProcKitch05_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef2:ProcKitch05_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef2:ProcKitch05_KitchenExhaustHoodFlow ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[2] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Create nrcctblRowKitchHoodsRef3 object for each pertinent Spc"     Spc:nrcctblRowKitchHoodsRef3 =
      {  if (LocalCompAssigned( nrccTableKitchHoodsRef ) < 1) then UNDEFINED
         else if (LocalStatus( KitExhHoodStyle[3] ) > 0 .AND. KitExhHoodStyle[3] != "None") 
         then CreateComp( nrcctblRowKitchHoods, Format( "%s ProcKitchRowKitchHoods3", Name ) )
         else UNDEFINED
         endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef3:noXMLoutput_SpcRef"                  Spc:nrcctblRowKitchHoodsRef3:noXMLoutput_SpcRef                  = {  Name  }
   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch02_KitchenExhaustHoodStyle" Spc:nrcctblRowKitchHoodsRef3:ProcKitch02_KitchenExhaustHoodStyle = { 
        if (LocalStatus( KitExhHoodStyle[3] ) > 0) 
        then
            switch (KitExhHoodStyle[3])
                case "BackshelfOrPassover" : "BackshelfPassover"
                case "DoubleIsland"        : "DoubleIsland"
                case "Eyebrow"             : "Eyebrow"
                case "None"                : "None"
                case "SingleIsland"        : "SingleIsland"
                case "WallMountedCanopy"   : "WallMountedCanopy"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch03_KitchenExhaustHoodDuty" Spc:nrcctblRowKitchHoodsRef3:ProcKitch03_KitchenExhaustHoodDuty = { 
        if (LocalStatus( KitExhHoodDuty[3] ) > 0 .AND. LocalStatus( KitExhHoodStyle[3] ) > 0) 
        then
            switch (KitExhHoodDuty[3])
                case "Light"      : "LightDuty"
                case "Medium"     : "MediumDuty"
                case "Heavy"      : "HeavyDuty"
                case "ExtraHeavy" : "ExtraHeavyDuty"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch03_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef3:ProcKitch03_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef3:ProcKitch03_KitchenExhaustHoodDuty ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[3] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch04_KitchenExhaustHoodLength" Spc:nrcctblRowKitchHoodsRef3:ProcKitch04_KitchenExhaustHoodLength = { 
        if (LocalStatus( KitExhHoodLen[3] ) > 0 .AND. LocalStatus( KitExhHoodStyle[3] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodLen[3] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch04_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef3:ProcKitch04_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef3:ProcKitch04_KitchenExhaustHoodLength ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[3] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch05_KitchenExhaustHoodFlow" Spc:nrcctblRowKitchHoodsRef3:ProcKitch05_KitchenExhaustHoodFlow = { 
        if (LocalStatus( KitExhHoodFlow[3] ) > 0 .AND. LocalStatus( KitExhHoodStyle[3] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodFlow[3] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef3:ProcKitch05_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef3:ProcKitch05_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef3:ProcKitch05_KitchenExhaustHoodFlow ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[3] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Create nrcctblRowKitchHoodsRef4 object for each pertinent Spc"     Spc:nrcctblRowKitchHoodsRef4 =
      {  if (LocalCompAssigned( nrccTableKitchHoodsRef ) < 1) then UNDEFINED
         else if (LocalStatus( KitExhHoodStyle[4] ) > 0 .AND. KitExhHoodStyle[4] != "None") 
         then CreateComp( nrcctblRowKitchHoods, Format( "%s ProcKitchRowKitchHoods4", Name ) )
         else UNDEFINED
         endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef4:noXMLoutput_SpcRef"                  Spc:nrcctblRowKitchHoodsRef4:noXMLoutput_SpcRef                  = {  Name  }
   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch02_KitchenExhaustHoodStyle" Spc:nrcctblRowKitchHoodsRef4:ProcKitch02_KitchenExhaustHoodStyle = { 
        if (LocalStatus( KitExhHoodStyle[4] ) > 0) 
        then
            switch (KitExhHoodStyle[4])
                case "BackshelfOrPassover" : "BackshelfPassover"
                case "DoubleIsland"        : "DoubleIsland"
                case "Eyebrow"             : "Eyebrow"
                case "None"                : "None"
                case "SingleIsland"        : "SingleIsland"
                case "WallMountedCanopy"   : "WallMountedCanopy"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch03_KitchenExhaustHoodDuty" Spc:nrcctblRowKitchHoodsRef4:ProcKitch03_KitchenExhaustHoodDuty = { 
        if (LocalStatus( KitExhHoodDuty[4] ) > 0 .AND. LocalStatus( KitExhHoodStyle[4] ) > 0) 
        then
            switch (KitExhHoodDuty[4])
                case "Light"      : "LightDuty"
                case "Medium"     : "MediumDuty"
                case "Heavy"      : "HeavyDuty"
                case "ExtraHeavy" : "ExtraHeavyDuty"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch03_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef4:ProcKitch03_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef4:ProcKitch03_KitchenExhaustHoodDuty ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[4] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch04_KitchenExhaustHoodLength" Spc:nrcctblRowKitchHoodsRef4:ProcKitch04_KitchenExhaustHoodLength = { 
        if (LocalStatus( KitExhHoodLen[4] ) > 0 .AND. LocalStatus( KitExhHoodStyle[4] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodLen[4] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch04_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef4:ProcKitch04_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef4:ProcKitch04_KitchenExhaustHoodLength ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[4] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch05_KitchenExhaustHoodFlow" Spc:nrcctblRowKitchHoodsRef4:ProcKitch05_KitchenExhaustHoodFlow = { 
        if (LocalStatus( KitExhHoodFlow[4] ) > 0 .AND. LocalStatus( KitExhHoodStyle[4] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodFlow[4] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef4:ProcKitch05_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef4:ProcKitch05_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef4:ProcKitch05_KitchenExhaustHoodFlow ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[4] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Create nrcctblRowKitchHoodsRef5 object for each pertinent Spc"     Spc:nrcctblRowKitchHoodsRef5 =
      {  if (LocalCompAssigned( nrccTableKitchHoodsRef ) < 1) then UNDEFINED
         else if (LocalStatus( KitExhHoodStyle[5] ) > 0 .AND. KitExhHoodStyle[5] != "None") 
         then CreateComp( nrcctblRowKitchHoods, Format( "%s ProcKitchRowKitchHoods5", Name ) )
         else UNDEFINED
         endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef5:noXMLoutput_SpcRef"                  Spc:nrcctblRowKitchHoodsRef5:noXMLoutput_SpcRef                  = {  Name  }
   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch02_KitchenExhaustHoodStyle" Spc:nrcctblRowKitchHoodsRef5:ProcKitch02_KitchenExhaustHoodStyle = { 
        if (LocalStatus( KitExhHoodStyle[5] ) > 0) 
        then
            switch (KitExhHoodStyle[5])
                case "BackshelfOrPassover" : "BackshelfPassover"
                case "DoubleIsland"        : "DoubleIsland"
                case "Eyebrow"             : "Eyebrow"
                case "None"                : "None"
                case "SingleIsland"        : "SingleIsland"
                case "WallMountedCanopy"   : "WallMountedCanopy"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch03_KitchenExhaustHoodDuty" Spc:nrcctblRowKitchHoodsRef5:ProcKitch03_KitchenExhaustHoodDuty = { 
        if (LocalStatus( KitExhHoodDuty[5] ) > 0 .AND. LocalStatus( KitExhHoodStyle[5] ) > 0) 
        then
            switch (KitExhHoodDuty[5])
                case "Light"      : "LightDuty"
                case "Medium"     : "MediumDuty"
                case "Heavy"      : "HeavyDuty"
                case "ExtraHeavy" : "ExtraHeavyDuty"
                default :  UNDEFINED
            endswitch
        else  UNDEFINED  endif }
   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch03_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef5:ProcKitch03_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef5:ProcKitch03_KitchenExhaustHoodDuty ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[5] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch04_KitchenExhaustHoodLength" Spc:nrcctblRowKitchHoodsRef5:ProcKitch04_KitchenExhaustHoodLength = { 
        if (LocalStatus( KitExhHoodLen[5] ) > 0 .AND. LocalStatus( KitExhHoodStyle[5] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodLen[5] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch04_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef5:ProcKitch04_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef5:ProcKitch04_KitchenExhaustHoodLength ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[5] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch05_KitchenExhaustHoodFlow" Spc:nrcctblRowKitchHoodsRef5:ProcKitch05_KitchenExhaustHoodFlow = { 
        if (LocalStatus( KitExhHoodFlow[5] ) > 0 .AND. LocalStatus( KitExhHoodStyle[5] ) > 0) 
        then atof( Format( "%.2f", KitExhHoodFlow[5] ) )
        else UNDEFINED endif }
   "Set Spc:nrcctblRowKitchHoodsRef5:ProcKitch05_NotApplicableMessage" Spc:nrcctblRowKitchHoodsRef5:ProcKitch05_NotApplicableMessage = { 
        if (LocalStatus( nrcctblRowKitchHoodsRef5:ProcKitch05_KitchenExhaustHoodFlow ) > 0) then UNDEFINED  
        else if (LocalStatus( KitExhHoodStyle[5] ) > 0) then "NotApplicable" 
        else UNDEFINED
        endif endif }

  ; Rule to Delete empty nrccSection_ProcKitch
   "DELETE empty nrccTableProcKitch object"
      nrccSection_ProcKitch:Action   = {  if (ComponentCount( nrcctblRowProcKitch ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


; RJH 9/19/22 Section_ProcComp removed from NRCC/LMCC 2022, remains in NRCC 2019
;   "Create nrccSection_ProcComp object"
;      nrccNRCCPRF:Action    = {  if (Proj:CompPathMech == "Performance") 
;                                 then CreateChildren( nrccSection_ProcComp, 1, "NRCC ProcComp" )
;                                 else UNCHANGED 
;                                 endif }
   "Create nrccSection_ProcComp nrccTableProcComp object"              nrccSection_ProcComp:Action  =
      {  CreateChildren( nrccTableProcComp, 1, "NRCC ProcComp table" )  }
   "Create nrcctblRowProcComp object for each pertinent AirSys"     AirSys:nrcctblRowProcCompRef =
      {  if (LocalCompAssigned( nrcctblRowProcCompRef ) > 0 .OR.
             ComponentCount( nrccTableProcComp ) < 1 .OR.
             ComponentCount( AirSys ) < 1 ) then  UNDEFINED
         else if ((IfValidAnd(Subtype == "CRAC") .OR. IfValidAnd(Subtype == "CRAH")) .AND. IfValidAnd(Proj:CompPathComputerRm == "Performance"))
              then CreateComp( nrcctblRowProcComp, Format( "%s ProcComp tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set AirSys:nrcctblRowProcCompRef:noXMLoutput_AirSysRef"    AirSys:nrcctblRowProcCompRef:noXMLoutput_AirSysRef = 
      {  if (ComponentCount( AirSys ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_ProcComp
   "DELETE empty nrccTableProcComp object"
      nrccSection_ProcComp:Action   = {  if (ComponentCount( nrcctblRowProcComp ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_ProcLab object"
      nrccNRCCPRF:Action    = {  if (Proj:CompPathMech == "Performance") 
                                 then CreateChildren( nrccSection_ProcLab, 1, "NRCC ProcLab" )
                                 else UNCHANGED 
                                 endif }
   "Create nrccSection_ProcLab nrccTableProcLab object"              nrccSection_ProcLab:Action  =
      {  CreateChildren( nrccTableProcLab, 1, "NRCC ProcLab table" )  }
   "Create nrcctblRowProcLab object for each pertinent Spc"     Spc:nrcctblRowProcLabRef =
      {  if (LocalCompAssigned( nrcctblRowProcLabRef ) > 0 .OR.
             ComponentCount( nrccTableProcLab ) < 1 .OR.
             ComponentCount( Spc ) < 1 ) then  UNDEFINED
         else if ((IfValidAnd(SpcFunc == "Scientific Laboratory Area") .OR.
                   IfValidAnd(SpcFunc == "Laboratory, Scientific"    )) .AND. IfValidAnd(Proj:CompPathLab == "Performance"))
              then CreateComp( nrcctblRowProcLab, Format( "%s ProcLab tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowProcLabRef:noXMLoutput_SpcRef"    Spc:nrcctblRowProcLabRef:noXMLoutput_SpcRef = 
      {  if (ComponentCount( Spc ) < 1) then  UNDEFINED
         else Name
         endif  }
  ; Rule to Delete empty nrccSection_ProcLab
   "DELETE empty nrccTableProcLab object"
      nrccSection_ProcLab:Action   = {  if (ComponentCount( nrcctblRowProcLab ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_LtgInfo object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_LtgInfo, 1, "NRCC LtgInfo" )
         else UNCHANGED 
         endif }
   "Create nrccSection_LtgInfo nrccTableLtgInfo object"              nrccSection_LtgInfo:Action  =
      {  CreateChildren( nrccTableLtgInfo, 1, "NRCC LtgInfo table" )  }


;   "Create nrcctblRowLtgInfo object for each pertinent Space"     Spc:nrcctblRowLtgInfoRef =
;      {  if (LocalCompAssigned( nrcctblRowLtgInfoRef ) > 0 .OR.
;             ComponentCount( nrccTableLtgInfo ) < 1) then  UNDEFINED
;         else if (LtgStatus != "Existing" .AND. LtgStatus != "Future" .AND. CondFlrAreaWithMult > 0 .AND. OccClass != "Residential") 
;              then CreateComp( nrcctblRowLtgInfo, Format( "%s LtgInfo tblRow", Name ) )
;              else UNDEFINED
;              endif
;         endif  }
;   "Set Spc:nrcctblRowLtgInfoRef:noXMLoutput_SpcRef"    Spc:nrcctblRowLtgInfoRef:noXMLoutput_SpcRef = {  Name  }
; replaced above w/ following to create nrcctblRowLtgInfo by SpcFunc rather than Spc - SAC 04/29/22
   "Create nrcctblRowLtgInfo object for each SpcFunc (as opposed to each Spc)"   Proj:Action =
      {  if (MaxAll( Spc:nrcctblRowLtgBucketVal ) > 0)
         then  CreateCompFor( MinAll( Spc:nrcctblRowLtgBucketVal ), MaxAll( Spc:nrcctblRowLtgBucketVal ),
                   "Spc:nrcctblRowLtgBucketVal", nrccTableLtgInfo:Name,
                   "nrcctblRowLtgInfo:noXMLoutput_LtgTblBucketVal",
                   "nrcctblRowLtgInfo:noXMLoutput_SpcRef"  )
         else  UNCHANGED  endif  }

  ; Rule to Delete empty nrccSection_LtgInfo
   "DELETE empty nrccTableLtgInfo object"
      nrccSection_LtgInfo:Action   = {  if (ComponentCount( nrcctblRowLtgInfo ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_LtgSched object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance" .AND. SumAll( Lum:CondCnt ) > 0) 
         then CreateChildren( nrccSection_LtgSched, 1, "NRCC LtgSched" )
         else UNCHANGED 
         endif }
   "Create nrccSection_LtgSched nrccTableLtgSched object"              nrccSection_LtgSched:Action  =
      {  CreateChildren( nrccTableLtgSched, 1, "NRCC LtgSched table" )  }
   "Create nrcctblRowLtgSched object for each pertinent Luminaire"     Lum:nrcctblRowLtgSchedRef =
      {  if (LocalCompAssigned( nrcctblRowLtgSchedRef ) > 0 .OR.
             ComponentCount( nrccTableLtgSched ) < 1) then  UNDEFINED
         else if (CondCnt > 0) 
              then CreateComp( nrcctblRowLtgSched, Format( "%s LtgSched tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Lum:nrcctblRowLtgSchedRef:noXMLoutput_LumRef"    Lum:nrcctblRowLtgSchedRef:noXMLoutput_LumRef = {  Name  }
  ; Rule to Delete empty nrccSection_LtgSched
   "DELETE empty nrccTableLtgSched object"
      nrccSection_LtgSched:Action   = {  if (ComponentCount( nrcctblRowLtgSched ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_LtgCredits object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_LtgCredits, 1, "NRCC LtgCredits" )
         else UNCHANGED 
         endif }
   "Create nrccSection_LtgCredits nrccTableLtgCredits object"              nrccSection_LtgCredits:Action  =
      {  CreateChildren( nrccTableLtgCredits, 1, "NRCC LtgCredits table" )  }
; RJH 8/30/2023 GitHub Issue #102 - Do not report if IntLtgSys has no controls
   "Create nrcctblRowLtgCredits object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLtgCreditsRef =
      {  if (LocalCompAssigned( nrcctblRowLtgCreditsRef ) > 0 .OR.
             ComponentCount( nrccTableLtgCredits ) < 1 .OR.
             PAFCredType[1] == "- none specified -") then  UNDEFINED
         else if (ParentSpcIsCond == 1 .AND. IfValidAnd(Parent(OccClass) != "Residential")) 
              then CreateComp( nrcctblRowLtgCredits, Format( "%s LtgCredits tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set IntLtgSys:nrcctblRowLtgCreditsRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrcctblRowLtgCreditsRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Create nrccTableLuminairesCreditsRef object for each pertinent IntLtgSys"     IntLtgSys:nrccTableLuminairesCreditsRef =
      {  if (LocalCompAssigned( nrcctblRowLtgCreditsRef ) < 1 .OR.
               (LocalCompAssigned( LumRef[1] ) < 1 .AND. LocalCompAssigned( LumRef[2] ) < 1 .AND.
                LocalCompAssigned( LumRef[3] ) < 1 .AND. LocalCompAssigned( LumRef[4] ) < 1 .AND.
                LocalCompAssigned( LumRef[5] ) < 1 ))
         then  UNDEFINED
         else  CreateComp( nrccTableLuminairesCredits, Format( "%s TableLuminairesCredits", Name ) )
         endif  }
   "Set IntLtgSys:nrccTableLuminairesCreditsRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrccTableLuminairesCreditsRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Create nrcctblRowLuminairesCreditsRef1 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesCreditsRef1 =
      {  if (LocalCompAssigned( nrccTableLuminairesCreditsRef ) < 1 .OR.
             LocalCompAssigned( LumRef[1] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesCredits, Format( "%s LtgCreditsRowLuminaires1", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef1:noXMLoutput_IntLtgSysRef"           IntLtgSys:nrcctblRowLuminairesCreditsRef1:noXMLoutput_IntLtgSysRef          = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits05_LuminaireName"         IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits05_LuminaireName        = {  LumRef[1]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits06_LuminairePower"        IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits06_LuminairePower       = {  LumRef[1]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits07_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesCreditsRef1:LtgCredits07_LuminaireCountByType = {  LumCnt[1]  }

   "Create nrcctblRowLuminairesCreditsRef2 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesCreditsRef2 =
      {  if (LocalCompAssigned( nrccTableLuminairesCreditsRef ) < 1 .OR.
             LocalCompAssigned( LumRef[2] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesCredits, Format( "%s LtgCreditsRowLuminaires2", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef2:noXMLoutput_IntLtgSysRef"           IntLtgSys:nrcctblRowLuminairesCreditsRef2:noXMLoutput_IntLtgSysRef          = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits05_LuminaireName"         IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits05_LuminaireName        = {  LumRef[2]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits06_LuminairePower"        IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits06_LuminairePower       = {  LumRef[2]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits07_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesCreditsRef2:LtgCredits07_LuminaireCountByType = {  LumCnt[2]  }

   "Create nrcctblRowLuminairesCreditsRef3 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesCreditsRef3 =
      {  if (LocalCompAssigned( nrccTableLuminairesCreditsRef ) < 1 .OR.
             LocalCompAssigned( LumRef[3] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesCredits, Format( "%s LtgCreditsRowLuminaires3", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef3:noXMLoutput_IntLtgSysRef"           IntLtgSys:nrcctblRowLuminairesCreditsRef3:noXMLoutput_IntLtgSysRef          = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits05_LuminaireName"         IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits05_LuminaireName        = {  LumRef[3]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits06_LuminairePower"        IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits06_LuminairePower       = {  LumRef[3]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits07_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesCreditsRef3:LtgCredits07_LuminaireCountByType = {  LumCnt[3]  }

   "Create nrcctblRowLuminairesCreditsRef4 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesCreditsRef4 =
      {  if (LocalCompAssigned( nrccTableLuminairesCreditsRef ) < 1 .OR.
             LocalCompAssigned( LumRef[4] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesCredits, Format( "%s LtgCreditsRowLuminaires4", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef4:noXMLoutput_IntLtgSysRef"           IntLtgSys:nrcctblRowLuminairesCreditsRef4:noXMLoutput_IntLtgSysRef          = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits05_LuminaireName"         IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits05_LuminaireName        = {  LumRef[4]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits06_LuminairePower"        IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits06_LuminairePower       = {  LumRef[4]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits07_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesCreditsRef4:LtgCredits07_LuminaireCountByType = {  LumCnt[4]  }

   "Create nrcctblRowLuminairesCreditsRef5 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesCreditsRef5 =
      {  if (LocalCompAssigned( nrccTableLuminairesCreditsRef ) < 1 .OR.
             LocalCompAssigned( LumRef[5] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesCredits, Format( "%s LtgCreditsRowLuminaires5", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef5:noXMLoutput_IntLtgSysRef"           IntLtgSys:nrcctblRowLuminairesCreditsRef5:noXMLoutput_IntLtgSysRef          = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits05_LuminaireName"         IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits05_LuminaireName        = {  LumRef[5]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits06_LuminairePower"        IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits06_LuminairePower       = {  LumRef[5]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits07_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesCreditsRef5:LtgCredits07_LuminaireCountByType = {  LumCnt[5]  }

  ; Rule to Delete empty nrccSection_LtgCredits
   "DELETE empty nrccTableLtgCredits object"
      nrccSection_LtgCredits:Action   = {  if (ComponentCount( nrcctblRowLtgCredits ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_LtgControls object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_LtgControls, 1, "NRCC LtgControls" )
         else UNCHANGED 
         endif }
   "Create nrccSection_LtgControls nrccTableLtgControls object"              nrccSection_LtgControls:Action  =
      {  CreateChildren( nrccTableLtgControls, 1, "NRCC LtgControls table" )  }

   "Create nrccSection_LtgControls nrcctblRowLtgControls #1 object"     nrccTableLtgControls:Action  =      ; SAC 05/17/21
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[1] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[1] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[1] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row1", "NRCCPRF_RowLtgControls_row1" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #2 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[2] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[2] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[2] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row2", "NRCCPRF_RowLtgControls_row2" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #3 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[3] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[3] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[3] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row3", "NRCCPRF_RowLtgControls_row3" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #4 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[4] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[4] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[4] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row4", "NRCCPRF_RowLtgControls_row4" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #5 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[5] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[5] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[5] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row5", "NRCCPRF_RowLtgControls_row5" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #6 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[6] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[6] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[6] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row6", "NRCCPRF_RowLtgControls_row6" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #7 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[7] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[7] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[7] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row7", "NRCCPRF_RowLtgControls_row7" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #8 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[8] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[8] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[8] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row8", "NRCCPRF_RowLtgControls_row8" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #9 object"     nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[9] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[9] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[9] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row9", "NRCCPRF_RowLtgControls_row9" )
         else  UNCHANGED  endif endif  }
   "Create nrccSection_LtgControls nrcctblRowLtgControls #10 object"    nrccTableLtgControls:Action  = 
      {  if (GlobalStatus( Proj:MandatoryLtgCtrlDescRpt[10] ) < 1 .OR.
             EnumValue( Proj:MandatoryLtgCtrlSpcFunctRpt[10] ) < 1)
         then  UNCHANGED
         else if (strlen( Proj:MandatoryLtgCtrlDescRpt[10] ) > 0)
         then  CreateChildren( nrcctblRowLtgControls, 1, "NRCC LtgControls row10", "NRCCPRF_RowLtgControls_row10" )
         else  UNCHANGED  endif endif  }

; Scenarios for this section:
;1. If elements LtgControls01 through LtgControls10 are present, then populate them.
;2. If elements LtgControls01 and LtgControls02 are present, but LtgControls03 through LtgControls10 are missing, then also populate LtgControlsNA
;3. If elements LtgControls01 through LtgControls10 are all missing, then only populate LtgControlsNA

  ; Scenario 1 is automatic

  ; Scenario 2
  ; Rule to Delete empty nrccTableLtgControls table
   "DELETE empty nrccTableLtgControls object"
      nrccTableLtgControls:Action   = {  if (ComponentCount( nrcctblRowLtgControls ) < 1) then  DeleteComp()  else  UNCHANGED  endif }
  ; Rule to set LtgControlsNA is below

  ; Scenario 3
  ; Rule to set LtgControlsNA for deleted nrccTableLtgControls
   "Set nrccSection_LtgControls:LtgControlsNA"  nrccSection_LtgControls:LtgControlsNA  = {
         if (ComponentCount( nrccTableLtgControls ) < 1)
         then  if ( IfValidAnd( Proj:IsLowRiseMFam > 0 ) )
               then  "See LMCC-LTI01-E for mandatory controls"     
               else  "See NRCC-LTI-E for mandatory controls"
               endif
         else  UNDEFINED
         endif  }


   "Create nrccSection_TailoredSum object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance" .AND. Bldg:CondTMBaseGenlPwr) 
         then CreateChildren( nrccSection_TailoredSum,    1, "NRCC TailoredSum" )
         else UNCHANGED 
         endif }


   "Create nrccSection_TailoredGen object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredGen, 1, "NRCC TailoredGen" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredGen nrccTableTailoredGen object"              nrccSection_TailoredGen:Action  =
      {  CreateChildren( nrccTableTailoredGen, 1, "NRCC TailoredGen table" )  }
   "Create nrcctblRowTailoredGen object for each pertinent Space"     Spc:nrcctblRowTailoredGenRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredGenRef ) > 0 .OR.
             ComponentCount( nrccTableTailoredGen ) < 1 .OR.
             IntLtgSpecMthd != "TailoredMethod") then  UNDEFINED
         else if (CondgType == "DirectlyConditioned" .OR. CondgType == "IndirectlyConditioned") 
              then CreateComp( nrcctblRowTailoredGen, Format( "%s TailoredGen tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowTailoredGenRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredGenRef:noXMLoutput_SpcRef = {  Name  }
  ; Rule to Delete empty nrccSection_TailoredGen
   "DELETE empty nrccTableTailoredGen object"
      nrccSection_TailoredGen:Action   = {  if (ComponentCount( nrcctblRowTailoredGen ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_TailoredRCR object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredRCR, 1, "NRCC TailoredRCR" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredRCR nrccTableTailoredRCR object"              nrccSection_TailoredRCR:Action  =
      {  CreateChildren( nrccTableTailoredRCR, 1, "NRCC TailoredRCR table" )  }
   "Create nrcctblRowTailoredRCR object for each pertinent Space"     Spc:nrcctblRowTailoredRCRRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredRCRRef ) > 0 .OR.
             ComponentCount( nrccTableTailoredRCR ) < 1 .OR.
             IntLtgSpecMthd != "TailoredMethod" .OR.
             ( CondgType != "DirectlyConditioned" .AND. CondgType != "IndirectlyConditioned" ) ) then  UNDEFINED
         else  CreateComp( nrcctblRowTailoredRCR, Format( "%s TailoredRCR tblRow", Name ) )
         endif  }
   "Set Spc:nrcctblRowTailoredRCRRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredRCRRef:noXMLoutput_SpcRef = {  Name  }
  ; Rule to Delete empty nrccSection_TailoredRCR
   "DELETE empty nrccTableTailoredRCR object"
      nrccSection_TailoredRCR:Action   = {  if (ComponentCount( nrcctblRowTailoredRCR ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_TailoredWall object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredWall, 1, "NRCC TailoredWall" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredWall nrccTableTailoredWall object"              nrccSection_TailoredWall:Action  =
      {  CreateChildren( nrccTableTailoredWall, 1, "NRCC TailoredWall table" )  }
   "Create nrcctblRowTailoredWall object for each pertinent Space"     Spc:nrcctblRowTailoredWallRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredWallRef ) > 0 .OR.
             TMWallDispAllow <= 0 ) then  UNDEFINED
         else if (CondgType == "DirectlyConditioned" .OR. CondgType == "IndirectlyConditioned") 
              then CreateComp( nrcctblRowTailoredWall, Format( "%s TailoredWall tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowTailoredWallRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredWallRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrccTableIntLtgSysWallRef object for each pertinent Space"     Spc:nrccTableIntLtgSysWallRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredWallRef ) < 1)
         then  UNDEFINED
         else  CreateComp( nrccTableIntLtgSysWall, Format( "%s TableIntLtgSysWall", Name ) )
         endif  }
   "Set Spc:nrccTableIntLtgSysWallRef:noXMLoutput_SpcRef"    Spc:nrccTableIntLtgSysWallRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowIntLtgSysWallRef object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowIntLtgSysWallRef =
      {  if( ParentComponentType() = "Spc" )
         then if (ParentCompAssigned( Spc:nrcctblRowTailoredWallRef ) < 1 .OR. AllowType != "TailoredWallDisplayAllowance")
              then  UNDEFINED
              else  CreateComp( nrcctblRowIntLtgSysWall, Format( "%s RowIntLtgSysWall", Name ) )
              endif
         else UNDEFINED
         endif  }
   "Set IntLtgSys:nrcctblRowIntLtgSysWallRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrcctblRowIntLtgSysWallRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Set nrcctblRowIntLtgSysWall Parent"    IntLtgSys:nrcctblRowIntLtgSysWallRef:Parent = {  Spc:nrccTableIntLtgSysWallRef  }

;   "Debug"    IntLtgSys:Action = {  PostMessageToLog("IntLtgSys '%s'  Parent: %s", Name, Parent(Name) )  }
;   "Debug"    IntLtgSys:Action = {  if ( ParentCompAssigned(nrcctblRowTailoredWallRef)) then PostMessageToLog("IntLtgSys '%s'  Parent:nrcctblRowTailoredWallRef '%s'", Name, nrcctblRowTailoredWallRef:Name ) else PostMessageToLog("IntLtgSys '%s'  No Parent:nrcctblRowTailoredWallRef", Name ) endif  }
;   "Debug"    nrcctblRowIntLtgSysWall:Action = {  if ( ParentCompAssigned(noXMLoutput_SpcRef)) then PostMessageToLog("tblRowIntLtgSysWall '%s  Parent: %s", Name, Parent(Name) ) else PostMessageToLog("tblRowIntLtgSysWall '%s  No Parent", Name ) endif  }

   "Create nrccTableLuminairesWallRef object for each pertinent IntLtgSys"     IntLtgSys:nrccTableLuminairesWallRef =
      {  if (LocalCompAssigned( nrcctblRowIntLtgSysWallRef ) < 1 .OR.
               (LocalCompAssigned( LumRef[1] ) < 1 .AND. LocalCompAssigned( LumRef[2] ) < 1 .AND.
                LocalCompAssigned( LumRef[3] ) < 1 .AND. LocalCompAssigned( LumRef[4] ) < 1 .AND.
                LocalCompAssigned( LumRef[5] ) < 1 ))
         then  UNDEFINED
         else  CreateComp( nrccTableLuminairesWall, Format( "%s TableLuminairesWall", Name ) )
         endif  }
   "Set IntLtgSys:nrccTableLuminairesWallRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrccTableLuminairesWallRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Create nrcctblRowLuminairesWallRef1 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesWallRef1 =
      {  if (LocalCompAssigned( nrccTableLuminairesWallRef ) < 1 .OR.
             LocalCompAssigned( LumRef[1] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesWall, Format( "%s RowLuminaires1", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef1:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesWallRef1:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall09_LuminaireName  = {  LumRef[1]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall10_LuminairePower = {  LumRef[1]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesWallRef1:TailoredWall11_LuminaireCountByType = {  LumCnt[1]  }

   "Create nrcctblRowLuminairesWallRef2 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesWallRef2 =
      {  if (LocalCompAssigned( nrccTableLuminairesWallRef ) < 1 .OR.
             LocalCompAssigned( LumRef[2] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesWall, Format( "%s RowLuminaires2", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef2:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesWallRef2:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall09_LuminaireName  = {  LumRef[2]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall10_LuminairePower = {  LumRef[2]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesWallRef2:TailoredWall11_LuminaireCountByType = {  LumCnt[2]  }

   "Create nrcctblRowLuminairesWallRef3 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesWallRef3 =
      {  if (LocalCompAssigned( nrccTableLuminairesWallRef ) < 1 .OR.
             LocalCompAssigned( LumRef[3] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesWall, Format( "%s RowLuminaires3", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef3:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesWallRef3:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall09_LuminaireName  = {  LumRef[3]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall10_LuminairePower = {  LumRef[3]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesWallRef3:TailoredWall11_LuminaireCountByType = {  LumCnt[3]  }

   "Create nrcctblRowLuminairesWallRef4 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesWallRef4 =
      {  if (LocalCompAssigned( nrccTableLuminairesWallRef ) < 1 .OR.
             LocalCompAssigned( LumRef[4] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesWall, Format( "%s RowLuminaires4", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef4:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesWallRef4:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall09_LuminaireName  = {  LumRef[4]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall10_LuminairePower = {  LumRef[4]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesWallRef4:TailoredWall11_LuminaireCountByType = {  LumCnt[4]  }

   "Create nrcctblRowLuminairesWallRef5 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesWallRef5 =
      {  if (LocalCompAssigned( nrccTableLuminairesWallRef ) < 1 .OR.
             LocalCompAssigned( LumRef[5] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesWall, Format( "%s RowLuminaires5", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef5:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesWallRef5:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall09_LuminaireName  = {  LumRef[5]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall10_LuminairePower = {  LumRef[5]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesWallRef5:TailoredWall11_LuminaireCountByType = {  LumCnt[5]  }

  ; Rule to Delete empty nrccSection_TailoredWall
   "DELETE empty nrccTableTailoredWall object"
      nrccSection_TailoredWall:Action   = {  if (ComponentCount( nrcctblRowTailoredWall ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_TailoredFloor object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredFloor, 1, "NRCC TailoredFloor" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredFloor nrccTableTailoredFloor object"              nrccSection_TailoredFloor:Action  =
      {  CreateChildren( nrccTableTailoredFloor, 1, "NRCC TailoredFloor table" )  }
   "Create nrcctblRowTailoredFloor object for each pertinent Space"     Spc:nrcctblRowTailoredFloorRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredFloorRef ) > 0 .OR.
             TMCmbdFlrDispTaskAllow <= 0 ) then  UNDEFINED
         else if (CondgType == "DirectlyConditioned" .OR. CondgType == "IndirectlyConditioned") 
              then CreateComp( nrcctblRowTailoredFloor, Format( "%s TailoredFloor tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowTailoredFloorRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredFloorRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrccTableIntLtgSysFloorRef object for each pertinent Space"     Spc:nrccTableIntLtgSysFloorRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredFloorRef ) < 1)
         then  UNDEFINED
         else  CreateComp( nrccTableIntLtgSysFloor, Format( "%s TableIntLtgSysFloor", Name ) )
         endif  }
   "Set Spc:nrccTableIntLtgSysFloorRef:noXMLoutput_SpcRef"    Spc:nrccTableIntLtgSysFloorRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowIntLtgSysFloorRef object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowIntLtgSysFloorRef =
      {  if( ParentComponentType() = "Spc" )
         then if( ParentCompAssigned( Spc:nrcctblRowTailoredFloorRef ) < 1 .OR.
                  (AllowType != "TailoredFloorDisplayAllowance" .AND. AllowType != "TailoredTaskAllowance") )
              then  UNDEFINED
              else  CreateComp( nrcctblRowIntLtgSysFloor, Format( "%s RowIntLtgSysFloor", Name ) )
              endif
         else UNDEFINED
         endif  }
   "Set IntLtgSys:nrcctblRowIntLtgSysFloorRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrcctblRowIntLtgSysFloorRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Set nrcctblRowIntLtgSysFloor Parent"    IntLtgSys:nrcctblRowIntLtgSysFloorRef:Parent = {  Spc:nrccTableIntLtgSysFloorRef  }

;   "Debug"    IntLtgSys:Action = {  PostMessageToLog("IntLtgSys '%s'  Parent: %s", Name, Parent(Name) )  }
;   "Debug"    IntLtgSys:Action = {  if ( ParentCompAssigned(nrcctblRowTailoredFloorRef)) then PostMessageToLog("IntLtgSys '%s'  Parent:nrcctblRowTailoredFloorRef '%s'", Name, nrcctblRowTailoredFloorRef:Name ) else PostMessageToLog("IntLtgSys '%s'  No Parent:nrcctblRowTailoredFloorRef", Name ) endif  }
;   "Debug"    nrcctblRowIntLtgSysFloor:Action = {  if ( ParentCompAssigned(noXMLoutput_SpcRef)) then PostMessageToLog("tblRowIntLtgSysFloor '%s  Parent: %s", Name, Parent(Name) ) else PostMessageToLog("tblRowIntLtgSysFloor '%s  No Parent", Name ) endif  }

   "Create nrccTableLuminairesFloorRef object for each pertinent IntLtgSys"     IntLtgSys:nrccTableLuminairesFloorRef =
      {  if (LocalCompAssigned( nrcctblRowIntLtgSysFloorRef ) < 1 .OR.
               (LocalCompAssigned( LumRef[1] ) < 1 .AND. LocalCompAssigned( LumRef[2] ) < 1 .AND.
                LocalCompAssigned( LumRef[3] ) < 1 .AND. LocalCompAssigned( LumRef[4] ) < 1 .AND.
                LocalCompAssigned( LumRef[5] ) < 1 ))
         then  UNDEFINED
         else  CreateComp( nrccTableLuminairesFloor, Format( "%s TableLuminairesFloor", Name ) )
         endif  }
   "Set IntLtgSys:nrccTableLuminairesFloorRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrccTableLuminairesFloorRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Create nrcctblRowLuminairesFloorRef1 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesFloorRef1 =
      {  if (LocalCompAssigned( nrccTableLuminairesFloorRef ) < 1 .OR.
             LocalCompAssigned( LumRef[1] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesFloor, Format( "%s TailoredFloorRowLuminaires1", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef1:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesFloorRef1:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor09_LuminaireName  = {  LumRef[1]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor10_LuminairePower = {  LumRef[1]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesFloorRef1:TailoredFloor11_LuminaireCountByType = {  LumCnt[1]  }

   "Create nrcctblRowLuminairesFloorRef2 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesFloorRef2 =
      {  if (LocalCompAssigned( nrccTableLuminairesFloorRef ) < 1 .OR.
             LocalCompAssigned( LumRef[2] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesFloor, Format( "%s TailoredFloorRowLuminaires2", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef2:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesFloorRef2:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor09_LuminaireName  = {  LumRef[2]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor10_LuminairePower = {  LumRef[2]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesFloorRef2:TailoredFloor11_LuminaireCountByType = {  LumCnt[2]  }

   "Create nrcctblRowLuminairesFloorRef3 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesFloorRef3 =
      {  if (LocalCompAssigned( nrccTableLuminairesFloorRef ) < 1 .OR.
             LocalCompAssigned( LumRef[3] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesFloor, Format( "%s TailoredFloorRowLuminaires3", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef3:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesFloorRef3:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor09_LuminaireName  = {  LumRef[3]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor10_LuminairePower = {  LumRef[3]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesFloorRef3:TailoredFloor11_LuminaireCountByType = {  LumCnt[3]  }

   "Create nrcctblRowLuminairesFloorRef4 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesFloorRef4 =
      {  if (LocalCompAssigned( nrccTableLuminairesFloorRef ) < 1 .OR.
             LocalCompAssigned( LumRef[4] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesFloor, Format( "%s TailoredFloorRowLuminaires4", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef4:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesFloorRef4:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor09_LuminaireName  = {  LumRef[4]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor10_LuminairePower = {  LumRef[4]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesFloorRef4:TailoredFloor11_LuminaireCountByType = {  LumCnt[4]  }

   "Create nrcctblRowLuminairesFloorRef5 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesFloorRef5 =
      {  if (LocalCompAssigned( nrccTableLuminairesFloorRef ) < 1 .OR.
             LocalCompAssigned( LumRef[5] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesFloor, Format( "%s TailoredFloorRowLuminaires5", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef5:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesFloorRef5:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor09_LuminaireName  = {  LumRef[5]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor10_LuminairePower = {  LumRef[5]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesFloorRef5:TailoredFloor11_LuminaireCountByType = {  LumCnt[5]  }

  ; Rule to Delete empty nrccSection_TailoredFloor
   "DELETE empty nrccTableTailoredFloor object"
      nrccSection_TailoredFloor:Action   = {  if (ComponentCount( nrcctblRowTailoredFloor ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_TailoredOrnamental object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredOrnamental, 1, "NRCC TailoredOrnamental" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredOrnamental nrccTableTailoredOrnamental object"              nrccSection_TailoredOrnamental:Action  =
      {  CreateChildren( nrccTableTailoredOrnamental, 1, "NRCC TailoredOrnamental table" )  }
   "Create nrcctblRowTailoredOrnamental object for each pertinent Space"     Spc:nrcctblRowTailoredOrnamentalRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredOrnamentalRef ) > 0 .OR.
             TMOrnAndSpclEftAllow <= 0 ) then  UNDEFINED
         else if (CondgType == "DirectlyConditioned" .OR. CondgType == "IndirectlyConditioned") 
              then CreateComp( nrcctblRowTailoredOrnamental, Format( "%s TailoredOrnamental tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowTailoredOrnamentalRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredOrnamentalRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrccTableIntLtgSysOrnamentalRef object for each pertinent IntLtgSys"     Spc:nrccTableIntLtgSysOrnamentalRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredOrnamentalRef ) < 1)
         then  UNDEFINED
         else  CreateComp( nrccTableIntLtgSysOrnamental, Format( "%s TableIntLtgSysOrnamental", Name ) )
         endif  }
   "Set Spc:nrccTableIntLtgSysOrnamentalRef:noXMLoutput_SpcRef"    Spc:nrccTableIntLtgSysOrnamentalRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowIntLtgSysOrnamentalRef object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowIntLtgSysOrnamentalRef =
      {  if( ParentComponentType() = "Spc" )
         then if( ParentCompAssigned( Spc:nrcctblRowTailoredOrnamentalRef ) < 1 .OR.
                  AllowType != "TailoredDecorativeAndSpecialEffectAllowance" )
              then UNDEFINED
              else CreateComp( nrcctblRowIntLtgSysOrnamental, Format( "%s TailoredOrnamentalRowIntLtgSys", Name ) )
              endif
         else UNDEFINED
         endif  }
   "Set IntLtgSys:nrcctblRowIntLtgSysOrnamentalRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrcctblRowIntLtgSysOrnamentalRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Set nrcctblRowIntLtgSysOrnamental Parent"    IntLtgSys:nrcctblRowIntLtgSysOrnamentalRef:Parent = {  Spc:nrccTableIntLtgSysOrnamentalRef  }

   "Create nrccTableLuminairesOrnamentalRef object for each pertinent IntLtgSys"     IntLtgSys:nrccTableLuminairesOrnamentalRef =
      {  if (LocalCompAssigned( nrcctblRowIntLtgSysOrnamentalRef ) < 1 .OR.
               (LocalCompAssigned( LumRef[1] ) < 1 .AND. LocalCompAssigned( LumRef[2] ) < 1 .AND.
                LocalCompAssigned( LumRef[3] ) < 1 .AND. LocalCompAssigned( LumRef[4] ) < 1 .AND.
                LocalCompAssigned( LumRef[5] ) < 1 ))
         then  UNDEFINED
         else  CreateComp( nrccTableLuminairesOrnamental, Format( "%s TableLuminairesOrnamental", Name ) )
         endif  }
   "Set IntLtgSys:nrccTableLuminairesOrnamentalRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrccTableLuminairesOrnamentalRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Create nrcctblRowLuminairesOrnamentalRef1 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesOrnamentalRef1 =
      {  if (LocalCompAssigned( nrccTableLuminairesOrnamentalRef ) < 1 .OR.
             LocalCompAssigned( LumRef[1] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesOrnamental, Format( "%s TailoredOrnamentalRowLuminaires1", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental09_LuminaireName  = {  LumRef[1]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental10_LuminairePower = {  LumRef[1]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesOrnamentalRef1:TailoredOrnamental11_LuminaireCountByType = {  LumCnt[1]  }

   "Create nrcctblRowLuminairesOrnamentalRef2 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesOrnamentalRef2 =
      {  if (LocalCompAssigned( nrccTableLuminairesOrnamentalRef ) < 1 .OR.
             LocalCompAssigned( LumRef[2] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesOrnamental, Format( "%s TailoredOrnamentalRowLuminaires2", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental09_LuminaireName  = {  LumRef[2]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental10_LuminairePower = {  LumRef[2]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesOrnamentalRef2:TailoredOrnamental11_LuminaireCountByType = {  LumCnt[2]  }

   "Create nrcctblRowLuminairesOrnamentalRef3 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesOrnamentalRef3 =
      {  if (LocalCompAssigned( nrccTableLuminairesOrnamentalRef ) < 1 .OR.
             LocalCompAssigned( LumRef[3] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesOrnamental, Format( "%s TailoredOrnamentalRowLuminaires3", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental09_LuminaireName  = {  LumRef[3]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental10_LuminairePower = {  LumRef[3]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesOrnamentalRef3:TailoredOrnamental11_LuminaireCountByType = {  LumCnt[3]  }

   "Create nrcctblRowLuminairesOrnamentalRef4 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesOrnamentalRef4 =
      {  if (LocalCompAssigned( nrccTableLuminairesOrnamentalRef ) < 1 .OR.
             LocalCompAssigned( LumRef[4] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesOrnamental, Format( "%s TailoredOrnamentalRowLuminaires4", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental09_LuminaireName  = {  LumRef[4]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental10_LuminairePower = {  LumRef[4]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesOrnamentalRef4:TailoredOrnamental11_LuminaireCountByType = {  LumCnt[4]  }

   "Create nrcctblRowLuminairesOrnamentalRef5 object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowLuminairesOrnamentalRef5 =
      {  if (LocalCompAssigned( nrccTableLuminairesOrnamentalRef ) < 1 .OR.
             LocalCompAssigned( LumRef[5] ) < 1)
         then  UNDEFINED
         else  CreateComp( nrcctblRowLuminairesOrnamental, Format( "%s TailoredOrnamentalRowLuminaires5", Name ) )
         endif  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:noXMLoutput_IntLtgSysRef"             IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:noXMLoutput_IntLtgSysRef      = {  Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental09_LuminaireName"         IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental09_LuminaireName  = {  LumRef[5]:Name  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental10_LuminairePower"        IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental10_LuminairePower = {  LumRef[5]:Pwr  }
   "Set IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental11_LuminaireCountByType"  IntLtgSys:nrcctblRowLuminairesOrnamentalRef5:TailoredOrnamental11_LuminaireCountByType = {  LumCnt[5]  }

  ; Rule to Delete empty nrccSection_TailoredOrnamental
   "DELETE empty nrccTableTailoredOrnamental object"
      nrccSection_TailoredOrnamental:Action   = {  if (ComponentCount( nrcctblRowTailoredOrnamental ) < 1) then  DeleteComp()  else  UNCHANGED  endif }



   "Create nrccSection_TailoredValuable object"   nrccNRCCPRF:Action =
      {  if (Proj:CompPathLtg == "Performance") 
         then CreateChildren( nrccSection_TailoredValuable, 1, "NRCC TailoredValuable" )
         else UNCHANGED 
         endif }
   "Create nrccSection_TailoredValuable nrccTableTailoredValuable object"              nrccSection_TailoredValuable:Action  =
      {  CreateChildren( nrccTableTailoredValuable, 1, "NRCC TailoredValuable table" )  }
   "Create nrcctblRowTailoredValuable object for each pertinent Space"     Spc:nrcctblRowTailoredValuableRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredValuableRef ) > 0 .OR.
             TMVeryValDispAllow <= 0 ) then  UNDEFINED
         else if (CondgType == "DirectlyConditioned" .OR. CondgType == "IndirectlyConditioned") 
              then CreateComp( nrcctblRowTailoredValuable, Format( "%s TailoredValuable tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set Spc:nrcctblRowTailoredValuableRef:noXMLoutput_SpcRef"    Spc:nrcctblRowTailoredValuableRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrccTableTailoredCaseRef object for each pertinent IntLtgSys"     Spc:nrccTableTailoredCaseRef =
      {  if (LocalCompAssigned( nrcctblRowTailoredValuableRef ) < 1)
         then  UNDEFINED
         else  CreateComp( nrccTableTailoredCase, Format( "%s TableTailoredCase", Name ) )
         endif  }
   "Set Spc:nrccTableTailoredCaseRef:noXMLoutput_SpcRef"    Spc:nrccTableTailoredCaseRef:noXMLoutput_SpcRef = {  Name  }

   "Create nrcctblRowTailoredCaseRef object for each pertinent IntLtgSys"     IntLtgSys:nrcctblRowTailoredCaseRef =
      {  if( ParentComponentType() = "Spc" )
         then if( ParentCompAssigned( Spc:nrccTableTailoredCaseRef ) < 1 .OR.
                  AllowType != "TailoredVeryValuableDisplayCaseAllowance" )
              then  UNDEFINED
              else  CreateComp( nrcctblRowTailoredCase, Format( "%s RowTailoredCase", Name ) ) endif
         else UNDEFINED
         endif  }
   "Set IntLtgSys:nrcctblRowTailoredCaseRef:noXMLoutput_IntLtgSysRef"    IntLtgSys:nrcctblRowTailoredCaseRef:noXMLoutput_IntLtgSysRef = {  Name  }

   "Set nrcctblRowTailoredCase Parent"    IntLtgSys:nrcctblRowTailoredCaseRef:Parent = {  Spc:nrccTableTailoredCaseRef  }

  ; Rule to Delete empty nrccSection_TailoredValuable
   "DELETE empty nrccTableTailoredValuable object"
      nrccSection_TailoredValuable:Action   = {  if (ComponentCount( nrcctblRowTailoredValuable ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


   "Create nrccSection_Nrci object"
      nrccNRCCPRF:Action    = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then UNCHANGED else CreateChildren( nrccSection_Nrci,    1, "Nrci" ) endif  }
  ; Rule to denote empty nrccSection_Nrci:Nrci00_NoRequiredNRCI located in Project-NRCCPRF.rule

   "Create nrccSection_Nrca object"
      nrccNRCCPRF:Action    = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then UNCHANGED else CreateChildren( nrccSection_Nrca,    1, "Nrca" ) endif  }
  ; Rule to denote empty nrccSection_Nrca:Nrca00_NoRequiredNRCA located in Project-NRCCPRF.rule


   "Create nrccSection_Nrcv object"
      nrccNRCCPRF:Action    = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 )) then UNCHANGED else CreateChildren( nrccSection_Nrcv,    1, "Nrcv" ) endif  }
  ; Rule to denote empty nrccSection_Nrcv:Nrcv00_NoRequiredNRCV located in Project-NRCCPRF.rule



   "Create & initialize new nrccDeclarationsBlock object"
      nrccDocumentData:Action  = {  CreateChildren( nrccDeclarationsBlock,       1, "NRCC DeclarationsBlock" ) } ; no init needed

   "Create & initialize new nrcccomp_DocumentAuthorNRCC object"
      nrccDeclarationsBlock:Action  = {  CreateChildren( nrcccomp_DocumentAuthorNRCC,       1, "NRCC DocumentAuthorNRCC",     "NRCCPRF_Init_nrccDocumentAuthorNRCC" )  }

   "Create & initialize new nrcccomp_ResponsiblePersonNRCCPRF object"
      nrccDeclarationsBlock:Action  = {  CreateChildren( nrcccomp_ResponsiblePersonNRCCPRF,       1, "NRCC ResponsiblePersonNRCCPRF" ) } ; no init needed

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName01) > 0 .AND. Proj:RespDsgnrName01 != " - specify - " .AND. Proj:RespDsgnrName01 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany01) > 0 .AND. Proj:RespDsgnrCompany01 != " - specify - " .AND. Proj:RespDsgnrCompany01 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner01" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName02) > 0 .AND. Proj:RespDsgnrName02 != " - specify - " .AND. Proj:RespDsgnrName02 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany02) > 0 .AND. Proj:RespDsgnrCompany02 != " - specify - " .AND. Proj:RespDsgnrCompany02 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner02" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName03) > 0 .AND. Proj:RespDsgnrName03 != " - specify - " .AND. Proj:RespDsgnrName03 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany03) > 0 .AND. Proj:RespDsgnrCompany03 != " - specify - " .AND. Proj:RespDsgnrCompany03 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner03" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName04) > 0 .AND. Proj:RespDsgnrName04 != " - specify - " .AND. Proj:RespDsgnrName04 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany04) > 0 .AND. Proj:RespDsgnrCompany04 != " - specify - " .AND. Proj:RespDsgnrCompany04 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner04" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName05) > 0 .AND. Proj:RespDsgnrName05 != " - specify - " .AND. Proj:RespDsgnrName05 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany05) > 0 .AND. Proj:RespDsgnrCompany05 != " - specify - " .AND. Proj:RespDsgnrCompany05 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner05" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName06) > 0 .AND. Proj:RespDsgnrName06 != " - specify - " .AND. Proj:RespDsgnrName06 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany06) > 0 .AND. Proj:RespDsgnrCompany06 != " - specify - " .AND. Proj:RespDsgnrCompany06 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner06" )
                                                     else UNCHANGED
                                                     endif  }

   "Create & initialize new nrcccomp_ResponsiblePersonDesigner object"
      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  if ((GlobalStatus(Proj:RespDsgnrName07) > 0 .AND. Proj:RespDsgnrName07 != " - specify - " .AND. Proj:RespDsgnrName07 != "- specify -") 
                                                         .OR. (GlobalStatus(Proj:RespDsgnrCompany07) > 0 .AND. Proj:RespDsgnrCompany07 != " - specify - " .AND. Proj:RespDsgnrCompany07 != "- specify -")) 
                                                     then CreateChildren( nrcccomp_ResponsiblePersonDesigner,       1, "NRCC ResponsiblePersonDesigner",     "NRCCPRF_Init_nrccResponsiblePersonDesigner07" )
                                                     else UNCHANGED
                                                     endif  }

;   "Create & initialize new nrcccomp_ResponsiblePersonEnvelopeDesigner object"
;      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  CreateChildren( nrcccomp_ResponsiblePersonEnvelopeDesigner,       1, "NRCC ResponsiblePersonEnvelopeDesigner",     "NRCCPRF_Init_nrccResponsiblePersonEnvelopeDesigner" )  }

;   "Create & initialize new nrcccomp_ResponsiblePersonLightingDesigner object"
;      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  CreateChildren( nrcccomp_ResponsiblePersonLightingDesigner,       1, "NRCC ResponsiblePersonLightingDesigner",     "NRCCPRF_Init_nrccResponsiblePersonLightingDesigner" )  }

;   "Create & initialize new nrcccomp_ResponsiblePersonMechanicalDesigner object"
;      nrcccomp_ResponsiblePersonNRCCPRF:Action  = {  CreateChildren( nrcccomp_ResponsiblePersonMechanicalDesigner,       1, "NRCC ResponsiblePersonMechanicalDesigner",     "NRCCPRF_Init_nrccResponsiblePersonMechanicalDesigner" )  }

   "Create & initialize new nrccFooter object"
      nrccDocumentData:Action  = {  CreateChildren( nrccFooter,       1, "NRCC Footer",     "NRCCPRF_Init_nrccFooter" )  }

END


;************************************************************************* rulelist evaluated AFTER Proposed simulation but before copying of nrcc* objects to following transform - SAC 04/14/21
RULELIST "NRCCPRF_ap_PostSim"  1 0 0 1

; moved from above due to requirement of having access to Proposed simulation results - SAC 04/14/21
   "Create nrcctblRowUMLH object for each pertinent ThrmlZn"     ThrmlZn:nrcctblRowUMLHRef =
      {  if (LocalCompAssigned( nrcctblRowUMLHRef ) > 0 .OR.
             ComponentCount( nrccTableUMLH ) < 1 .OR.
             (IfValidAnd( ClgUnmetLdHrs <= ClgUMLHLimit ) .AND.
              IfValidAnd( HtgUnmetLdHrs <= HtgUMLHLimit )) ) 
         then UNDEFINED
         else if ( (IfValidAnd( ClgUnmetLdHrs > ClgUMLHLimit + 0.1 ) .AND. IfValidAnd( BypassClgUMLHLimit = 0 )) .OR.
                   (IfValidAnd( HtgUnmetLdHrs > HtgUMLHLimit + 0.1 ) .AND. IfValidAnd( BypassHtgUMLHLimit = 0 )) )
              then CreateComp( nrcctblRowUMLH, Format( "%s UMLH tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set ThrmlZn:nrcctblRowUMLHRef:noXMLoutput_ThrmlZnRef"      ThrmlZn:nrcctblRowUMLHRef:noXMLoutput_ThrmlZnRef   = {  Name  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Parent"                      ThrmlZn:nrcctblRowUMLHRef:Parent                   = {  nrccTableUMLH:Name  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Result4_01_ThermalZoneName"              ThrmlZn:nrcctblRowUMLHRef:Result4_01_ThermalZoneName           = {  Name  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Result4_02_ZoneUnmetCoolingLoadHours"    ThrmlZn:nrcctblRowUMLHRef:Result4_02_ZoneUnmetCoolingLoadHours = {  ClgUMLHLimit  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Result4_03_UnmetCoolingLoadHours"        ThrmlZn:nrcctblRowUMLHRef:Result4_03_UnmetCoolingLoadHours     = {  ClgUnmetLdHrs  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Result4_04_ZoneUnmetHeatingLoadHours"    ThrmlZn:nrcctblRowUMLHRef:Result4_04_ZoneUnmetHeatingLoadHours = {  HtgUMLHLimit  }
   "Set ThrmlZn:nrcctblRowUMLHRef:Result4_05_UnmetHeatingLoadHours"        ThrmlZn:nrcctblRowUMLHRef:Result4_05_UnmetHeatingLoadHours     = {  HtgUnmetLdHrs  }

  ; Rule to Delete empty nrccSection_Result4
   "DELETE empty nrccTableUMLH object"
      nrccSection_Result4:Action   = {  if (ComponentCount( nrcctblRowUMLH ) < 1) then  DeleteComp()  else  UNCHANGED  endif }

   "Create nrcctblRowUMLHC22 object for each pertinent ThrmlZn"     ThrmlZn:nrcctblRowUMLHC22Ref =
      {  if (LocalCompAssigned( nrcctblRowUMLHC22Ref ) > 0 .OR.
             ComponentCount( nrccTableUMLHC22 ) < 1 .OR.
             (IfValidAnd( ClgUnmetLdHrs <= ClgUMLHLimit ) .AND.
              IfValidAnd( HtgUnmetLdHrs <= HtgUMLHLimit )) ) 
         then UNDEFINED
         else if ( (IfValidAnd( ClgUnmetLdHrs > ClgUMLHLimit + 0.1 ) .AND. IfValidAnd( BypassClgUMLHLimit = 0 )) .OR.
                   (IfValidAnd( HtgUnmetLdHrs > HtgUMLHLimit + 0.1 ) .AND. IfValidAnd( BypassHtgUMLHLimit = 0 )) )
              then CreateComp( nrcctblRowUMLHC22, Format( "%s UMLHC22 tblRow", Name ) )
              else UNDEFINED
              endif
         endif  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:noXMLoutput_ThrmlZnRef"      ThrmlZn:nrcctblRowUMLHC22Ref:noXMLoutput_ThrmlZnRef   = {  Name  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:Parent"                      ThrmlZn:nrcctblRowUMLHC22Ref:Parent                   = {  nrccTableUMLHC22:Name  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_01_ThermalZoneName"              ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_01_ThermalZoneName           = {  Name  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_02_ZoneUnmetCoolingLoadHours"    ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_02_ZoneUnmetCoolingLoadHours = {  ClgUMLHLimit  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_03_UnmetCoolingLoadHours"        ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_03_UnmetCoolingLoadHours     = {  ClgUnmetLdHrs  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_04_ZoneUnmetHeatingLoadHours"    ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_04_ZoneUnmetHeatingLoadHours = {  HtgUMLHLimit  }
   "Set ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_05_UnmetHeatingLoadHours"        ThrmlZn:nrcctblRowUMLHC22Ref:C22Result9_05_UnmetHeatingLoadHours     = {  HtgUnmetLdHrs  }

  ; Rule to Delete empty nrccSection_C22Result9
   "DELETE empty nrccTableUMLHC22 object"
      nrccSection_C22Result9:Action   = {  if (ComponentCount( nrcctblRowUMLHC22 ) < 1) then  DeleteComp()  else  UNCHANGED  endif }


  ; Rule to Delete empty nrccSection_Except
   ; DISABLED rules to delete empty Section_Except - needed for reporting hard-wired exception that reporting is not fully functional for 2022.1.0
   "Set nrccSection_Except:noXMLoutput_DeleteFlag"      nrccSection_Except:noXMLoutput_DeleteFlag   =
      {  if (Proj:AnalysisVersion >= 220100 .AND. Proj:AnalysisVersion <= 220101)   ; always include exception section for 2022.1.0
         then  0  else  1  endif }
   "Set nrccSection_Except:noXMLoutput_DeleteFlag"      for:#S=(1to40)   nrccSection_Except:noXMLoutput_DeleteFlag   = {  if (LocalStatus(Except01_ExceptionalConditionMessageCCPRFE[#S]) > 0) then 0 else UNCHANGED endif }
   "DELETE empty nrccSection_Except object"
      nrccSection_Except:Action   = {  if (noXMLoutput_DeleteFlag > 0) then  DeleteComp()  else  UNCHANGED  endif }

  ; Rule to Delete empty nrccSection_HERS
   "Set nrccSection_HERS:noXMLoutput_DeleteFlag"      nrccSection_HERS:noXMLoutput_DeleteFlag   = { 1 }
   "Set nrccSection_HERS:noXMLoutput_DeleteFlag"      for:#S=(1to10)   nrccSection_HERS:noXMLoutput_DeleteFlag   = {  if (LocalStatus(HERS_01_HERS_VerificationMeasure[#S]) > 0) then 0 else UNCHANGED endif }
   "DELETE empty nrccSection_HERS object"
      nrccSection_HERS:Action   = {  if (noXMLoutput_DeleteFlag > 0) then  DeleteComp()  else  UNCHANGED  endif }

  ; Rule to Delete empty nrccHvacSpec04 and set nrccHvacSpec04Choice:HvacSpec04_NotApplicableMessage
   "Set nrccHvacSpec04:noXMLoutput_DeleteFlag"      nrccHvacSpec04:noXMLoutput_DeleteFlag   = { 1 }
   "Set nrccHvacSpec04:noXMLoutput_DeleteFlag"      for:#S=(1to8)   nrccHvacSpec04:noXMLoutput_DeleteFlag   = {  if (LocalStatus(HvacSpec04_HvacControls[#S]) > 0) then 0 else UNCHANGED endif }
   "Set nrccHvacSpec04:noXMLoutput_DeleteFlag"      for:#S=(1to8)   nrccHvacSpec04:noXMLoutput_DeleteFlag   = {  if (LocalStatus(HvacSpec04_EconomizerControlMethod[#S]) > 0) then 0 else UNCHANGED endif }
   "Set nrccHvacSpec04:noXMLoutput_DeleteFlag"      for:#S=(1to8)   nrccHvacSpec04:noXMLoutput_DeleteFlag   = {  if (LocalStatus(HvacSpec04_EvaporativeCoolerType[#S]) > 0) then 0 else UNCHANGED endif }
   "DELETE empty nrccHvacSpec04 object"
      nrccHvacSpec04:Action   = {  if (noXMLoutput_DeleteFlag > 0) then  DeleteComp()  else  UNCHANGED  endif }
   "Set nrccHvacSpec04Choice:HvacSpec04_NotApplicableMessage"      nrccHvacSpec04Choice:HvacSpec04_NotApplicableMessage   = {  if (ChildCount( nrccHvacSpec04 ) < 1) then "NotApplicable" else UNDEFINED endif }
END



;*************************************************************************
RULELIST "NRCCPRF_Init_nrccComplianceDocumentPackage"  1 0 0 1
   "Set nrccComplianceDocumentPackage:attrib_xmlns"               nrccComplianceDocumentPackage:attrib_xmlns              = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                                                                               then "http://www.lmonte.com/besm/LMCCPRF01E"
                                                                                                                               else "http://www.lmonte.com/besm/NRCCPRF01E"
                                                                                                                               endif }
   "Set nrccComplianceDocumentPackage:attrib_xmlns_lit"           nrccComplianceDocumentPackage:attrib_xmlns_lit          = {  "http://www.lmonte.com/besm/lit"  }            
   "Set nrccComplianceDocumentPackage:attrib_xmlns_com"           nrccComplianceDocumentPackage:attrib_xmlns_com          = {  "http://www.lmonte.com/besm/com"  }            
   "Set nrccComplianceDocumentPackage:attrib_xmlns_dtyp"          nrccComplianceDocumentPackage:attrib_xmlns_dtyp         = {  "http://www.lmonte.com/besm/dtyp"  }           
   "Set nrccComplianceDocumentPackage:attrib_xmlns_bld"           nrccComplianceDocumentPackage:attrib_xmlns_bld          = {  "http://www.lmonte.com/besm/bld"  }            
   "Set nrccComplianceDocumentPackage:attrib_xmlns_env"           nrccComplianceDocumentPackage:attrib_xmlns_env          = {  "http://www.lmonte.com/besm/env"  }            
   "Set nrccComplianceDocumentPackage:attrib_xmlns_hvac"          nrccComplianceDocumentPackage:attrib_xmlns_hvac         = {  "http://www.lmonte.com/besm/hvac"  }           
   "Set nrccComplianceDocumentPackage:attrib_xmlns_comp"          nrccComplianceDocumentPackage:attrib_xmlns_comp         = {  "http://www.lmonte.com/besm/comp"  }           
   "Set nrccComplianceDocumentPackage:attrib_xmlns_d"             nrccComplianceDocumentPackage:attrib_xmlns_d            = {  "http://www.lmonte.com/besm/d"  }              
   "Set nrccComplianceDocumentPackage:attrib_xmlns_altova"        nrccComplianceDocumentPackage:attrib_xmlns_altova       = {  "http://www.altova.com/xml-schema-extensions"  }
   "Set nrccComplianceDocumentPackage:attrib_xmlns_xsi"           nrccComplianceDocumentPackage:attrib_xmlns_xsi          = {  "http://www.w3.org/2001/XMLSchema-instance"  } 
   "Set nrccComplianceDocumentPackage:attrib_xsi_schemaLocation"  nrccComplianceDocumentPackage:attrib_xsi_schemaLocation = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                                                                               then "http://www.lmonte.com/besm/LMCCPRF01E.xsd"
                                                                                                                               else "http://www.lmonte.com/besm/NRCCPRF.xsd"
                                                                                                                               endif }
   "Set nrccComplianceDocumentPackage:attrib_revision"            nrccComplianceDocumentPackage:attrib_revision           = {  "rev 20220601"  } 
   "Set nrccComplianceDocumentPackage:attrib_doc"                 nrccComplianceDocumentPackage:attrib_doc                = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                                                                               then "LMCCPRF01E"
                                                                                                                               else "NRCCPRFE"
                                                                                                                               endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccDocID"  1 0 0 1
   "Set nrccDocID:attrib_doc"          nrccDocID:attrib_doc      = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                      then "LMCCPRF01E"
                                                                      else "NRCCPRFE"
                                                                      endif }
   "Set nrccDocID:attrib_docType"      nrccDocID:attrib_docType  = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                      then "CERTIFICATE OF COMPLIANCE -  LOWRISE MULTIFAMILY MIXED USE PERFORMANCE COMPLIANCE METHOD"
                                                                      else "CertificateComplianceNonResPerformance"
                                                                      endif }
   "Set nrccDocID:attrib_docTitle"     nrccDocID:attrib_docTitle = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                      then "LMCC Performance Compliance"
                                                                      else "NonResidentialPerformanceCompliance"
                                                                      endif }
   END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccPayload"  1 0 0 1
   "Set nrccPayload:attrib_complianceDocumentGUID"             nrccPayload:attrib_complianceDocumentGUID           = {  "complianceDocumentGUID1"  }
   "Set nrccPayload:attrib_complianceDocumentSchemaVersion"    nrccPayload:attrib_complianceDocumentSchemaVersion  = {  "complianceDocumentSchemaVersion1"  }
   "Set nrccPayload:attrib_compMgrVersion"                     nrccPayload:attrib_compMgrVersion                   = {  ValidOr( Proj:CompManagerVersion, "Unknown" )  }
   "Set nrccPayload:attrib_displayTagNR"                       nrccPayload:attrib_displayTagNR                     = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                                                                        then "LMCC-PRF-01-E"
                                                                                                                        else "NRCC-PRF-E"
                                                                                                                        endif }
   "Set nrccPayload:attrib_payloadDocumentNR"                  nrccPayload:attrib_payloadDocumentNR                = {  if (IfValidAnd(Proj:IsLowRiseMFam > 0 ))
                                                                                                                        then "LMCCPRF01E"
                                                                                                                        else "NRCCPRFE"
                                                                                                                        endif }
   "Set nrccPayload:attrib_processedDate"                      nrccPayload:attrib_processedDate                    = {  ValidOr( Proj:RunDateISO, "2006-05-04T18:13:51.0" )  }
   "Set nrccPayload:attrib_projectID"                          nrccPayload:attrib_projectID                        = {  ValidOr( Proj:RptComplianceID, " " )  }    ; SAC 12/13/22
   "Set nrccPayload:attrib_reportRequestor"                    nrccPayload:attrib_reportRequestor                  = {  "reportRequestor1"  }
   "Set nrccPayload:attrib_reportRequestorIP_Address"          nrccPayload:attrib_reportRequestorIP_Address        = {  "reportRequestorIP_Address1"  }
   "Set nrccPayload:attrib_revision"                           nrccPayload:attrib_revision                         = {  "revision3"  }
   "Set nrccPayload:attrib_validates"                          nrccPayload:attrib_validates                        = {  "false"  }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccHeader"  1 0 0 1
   "Set nrccHeader:comp_header01_ProjectName"      nrccHeader:comp_header01_ProjectName     = {  if (GlobalStatus( Proj:Name ) > 0) then  Proj:Name  else  UNDEFINED  endif  }
   "Set nrccHeader:comp_header02_RunDateTime"      nrccHeader:comp_header02_RunDateTime     = {  if (GlobalStatus( Proj:RunDateISO ) > 0) then  Proj:RunDateISO  else  UNDEFINED  endif  }
   "Set nrccHeader:comp_header04_InputFilename"    nrccHeader:comp_header04_InputFilename   = {  if (GlobalStatus( Proj:ProjFileName ) > 0) then  Proj:ProjFileName  else  UNDEFINED  endif  }
   "Set nrccHeader:comp_streetAddress"             nrccHeader:comp_streetAddress            = {  if (GlobalStatus( Proj:StreetAddress ) > 0) then  Proj:StreetAddress  else  UNDEFINED  endif  }
;   "Set nrccHeader:comp_header05_ProjectCity"           nrccHeader:comp_header05_ProjectCity           = {  Proj:City  }
;   "Set nrccHeader:comp_header06_ProjectZipcode"        nrccHeader:comp_header06_ProjectZipcode        = {  Proj:ZipCode  }
;   "Set nrccHeader:comp_header07_DatePreparedNRPres"    nrccHeader:comp_header07_DatePreparedNRPres    = {  Proj:RunDateISO  }
;   "Set nrccHeader:comp_header03_RunDescription"   nrccHeader:comp_header03_RunDescription  = {  if (GlobalStatus( Proj:RunTitle     ) > 0) then  Proj:RunTitle      else  UNDEFINED  endif  }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccDocumentAuthorNRCC"  1 0 0 1
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor01Name" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor01Name = { 
        if (GlobalStatus(Proj:DocAuthName) > 0) 
        then if (Proj:DocAuthName != " - specify - ") then Proj:DocAuthName else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor03Company" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor03Company = { 
        if (GlobalStatus(Proj:DocAuthCompany) > 0) 
        then if (Proj:DocAuthCompany != " - specify - ") then Proj:DocAuthCompany else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor05Address" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor05Address = { 
        if (GlobalStatus(Proj:DocAuthAddress) > 0) 
        then if (Proj:DocAuthAddress != " - specify - ") then Proj:DocAuthAddress else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor06Certification" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor06Certification = { 
        if (GlobalStatus(Proj:DocAuthCEAIdent) > 0) 
        then if (Proj:DocAuthCEAIdent != " - specify - ") then Proj:DocAuthCEAIdent else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor07CityDA" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor07CityDA = { 
        if (GlobalStatus(Proj:DocAuthCity) > 0) 
        then if (Proj:DocAuthCity != " - specify - ") then Proj:DocAuthCity else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor08State" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor08State = { 
        if (GlobalStatus(Proj:DocAuthState) > 0) 
        then if (Proj:DocAuthState != " - specify - ") then Proj:DocAuthState else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor09Zipcode" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor09Zipcode = { 
        if (GlobalStatus(Proj:DocAuthZipCode) > 0) 
        then if (Proj:DocAuthZipCode != " - specify - ") then Proj:DocAuthZipCode else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcccomp_DocumentAuthorNRCC:comp_documentAuthor10Phone" nrcccomp_DocumentAuthorNRCC:comp_documentAuthor10Phone = { 
        if (GlobalStatus(Proj:DocAuthPhone) > 0) 
        then if (Proj:DocAuthPhone != " - specify - ") then Proj:DocAuthPhone else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner01"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName01) > 0) 
        then if (Proj:RespDsgnrName01 != " - specify - " .AND. Proj:RespDsgnrName01 != "- specify -") then Proj:RespDsgnrName01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope01) > 0) 
        then if (Proj:RespDsgnrScope01 != " - specify - " .AND. Proj:RespDsgnrScope01 != "- specify -") then Proj:RespDsgnrScope01 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany01) > 0) 
        then if (Proj:RespDsgnrCompany01 != " - specify - " .AND. Proj:RespDsgnrCompany01 != "- specify -") then Proj:RespDsgnrCompany01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress01) > 0) 
        then if (Proj:RespDsgnrAddress01 != " - specify - " .AND. Proj:RespDsgnrAddress01 != "- specify -") then Proj:RespDsgnrAddress01 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity01) > 0) 
        then if (Proj:RespDsgnrCity01 != " - specify - " .AND. Proj:RespDsgnrCity01 != "- specify -") then Proj:RespDsgnrCity01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState01) > 0) 
        then if (Proj:RespDsgnrState01 != " - specify - " .AND. Proj:RespDsgnrState01 != "- specify -") then Proj:RespDsgnrState01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode01) > 0) 
        then if (Proj:RespDsgnrZipCode01 != " - specify - " .AND. Proj:RespDsgnrZipCode01 != "- specify -") then Proj:RespDsgnrZipCode01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone01) > 0) 
        then if (Proj:RespDsgnrPhone01 != " - specify - " .AND. Proj:RespDsgnrPhone01 != "- specify -") then Proj:RespDsgnrPhone01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType01) > 0) 
        then if (Proj:RespDsgnrType01 != " - specify - " .AND. Proj:RespDsgnrType01 != "- specify -") then Proj:RespDsgnrType01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense01) > 0) 
        then if (Proj:RespDsgnrLicense01 != " - specify - " .AND. Proj:RespDsgnrLicense01 != "- specify -") then Proj:RespDsgnrLicense01 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner02"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName02) > 0) 
        then if (Proj:RespDsgnrName02 != " - specify - " .AND. Proj:RespDsgnrName02 != "- specify -") then Proj:RespDsgnrName02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope02) > 0) 
        then if (Proj:RespDsgnrScope02 != " - specify - " .AND. Proj:RespDsgnrScope02 != "- specify -") then Proj:RespDsgnrScope02 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany02) > 0) 
        then if (Proj:RespDsgnrCompany02 != " - specify - " .AND. Proj:RespDsgnrCompany02 != "- specify -") then Proj:RespDsgnrCompany02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress02) > 0) 
        then if (Proj:RespDsgnrAddress02 != " - specify - " .AND. Proj:RespDsgnrAddress02 != "- specify -") then Proj:RespDsgnrAddress02 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity02) > 0) 
        then if (Proj:RespDsgnrCity02 != " - specify - " .AND. Proj:RespDsgnrCity02 != "- specify -") then Proj:RespDsgnrCity02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState02) > 0) 
        then if (Proj:RespDsgnrState02 != " - specify - " .AND. Proj:RespDsgnrState02 != "- specify -") then Proj:RespDsgnrState02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode02) > 0) 
        then if (Proj:RespDsgnrZipCode02 != " - specify - " .AND. Proj:RespDsgnrZipCode02 != "- specify -") then Proj:RespDsgnrZipCode02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone02) > 0) 
        then if (Proj:RespDsgnrPhone02 != " - specify - " .AND. Proj:RespDsgnrPhone02 != "- specify -") then Proj:RespDsgnrPhone02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType02) > 0) 
        then if (Proj:RespDsgnrType02 != " - specify - " .AND. Proj:RespDsgnrType02 != "- specify -") then Proj:RespDsgnrType02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense02) > 0) 
        then if (Proj:RespDsgnrLicense02 != " - specify - " .AND. Proj:RespDsgnrLicense02 != "- specify -") then Proj:RespDsgnrLicense02 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner03"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName03) > 0) 
        then if (Proj:RespDsgnrName03 != " - specify - " .AND. Proj:RespDsgnrName03 != "- specify -") then Proj:RespDsgnrName03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope03) > 0) 
        then if (Proj:RespDsgnrScope03 != " - specify - " .AND. Proj:RespDsgnrScope03 != "- specify -") then Proj:RespDsgnrScope03 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany03) > 0) 
        then if (Proj:RespDsgnrCompany03 != " - specify - " .AND. Proj:RespDsgnrCompany03 != "- specify -") then Proj:RespDsgnrCompany03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress03) > 0) 
        then if (Proj:RespDsgnrAddress03 != " - specify - " .AND. Proj:RespDsgnrAddress03 != "- specify -") then Proj:RespDsgnrAddress03 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity03) > 0) 
        then if (Proj:RespDsgnrCity03 != " - specify - " .AND. Proj:RespDsgnrCity03 != "- specify -") then Proj:RespDsgnrCity03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState03) > 0) 
        then if (Proj:RespDsgnrState03 != " - specify - " .AND. Proj:RespDsgnrState03 != "- specify -") then Proj:RespDsgnrState03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode03) > 0) 
        then if (Proj:RespDsgnrZipCode03 != " - specify - " .AND. Proj:RespDsgnrZipCode03 != "- specify -") then Proj:RespDsgnrZipCode03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone03) > 0) 
        then if (Proj:RespDsgnrPhone03 != " - specify - " .AND. Proj:RespDsgnrPhone03 != "- specify -") then Proj:RespDsgnrPhone03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType03) > 0) 
        then if (Proj:RespDsgnrType03 != " - specify - " .AND. Proj:RespDsgnrType03 != "- specify -") then Proj:RespDsgnrType03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense03) > 0) 
        then if (Proj:RespDsgnrLicense03 != " - specify - " .AND. Proj:RespDsgnrLicense03 != "- specify -") then Proj:RespDsgnrLicense03 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner04"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName04) > 0) 
        then if (Proj:RespDsgnrName04 != " - specify - " .AND. Proj:RespDsgnrName04 != "- specify -") then Proj:RespDsgnrName04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope04) > 0) 
        then if (Proj:RespDsgnrScope04 != " - specify - " .AND. Proj:RespDsgnrScope04 != "- specify -") then Proj:RespDsgnrScope04 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany04) > 0) 
        then if (Proj:RespDsgnrCompany04 != " - specify - " .AND. Proj:RespDsgnrCompany04 != "- specify -") then Proj:RespDsgnrCompany04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress04) > 0) 
        then if (Proj:RespDsgnrAddress04 != " - specify - " .AND. Proj:RespDsgnrAddress04 != "- specify -") then Proj:RespDsgnrAddress04 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity04) > 0) 
        then if (Proj:RespDsgnrCity04 != " - specify - " .AND. Proj:RespDsgnrCity04 != "- specify -") then Proj:RespDsgnrCity04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState04) > 0) 
        then if (Proj:RespDsgnrState04 != " - specify - " .AND. Proj:RespDsgnrState04 != "- specify -") then Proj:RespDsgnrState04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode04) > 0) 
        then if (Proj:RespDsgnrZipCode04 != " - specify - " .AND. Proj:RespDsgnrZipCode04 != "- specify -") then Proj:RespDsgnrZipCode04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone04) > 0) 
        then if (Proj:RespDsgnrPhone04 != " - specify - " .AND. Proj:RespDsgnrPhone04 != "- specify -") then Proj:RespDsgnrPhone04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType04) > 0) 
        then if (Proj:RespDsgnrType04 != " - specify - " .AND. Proj:RespDsgnrType04 != "- specify -") then Proj:RespDsgnrType04 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense04) > 0) 
        then if (Proj:RespDsgnrLicense04 != " - specify - " .AND. Proj:RespDsgnrLicense04 != "- specify -") then Proj:RespDsgnrLicense04 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner05"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName05) > 0) 
        then if (Proj:RespDsgnrName05 != " - specify - " .AND. Proj:RespDsgnrName05 != "- specify -") then Proj:RespDsgnrName05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope05) > 0) 
        then if (Proj:RespDsgnrScope05 != " - specify - " .AND. Proj:RespDsgnrScope05 != "- specify -") then Proj:RespDsgnrScope05 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany05) > 0) 
        then if (Proj:RespDsgnrCompany05 != " - specify - " .AND. Proj:RespDsgnrCompany05 != "- specify -") then Proj:RespDsgnrCompany05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress05) > 0) 
        then if (Proj:RespDsgnrAddress05 != " - specify - " .AND. Proj:RespDsgnrAddress05 != "- specify -") then Proj:RespDsgnrAddress05 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity05) > 0) 
        then if (Proj:RespDsgnrCity05 != " - specify - " .AND. Proj:RespDsgnrCity05 != "- specify -") then Proj:RespDsgnrCity05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState05) > 0) 
        then if (Proj:RespDsgnrState05 != " - specify - " .AND. Proj:RespDsgnrState05 != "- specify -") then Proj:RespDsgnrState05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode05) > 0) 
        then if (Proj:RespDsgnrZipCode05 != " - specify - " .AND. Proj:RespDsgnrZipCode05 != "- specify -") then Proj:RespDsgnrZipCode05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone05) > 0) 
        then if (Proj:RespDsgnrPhone05 != " - specify - " .AND. Proj:RespDsgnrPhone05 != "- specify -") then Proj:RespDsgnrPhone05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType05) > 0) 
        then if (Proj:RespDsgnrType05 != " - specify - " .AND. Proj:RespDsgnrType05 != "- specify -") then Proj:RespDsgnrType05 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense05) > 0) 
        then if (Proj:RespDsgnrLicense05 != " - specify - " .AND. Proj:RespDsgnrLicense05 != "- specify -") then Proj:RespDsgnrLicense05 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner06"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName06) > 0) 
        then if (Proj:RespDsgnrName06 != " - specify - " .AND. Proj:RespDsgnrName06 != "- specify -") then Proj:RespDsgnrName06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope06) > 0) 
        then if (Proj:RespDsgnrScope06 != " - specify - " .AND. Proj:RespDsgnrScope06 != "- specify -") then Proj:RespDsgnrScope06 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany06) > 0) 
        then if (Proj:RespDsgnrCompany06 != " - specify - " .AND. Proj:RespDsgnrCompany06 != "- specify -") then Proj:RespDsgnrCompany06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress06) > 0) 
        then if (Proj:RespDsgnrAddress06 != " - specify - " .AND. Proj:RespDsgnrAddress06 != "- specify -") then Proj:RespDsgnrAddress06 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity06) > 0) 
        then if (Proj:RespDsgnrCity06 != " - specify - " .AND. Proj:RespDsgnrCity06 != "- specify -") then Proj:RespDsgnrCity06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState06) > 0) 
        then if (Proj:RespDsgnrState06 != " - specify - " .AND. Proj:RespDsgnrState06 != "- specify -") then Proj:RespDsgnrState06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode06) > 0) 
        then if (Proj:RespDsgnrZipCode06 != " - specify - " .AND. Proj:RespDsgnrZipCode06 != "- specify -") then Proj:RespDsgnrZipCode06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone06) > 0) 
        then if (Proj:RespDsgnrPhone06 != " - specify - " .AND. Proj:RespDsgnrPhone06 != "- specify -") then Proj:RespDsgnrPhone06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType06) > 0) 
        then if (Proj:RespDsgnrType06 != " - specify - " .AND. Proj:RespDsgnrType06 != "- specify -") then Proj:RespDsgnrType06 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense06) > 0) 
        then if (Proj:RespDsgnrLicense06 != " - specify - " .AND. Proj:RespDsgnrLicense06 != "- specify -") then Proj:RespDsgnrLicense06 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonDesigner07"  1 0 0 1
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_NameNRCC = { 
        if (GlobalStatus(Proj:RespDsgnrName07) > 0) 
        then if (Proj:RespDsgnrName07 != " - specify - " .AND. Proj:RespDsgnrName07 != "- specify -") then Proj:RespDsgnrName07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC" nrcccomp_ResponsiblePersonDesigner:comp_responsibleDesigner01_ScopeCC = { 
        if (GlobalStatus(Proj:RespDsgnrScope07) > 0) 
        then if (Proj:RespDsgnrScope07 != " - specify - " .AND. Proj:RespDsgnrScope07 != "- specify -") then Proj:RespDsgnrScope07 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany07) > 0) 
        then if (Proj:RespDsgnrCompany07 != " - specify - " .AND. Proj:RespDsgnrCompany07 != "- specify -") then Proj:RespDsgnrCompany07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress07) > 0) 
        then if (Proj:RespDsgnrAddress07 != " - specify - " .AND. Proj:RespDsgnrAddress07 != "- specify -") then Proj:RespDsgnrAddress07 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity07) > 0) 
        then if (Proj:RespDsgnrCity07 != " - specify - " .AND. Proj:RespDsgnrCity07 != "- specify -") then Proj:RespDsgnrCity07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState07) > 0) 
        then if (Proj:RespDsgnrState07 != " - specify - " .AND. Proj:RespDsgnrState07 != "- specify -") then Proj:RespDsgnrState07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode07) > 0) 
        then if (Proj:RespDsgnrZipCode07 != " - specify - " .AND. Proj:RespDsgnrZipCode07 != "- specify -") then Proj:RespDsgnrZipCode07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone07) > 0) 
        then if (Proj:RespDsgnrPhone07 != " - specify - " .AND. Proj:RespDsgnrPhone07 != "- specify -") then Proj:RespDsgnrPhone07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType07) > 0) 
        then if (Proj:RespDsgnrType07 != " - specify - " .AND. Proj:RespDsgnrType07 != "- specify -") then Proj:RespDsgnrType07 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense07) > 0) 
        then if (Proj:RespDsgnrLicense07 != " - specify - " .AND. Proj:RespDsgnrLicense07 != "- specify -") then Proj:RespDsgnrLicense07 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonEnvelopeDesigner"  1 0 0 1
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsibleEnvelopeDesigner01_Name" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsibleEnvelopeDesigner01_Name = { 
        if (GlobalStatus(Proj:RespDsgnrName01) > 0) 
        then if (Proj:RespDsgnrName01 != " - specify - " .AND. Proj:RespDsgnrName01 != "- specify -") then Proj:RespDsgnrName01 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany01) > 0) 
        then if (Proj:RespDsgnrCompany01 != " - specify - " .AND. Proj:RespDsgnrCompany01 != "- specify -") then Proj:RespDsgnrCompany01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress01) > 0) 
        then if (Proj:RespDsgnrAddress01 != " - specify - " .AND. Proj:RespDsgnrAddress01 != "- specify -") then Proj:RespDsgnrAddress01 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity01) > 0) 
        then if (Proj:RespDsgnrCity01 != " - specify - " .AND. Proj:RespDsgnrCity01 != "- specify -") then Proj:RespDsgnrCity01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState01) > 0) 
        then if (Proj:RespDsgnrState01 != " - specify - " .AND. Proj:RespDsgnrState01 != "- specify -") then Proj:RespDsgnrState01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode01) > 0) 
        then if (Proj:RespDsgnrZipCode01 != " - specify - " .AND. Proj:RespDsgnrZipCode01 != "- specify -") then Proj:RespDsgnrZipCode01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone01) > 0) 
        then if (Proj:RespDsgnrPhone01 != " - specify - " .AND. Proj:RespDsgnrPhone01 != "- specify -") then Proj:RespDsgnrPhone01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType01) > 0) 
        then if (Proj:RespDsgnrType01 != " - specify - " .AND. Proj:RespDsgnrType01 != "- specify -") then Proj:RespDsgnrType01 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonEnvelopeDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonEnvelopeDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense01) > 0) 
        then if (Proj:RespDsgnrLicense01 != " - specify - " .AND. Proj:RespDsgnrLicense01 != "- specify -") then Proj:RespDsgnrLicense01 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonLightingDesigner"  1 0 0 1
   "Set nrcResponsiblePersonLightingDesigner:comp_responsibleLightingDesigner01_Name" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsibleLightingDesigner01_Name = { 
        if (GlobalStatus(Proj:RespDsgnrName02) > 0) 
        then if (Proj:RespDsgnrName02 != " - specify - " .AND. Proj:RespDsgnrName02 != "- specify -") then Proj:RespDsgnrName02 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany02) > 0) 
        then if (Proj:RespDsgnrCompany02 != " - specify - " .AND. Proj:RespDsgnrCompany02 != "- specify -") then Proj:RespDsgnrCompany02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress02) > 0) 
        then if (Proj:RespDsgnrAddress02 != " - specify - " .AND. Proj:RespDsgnrAddress02 != "- specify -") then Proj:RespDsgnrAddress02 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity02) > 0) 
        then if (Proj:RespDsgnrCity02 != " - specify - " .AND. Proj:RespDsgnrCity02 != "- specify -") then Proj:RespDsgnrCity02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState02) > 0) 
        then if (Proj:RespDsgnrState02 != " - specify - " .AND. Proj:RespDsgnrState02 != "- specify -") then Proj:RespDsgnrState02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode02) > 0) 
        then if (Proj:RespDsgnrZipCode02 != " - specify - " .AND. Proj:RespDsgnrZipCode02 != "- specify -") then Proj:RespDsgnrZipCode02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone02) > 0) 
        then if (Proj:RespDsgnrPhone02 != " - specify - " .AND. Proj:RespDsgnrPhone02 != "- specify -") then Proj:RespDsgnrPhone02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType02) > 0) 
        then if (Proj:RespDsgnrType02 != " - specify - " .AND. Proj:RespDsgnrType02 != "- specify -") then Proj:RespDsgnrType02 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonLightingDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonLightingDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense02) > 0) 
        then if (Proj:RespDsgnrLicense02 != " - specify - " .AND. Proj:RespDsgnrLicense02 != "- specify -") then Proj:RespDsgnrLicense02 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccResponsiblePersonMechanicalDesigner"  1 0 0 1
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsibleMechanicalDesigner01_Name" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsibleMechanicalDesigner01_Name = { 
        if (GlobalStatus(Proj:RespDsgnrName03) > 0) 
        then if (Proj:RespDsgnrName03 != " - specify - " .AND. Proj:RespDsgnrName03 != "- specify -") then Proj:RespDsgnrName03 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson03_Company" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson03_Company = { 
        if (GlobalStatus(Proj:RespDsgnrCompany03) > 0) 
        then if (Proj:RespDsgnrCompany03 != " - specify - " .AND. Proj:RespDsgnrCompany03 != "- specify -") then Proj:RespDsgnrCompany03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson04_Address" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson04_Address = { 
        if (GlobalStatus(Proj:RespDsgnrAddress03) > 0) 
        then if (Proj:RespDsgnrAddress03 != " - specify - " .AND. Proj:RespDsgnrAddress03 != "- specify -") then Proj:RespDsgnrAddress03 else UNDEFINED endif 
        else UNDEFINED endif }

   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson06_City" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson06_City = { 
        if (GlobalStatus(Proj:RespDsgnrCity03) > 0) 
        then if (Proj:RespDsgnrCity03 != " - specify - " .AND. Proj:RespDsgnrCity03 != "- specify -") then Proj:RespDsgnrCity03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson07_State" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson07_State = { 
        if (GlobalStatus(Proj:RespDsgnrState03) > 0) 
        then if (Proj:RespDsgnrState03 != " - specify - " .AND. Proj:RespDsgnrState03 != "- specify -") then Proj:RespDsgnrState03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson08_Zipcode" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson08_Zipcode = { 
        if (GlobalStatus(Proj:RespDsgnrZipCode03) > 0) 
        then if (Proj:RespDsgnrZipCode03 != " - specify - " .AND. Proj:RespDsgnrZipCode03 != "- specify -") then Proj:RespDsgnrZipCode03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson09_Phone" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson09_Phone = { 
        if (GlobalStatus(Proj:RespDsgnrPhone03) > 0) 
        then if (Proj:RespDsgnrPhone03 != " - specify - " .AND. Proj:RespDsgnrPhone03 != "- specify -") then Proj:RespDsgnrPhone03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson10_JobTitle" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson10_JobTitle = { 
        if (GlobalStatus(Proj:RespDsgnrType03) > 0) 
        then if (Proj:RespDsgnrType03 != " - specify - " .AND. Proj:RespDsgnrType03 != "- specify -") then Proj:RespDsgnrType03 else UNDEFINED endif 
        else UNDEFINED endif }
   "Set nrcResponsiblePersonMechanicalDesigner:comp_responsiblePerson11_License" nrcccomp_ResponsiblePersonMechanicalDesigner:comp_responsiblePerson11_License = { 
        if (GlobalStatus(Proj:RespDsgnrLicense03) > 0) 
        then if (Proj:RespDsgnrLicense03 != " - specify - " .AND. Proj:RespDsgnrLicense03 != "- specify -") then Proj:RespDsgnrLicense03 else UNDEFINED endif 
        else UNDEFINED endif }
END
;*************************************************************************

;*************************************************************************
RULELIST "NRCCPRF_Init_nrccFooter"  1 0 0 1
;   "Set nrccFooter:comp_complianceDocumentStandardsTitle"  nrccFooter:comp_complianceDocumentStandardsTitle = {  ??  }
END
;*************************************************************************


;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row1"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[1]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[1]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[1]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[1]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[1]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[1]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[1]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[1]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row2"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[2]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[2]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[2]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[2]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[2]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[2]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[2]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[2]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row3"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[3]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[3]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[3]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[3]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[3]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[3]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[3]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[3]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row4"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[4]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[4]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[4]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[4]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[4]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[4]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[4]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[4]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row5"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[5]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[5]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[5]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[5]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[5]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[5]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[5]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[5]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row6"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[6]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[6]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[6]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[6]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[6]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[6]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[6]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[6]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row7"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[7]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[7]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[7]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[7]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[7]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[7]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[7]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[7]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row8"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[8]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[8]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[8]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[8]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[8]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[8]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[8]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[8]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row9"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[9]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[9]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[9]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[9]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[9]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[9]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[9]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[9]  }
END
;*************************************************************************
RULELIST "NRCCPRF_RowLtgControls_row10"  1 0 0 1
   "Set nrcctblRowLtgControls:LtgControls03_SpaceDescription"                                nrcctblRowLtgControls:LtgControls03_SpaceDescription                             =
      {  Proj:MandatoryLtgCtrlDescRpt[10]             }
   "Set nrcctblRowLtgControls:LtgControls04_SpaceFunction"                                   nrcctblRowLtgControls:LtgControls04_SpaceFunction                                =
      { if (enumvalue(Proj:MandatoryLtgCtrlSpcFunctRpt[10]) < 1)
        then UNDEFINED
        else SpaceFunctionData:NRCCPRFSpaceFunction("FuncType", Proj:MandatoryLtgCtrlSpcFunctRpt[10]) 
        endif }
   "Set nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired"                   nrcctblRowLtgControls:LtgControls05_MandatoryAreaControlsRequired                =
      {  Proj:MandatoryLtgCtrlIsAreaCtrlRpt[10]       }
   "Set nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired"              nrcctblRowLtgControls:LtgControls06_MandatoryMultiLevelControlRequired           =
      {  Proj:MandatoryLtgCtrlIsMultiLvlCtrlRpt[10]   }
   "Set nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired"                 nrcctblRowLtgControls:LtgControls07_MandatoryShutOffControlRequired              =
      {  Proj:MandatoryLtgCtrlIsShutOffCtrlRpt[10]    }
   "Set nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired"      nrcctblRowLtgControls:LtgControls08_MandatoryPrimaryDaylightingControlRequired   =
      {  Proj:MandatoryLtgCtrlIsPriDayltgCtrlRpt[10]  }
   "Set nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired"    nrcctblRowLtgControls:LtgControls09_MandatorySecondaryDaylightingControlRequired =
      {  Proj:MandatoryLtgCtrlIsSecDayltgCtrlRpt[10]  }
END
;*************************************************************************

; RJH 10/5/22 Switched 2022 Section_WaterDWHR implementation from previous 2019 NRCC to Res CF1R Section_Tdw implementation


;*************************************************************************
; porting of PV & Battery sections/tables from CF1R - require full re-work due to diffs in data model (PV/Batt in Res via Project properties vs. individual objects in Com) - SAC 08/23/22
;   CF1R Da (PV) & Db (Batt) -> NRCC/LMCC sections F1 & F2 / 
;*************************************************************************
;  RULELIST "CF1RPRF01E_Section_Da"  1 0 0 1
;  
;     "Create & initialize new cf1rTablePV object"
;        cf1rSection_Da:Action   = {  CreateChildren( cf1rTablePV, 1, "EDR_PV" )  }     ; no init needed
;    ; ----------------------------------------------------------------------
;    ; Section_Da rules to create individual EDR_PV table rows
;     "Create cf1rtblRowPV for all PVW instances - 1"
;        Proj:CF1R_PVRow[1]   = {  if (IfValidAnd( CommunitySolarProjID > 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow1", "CF1RPRF01E_Section_Da_Row1_CommunitySolar" )
;                                      else if (IfValidAnd( PVWDCSysSize[1] > 0 )==0 .OR. IfValidAnd( UseReducedPVReqVal == 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow1", "CF1RPRF01E_Section_Da_Row1_0ReqPVException" )
;                                      else  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow1", "CF1RPRF01E_Section_Da_Row1" )
;                                      endif endif  }
;     "Create cf1rtblRowPV for all PVW instances - 2"
;        Proj:CF1R_PVRow[2]   = {  if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[2] > 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow2", "CF1RPRF01E_Section_Da_Row2" )
;                                      else  UNCHANGED  endif  }
;     "Create cf1rtblRowPV for all PVW instances - 3"
;        Proj:CF1R_PVRow[3]   = {  if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[3] > 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow3", "CF1RPRF01E_Section_Da_Row3" )
;                                      else  UNCHANGED  endif  }
;     "Create cf1rtblRowPV for all PVW instances - 4"
;        Proj:CF1R_PVRow[4]   = {  if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[4] > 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow4", "CF1RPRF01E_Section_Da_Row4" )
;                                      else  UNCHANGED  endif  }
;     "Create cf1rtblRowPV for all PVW instances - 5"
;        Proj:CF1R_PVRow[5]   = {  if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[5] > 0 ))
;                                      then  CreateComp( cf1rtblRowPV, Name + "EDR_PVRow5", "CF1RPRF01E_Section_Da_Row5" )
;                                      else  UNCHANGED  endif  }
;  
;    ; Rule to add EDR_PV table rows to the cf1rTablePV
;        "Set cf1rtblRowPV:Parent"
;           cf1rtblRowPV:Parent  = {  cf1rTablePV:Name  }
;  END

;************************************************************************* SAC 6/12/20 (CommunitySolar)
RULELIST "CF1RPRF01E_Section_Da_Row1_CommunitySolar"  1 0 0 1
     "Set cf1rtblRowPV:Pv01_PV_SystemTotalRatedPowerDC"    cf1rtblRowPV:Pv01_PV_SystemTotalRatedPowerDC  = {
            int((ValidOr( Proj:PrscrpPVSize, 0 ) * 100) + 0.5) / 100  }

     "Set cf1rtblRowPV:Pv02_PhotoVoltaicExceptionRes"    cf1rtblRowPV:Pv02_PhotoVoltaicExceptionRes  = { 
            "CommunitySolar"  }
     "Set cf1rtblRowPV:Pv02_PVExceptionString"    cf1rtblRowPV:Pv02_PVExceptionString  = { 
            EnumString( Proj:CommunitySolarProject )  }

     "Set cf1rtblRowPV:Pv03_NotApplicableMessage" cf1rtblRowPV:Pv03_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv04_NotApplicableMessage" cf1rtblRowPV:Pv04_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv05_NotApplicableMessage" cf1rtblRowPV:Pv05_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv06_NotApplicableMessage" cf1rtblRowPV:Pv06_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv07_NotApplicableMessage" cf1rtblRowPV:Pv07_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv08_NotApplicableMessage" cf1rtblRowPV:Pv08_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv09_NotApplicableMessage" cf1rtblRowPV:Pv09_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv10_NotApplicableMessage" cf1rtblRowPV:Pv10_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv11_NotApplicableMessage" cf1rtblRowPV:Pv11_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv12_NotApplicableMessage" cf1rtblRowPV:Pv12_NotApplicableMessage  = { "n/a"  }
END

;  ;************************************************************************* replace several individual rules for documenting Reduced PV requirement - SAC 03/01/21
;  RULELIST "CF1RPRF01E_Set_Pv02_PhotoVoltaicExceptionRes"  1 0 0 1
;       "Set cf1rtblRowPV:Pv02_PhotoVoltaicExceptionRes"    cf1rtblRowPV:Pv02_PhotoVoltaicExceptionRes  = { 
;  			switch( EnumString( Proj:ReducedPVReqExcept ) )
;  				case "- select applicable required PV exception -"                            :  "NoExceptionsNA"
;  				case "(1) Effective solar access < 80 ft2"                                    :  "LimitedSolarAccess"
;  				case "(2) Smaller of solar access and home area-based size (CZ 15 only)"      :  "CZ15ReducedSize"
;  				case "(2) NOT VALID IN THIS CZ - Smaller of solar access and home area-based" :  "NoExceptionsNA"
;  				case "(3) 2 habitable stories - smaller of solar access and home area-based"  :  "HabitableStories2"
;  				case "(4) 3 habitable stories - smaller of solar access and home area-based"  :  "HabitableStories3"
;  				case "(5) 80-200 ft2 solar ready zone approved before 1/1/20"                 :  "PlansBefore2020"
;  				case "(6) Declared emergency area (prior to 1/1/20)"                          :  "DeclaredEmergencyArea"    ; SAC 2/1/20 (tic #1157)  ; SAC 03/01/21
;  				case "(7) Section 10-109(k) determination"                                    :  "Section10_109k"           ; SAC 03/01/21
;  				case "(8) Excessive snow load"                                                :  "SnowLoad"                 ; SAC 03/01/21
;              case "(1) Solar Access Roof Area (SARA) < 80 ft2"                             :  "LimitedSolarAccess"    ; 2022 exceptions (some reused) - SAC 05/23/22 (tic #1292)
;              case "(2) No PV Req'd when less than 1.8 kWdc"                                :  "MinimumSize"
;              case "(3) Excessive snow load"                                                :  "SnowLoad"
;              case "(4) Bldgs approved by local planning dept prior to 1/1/20"              :  "PlansBefore2020"
;  				default  :  UNDEFINED
;  			endswitch  }
;  END

;************************************************************************* SAC 1/29/20 - new rules for documenting 0 Reduced PV requirement (tic #1193)
RULELIST "CF1RPRF01E_Section_Da_Row1_0ReqPVException"  1 0 0 1
     "Set cf1rtblRowPV:Pv01_PV_SystemTotalRatedPowerDC"    cf1rtblRowPV:Pv01_PV_SystemTotalRatedPowerDC  = {  0  }
     "Set cf1rtblRowPV:Pv02_PhotoVoltaicExceptionRes"      cf1rtblRowPV:Action = {  EvalRulelist( "CF1RPRF01E_Set_Pv02_PhotoVoltaicExceptionRes", 1 )  }     ; SAC 03/01/21
     "Set cf1rtblRowPV:Pv03_ArrayModuleType"    cf1rtblRowPV:Pv03_ArrayModuleType  = { "Standard" }
     "Set cf1rtblRowPV:Pv04_ArrayType"    cf1rtblRowPV:Pv04_ArrayType  = { "FixedArray" }
     "Set cf1rtblRowPV:Pv05_PowerElectronics"    cf1rtblRowPV:Pv05_PowerElectronics  = { "NoPowerElectronics" }
     "Set cf1rtblRowPV:Pv06_CFI_PV"    cf1rtblRowPV:Pv06_CFI_PV  = {  "true"  }
     "Set cf1rtblRowPV:Pv07_NotApplicableMessage" cf1rtblRowPV:Pv07_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv08_NotApplicableMessage" cf1rtblRowPV:Pv08_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv09_NotApplicableMessage" cf1rtblRowPV:Pv09_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv10_NotApplicableMessage" cf1rtblRowPV:Pv10_NotApplicableMessage  = { "n/a"  }
     "Set cf1rtblRowPV:Pv11_NotApplicableMessage" cf1rtblRowPV:Pv11_NotApplicableMessage  = { "n/a"  }

     "Set cf1rtblRowPV:Parent" cf1rtblRowPV:Parent  = {  cf1rTablePV:Name  }
END


;************************************************************************* SAC 08/23/22
RULELIST "CF1RPRF01E_Section_Da_PVArray"  1 0 0 1
   "Create PVArray:CF1R_PVRow"     PVArray:CF1R_PVRow = {  CreateComp( cf1rtblRowPV, Name + "NRCC PVRow" )  }
  ; Rules to populate EDR_PV table row from PVArray
     "Set PVArray:CF1R_PVRow:Pv01_PV_SystemTotalRatedPowerDC"    PVArray:CF1R_PVRow:Pv01_PV_SystemTotalRatedPowerDC  = {
             int((ValidOr( Proj:DCSizeMultiplier, 1 ) * DCSysSize * 100) + 0.5) / 100  }
; TO DO - CBECC-22 PV exceptions
;     "Set PVArray:CF1R_PVRow:Pv02_PhotoVoltaicExceptionRes"      PVArray:CF1R_PVRow:Action = {  EvalRulelist( "CF1RPRF01E_Set_Pv02_PhotoVoltaicExceptionRes", 1 )  }     ; SAC 03/01/21
     "Set PVArray:CF1R_PVRow:Pv03_ArrayModuleType"    PVArray:CF1R_PVRow:Pv03_ArrayModuleType  = { 
																									switch( EnumString( ModuleType ) )
																										case "Standard"  :  "Standard"
																										case "Premium"   :  "Premium"
																										case "ThinFilm"  :  "ThinFilm"
																										case "Thin Film" :  "ThinFilm"
																										case "Custom"    :  "Custom"
																										default  :  UNDEFINED
																									endswitch  }
     "Set PVArray:CF1R_PVRow:Pv04_ArrayType"    PVArray:CF1R_PVRow:Pv04_ArrayType  = { 
																					switch( EnumString( ArrayType ) )
																						case "Fixed (open rack)"   :  "FixedArray"
																						case "Tracking (one axis)" :  "Tracking1Axis"
																						case "Tracking (two axis)" :  "Tracking2Axis"
																						default  :  UNDEFINED
																					endswitch  }
     "Set PVArray:CF1R_PVRow:Pv05_PowerElectronics"    PVArray:CF1R_PVRow:Pv05_PowerElectronics  = { 
																								switch( EnumString( PwrElec ) )
																									case "Microinverters"      :  "Microinverters"
																									case "- none -"            :  "NoPowerElectronics"
																									case "DC Power Optimizers" :  "PowerOptimizer"
																									default  :  UNDEFINED
																								endswitch  }
     "Set PVArray:CF1R_PVRow:Pv06_CFI_PV"    PVArray:CF1R_PVRow:Pv06_CFI_PV  = {  if( CalFlexibleInstallOpt == "n/a" ) then "false" else "true" endif  } 
;    n/a
;    CFI1
;    CFI2

     "Set PVArray:CF1R_PVRow:Pv07_Azimuth"    PVArray:CF1R_PVRow:Pv07_Azimuth  = {  if( CalFlexibleInstallOpt != "n/a" .OR. ArrayType == "Tracking (two axis)" ) then UNDEFINED else Az endif  }
     "Set PVArray:CF1R_PVRow:Pv07_AzimuthRange"    PVArray:CF1R_PVRow:Pv07_AzimuthRange  = {  if( CalFlexibleInstallOpt == "CFI1" ) then "150To270" 
	                                                                                      else if( CalFlexibleInstallOpt == "CFI2" ) then "105To300" 
																						  else UNDEFINED endif endif  } 
     "Set PVArray:CF1R_PVRow:Pv07_AzimuthRangeString"    PVArray:CF1R_PVRow:Pv07_AzimuthRangeString  =    ; SAC 2/3/20 - string representation of Azimuth, valid ranges for CFI* or entered value (tic #1012)
         {  if (IfValidAnd( CF1R_PVRow:Pv07_Azimuth > -360 )) then  FltToStr( CF1R_PVRow:Pv07_Azimuth )
            else if (IfValidAnd( CF1R_PVRow:Pv07_AzimuthRange == "150to270" )) then "150-270" 
            else if (IfValidAnd( CF1R_PVRow:Pv07_AzimuthRange == "105to300" )) then "105-300"
            else  UNDEFINED  endif endif endif  }
     "Set PVArray:CF1R_PVRow:Pv07_NotApplicableMessage" PVArray:CF1R_PVRow:Pv07_NotApplicableMessage  = { if ( (LocalStatus ( CF1R_PVRow:Pv07_Azimuth ) < 1) .AND. (LocalStatus ( CF1R_PVRow:Pv07_AzimuthRange ) < 1) ) then "n/a" else UNDEFINED endif  }
     "Set PVArray:CF1R_PVRow:Pv08_TiltMeasurementType" PVArray:CF1R_PVRow:Pv08_TiltMeasurementType  = {  if( CalFlexibleInstallOpt != "n/a" .OR. ArrayType == "Tracking (two axis)" ) 
	                                                                                                   then UNDEFINED 
																									   else
																										   switch( EnumString( TiltInp ) )
																											  case "deg"    :  "TiltDegrees"
																											  case "pitch"  :  "TiltPitch"
																											  default       :  UNDEFINED
																										   endswitch
																									   endif  }
     "Set PVArray:CF1R_PVRow:Pv08_NotApplicableMessage" PVArray:CF1R_PVRow:Pv08_NotApplicableMessage  = { if ( LocalStatus ( CF1R_PVRow:Pv08_TiltMeasurementType ) < 1 ) then "n/a" else UNDEFINED endif  }
     "Set PVArray:CF1R_PVRow:Pv09_Tilt"    PVArray:CF1R_PVRow:Pv09_Tilt  = {  if( CalFlexibleInstallOpt != "n/a" .OR. ArrayType == "Tracking (two axis)" ) then UNDEFINED else atof( Format( "%.2f", TiltAngle ) ) endif }
     "Set PVArray:CF1R_PVRow:Pv09_NotApplicableMessage" PVArray:CF1R_PVRow:Pv09_NotApplicableMessage  = { if ( LocalStatus ( CF1R_PVRow:Pv09_Tilt ) < 1 ) then "n/a" else UNDEFINED endif  }

     "Set PVArray:CF1R_PVRow:Pv10_RoofRise"    PVArray:CF1R_PVRow:Pv10_RoofRise  = {  if( CalFlexibleInstallOpt != "n/a" .OR. ArrayType == "Tracking (two axis)" ) then UNDEFINED else atof( Format( "%.2f", TiltPitch ) ) endif }
     "Set PVArray:CF1R_PVRow:Pv10_RoofRiseString"    PVArray:CF1R_PVRow:Pv10_RoofRiseString  = {  if( CalFlexibleInstallOpt != "n/a" ) then "<=7:12" 
																						      else UNDEFINED endif  } 
     "Set PVArray:CF1R_PVRow:Pv10_NotApplicableMessage" PVArray:CF1R_PVRow:Pv10_NotApplicableMessage  = { if ( (LocalStatus ( CF1R_PVRow:Pv10_RoofRise ) < 1) .AND. (LocalStatus ( CF1R_PVRow:Pv10_RoofRiseString ) < 1) ) then "n/a" else UNDEFINED endif  }

     "Set PVArray:CF1R_PVRow:Pv11_InverterEfficiencyPercent"    PVArray:CF1R_PVRow:Pv11_InverterEfficiencyPercent  = {  InverterEff  }
     "Set PVArray:CF1R_PVRow:Pv11_NotApplicableMessage" PVArray:CF1R_PVRow:Pv11_NotApplicableMessage  = { if ( LocalStatus ( CF1R_PVRow:Pv11_InverterEfficiencyPercent ) < 1 ) then "n/a" else UNDEFINED endif  }
     "Set PVArray:CF1R_PVRow:Pv12_AnnualSolarAccess" PVArray:CF1R_PVRow:Pv12_AnnualSolarAccess  = {  int( ValidOr( SolarAccess, 100 ) + 0.5 )  } 
     "Set PVArray:CF1R_PVRow:Parent"  PVArray:CF1R_PVRow:Parent  = {  cf1rTablePV:Name  }  
END


;*************************************************************************

;  ;************************************************************************* SAC 2/3/20 - rules to ensure PV capacities reflect final PV scaling (tic #1012)
;  RULELIST "CF1RPRF01E_Section_Da_FinalUpdate"  1 0 0 1
;       "Set Proj:CF1R_PVRow[1]:Pv01_PV_SystemTotalRatedPowerDC"    Proj:CF1R_PVRow[1]:Pv01_PV_SystemTotalRatedPowerDC  = {
;              int((Proj:PVWDCSysSize[1] * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) * 100) + 0.5) / 100  }
;       "Set Proj:CF1R_PVRow[2]:Pv01_PV_SystemTotalRatedPowerDC"    Proj:CF1R_PVRow[2]:Pv01_PV_SystemTotalRatedPowerDC  = {
;              int((Proj:PVWDCSysSize[2] * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) * 100) + 0.5) / 100  }
;       "Set Proj:CF1R_PVRow[3]:Pv01_PV_SystemTotalRatedPowerDC"    Proj:CF1R_PVRow[3]:Pv01_PV_SystemTotalRatedPowerDC  = {
;              int((Proj:PVWDCSysSize[3] * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) * 100) + 0.5) / 100  }
;       "Set Proj:CF1R_PVRow[4]:Pv01_PV_SystemTotalRatedPowerDC"    Proj:CF1R_PVRow[4]:Pv01_PV_SystemTotalRatedPowerDC  = {
;              int((Proj:PVWDCSysSize[4] * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) * 100) + 0.5) / 100  }
;       "Set Proj:CF1R_PVRow[5]:Pv01_PV_SystemTotalRatedPowerDC"    Proj:CF1R_PVRow[5]:Pv01_PV_SystemTotalRatedPowerDC  = {
;              int((Proj:PVWDCSysSize[5] * ValidOr( Proj:PVWDCSizeMultiplier[1], 1 ) * 100) + 0.5) / 100  }
;  END
;  ;*************************************************************************



;*************************************************************************
RULELIST "CF1RPRF01E_Section_Db_Batt"  1 0 0 1
   "Create Batt:CF1R_BatRow"     Batt:CF1R_BatRow = {  CreateComp( cf1rtblRowBat, Name + "NRCC BattRow" )  }
;   "Create & initialize new cf1rTableBat object"
;      cf1rSection_Bat:Action   = {  CreateChildren( cf1rTableBat, 1, "EDR_Bat" )  }     ; no init needed
;  ; ----------------------------------------------------------------------
;  ; Section_Bat rules to create individual EDR_Bat table rows
;   "Create cf1rtblRowBat for all Battery instances (currently only 1 allowed)"
;      Batt:CF1R_BatRow   = {  CreateComp( cf1rtblRowBat, Name + "EDR_BatRow" )  }

  ; Rules to populate EDR_Bat table rows for FIRST AND ONLY EDR_Bat instance
     "Set Batt:CF1R_BatRow:Bat01_BatteryControl"    Batt:CF1R_BatRow:Bat01_BatteryControl  = { 
																									switch( Ctrl )
																										case "Basic"                   :  "Basic"
																										case "Time of Use"             :  "TOU"
																										case "Advanced DR Control"     :  "AdvancedDR"
																									;	case "Advanced Control (old)"  :  "AdvancedControlOld"
																										default       :  UNDEFINED
																									endswitch  }

     "Set Batt:CF1R_BatRow:Bat02_BatteryCapacity"    Batt:CF1R_BatRow:Bat02_BatteryCapacity  = { atof( Format( "%.2f", MaxCap ) ) }

     "Set Batt:CF1R_BatRow:Bat03_ChargingEfficiency"    Batt:CF1R_BatRow:Bat03_ChargingEfficiency  = { if ( IfValidAnd(RoundTripEff > 0) )
                                                                                                       then UNDEFINED
                                                                                                       else atof( Format( "%.2f", ChrgEff ) )
                                                                                                       endif }
     "Set Batt:CF1R_BatRow:Bat03_NotApplicableMessage" Batt:CF1R_BatRow:Bat03_NotApplicableMessage  = { if ( LocalStatus ( CF1R_BatRow:Bat03_ChargingEfficiency ) < 1 ) then "NotApplicable" else UNDEFINED endif  }

     "Set Batt:CF1R_BatRow:Bat04_ChargingRate"    Batt:CF1R_BatRow:Bat04_ChargingRate  = {  atof( Format( "%.2f", ValidOr( MaxChrgPwr, 0 ) ) )  }
     "Set Batt:CF1R_BatRow:Bat04_NotApplicableMessage" Batt:CF1R_BatRow:Bat04_NotApplicableMessage  = { if ( LocalStatus ( CF1R_BatRow:Bat04_ChargingRate ) < 1 ) then "n/a" else UNDEFINED endif  }

     "Set Batt:CF1R_BatRow:Bat05_DischargingEfficiency"    Batt:CF1R_BatRow:Bat05_DischargingEfficiency  = { if ( IfValidAnd(RoundTripEff > 0) )
                                                                                                             then UNDEFINED
                                                                                                             else atof( Format( "%.2f", DschrgEff ) )
                                                                                                             endif }
     "Set Batt:CF1R_BatRow:Bat05_NotApplicableMessage" Batt:CF1R_BatRow:Bat05_NotApplicableMessage  = { if ( LocalStatus ( CF1R_BatRow:Bat05_DischargingEfficiency ) < 1 ) then "NotApplicable" else UNDEFINED endif  }
   
     "Set Batt:CF1R_BatRow:Bat06_DischargingRate"    Batt:CF1R_BatRow:Bat06_DischargingRate  = { if ( IfValidAnd(RoundTripEff > 0) )
                                                                                                 then atof( Format( "%.2f", ValidOr( MaxDschrgPwr, 0 ) ) )
                                                                                                 else UNDEFINED
                                                                                                 endif }
     "Set Batt:CF1R_BatRow:Bat06_NotApplicableMessage" Batt:CF1R_BatRow:Bat06_NotApplicableMessage  = { if ( LocalStatus ( CF1R_BatRow:Bat06_DischargingRate ) < 1 ) then "n/a" else UNDEFINED endif  }

     "Set Batt:CF1R_BatRow:Bat07_ChargeDischargeEfficiency"    Batt:CF1R_BatRow:Bat07_ChargeDischargeEfficiency  = { if ( AnalysisVersion > 220000 )
																										                   then atof( Format( "%.2f", ValidOr( RoundTripEff, 0 ) ) ) 
																										                   else UNDEFINED
																									                       endif }
     "Set Batt:CF1R_BatRow:Bat07_NotApplicableMessage" Batt:CF1R_BatRow:Bat07_NotApplicableMessage  = { if ( AnalysisVersion > 220000 )
                                                                                                              then if ( LocalStatus ( CF1R_BatRow:Bat07_ChargeDischargeEfficiency ) < 1 ) then "n/a" else UNDEFINED endif
                                                                                                              else UNDEFINED
                                                                                                              endif }

  ; Rule to add EDR_Bat table rows to the cf1rTableBat
      "Set Batt:CF1R_BatRow:Parent"
         Batt:CF1R_BatRow:Parent  = {  cf1rTableBat:Name  }

;     "Set PVArray:CF1R_PVRow:Parent"  PVArray:CF1R_PVRow:Parent  = {  cf1rTablePV:Name  }
END
;*************************************************************************

;  Batt   User: "Batt 1"  
;     AllowStandaloneBatt = RVal: 0
;     SimStandaloneBatt = RDef: 0
;     MaxCap = RDef: 5
;     DegradePct = RVal: 100
;     CapRat = RVal: 0.357143
;     Ctrl = UVal: "Time of Use"  (10)
;     AllowDischgStartHr = RVal: 0
;     StandaloneChgStartHr = RDef: 1
;     TOUFirstMonth = RVal: 1
;     TOULastMonth = RVal: 12
;     ChrgEff = RDef: 0.95
;     DschrgEff = RDef: 0.95
;     AllowBattRoundTripEff = RDef: 0
;     RoundTripEff = RDef: 0.9025
;     AdvBattTDVPkDayVal = RVal: 34.12
;     NumRankedDays = RVal: 20
;     UserMsg2[1] = RVal: "The battery model doesn't currently include extra energy consumption for"
;     UserMsg2[2] = RVal: "cooling the battery during charging in environments above 77F or to keep"
;     UserMsg2[3] = RVal: "the battery from freezing in winter if outdoors."
;     UserMsg2[4] = RVal: "WARNING: the battery will NOT be"
;     UserMsg2[5] = RVal: "simulated if roundtrip efficiency < 0.8."
;     TDVSummerPkFirstHr = RVal: 19
;     MaxChrgPwr = RVal: 1.78571
;     MaxDschrgPwr = RVal: 1.78571
;     TreeDescrip = RVal: "5 kWh, Time of Use control, charge/discharge efficiency: 0.95/0.95"
;     ..


;*************************************************************************
;*************************************************************************

ENDFILE
